{"version":3,"sources":["webpack:///D:/Projects/rick-love-master/code/utils/objects.ts","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/es6.reflect.construct.js","webpack:///D:/Projects/rick-love-master/code/utils/random.ts","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/_parse-int.js","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/_parse-float.js","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/es6.number.parse-int.js","webpack:///D:/Projects/rick-love-master/code/utils/email-address.ts","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/es6.string.starts-with.js","webpack:///D:/Projects/rick-love-master/code/games/educational-games/problems/problems-reviewer.ts","webpack:///D:/Projects/rick-love-master/code/games/educational-games/star-blast-sideways-with-subjects/voice-chooser.tsx","webpack:///D:/Projects/rick-love-master/code/react-native-lite/index.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/components/game-pad-analog.tsx","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/es6.array.find-index.js","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/es6.number.parse-float.js","webpack:///D:/Projects/rick-love-master/code/games/educational-games/utils/vectors.ts","webpack:///D:/Projects/rick-love-master/node_modules/@stripe/react-stripe-js/dist/react-stripe.umd.js","webpack:///D:/Projects/rick-love-master/code/utils/phone-number.ts","webpack:///D:/Projects/rick-love-master/node_modules/@stripe/stripe-js/dist/stripe.esm.js","webpack:///D:/Projects/rick-love-master/code/payments/common/types.ts","webpack:///D:/Projects/rick-love-master/code/payments/common/process-steps.ts","webpack:///D:/Projects/rick-love-master/code/payments/providers/stripe/common/stripe-process-steps.ts","webpack:///D:/Projects/rick-love-master/code/payments/providers/stripe/client/stripe-payment-react.tsx","webpack:///D:/Projects/rick-love-master/code/payments/providers/stripe/client/stripe-client-tokens.ts","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/_math-sign.js","webpack:///D:/Projects/rick-love-master/node_modules/react-icons/lib/esm/iconsManifest.js","webpack:///D:/Projects/rick-love-master/node_modules/react-icons/lib/esm/iconContext.js","webpack:///D:/Projects/rick-love-master/node_modules/react-icons/lib/esm/iconBase.js","webpack:///D:/Projects/rick-love-master/code/games/educational-games/utils/speech.ts","webpack:///D:/Projects/rick-love-master/code/controls-react/icon-kind.ts","webpack:///D:/Projects/rick-love-master/code/utils/json.ts","webpack:///D:/Projects/rick-love-master/code/controls-react/icon.tsx","webpack:///D:/Projects/rick-love-master/code/controls-react/error-box.tsx","webpack:///D:/Projects/rick-love-master/code/controls-react/button.tsx","webpack:///D:/Projects/rick-love-master/code/controls-react/index.tsx","webpack:///D:/Projects/rick-love-master/code/controls-react/loading.tsx","webpack:///D:/Projects/rick-love-master/code/controls-react/inputs.tsx","webpack:///D:/Projects/rick-love-master/node_modules/core-js/modules/es6.math.sign.js","webpack:///D:/Projects/rick-love-master/code/utils/delay.ts","webpack:///D:/Projects/rick-love-master/code/themes/theme.ts","webpack:///D:/Projects/rick-love-master/code/games/educational-games/problems/multiples.ts","webpack:///D:/Projects/rick-love-master/code/utils/arrays.ts","webpack:///D:/Projects/rick-love-master/code/utils-react/hooks.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/star-blast-sideways.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/components/leaderboard.tsx","webpack:///D:/Projects/rick-love-master/code/games/console-simulator/utils.ts"],"names":["getValuesAsItems","obj","Object","keys","map","k","filter","x","toKeyValueObject","items","v","forEach","key","value","toMap","Map","$export","create","aFunction","anObject","isObject","fails","bind","rConstruct","Reflect","construct","NEW_TARGET_BUG","F","ARGS_BUG","S","Target","args","newTarget","arguments","length","$args","push","apply","proto","prototype","instance","result","Function","call","randomIndex","Math","floor","random","randomItem","$parseInt","parseInt","$trim","trim","ws","hex","module","exports","str","radix","string","String","test","$parseFloat","parseFloat","Infinity","charAt","Number","toEmailAddress","email","toLength","context","$startsWith","P","startsWith","searchString","that","this","index","min","undefined","search","slice","createReviewProblemService","problemSource","maxReviewCount","reviewSequenceLength","reviewSequencePreviousLength","reviewQuestionPrefix","state","problemSourceHistory","problemsToReview","reviewSequence","repeatState","startReview","console","log","service","getSections","gotoSection","getNextProblem","reviewProblem","iNext","iEnd","nextProblemToReview","max","seq","p","question","answers","shuffle","getReviewProblem","newProblem","recordAnswer","problem","answer","isCorrect","i","findIndex","distinct_key","VoiceChooser","languange","speechService","useState","loading","setLoading","setRenderId","refresh","setTimeout","useEffect","onPress","style","fontSize","size","color","getVoicesForLanguange","voice","setVoiceForLanguange","s","speak","name","margin","whiteSpace","isSelected","lang","localService","mergeStyles","Array","isArray","item","viewStyleDefaults","display","flexDirection","textStyleDefaults","finalizeTextStyle","userSelect","MozUserSelect","WebkitUserSelect","View","props","children","Text","numberOfLines","allStyles","overflow","wordWrap","textOverflow","TextInput","type","keyboardType","secureTextEntry","autoCompleteType","onKeyPress","onSubmitEditing","e","shiftKey","preventDefault","id","placeholder","disabled","editable","onChange","target","onBlur","TouchableOpacity","lastPressTime","useRef","Date","now","current","hasTouchStarted","onClick","onTouchStart","onTouchMove","onTouchEnd","role","tabIndex","Pressable","onIgnore","stopPropagation","cancelBubble","returnValue","onPressIn","onPressOut","onMouseDown","onMouseUp","onTouchCancel","onMouseLeave","onTouchEndCapture","ActivityIndicator","sizePx","CircleSvg","thickness","dashLength","PI","maxWidth","viewBox","xmlns","fill","stroke","strokeWidth","opacity","cx","cy","r","className","strokeDasharray","transformOrigin","Platform","OS","Clipboard","setString","a","navigator","clipboard","writeText","GamepadAnalogStateful","moveDirection","y","buttons","isDown","text","onPressStateChange","GamepadAnalog","onMovePressIn","dir","onMovePressOut","inputStyles","container","flex","alignSelf","justifyContent","alignItems","padding","section","moveSectionWrapper","moveSectionRotation","transform","row","cellTouch","outline","cellView","pointerEvents","position","width","height","borderWidth","borderStyle","cellText","moveCellText","cellEmptyView","cellTextOcclusionView","top","bottom","left","right","backgroundColor","cellViewStyle","onKeyDown","onKeyUp","window","addEventListener","removeEventListener","DirectionButton","direction","ActionButton","Fragment","$find","KEY","forced","callbackfn","getDistanceSq","b","React","_typeof","Symbol","iterator","constructor","_objectWithoutProperties","source","excluded","sourceKeys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_slicedToArray","arr","_arrayWithHoles","toString","_arr","_n","_d","_e","_s","_i","next","done","err","_iterableToArrayLimit","TypeError","_nonIterableRest","emptyFunction","emptyFunctionWithReset","hasOwnProperty","resetWarningCache","propTypes","fn","createCommonjsModule","shim","propName","componentName","location","propFullName","secret","Error","getShim","isRequired","ReactPropTypes","array","bool","func","number","object","symbol","any","arrayOf","element","elementType","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","factoryWithThrowingShims","isUnknownObject","raw","isEqual","leftArray","leftPlainObject","leftKeys","rightKeys","keySet","allKeys","l","every","usePrevious","ref","validateStripe","maybeStripe","elements","createToken","createPaymentMethod","confirmCardPayment","parseStripeProp","then","isPromise","tag","stripePromise","Promise","resolve","stripe","ElementsContext","createContext","displayName","useElementsContextWithUseCase","useCaseMessage","ctx","useCase","concat","parseElementsContext","useContext","ElementsConsumer","_ref2","useCallbackReference","cb","extractUpdateableOptions","options","paymentRequest","noop","createElementComponent","isServer","toUpperCase","Element","createElement","_ref","_ref$options","_ref$onBlur","_ref$onFocus","onFocus","_ref$onReady","onReady","_ref$onChange","_ref$onEscape","onEscape","_ref$onClick","elementRef","domNode","callOnReady","callOnBlur","callOnFocus","callOnClick","callOnChange","callOnEscape","useLayoutEffect","mount","on","prevOptions","warn","updateableOptions","update","destroy","__elementType","AuBankAccountElement","CardElement","CardNumberElement","CardExpiryElement","CardCvcElement","FpxBankElement","IbanElement","IdealBankElement","PaymentRequestButtonElement","Elements","rawStripeProp","_final","isMounted","parsed","useMemo","_React$useState2","setContext","prevStripe","anyStripe","_registerWrapper","version","Provider","useElements","useStripe","defineProperty","factory","formatPhoneNumber_UsaCanada","phoneNumberMask_UsaCanada","corrected","toStandardPhoneNumber","digitsNo1","digits","replace","split","letters","iDigit","iLast","full","join","_toConsumableArray","arr2","_arrayWithoutHoles","iter","from","_iterableToArray","_nonIterableSpread","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","loadScript","params","reject","Stripe","script","scripts","document","querySelectorAll","src","findScript","queryString","advancedFraudSignals","headOrBody","head","body","appendChild","injectScript","error","initStripe","registerWrapper","stripePromise$1","loadCalled","ProcessSteps_CreateSavedPaymentMethod","PaymentError","message","data","ProcessSteps_CreateSavedPaymentMethod_Stripe","_02_Server_SetupSavedPaymentMethod","_03_Client_CollectPaymentDetails","_04_Server_ObtainPaymentMethod","logProcessStep_CreateSavedPaymentMethod_Stripe","step","status","wrapProcessStep_CreateSavedPaymentMethod_Stripe","execute","createPaymentClientComponents_stripe","_len","_key","loadStripe","stripePublicKey","AppWrapperComponent","PaymentMethodEntryComponent","paymentMethodSetupToken","onPaymentMethodReady","stripeError","setStripeError","handleSubmit","event","_03A_Client_CollectPaymentDetails","setupInfo","stripeDecodeClientSetupToken","confirmCardSetup","clientSecret","payment_method","card","getElement","billing_details","customerBillingDetails","setupIntent","stripeEncodeClientToken","inputStyle","base","textColor","fontFamily","fontSmoothing","invalid","textColor_invalid","iconColor","inputContainerStyle","marginBottom","elementPadding","textPadding","borderColor","borderRadius","buttonStyle","fontWeight","buttonJustifyContent","buttonAlignment","errorContainerStyle","errorMessageStyle","onSubmit","buttonText","stripeEncodeClientSetupToken","sign","DefaultContext","attr","IconContext","__assign","assign","t","n","__rest","GenIcon","IconBase","Tree2Element","tree","child","elem","conf","computedSize","title","svgProps","Consumer","createSpeechService","synth","speechSynthesis","selectedVoices","voiceLang","u","SpeechSynthesisUtterance","voices","getVoices","language","IconKind","jsonStringify_safe","shouldFormat","visited","JSON","stringify","_","val","includes","Icon","icon","kind","menu","component","MdMenu","back","MdArrowBack","MdErrorOutline","expanded","FiChevronDown","collapsed","FiChevronRight","copy","MdContentCopy","retry","FaRedo","dashboard","MdDashboard","add","FaPlus","remove","FaMinus","eye","FaEye","eyeSlash","FaEyeSlash","MdCheckBoxOutlineBlank","getIcon","IconComponent","theme","sizes","errorBoxStyle","view","view_error","text_error","text_errorMessage","icon_errorMessage","button","outlineColor","colors","ErrorBox_Inner","setExpanded","errorAsString","errorMessage","errorDetails","errorObjText","canExpand","paddingRight","paddingLeft","retryCallback","Button","styleAlt","button_formAction_alt","button_formAction","extractViewStyle","extractTextStyle","C","Loading","loader","LoadingInline","ErrorBox","ErrorMessage","View_Panel","view_panel","View_Form","view_form","View_FormFields","view_formFields","View_FieldRow","view_fieldRow","View_FormActionRow","view_formActionRow","Text_FormTitle","text_formTitle","Text_FieldLabel","text_fieldLabel","Button_FieldInline","button_fieldInline_alt","button_fieldInline","Button_FormAction","Input_Text","input_fieldEntry","Input_Username","Input_Password","showPassword","setShowPassword","marginRight","Input_Phone","valueActual","setValueActual","Input_Email","Input_Currency","delay","timeout","background","marginLeft","marginTop","paddingTop","paddingBottom","minWidth","lineHeight","getBorderSizes","all","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","basicThemeSizes","borderWidth_minor","borderWidth_input","sectionGap","elementGap","rowGap","rowPadding","fontSize_input","fontSize_button","fontSize_header","minWidth_label","minWidth_input","minWidth_button","basicFont","fontWeight_normal","fontWeight_button","fontWeight_header","createTheme","font","borderProps","border","borderProps_minor","border_minor","borderProps_input","border_input","sTextView","text_header","background_field","flexWrap","background_button","text_button","background_error","purpleThemeColors","purpleSizes","createMultiplesProblemService","maxAnswers","m","parts","bVal","correctValue","wrongAnswerCount","wrongValues","distinct","round","moveItem","to","splice","Set","sort","getKey","set","sameArrayContents","useAutoLoadingError","mounted","useMounted","loadingError","setLoadingError","doWork","doWorkInner","getContext","contextInit","stopIfObsolete","c","doCall","EducationalGame_StarBlastSideways_Multiples","EducationalGame_StarBlastSideways","problemService","paused","pauseState","setPauseState","pressState","setPressState","problemSourceKey","setProblemSourceKey","SubjectNavigator","onOpen","onClose","onSubjectNavigation","GameView","zIndex","gamepad","subjectStyles","header","isExpanded","setIsExpanded","scrollTo","viewscreen","gameStyles","viewscreenView","sprite","viewSize","textAlign","fontSize_small","gameOver","gameState","lives","gameStartTimeMs","score","getGameTime","gameTime","playerPositionState","rotation","projectilesState","lastShotTime","shots","debris","enemiesState","enemies","problemsState","gotoNextProblem","pSize","newProblemState","problemTime","pos","isAnsweredWrong","newEnemyState","ans","enemy","vel","onHit","ignore","destroyed","onQuestion","gameLastTime","requestAnimationFrame","gameLoop","gameDeltaTime","getCommonState","playerPosition","onLoseLife","deadTime","gameOverTime","gameResult","updateGame","e2","playerResult","updatePlayer","projectilesResult","updateProjectiles","enemiesResult","updateEnemies","timeSinceProblem","TextPositioned","toLocaleString","Sprite","hasHitGround","explodeTime","weaponsLock","lockedEnemy","targetRotation","w","gw","h","gh","playerPos","didShoot","find","d","pad","hPad","shift","newShots","radius","radiusSq","radiusSq_enemies","i2","swap","radiusSq_player","wPad","closestEnemyToPlayer","abs","lockedAtPlayerPosition","newEnemies","offsetX","offsetY","scale","getSpriteEmoji","stylePosition","styleRotation","createLeaderboard","leaderboard","saveScore","loadScore","sortKey","localStorage","setItem","storageKey","json","getItem","parse","sortDescending","leaderboardInputStyles","textInput","buttonView","LeaderboardNameInput","setName","leaderboardStyles","scoreView","nameText","scoreText","LeaderboardViewInner","scoreColumns","scores","getValue","useLeaderboard","getScore","leaderboardScores","setLeaderboardScores","LeaderboardArea","onScoreSaved","randomBinary","fromCharCode"],"mappings":"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","file":"commons-7898f185cb0b9a0729de.js","sourcesContent":["export const getValuesAsItems = <T>(obj: T) => {\r\n    return Object.keys(obj).map(k => k as keyof typeof obj).map(k => obj[k]).filter(x => x);\r\n};\r\n\r\nexport const toKeyValueObject = <T>(items: { key: string, value: T }[]): { [key: string]: T } => {\r\n    const v = {} as { [key: string]: T };\r\n    items.forEach(x => { v[x.key] = x.value; });\r\n    return v;\r\n};\r\n\r\nexport const toMap = <T>(items: { key: string, value: T }[]): Map<string, T> => {\r\n    const v = new Map(items.map(x => [x.key, x.value]));\r\n    return v;\r\n};\r\n\r\nexport const toKeyValueArray = <T>(obj: { [key: string]: T }): { key: string, value: T }[] => {\r\n    return Object.keys(obj).map(k => k as keyof typeof obj).map(k => ({ key: k as string, value: obj[k] }));\r\n};\r\n","// 26.1.2 Reflect.construct(target, argumentsList [, newTarget])\nvar $export = require('./_export');\nvar create = require('./_object-create');\nvar aFunction = require('./_a-function');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar fails = require('./_fails');\nvar bind = require('./_bind');\nvar rConstruct = (require('./_global').Reflect || {}).construct;\n\n// MS Edge supports only 2 arguments and argumentsList argument is optional\n// FF Nightly sets third argument as `new.target`, but does not create `this` from it\nvar NEW_TARGET_BUG = fails(function () {\n  function F() { /* empty */ }\n  return !(rConstruct(function () { /* empty */ }, [], F) instanceof F);\n});\nvar ARGS_BUG = !fails(function () {\n  rConstruct(function () { /* empty */ });\n});\n\n$export($export.S + $export.F * (NEW_TARGET_BUG || ARGS_BUG), 'Reflect', {\n  construct: function construct(Target, args /* , newTarget */) {\n    aFunction(Target);\n    anObject(args);\n    var newTarget = arguments.length < 3 ? Target : aFunction(arguments[2]);\n    if (ARGS_BUG && !NEW_TARGET_BUG) return rConstruct(Target, args, newTarget);\n    if (Target == newTarget) {\n      // w/o altered newTarget, optimization for 0-4 arguments\n      switch (args.length) {\n        case 0: return new Target();\n        case 1: return new Target(args[0]);\n        case 2: return new Target(args[0], args[1]);\n        case 3: return new Target(args[0], args[1], args[2]);\n        case 4: return new Target(args[0], args[1], args[2], args[3]);\n      }\n      // w/o altered newTarget, lot of arguments case\n      var $args = [null];\n      $args.push.apply($args, args);\n      return new (bind.apply(Target, $args))();\n    }\n    // with altered newTarget, not support built-in constructors\n    var proto = newTarget.prototype;\n    var instance = create(isObject(proto) ? proto : Object.prototype);\n    var result = Function.apply.call(Target, instance, args);\n    return isObject(result) ? result : instance;\n  }\n});\n","export const randomIndex = (length: number) => {\r\n    const x = Math.floor(length * Math.random());\r\n    return x >= length ? length - 1 : x;\r\n};\r\nexport const randomItem = <T>(items: T[]) => items[randomIndex(items.length)];\r\n","var $parseInt = require('./_global').parseInt;\nvar $trim = require('./_string-trim').trim;\nvar ws = require('./_string-ws');\nvar hex = /^[-+]?0[xX]/;\n\nmodule.exports = $parseInt(ws + '08') !== 8 || $parseInt(ws + '0x16') !== 22 ? function parseInt(str, radix) {\n  var string = $trim(String(str), 3);\n  return $parseInt(string, (radix >>> 0) || (hex.test(string) ? 16 : 10));\n} : $parseInt;\n","var $parseFloat = require('./_global').parseFloat;\nvar $trim = require('./_string-trim').trim;\n\nmodule.exports = 1 / $parseFloat(require('./_string-ws') + '-0') !== -Infinity ? function parseFloat(str) {\n  var string = $trim(String(str), 3);\n  var result = $parseFloat(string);\n  return result === 0 && string.charAt(0) == '-' ? -0 : result;\n} : $parseFloat;\n","var $export = require('./_export');\nvar $parseInt = require('./_parse-int');\n// 20.1.2.13 Number.parseInt(string, radix)\n$export($export.S + $export.F * (Number.parseInt != $parseInt), 'Number', { parseInt: $parseInt });\n","\r\nexport type EmailAddress = string & { __type: 'email' };\r\nexport const toEmailAddress = (email: string): EmailAddress => {\r\n    return email.trim() as EmailAddress;\r\n};\r\n","// 21.1.3.18 String.prototype.startsWith(searchString [, position ])\n'use strict';\nvar $export = require('./_export');\nvar toLength = require('./_to-length');\nvar context = require('./_string-context');\nvar STARTS_WITH = 'startsWith';\nvar $startsWith = ''[STARTS_WITH];\n\n$export($export.P + $export.F * require('./_fails-is-regexp')(STARTS_WITH), 'String', {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = context(this, searchString, STARTS_WITH);\n    var index = toLength(Math.min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return $startsWith\n      ? $startsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","import { distinct, shuffle, distinct_key } from 'utils/arrays';\r\nimport { ProblemService, Problem, ProblemResult } from './problems-service';\r\n\r\n\r\nexport const createReviewProblemService = (problemSource: ProblemService, {\r\n    maxReviewCount = 3, reviewSequenceLength = 3, reviewSequencePreviousLength = 1, reviewQuestionPrefix = `🔄 `,\r\n}: {\r\n    maxReviewCount?: number; reviewSequenceLength?: number; reviewSequencePreviousLength?: number;\r\n    reviewQuestionPrefix?: string;\r\n}): ProblemService => {\r\n    const state = {\r\n        problemSourceHistory: [] as Problem[],\r\n        problemsToReview: [] as { index: number }[],\r\n        reviewSequence: null as null | { iNext: number, iEnd: number },\r\n        repeatState: `new` as 'new' | 'review',\r\n    };\r\n\r\n    const startReview = () => {\r\n        console.log(`createReviewProblemService startReview`, state);\r\n        state.repeatState = `review`;\r\n    };\r\n\r\n    const getReviewProblem = (): null | Problem => {\r\n        console.log(`createReviewProblemService getReviewProblem`, state);\r\n\r\n        if (state.reviewSequence && state.reviewSequence.iNext > state.reviewSequence.iEnd) {\r\n            console.log(`createReviewProblemService getReviewProblem - End of Sequence`, state);\r\n            state.reviewSequence = null;\r\n        }\r\n\r\n        if (!state.reviewSequence) {\r\n            const nextProblemToReview = state.problemsToReview[0];\r\n            if (!nextProblemToReview) {\r\n                console.log(`createReviewProblemService getReviewProblem - No Review Problems`, state);\r\n                return null;\r\n            }\r\n\r\n            console.log(`createReviewProblemService getReviewProblem - Start Review Sequence`, state);\r\n            state.reviewSequence = {\r\n                iNext: Math.max(0, nextProblemToReview.index - reviewSequencePreviousLength),\r\n                iEnd: Math.min(state.problemSourceHistory.length - 1, nextProblemToReview.index - reviewSequencePreviousLength + reviewSequenceLength - 1),\r\n            };\r\n        }\r\n\r\n        const seq = state.reviewSequence;\r\n\r\n        // Remove reviewed problem\r\n        state.problemsToReview = state.problemsToReview.filter(x => x.index !== seq.iNext);\r\n        const p = state.problemSourceHistory[seq.iNext];\r\n        seq.iNext++;\r\n\r\n        return {\r\n            ...p,\r\n            question: reviewQuestionPrefix + p.question,\r\n            answers: shuffle(p.answers),\r\n        };\r\n    };\r\n\r\n    const service: ProblemService = {\r\n        getSections: problemSource.getSections,\r\n        gotoSection: problemSource.gotoSection,\r\n\r\n        getNextProblem: (): ProblemResult => {\r\n            console.log(`createReviewProblemService getNextProblem`, state);\r\n\r\n            if (state.repeatState === `review`) {\r\n                const reviewProblem = getReviewProblem();\r\n                if (reviewProblem) {\r\n                    return reviewProblem;\r\n                }\r\n\r\n                console.log(`createReviewProblemService getNextProblem - No Review Problem - Change Mode to NEW`, state);\r\n                state.repeatState = `new`;\r\n            }\r\n\r\n            if (state.problemsToReview.length >= maxReviewCount) {\r\n                startReview();\r\n                return service.getNextProblem();\r\n            }\r\n\r\n            const newProblem = problemSource.getNextProblem();\r\n            if (newProblem.question) {\r\n                state.problemSourceHistory.push(newProblem);\r\n            } else {\r\n                // Done - Finish Review\r\n                startReview();\r\n                return service.getNextProblem();\r\n            }\r\n            return newProblem;\r\n        },\r\n        recordAnswer: (problem, answer) => {\r\n            console.log(`createReviewProblemService recordAnswer`, state);\r\n\r\n            if (answer.isCorrect) {\r\n                problemSource.recordAnswer(problem, answer);\r\n                return;\r\n            }\r\n\r\n            const i = state.problemSourceHistory.findIndex(x => x.key === problem.key);\r\n            if (i < 0) { return; }\r\n\r\n            state.problemsToReview.push({ index: i });\r\n            state.problemsToReview = distinct_key(state.problemsToReview, x => `${x.index}`);\r\n\r\n            problemSource.recordAnswer(problem, answer);\r\n        },\r\n    };\r\n\r\n    return service;\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Text, View, ActivityIndicator, TouchableOpacity } from 'react-native-lite';\r\nimport { SpeechService } from '../utils/speech';\r\n\r\nexport const VoiceChooser = ({ languange, speechService }: { languange: string, speechService: SpeechService }) => {\r\n    const [loading, setLoading] = useState(true);\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    const [renderId, setRenderId] = useState(0);\r\n\r\n    const refresh = () => {\r\n        setLoading(true);\r\n        setTimeout(() => {\r\n            setLoading(false);\r\n        }, 1000);\r\n    };\r\n\r\n    useEffect(() => {\r\n        refresh();\r\n    }, []);\r\n\r\n    const selectVoice = (voice: SpeechSynthesisVoice) => {\r\n        speechService.setVoiceForLanguange(languange, voice);\r\n        setRenderId(s => s + 1);\r\n        speechService.speak(voice.name, languange);\r\n    };\r\n\r\n    return (\r\n        <View>\r\n            <TouchableOpacity onPress={refresh}>\r\n                <Text style={{ fontSize: 24 }}>{`Voice for ${languange}`}</Text>\r\n            </TouchableOpacity>\r\n            {loading && <ActivityIndicator size='small' color='red' />}\r\n            {!loading && (\r\n                <>\r\n                    {speechService.getVoicesForLanguange(languange).map(x => (\r\n                        <TouchableOpacity onPress={() => { selectVoice(x.voice); }}>\r\n                            <View>\r\n                                <Text style={{ margin: 4, fontSize: 14, whiteSpace: `normal` }} >{`${x.isSelected ? `✅` : `🔲`} ${x.voice.lang} - ${x.voice.name} - ${x.voice.localService ? `local` : `web`}`}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </>\r\n            )}\r\n        </View>\r\n    );\r\n};\r\n","import './index.css';\r\nimport React, { ReactNode, useRef } from 'react';\r\nimport { ThemeTextStyle, ThemeViewStyle } from 'themes/theme';\r\n\r\nfunction mergeStyles<T>(items: (T | undefined | null) | (T | T[] | undefined | null)[]): T {\r\n    if (Array.isArray(items)) {\r\n        if (items.length === 1) { return mergeStyles(items[0]) ?? {} as T; }\r\n        let item = { ...mergeStyles(items[0]) };\r\n        items.forEach(x => { item = { ...item, ...mergeStyles(x ?? {}) }; });\r\n        return (item ?? {}) as T;\r\n    }\r\n    return items as T;\r\n};\r\n\r\nconst viewStyleDefaults = {\r\n    display: `flex`,\r\n    flexDirection: `column`,\r\n} as const;\r\n\r\nconst textStyleDefaults = {\r\n    whiteSpace: `pre`,\r\n} as const;\r\n\r\nconst finalizeTextStyle = <T extends unknown>(style: T) => {\r\n    const s = style as {\r\n        userSelect?: 'none';\r\n        MozUserSelect?: 'none';\r\n        WebkitUserSelect?: 'none';\r\n    };\r\n    if (s.userSelect === `none`) {\r\n        s.MozUserSelect = `none`;\r\n        s.WebkitUserSelect = `none`;\r\n    }\r\n\r\n    return style;\r\n};\r\n\r\nexport const View = (props: { style?: ThemeViewStyle | ThemeViewStyle[], children?: ReactNode }) => { return (<div style={mergeStyles([viewStyleDefaults, props.style])}>{props.children}</div>); };\r\nexport const Text = (props: { style?: ThemeTextStyle | ThemeTextStyle[], children?: string, numberOfLines?: undefined | 1 }) => {\r\n    if (props.numberOfLines === 1) {\r\n        const singleLineStyle = {\r\n            overflow: `hidden`,\r\n            whiteSpace: `nowrap`,\r\n            wordWrap: `break-word`,\r\n            textOverflow: `ellipsis`,\r\n        } as const;\r\n        const allStyles = mergeStyles([textStyleDefaults, props.style, singleLineStyle]);\r\n        return (<span style={finalizeTextStyle(allStyles)}>{props.children}</span>);\r\n    }\r\n    const allStyles = mergeStyles([textStyleDefaults, props.style]);\r\n    return (<span style={finalizeTextStyle(allStyles)}>{props.children}</span>);\r\n};\r\nexport const TextInput = (props: {\r\n    style?: ThemeTextStyle | ThemeTextStyle[];\r\n    keyboardType: 'default' | 'numeric' | 'phone-pad' | 'email-address';\r\n    autoCompleteType: 'off' | 'username' | 'password' | 'email' | 'name' | 'tel' | 'street-address' | 'postal-code';\r\n    secureTextEntry?: boolean;\r\n    placeholder?: string;\r\n    editable?: boolean;\r\n    value: string;\r\n    onChange: (value: string) => void;\r\n    onSubmitEditing?: () => void;\r\n    onBlur?: () => void;\r\n}) => {\r\n    const type = props.keyboardType === `numeric` ? `number`\r\n        : (props.secureTextEntry ? `password`\r\n            : `text`);\r\n\r\n    const name = props.autoCompleteType === `username` ? `username`\r\n        : (props.autoCompleteType === `password` ? `password`\r\n            : undefined);\r\n\r\n    const onKeyPress = props.onSubmitEditing && ((e: React.KeyboardEvent<HTMLInputElement>) => {\r\n        if (e.key === `Enter` && !e.shiftKey) {\r\n            e.preventDefault();\r\n            props.onSubmitEditing?.();\r\n        }\r\n    }) || undefined;\r\n\r\n    return (<input type={type}\r\n        name={name} id={name}\r\n        style={mergeStyles([textStyleDefaults, props.style])}\r\n        placeholder={props.placeholder}\r\n        disabled={!(props.editable ?? true)}\r\n        value={props.value}\r\n        onChange={(e) => props.onChange(e.target.value)}\r\n        onKeyPress={onKeyPress}\r\n        onBlur={props.onBlur}\r\n    />);\r\n\r\n};\r\nexport const TouchableOpacity = (props: { style?: ThemeViewStyle | ThemeViewStyle[], children?: ReactNode, onPress: () => void }) => {\r\n\r\n    // Prevent Initial Press (already pressing when created)\r\n    const lastPressTime = useRef(Date.now());\r\n    const onPress = () => {\r\n        // Prevent duplicate triggers\r\n        if (Date.now() < lastPressTime.current + 250) { return; }\r\n        lastPressTime.current = Date.now();\r\n\r\n        props.onPress();\r\n    };\r\n\r\n    const hasTouchStarted = useRef(true);\r\n\r\n    return (\r\n        <div style={mergeStyles([viewStyleDefaults, props.style])}\r\n            onClick={onPress}\r\n            onKeyPress={onPress}\r\n            onTouchStart={() => { hasTouchStarted.current = true; }}\r\n            onTouchMove={() => { hasTouchStarted.current = false; }}\r\n            onTouchEnd={() => { if (hasTouchStarted.current) { onPress(); } }}\r\n            role='button'\r\n            tabIndex={0}>\r\n            {props.children}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const Pressable = (props: { style?: ThemeViewStyle | ThemeViewStyle[], children?: ReactNode, onPressIn: () => void, onPressOut: () => void }) => {\r\n\r\n    const onIgnore = (e: React.MouseEvent | React.TouchEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation?.();\r\n        (e as unknown as { [key: string]: boolean }).cancelBubble = true;\r\n        (e as unknown as { [key: string]: boolean }).returnValue = false;\r\n        return false;\r\n    };\r\n\r\n    const onPressIn = (e: React.MouseEvent | React.TouchEvent) => {\r\n        props.onPressIn();\r\n        return onIgnore(e);\r\n    };\r\n    const onPressOut = (e: React.MouseEvent | React.TouchEvent) => {\r\n        props.onPressOut();\r\n        return onIgnore(e);\r\n    };\r\n\r\n    return (\r\n        <div style={mergeStyles([viewStyleDefaults, props.style])}\r\n            onMouseDown={onPressIn}\r\n            onMouseUp={onPressOut}\r\n            onTouchStart={onPressIn}\r\n            onTouchEnd={onPressOut}\r\n            onTouchCancel={onPressOut}\r\n            onTouchMove={onIgnore}\r\n            onMouseLeave={onPressOut}\r\n            onTouchEndCapture={onPressOut}\r\n            role='button'\r\n            tabIndex={0}>\r\n            {props.children}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const ActivityIndicator = ({ size, color }: { size: 'large' | 'small', color: string }) => {\r\n    const sizePx = size === `small` ? 16 : 32;\r\n    return (\r\n        <CircleSvg size={sizePx} thickness={sizePx / 8} color={color} />\r\n    );\r\n};\r\n\r\n// Based on: https://glennmccomb.com/articles/building-a-pure-css-animated-svg-spinner/\r\nconst CircleSvg = ({ size, thickness, color }: { size: number, thickness: number, color: string }) => {\r\n    const circumference = 2 * Math.PI * (size - thickness) * 0.5;\r\n    const dashLength = circumference * 0.6;\r\n    return (\r\n        <svg style={{ maxWidth: size }} viewBox={`0 0 ${size} ${size}`} xmlns='http://www.w3.org/2000/svg'>\r\n            <circle style={{\r\n                fill: `transparent`,\r\n                stroke: color,\r\n                strokeWidth: thickness,\r\n                opacity: 0.5,\r\n            }} cx={size * 0.5} cy={size * 0.5} r={size * 0.5 - thickness} />\r\n            <circle className='activity-spinner' style={{\r\n                strokeDasharray: dashLength,\r\n                fill: `transparent`,\r\n                stroke: color,\r\n                strokeWidth: thickness,\r\n                transformOrigin: `${size * 0.5}px ${size * 0.5}px`,\r\n            }} cx={size * 0.5} cy={size * 0.5} r={size * 0.5 - thickness} />\r\n        </svg>\r\n    );\r\n};\r\n\r\n\r\nexport const Platform = {\r\n    OS: `web` as 'web' | 'ios' | 'android',\r\n};\r\n\r\nexport const Clipboard = {\r\n    setString: async (value: string) => { await navigator.clipboard.writeText(value); },\r\n};\r\n","import React, { useState, useRef, useEffect } from 'react';\r\nimport { View, Text, Pressable, Platform } from 'react-native-lite';\r\n\r\nexport type GamepadPressState = { moveDirection: { x: number, y: number }, buttons: { key: string, text: string, isDown: boolean }[] };\r\nexport const GamepadAnalogStateful = (props: {\r\n    style: { backgroundColor: string, borderColor: string };\r\n    onPressStateChange: (value: GamepadPressState) => void;\r\n    buttons: { text: string, key: string }[];\r\n}) => {\r\n\r\n    const state = useRef({\r\n        moveDirection: { x: 0, y: 0 },\r\n        buttons: props.buttons.map((x, i) => ({\r\n            isDown: false,\r\n            key: x.key,\r\n            text: x.text,\r\n            onPressIn: () => {\r\n                state.current.buttons[i].isDown = true;\r\n                props.onPressStateChange(state.current);\r\n            },\r\n            onPressOut: () => {\r\n                state.current.buttons[i].isDown = false;\r\n                props.onPressStateChange(state.current);\r\n            },\r\n        })),\r\n    });\r\n\r\n    const onMovePressIn = (dir: { x: number, y: number }) => {\r\n        const s = state.current;\r\n\r\n        state.current.moveDirection = {\r\n            x: dir.x ? dir.x : s.moveDirection.x,\r\n            y: dir.y ? dir.y : s.moveDirection.y,\r\n        };\r\n\r\n        console.log(`onMovePressIn`, { dir, s, moveDirection: state.current.moveDirection });\r\n\r\n        props.onPressStateChange(state.current);\r\n    };\r\n\r\n    const onMovePressOut = (dir: { x: number, y: number }) => {\r\n        const s = state.current;\r\n        state.current.moveDirection = {\r\n            x: dir.x ? 0 : s.moveDirection.x,\r\n            y: dir.y ? 0 : s.moveDirection.y,\r\n        };\r\n        props.onPressStateChange(state.current);\r\n    };\r\n\r\n    return (\r\n        <GamepadAnalog {...props} onMovePressIn={onMovePressIn} onMovePressOut={onMovePressOut} buttons={state.current.buttons} />\r\n    );\r\n};\r\n\r\nconst inputStyles = {\r\n    container: { flex: 1, alignSelf: `stretch`, flexDirection: `row`, justifyContent: `space-between`, alignItems: `center`, padding: 4 },\r\n    section: { justifyContent: `center`, alignItems: `center`, padding: 4 },\r\n    moveSectionWrapper: { overflow: `hidden` },\r\n    moveSectionRotation: { transform: `rotate(0.125turn)`, margin: 0 },\r\n    row: { flexDirection: `row` },\r\n    cellTouch: { outline: `none` },\r\n    cellView: { pointerEvents: `none`, position: `relative`, margin: 4, width: 56, height: 56, justifyContent: `center`, alignItems: `center`, borderWidth: 0, borderStyle: `solid`, outline: `none` },\r\n    cellText: { userSelect: `none`, pointerEvents: `none` },\r\n    moveCellText: { userSelect: `none`, pointerEvents: `none`, transform: `rotate(-0.125turn)` },\r\n    cellEmptyView: { margin: 2, width: 56, height: 56 },\r\n    cellTextOcclusionView: { position: `absolute`, top: 0, bottom: 0, left: 0, right: 0, backgroundColor: `red`, opacity: 0 },\r\n} as const;\r\n\r\nexport const GamepadAnalog = (props: {\r\n    style: { backgroundColor: string, borderColor: string };\r\n    onMovePressIn: (direction: { x: number, y: number }) => void;\r\n    onMovePressOut: (direction: { x: number, y: number }) => void;\r\n    buttons: { text: string, onPressIn: () => void, onPressOut: () => void }[];\r\n}) => {\r\n    const { onMovePressIn, onMovePressOut } = props;\r\n\r\n    const cellViewStyle = { ...inputStyles.cellView, ...props.style };\r\n\r\n    // Keyboard\r\n    useEffect(() => {\r\n        const onIgnore = (e: KeyboardEvent) => {\r\n            e.preventDefault();\r\n            e.stopPropagation?.();\r\n            return false;\r\n        };\r\n        if (Platform.OS === `web`) {\r\n            const onKeyDown = (e: KeyboardEvent) => {\r\n                if (e.key === `ArrowUp`) { onMovePressIn({ x: 0, y: +1 }); return onIgnore(e); }\r\n                if (e.key === `ArrowDown`) { onMovePressIn({ x: 0, y: -1 }); return onIgnore(e); }\r\n                if (e.key === `ArrowLeft`) { onMovePressIn({ x: -1, y: 0 }); return onIgnore(e); }\r\n                if (e.key === `ArrowRight`) { onMovePressIn({ x: +1, y: 0 }); return onIgnore(e); }\r\n                if (e.key === ` `) { props.buttons[0]?.onPressIn(); return onIgnore(e); }\r\n                // console.log(`onKeyDown`, { key: e.key });\r\n                return true;\r\n            };\r\n            const onKeyUp = (e: KeyboardEvent) => {\r\n                if (e.key === `ArrowUp`) { onMovePressOut({ x: 0, y: +1 }); return onIgnore(e); }\r\n                if (e.key === `ArrowDown`) { onMovePressOut({ x: 0, y: -1 }); return onIgnore(e); }\r\n                if (e.key === `ArrowLeft`) { onMovePressOut({ x: -1, y: 0 }); return onIgnore(e); }\r\n                if (e.key === `ArrowRight`) { onMovePressOut({ x: +1, y: 0 }); return onIgnore(e); }\r\n                if (e.key === ` `) { props.buttons[0]?.onPressOut(); return onIgnore(e); }\r\n                return true;\r\n            };\r\n            window.addEventListener(`keydown`, onKeyDown);\r\n            window.addEventListener(`keyup`, onKeyUp);\r\n            return () => {\r\n                window.removeEventListener(`keydown`, onKeyDown);\r\n                window.removeEventListener(`keyup`, onKeyUp);\r\n            };\r\n        }\r\n\r\n        return () => { };\r\n    });\r\n\r\n    const DirectionButton = ({ text, direction }: { text: string, direction: { x: number, y: number } }) => {\r\n        return (\r\n            <Pressable style={inputStyles.cellTouch} onPressIn={() => onMovePressIn(direction)} onPressOut={() => onMovePressOut(direction)}>\r\n                <View style={cellViewStyle}>\r\n                    <Text style={inputStyles.moveCellText}>{text}</Text>\r\n                    <View style={inputStyles.cellTextOcclusionView} />\r\n                </View>\r\n            </Pressable>\r\n        );\r\n    };\r\n\r\n    const ActionButton = ({ text, onPressIn, onPressOut }: { text: string, onPressIn: () => void, onPressOut: () => void }) => {\r\n        return (\r\n            <Pressable style={inputStyles.cellTouch} onPressIn={onPressIn} onPressOut={onPressOut}>\r\n                <View style={cellViewStyle}>\r\n                    <Text style={inputStyles.cellText}>{text}</Text>\r\n                    <View style={inputStyles.cellTextOcclusionView} />\r\n                </View>\r\n            </Pressable>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <View style={inputStyles.container}>\r\n            <View style={inputStyles.moveSectionWrapper}>\r\n                <View style={inputStyles.moveSectionRotation}>\r\n                    <View style={inputStyles.section}>\r\n                        <View style={inputStyles.row} >\r\n                            <DirectionButton direction={{ x: 0, y: +1 }} text='⬆' />\r\n                            <DirectionButton direction={{ x: +1, y: 0 }} text='➡' />\r\n                        </View>\r\n                        <View style={inputStyles.row} >\r\n                            <DirectionButton direction={{ x: -1, y: 0 }} text='⬅' />\r\n                            <DirectionButton direction={{ x: 0, y: -1 }} text='⬇' />\r\n                        </View>\r\n                    </View>\r\n                </View>\r\n            </View>\r\n            <View style={inputStyles.section} >\r\n                <View style={inputStyles.row} >\r\n                    {props.buttons.map(x => (\r\n                        <React.Fragment key={`${x.text}`}>\r\n                            <View style={inputStyles.cellEmptyView} />\r\n                            <ActionButton {...x} />\r\n                        </React.Fragment>\r\n                    ))}\r\n                </View>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n","'use strict';\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","var $export = require('./_export');\nvar $parseFloat = require('./_parse-float');\n// 20.1.2.12 Number.parseFloat(string)\n$export($export.S + $export.F * (Number.parseFloat != $parseFloat), 'Number', { parseFloat: $parseFloat });\n","export type Vector2 = { x: number, y: number };\r\nexport const getDistanceSq = (a: Vector2, b: Vector2) => {\r\n    const x = a.x - b.x;\r\n    const y = a.y - b.y;\r\n    return x * x + y * y;\r\n};\r\n","require(\"core-js/modules/es6.object.define-property\");\n\nrequire(\"core-js/modules/es6.promise\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es6.regexp.to-string\");\n\nrequire(\"core-js/modules/es6.date.to-string\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/es6.array.index-of\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es7.symbol.async-iterator\");\n\nrequire(\"core-js/modules/es6.symbol\");\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('react')) : typeof define === 'function' && define.amd ? define(['exports', 'react'], factory) : (global = global || self, factory(global.ReactStripe = {}, global.React));\n})(this, function (exports, React) {\n  'use strict';\n\n  React = React && React.hasOwnProperty('default') ? React['default'] : React;\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n      return;\n    }\n\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n  }\n\n  function createCommonjsModule(fn, module) {\n    return module = {\n      exports: {}\n    }, fn(module, module.exports), module.exports;\n  }\n  /**\n   * Copyright (c) 2013-present, Facebook, Inc.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   */\n\n\n  var ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n  var ReactPropTypesSecret_1 = ReactPropTypesSecret;\n\n  function emptyFunction() {}\n\n  function emptyFunctionWithReset() {}\n\n  emptyFunctionWithReset.resetWarningCache = emptyFunction;\n\n  var factoryWithThrowingShims = function factoryWithThrowingShims() {\n    function shim(props, propName, componentName, location, propFullName, secret) {\n      if (secret === ReactPropTypesSecret_1) {\n        // It is still safe when called from React.\n        return;\n      }\n\n      var err = new Error('Calling PropTypes validators directly is not supported by the `prop-types` package. ' + 'Use PropTypes.checkPropTypes() to call them. ' + 'Read more at http://fb.me/use-check-prop-types');\n      err.name = 'Invariant Violation';\n      throw err;\n    }\n\n    shim.isRequired = shim;\n\n    function getShim() {\n      return shim;\n    } // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n\n\n    var ReactPropTypes = {\n      array: shim,\n      bool: shim,\n      func: shim,\n      number: shim,\n      object: shim,\n      string: shim,\n      symbol: shim,\n      any: shim,\n      arrayOf: getShim,\n      element: shim,\n      elementType: shim,\n      instanceOf: getShim,\n      node: shim,\n      objectOf: getShim,\n      oneOf: getShim,\n      oneOfType: getShim,\n      shape: getShim,\n      exact: getShim,\n      checkPropTypes: emptyFunctionWithReset,\n      resetWarningCache: emptyFunction\n    };\n    ReactPropTypes.PropTypes = ReactPropTypes;\n    return ReactPropTypes;\n  };\n\n  var propTypes = createCommonjsModule(function (module) {\n    /**\n     * Copyright (c) 2013-present, Facebook, Inc.\n     *\n     * This source code is licensed under the MIT license found in the\n     * LICENSE file in the root directory of this source tree.\n     */\n    {\n      // By explicitly using `prop-types` you are opting into new production behavior.\n      // http://fb.me/prop-types-in-prod\n      module.exports = factoryWithThrowingShims();\n    }\n  });\n\n  var isUnknownObject = function isUnknownObject(raw) {\n    return raw !== null && _typeof(raw) === 'object';\n  };\n\n  var isPromise = function isPromise(raw) {\n    return isUnknownObject(raw) && typeof raw.then === 'function';\n  }; // We are using types to enforce the `stripe` prop in this lib,\n  // but in an untyped integration `stripe` could be anything, so we need\n  // to do some sanity validation to prevent type errors.\n\n\n  var isStripe = function isStripe(raw) {\n    return isUnknownObject(raw) && typeof raw.elements === 'function' && typeof raw.createToken === 'function' && typeof raw.createPaymentMethod === 'function' && typeof raw.confirmCardPayment === 'function';\n  };\n\n  var PLAIN_OBJECT_STR = '[object Object]';\n\n  var isEqual = function isEqual(left, right) {\n    if (!isUnknownObject(left) || !isUnknownObject(right)) {\n      return left === right;\n    }\n\n    var leftArray = Array.isArray(left);\n    var rightArray = Array.isArray(right);\n    if (leftArray !== rightArray) return false;\n    var leftPlainObject = Object.prototype.toString.call(left) === PLAIN_OBJECT_STR;\n    var rightPlainObject = Object.prototype.toString.call(right) === PLAIN_OBJECT_STR;\n    if (leftPlainObject !== rightPlainObject) return false;\n    if (!leftPlainObject && !leftArray) return false;\n    var leftKeys = Object.keys(left);\n    var rightKeys = Object.keys(right);\n    if (leftKeys.length !== rightKeys.length) return false;\n    var keySet = {};\n\n    for (var i = 0; i < leftKeys.length; i += 1) {\n      keySet[leftKeys[i]] = true;\n    }\n\n    for (var _i = 0; _i < rightKeys.length; _i += 1) {\n      keySet[rightKeys[_i]] = true;\n    }\n\n    var allKeys = Object.keys(keySet);\n\n    if (allKeys.length !== leftKeys.length) {\n      return false;\n    }\n\n    var l = left;\n    var r = right;\n\n    var pred = function pred(key) {\n      return isEqual(l[key], r[key]);\n    };\n\n    return allKeys.every(pred);\n  };\n\n  var usePrevious = function usePrevious(value) {\n    var ref = React.useRef(value);\n    React.useEffect(function () {\n      ref.current = value;\n    }, [value]);\n    return ref.current;\n  };\n\n  var INVALID_STRIPE_ERROR = 'Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.'; // We are using types to enforce the `stripe` prop in this lib, but in a real\n  // integration `stripe` could be anything, so we need to do some sanity\n  // validation to prevent type errors.\n\n  var validateStripe = function validateStripe(maybeStripe) {\n    if (maybeStripe === null || isStripe(maybeStripe)) {\n      return maybeStripe;\n    }\n\n    throw new Error(INVALID_STRIPE_ERROR);\n  };\n\n  var parseStripeProp = function parseStripeProp(raw) {\n    if (isPromise(raw)) {\n      return {\n        tag: 'async',\n        stripePromise: Promise.resolve(raw).then(validateStripe)\n      };\n    }\n\n    var stripe = validateStripe(raw);\n\n    if (stripe === null) {\n      return {\n        tag: 'empty'\n      };\n    }\n\n    return {\n      tag: 'sync',\n      stripe: stripe\n    };\n  };\n\n  var ElementsContext = React.createContext(null);\n  ElementsContext.displayName = 'ElementsContext';\n\n  var parseElementsContext = function parseElementsContext(ctx, useCase) {\n    if (!ctx) {\n      throw new Error(\"Could not find Elements context; You need to wrap the part of your app that \".concat(useCase, \" in an <Elements> provider.\"));\n    }\n\n    return ctx;\n  };\n  /**\n   * The `Elements` provider allows you to use [Element components](https://stripe.com/docs/stripe-js/react#element-components) and access the [Stripe object](https://stripe.com/docs/js/initializing) in any nested component.\n   * Render an `Elements` provider at the root of your React app so that it is available everywhere you need it.\n   *\n   * To use the `Elements` provider, call `loadStripe` from `@stripe/stripe-js` with your publishable key.\n   * The `loadStripe` function will asynchronously load the Stripe.js script and initialize a `Stripe` object.\n   * Pass the returned `Promise` to `Elements`.\n   *\n   * @docs https://stripe.com/docs/stripe-js/react#elements-provider\n   */\n\n\n  var Elements = function Elements(_ref) {\n    var rawStripeProp = _ref.stripe,\n        options = _ref.options,\n        children = _ref.children;\n\n    var _final = React.useRef(false);\n\n    var isMounted = React.useRef(true);\n    var parsed = React.useMemo(function () {\n      return parseStripeProp(rawStripeProp);\n    }, [rawStripeProp]);\n\n    var _React$useState = React.useState(function () {\n      return {\n        stripe: null,\n        elements: null\n      };\n    }),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        ctx = _React$useState2[0],\n        setContext = _React$useState2[1];\n\n    var prevStripe = usePrevious(rawStripeProp);\n    var prevOptions = usePrevious(options);\n\n    if (prevStripe !== null) {\n      if (prevStripe !== rawStripeProp) {\n        console.warn('Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.');\n      }\n\n      if (!isEqual(options, prevOptions)) {\n        console.warn('Unsupported prop change on Elements: You cannot change the `options` prop after setting the `stripe` prop.');\n      }\n    }\n\n    if (!_final.current) {\n      if (parsed.tag === 'sync') {\n        _final.current = true;\n        setContext({\n          stripe: parsed.stripe,\n          elements: parsed.stripe.elements(options)\n        });\n      }\n\n      if (parsed.tag === 'async') {\n        _final.current = true;\n        parsed.stripePromise.then(function (stripe) {\n          if (stripe && isMounted.current) {\n            // Only update Elements context if the component is still mounted\n            // and stripe is not null. We allow stripe to be null to make\n            // handling SSR easier.\n            setContext({\n              stripe: stripe,\n              elements: stripe.elements(options)\n            });\n          }\n        });\n      }\n    }\n\n    React.useEffect(function () {\n      return function () {\n        isMounted.current = false;\n      };\n    }, []);\n    React.useEffect(function () {\n      var anyStripe = ctx.stripe;\n\n      if (!anyStripe || !anyStripe._registerWrapper) {\n        return;\n      }\n\n      anyStripe._registerWrapper({\n        name: 'react-stripe-js',\n        version: \"1.1.2\"\n      });\n    }, [ctx.stripe]);\n    return React.createElement(ElementsContext.Provider, {\n      value: ctx\n    }, children);\n  };\n\n  var useElementsContextWithUseCase = function useElementsContextWithUseCase(useCaseMessage) {\n    var ctx = React.useContext(ElementsContext);\n    return parseElementsContext(ctx, useCaseMessage);\n  };\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#useelements-hook\n   */\n\n\n  var useElements = function useElements() {\n    var _useElementsContextWi = useElementsContextWithUseCase('calls useElements()'),\n        elements = _useElementsContextWi.elements;\n\n    return elements;\n  };\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#usestripe-hook\n   */\n\n\n  var useStripe = function useStripe() {\n    var _useElementsContextWi2 = useElementsContextWithUseCase('calls useStripe()'),\n        stripe = _useElementsContextWi2.stripe;\n\n    return stripe;\n  };\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#elements-consumer\n   */\n\n\n  var ElementsConsumer = function ElementsConsumer(_ref2) {\n    var children = _ref2.children;\n    var ctx = useElementsContextWithUseCase('mounts <ElementsConsumer>'); // Assert to satisfy the busted React.FC return type (it should be ReactNode)\n\n    return children(ctx);\n  };\n\n  ElementsConsumer.propTypes = {\n    children: propTypes.func.isRequired\n  };\n\n  var useCallbackReference = function useCallbackReference(cb) {\n    var ref = React.useRef(cb);\n    React.useEffect(function () {\n      ref.current = cb;\n    }, [cb]);\n    return function () {\n      if (ref.current) {\n        ref.current.apply(ref, arguments);\n      }\n    };\n  };\n\n  var extractUpdateableOptions = function extractUpdateableOptions(options) {\n    if (!isUnknownObject(options)) {\n      return {};\n    }\n\n    var _ = options.paymentRequest,\n        rest = _objectWithoutProperties(options, [\"paymentRequest\"]);\n\n    return rest;\n  };\n\n  var noop = function noop() {};\n\n  var capitalized = function capitalized(str) {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n  };\n\n  var createElementComponent = function createElementComponent(type, isServer) {\n    var displayName = \"\".concat(capitalized(type), \"Element\");\n\n    var ClientElement = function ClientElement(_ref) {\n      var id = _ref.id,\n          className = _ref.className,\n          _ref$options = _ref.options,\n          options = _ref$options === void 0 ? {} : _ref$options,\n          _ref$onBlur = _ref.onBlur,\n          onBlur = _ref$onBlur === void 0 ? noop : _ref$onBlur,\n          _ref$onFocus = _ref.onFocus,\n          onFocus = _ref$onFocus === void 0 ? noop : _ref$onFocus,\n          _ref$onReady = _ref.onReady,\n          onReady = _ref$onReady === void 0 ? noop : _ref$onReady,\n          _ref$onChange = _ref.onChange,\n          onChange = _ref$onChange === void 0 ? noop : _ref$onChange,\n          _ref$onEscape = _ref.onEscape,\n          onEscape = _ref$onEscape === void 0 ? noop : _ref$onEscape,\n          _ref$onClick = _ref.onClick,\n          onClick = _ref$onClick === void 0 ? noop : _ref$onClick;\n\n      var _useElementsContextWi = useElementsContextWithUseCase(\"mounts <\".concat(displayName, \">\")),\n          elements = _useElementsContextWi.elements;\n\n      var elementRef = React.useRef(null);\n      var domNode = React.useRef(null);\n      var callOnReady = useCallbackReference(onReady);\n      var callOnBlur = useCallbackReference(onBlur);\n      var callOnFocus = useCallbackReference(onFocus);\n      var callOnClick = useCallbackReference(onClick);\n      var callOnChange = useCallbackReference(onChange);\n      var callOnEscape = useCallbackReference(onEscape);\n      React.useLayoutEffect(function () {\n        if (elementRef.current == null && elements && domNode.current != null) {\n          var element = elements.create(type, options);\n          elementRef.current = element;\n          element.mount(domNode.current);\n          element.on('ready', function () {\n            return callOnReady(element);\n          });\n          element.on('change', callOnChange);\n          element.on('blur', callOnBlur);\n          element.on('focus', callOnFocus);\n          element.on('escape', callOnEscape); // Users can pass an an onClick prop on any Element component\n          // just as they could listen for the `click` event on any Element,\n          // but only the PaymentRequestButton will actually trigger the event.\n\n          element.on('click', callOnClick);\n        }\n      });\n      var prevOptions = React.useRef(options);\n      React.useEffect(function () {\n        if (prevOptions.current && prevOptions.current.paymentRequest !== options.paymentRequest) {\n          console.warn('Unsupported prop change: options.paymentRequest is not a customizable property.');\n        }\n\n        var updateableOptions = extractUpdateableOptions(options);\n\n        if (Object.keys(updateableOptions).length !== 0 && !isEqual(updateableOptions, extractUpdateableOptions(prevOptions.current))) {\n          if (elementRef.current) {\n            elementRef.current.update(updateableOptions);\n            prevOptions.current = options;\n          }\n        }\n      }, [options]);\n      React.useEffect(function () {\n        return function () {\n          if (elementRef.current) {\n            elementRef.current.destroy();\n          }\n        };\n      }, []);\n      return React.createElement(\"div\", {\n        id: id,\n        className: className,\n        ref: domNode\n      });\n    }; // Only render the Element wrapper in a server environment.\n\n\n    var ServerElement = function ServerElement(props) {\n      // Validate that we are in the right context by calling useElementsContextWithUseCase.\n      useElementsContextWithUseCase(\"mounts <\".concat(displayName, \">\"));\n      var id = props.id,\n          className = props.className;\n      return React.createElement(\"div\", {\n        id: id,\n        className: className\n      });\n    };\n\n    var Element = isServer ? ServerElement : ClientElement;\n    Element.propTypes = {\n      id: propTypes.string,\n      className: propTypes.string,\n      onChange: propTypes.func,\n      onBlur: propTypes.func,\n      onFocus: propTypes.func,\n      onReady: propTypes.func,\n      onClick: propTypes.func,\n      options: propTypes.object\n    };\n    Element.displayName = displayName;\n    Element.__elementType = type;\n    return Element;\n  };\n\n  var isServer = typeof window === 'undefined';\n  /**\n   * Requires beta access:\n   * Contact [Stripe support](https://support.stripe.com/) for more information.\n   *\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var AuBankAccountElement = createElementComponent('auBankAccount', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var CardElement = createElementComponent('card', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var CardNumberElement = createElementComponent('cardNumber', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var CardExpiryElement = createElementComponent('cardExpiry', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var CardCvcElement = createElementComponent('cardCvc', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var FpxBankElement = createElementComponent('fpxBank', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var IbanElement = createElementComponent('iban', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var IdealBankElement = createElementComponent('idealBank', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var PaymentRequestButtonElement = createElementComponent('paymentRequestButton', isServer);\n  exports.AuBankAccountElement = AuBankAccountElement;\n  exports.CardCvcElement = CardCvcElement;\n  exports.CardElement = CardElement;\n  exports.CardExpiryElement = CardExpiryElement;\n  exports.CardNumberElement = CardNumberElement;\n  exports.Elements = Elements;\n  exports.ElementsConsumer = ElementsConsumer;\n  exports.FpxBankElement = FpxBankElement;\n  exports.IbanElement = IbanElement;\n  exports.IdealBankElement = IdealBankElement;\n  exports.PaymentRequestButtonElement = PaymentRequestButtonElement;\n  exports.useElements = useElements;\n  exports.useStripe = useStripe;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","export type PhoneNumber = string & { __type: 'PhoneNumber', format: '+19785551234' };\r\nexport type PhoneNumberFormatted = string & { __type: 'PhoneNumber', format: '(###) ###-####' };\r\n\r\nexport function formatPhoneNumber_UsaCanada(text: string): PhoneNumberFormatted {\r\n    return phoneNumberMask_UsaCanada(text).corrected as PhoneNumberFormatted;\r\n}\r\n\r\nexport function toStandardPhoneNumber(text: string): PhoneNumber {\r\n    return `+1${phoneNumberMask_UsaCanada(text).digitsNo1}` as PhoneNumber;\r\n}\r\n\r\nexport function toStandardPhoneNumber_optional(text: string | null | undefined): PhoneNumber | undefined {\r\n    if (!text) { return undefined; }\r\n    return `+1${phoneNumberMask_UsaCanada(text).digitsNo1}` as PhoneNumber;\r\n}\r\n\r\nexport function phoneNumberMask_UsaCanada(x: string | null | undefined) {\r\n    const numberMask = `(###) ###-####`;\r\n    const digits = x\r\n        ?.replace(/^(\\+1|1)/, ``)\r\n        .replace(/\\D/g, ``)\r\n        .split(``) ?? [];\r\n    const letters = numberMask.split(``);\r\n    let iDigit = 0;\r\n    let iLast = -1;\r\n    for (let i = 0; i < letters.length; i++) {\r\n        if (letters[i] === `#` && iDigit < digits.length) {\r\n            letters[i] = digits[iDigit];\r\n            iDigit++;\r\n            iLast = i;\r\n        }\r\n    }\r\n    const full = letters.join(``);\r\n    const corrected = letters.slice(0, iLast + 1).join(``);\r\n    return { corrected, full, digitsNo1: digits.join(``) };\r\n}\r\n","import \"core-js/modules/es6.promise\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/es6.date.to-string\";\nimport \"core-js/modules/es6.object.to-string\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.is-array\";\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nvar V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\n\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.5.0\"\n  });\n};\n\nvar stripePromise = null;\n\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\n\nvar initStripe = function initStripe(maybeStripe, args) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(void 0, _toConsumableArray(args));\n  registerWrapper(stripe);\n  return stripe;\n}; // own script injection.\n\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\n\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args);\n  });\n};\n\nexport { loadStripe };","/** This token is used to identify a specific app user with the user's id in the provider's context (i.e. customer id) */\r\nexport type PaymentProviderUserToken = unknown & { __type: 'PaymentProviderUserToken' };\r\n/** This token is used to identify the client as it negotiates directly with the provider to enter payment method data */\r\nexport type PaymentProviderSavedPaymentMethodClientSetupToken = unknown & { __type: 'PaymentProviderSavedPaymentMethodClientSetupToken' };\r\n/** This token is used to identify the payment method obtained on the client from the provider */\r\nexport type PaymentProviderSavedPaymentMethodClientToken = unknown & { __type: 'PaymentProviderSavedPaymentMethodClientToken' };\r\n/** This token is used to identify the payment method long term after being verified by the provider on the server */\r\nexport type PaymentProviderSavedPaymentMethodStorageToken = unknown & { __type: 'PaymentProviderSavedPaymentMethodStorageToken' };\r\n\r\n/** PaymentProviderName identifies the payment provider and it's implementation (i.e. stripe, paypal, etc.) */\r\nexport type PaymentProviderName = string & { __type: 'PaymentProviderName' };\r\n\r\n/** PaymentMethodStorageKey is the auto generated storage key to uniquely identify a stored payment method */\r\nexport type PaymentMethodStorageKey = string & { __type: 'PaymentMethodStorageKey' };\r\n\r\nexport type PaymentMethodExpiration = {\r\n    year: number;\r\n    month: number;\r\n};\r\nexport type PaymentMethodClientInfo = {\r\n    key: PaymentMethodStorageKey;\r\n    providerName: PaymentProviderName;\r\n    title: string;\r\n    expiration: PaymentMethodExpiration;\r\n};\r\n\r\nexport type PaymentAmount = { currency: 'usd', usdCents: number };\r\n\r\nexport type PaymentTransaction = {\r\n    providerName: PaymentProviderName;\r\n    created: Date;\r\n    amount: PaymentAmount;\r\n    status: 'success' | 'incomplete' | 'terminated';\r\n}\r\n\r\n/** Payment Client to Server Calls\r\n * \r\n * These are the calls made on the client to the server, it supports multiple payment provider types\r\n * \r\n * Note: this is scoped to the user associated with the client\r\n */\r\nexport type PaymentClientApi = {\r\n    // Normal Flow\r\n    setupSavedPaymentMethod: (params: { providerName: PaymentProviderName }) => Promise<PaymentProviderSavedPaymentMethodClientSetupToken>;\r\n    saveSavedPaymentMethod: (params: { providerName: PaymentProviderName, paymentMethodClientToken: PaymentProviderSavedPaymentMethodClientToken }) => Promise<void>;\r\n\r\n    // Management of Payment Methods\r\n    getSavedPaymentMethods: () => Promise<PaymentMethodClientInfo[]>;\r\n    deleteSavedPaymentMethod: (params: { key: PaymentMethodStorageKey }) => Promise<void>;\r\n\r\n    // Management of Payments\r\n    debug_triggerPayment: (params: { amount: PaymentAmount }) => Promise<void>;\r\n    getPayments: () => Promise<PaymentTransaction[]>;\r\n    // getPaymentsRequiringUserAction: () => Promise<PaymentTransaction[]>;\r\n}\r\n\r\n\r\n/** Payment Server to Server Calls\r\n * \r\n * These are the calls intended to be used server-side to process payments\r\n * \r\n */\r\nexport type PaymentServerApi = {\r\n    /** This will use the payment methods in order until one succeeds */\r\n    chargeUsingSavedPaymentMethods: (params: { amount: PaymentAmount }) => Promise<void>;\r\n}\r\n\r\n/** Payment Server to Payment Provider Api Calls\r\n * \r\n * This wraps the provider-specific server code\r\n */\r\nexport type PaymentProviderApi = {\r\n    providerName: PaymentProviderName;\r\n    setupSavedPaymentMethod: (userToken: PaymentProviderUserToken | null) => Promise<{\r\n        newUserToken?: PaymentProviderUserToken;\r\n        setupToken: PaymentProviderSavedPaymentMethodClientSetupToken;\r\n    }>;\r\n    obtainSavedPaymentMethod: (userToken: PaymentProviderUserToken, clientToken: PaymentProviderSavedPaymentMethodClientToken) => Promise<{\r\n        token: PaymentProviderSavedPaymentMethodStorageToken;\r\n        title: string;\r\n        expiration: PaymentMethodExpiration;\r\n    }>;\r\n    chargeSavedPaymentMethod: (userToken: PaymentProviderUserToken, token: PaymentProviderSavedPaymentMethodStorageToken, amount: PaymentAmount) => Promise<void>;\r\n\r\n    getPayments: (userToken: PaymentProviderUserToken) => Promise<PaymentTransaction[]>;\r\n}\r\n\r\n/** Payment Server Dependencies */\r\nexport type PaymentMethodStorageData = {\r\n    /** Key should be auto-generated by storage provider */\r\n    key: PaymentMethodStorageKey;\r\n    title: string;\r\n    expiration: PaymentMethodExpiration;\r\n    providerName: PaymentProviderName;\r\n    paymentMethodStorageToken: PaymentProviderSavedPaymentMethodStorageToken;\r\n};\r\n\r\nexport type PaymentUserTokenData = {\r\n    providerName: PaymentProviderName;\r\n    userToken: PaymentProviderUserToken;\r\n};\r\n\r\nexport type PaymentStorageProviderApi = {\r\n    getUserToken: (params: { providerName: PaymentProviderName }) => Promise<PaymentUserTokenData | null>;\r\n    setUserToken: (params: PaymentUserTokenData) => Promise<void>;\r\n\r\n    savePaymentMethod: (params: Omit<PaymentMethodStorageData, 'key'>) => Promise<void>;\r\n    /** Return all saved payment methods - In the order that they were created */\r\n    getSavedPaymentMethods: () => Promise<PaymentMethodStorageData[]>;\r\n    deleteSavedPaymentMethod: (params: { key: PaymentMethodStorageKey }) => Promise<void>;\r\n}\r\n\r\nexport class PaymentError extends Error {\r\n    constructor(public message: string, public data?: unknown) { super(); }\r\n}\r\n","\r\nexport enum ProcessSteps_CreateSavedPaymentMethod {\r\n    _01_Client_BeginCreateSavedPaymentMethod = 100,\r\n    _02_Server_SetupSavedPaymentMethod = 200,\r\n    _03_Client_CollectPaymentDetails = 300,\r\n    _04_Server_ObtainPaymentMethod = 400,\r\n    _05_Server_SavePaymentMethod = 500,\r\n};\r\n\r\nexport const logProcessStep_CreateSavedPaymentMethod = (step: ProcessSteps_CreateSavedPaymentMethod, status?: 'BEGIN' | 'END' | 'FAIL', data?: unknown) => {\r\n    // TODO: Implement Universal Logger\r\n\r\n    // eslint-disable-next-line no-console\r\n    console.log(`CreateSavedPaymentMethod: ${ProcessSteps_CreateSavedPaymentMethod[step]} ${status}`, data);\r\n};\r\n\r\nexport const wrapProcessStep_CreateSavedPaymentMethod = async <TResult>(step: ProcessSteps_CreateSavedPaymentMethod, execute: () => Promise<TResult>): Promise<TResult> => {\r\n    try {\r\n        logProcessStep_CreateSavedPaymentMethod(step, `BEGIN`);\r\n\r\n        const result = await execute();\r\n        logProcessStep_CreateSavedPaymentMethod(step, `END`);\r\n        return result;\r\n    } catch (error) {\r\n        logProcessStep_CreateSavedPaymentMethod(step, `FAIL`, { error });\r\n        throw error;\r\n    }\r\n};\r\n","/* eslint-disable @typescript-eslint/quotes */\r\n/* eslint-disable prefer-template */\r\nimport { ProcessSteps_CreateSavedPaymentMethod } from '../../../common/process-steps';\r\n\r\n// Saved Payments: https://stripe.com/docs/payments/save-and-reuse\r\nexport enum ProcessSteps_CreateSavedPaymentMethod_Stripe {\r\n    _02A_Server_GetOrCreateCustomer = ProcessSteps_CreateSavedPaymentMethod._02_Server_SetupSavedPaymentMethod + 1,\r\n    _02B_Server_CreateSetupIntent = ProcessSteps_CreateSavedPaymentMethod._02_Server_SetupSavedPaymentMethod + 2,\r\n    _03A_Client_CollectPaymentDetails = ProcessSteps_CreateSavedPaymentMethod._03_Client_CollectPaymentDetails + 1,\r\n    _04A_Server_ObtainPaymentMethod = ProcessSteps_CreateSavedPaymentMethod._04_Server_ObtainPaymentMethod + 1,\r\n    _04B_Server_ObtainPaymentMethodDetails = ProcessSteps_CreateSavedPaymentMethod._04_Server_ObtainPaymentMethod + 2,\r\n};\r\n\r\nexport const logProcessStep_CreateSavedPaymentMethod_Stripe = (step: ProcessSteps_CreateSavedPaymentMethod_Stripe, status?: 'BEGIN' | 'END' | 'FAIL', data?: unknown) => {\r\n    // TODO: Implement Universal Logger\r\n\r\n    // eslint-disable-next-line no-console\r\n    console.log(`CreateSavedPaymentMethod_Stripe: ${ProcessSteps_CreateSavedPaymentMethod_Stripe[step]} ${status}`, data);\r\n};\r\n\r\nexport const wrapProcessStep_CreateSavedPaymentMethod_Stripe = async <TResult>(step: ProcessSteps_CreateSavedPaymentMethod_Stripe, execute: () => Promise<TResult>): Promise<TResult> => {\r\n    try {\r\n        logProcessStep_CreateSavedPaymentMethod_Stripe(step, `BEGIN`);\r\n\r\n        const result = await execute();\r\n        logProcessStep_CreateSavedPaymentMethod_Stripe(step, `END`);\r\n        return result;\r\n    } catch (error) {\r\n        logProcessStep_CreateSavedPaymentMethod_Stripe(step, `FAIL`, { error });\r\n        throw error;\r\n    }\r\n};\r\n","import React, { useState } from 'react';\r\nimport { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\r\nimport { loadStripe, PaymentMethod, PaymentMethodCreateParams } from '@stripe/stripe-js';\r\nimport { PaymentClientComponents } from '../../../common/types-react';\r\nimport { PaymentError } from '../../../common/types';\r\nimport { stripeDecodeClientSetupToken, stripeEncodeClientToken } from './stripe-client-tokens';\r\nimport { wrapProcessStep_CreateSavedPaymentMethod_Stripe, ProcessSteps_CreateSavedPaymentMethod_Stripe } from '../common/stripe-process-steps';\r\n\r\nexport const createPaymentClientComponents_stripe = (params: { stripePublicKey: string }): PaymentClientComponents => {\r\n\r\n    const stripePromise = loadStripe(params.stripePublicKey);\r\n\r\n    const components: PaymentClientComponents = {\r\n        AppWrapperComponent: ({ children }) => (<Elements stripe={stripePromise}>{children}</Elements>),\r\n        PaymentMethodEntryComponent: ({ style, paymentMethodSetupToken, onPaymentMethodReady }) => {\r\n            const stripe = useStripe();\r\n            const elements = useElements();\r\n\r\n            const [stripeError, setStripeError] = useState(null as null | { message: string, error: unknown });\r\n\r\n            const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\r\n                event.preventDefault();\r\n                if (!stripe || !elements) { return; }\r\n\r\n                try {\r\n                    // Completed SetupIntent -> Used to get PaymentMethod\r\n                    const setupIntent = await wrapProcessStep_CreateSavedPaymentMethod_Stripe(\r\n                        ProcessSteps_CreateSavedPaymentMethod_Stripe._03A_Client_CollectPaymentDetails,\r\n                        async () => {\r\n\r\n                            const setupInfo = stripeDecodeClientSetupToken(paymentMethodSetupToken);\r\n\r\n                            const result = await stripe.confirmCardSetup(setupInfo.clientSecret, {\r\n                                payment_method: {\r\n                                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n                                    card: elements.getElement(CardElement)!,\r\n                                    billing_details: setupInfo.customerBillingDetails,\r\n                                },\r\n                            });\r\n\r\n                            if (result.error || !result.setupIntent) {\r\n                                throw new PaymentError(`Stripe Payment Error`, result.error);\r\n                            }\r\n\r\n                            return result.setupIntent;\r\n                        });\r\n                    if (!setupIntent) { return; }\r\n\r\n                    onPaymentMethodReady(stripeEncodeClientToken({ setupIntent }));\r\n                } catch (error) {\r\n                    setStripeError({ message: `Stripe Payment Error`, error });\r\n                }\r\n            };\r\n\r\n            const s = style;\r\n            const inputStyle = {\r\n                base: {\r\n                    color: s.textColor,\r\n                    fontSize: s.fontSize ? `${s.fontSize}px` : ``,\r\n                    fontFamily: s.fontFamily,\r\n                    fontSmoothing: `antialiased`,\r\n                    \"::placeholder\": {\r\n                        color: s.textColor,\r\n                        opacity: 0.8,\r\n                    },\r\n                },\r\n                invalid: {\r\n                    color: s.textColor_invalid,\r\n                    iconColor: s.textColor_invalid,\r\n                },\r\n            };\r\n            const inputContainerStyle = {\r\n                marginBottom: s.elementPadding,\r\n                padding: s.textPadding,\r\n                backgroundColor: s.backgroundColor,\r\n                borderWidth: 1, borderStyle: `solid`, borderColor: s.borderColor, borderRadius: s.borderRadius,\r\n            };\r\n            const buttonStyle = {\r\n                color: s.textColor,\r\n                backgroundColor: s.backgroundColor,\r\n                borderWidth: 1, borderStyle: `solid`, borderColor: s.borderColor, borderRadius: s.borderRadius,\r\n\r\n                fontSize: s.fontSize ? `${s.fontSize}px` : ``,\r\n                fontFamily: s.fontFamily,\r\n                fontSmoothing: `antialiased`,\r\n                fontWeight: `bold`,\r\n                padding: s.textPadding,\r\n                marginBottom: s.elementPadding,\r\n            } as const;\r\n            const buttonJustifyContent = s.buttonAlignment === `left` ? `flex-start`\r\n                : (s.buttonAlignment === `right` ? `flex-end`\r\n                    : `center`);\r\n\r\n            const errorContainerStyle = {\r\n                marginBottom: s.elementPadding,\r\n                padding: s.textPadding,\r\n                backgroundColor: s.backgroundColor,\r\n                borderWidth: 1, borderStyle: `solid`, borderColor: s.borderColor, borderRadius: s.borderRadius,\r\n            };\r\n            const errorMessageStyle = {\r\n                color: s.textColor_invalid,\r\n\r\n                fontSize: s.fontSize ? `${s.fontSize}px` : ``,\r\n                fontFamily: s.fontFamily,\r\n                fontSmoothing: `antialiased`,\r\n                fontWeight: `bold`,\r\n                padding: s.textPadding,\r\n                marginBottom: s.elementPadding,\r\n            } as const;\r\n\r\n            return (\r\n                <form onSubmit={handleSubmit}>\r\n                    <div style={inputContainerStyle}>\r\n                        <CardElement options={{ style: inputStyle }} />\r\n                    </div>\r\n                    {stripeError && (\r\n                        <>\r\n                            <div style={errorContainerStyle}>\r\n                                <span style={errorMessageStyle}>{stripeError.message}</span>\r\n                            </div>\r\n                        </>\r\n                    )}\r\n\r\n                    {!stripeError && (\r\n                        <div style={{ display: `flex`, flexDirection: `row`, justifyContent: buttonJustifyContent }}>\r\n                            <button type='submit' disabled={!stripe || !elements} style={buttonStyle}>{s.buttonText ?? `Subscribe`}</button>\r\n                        </div>\r\n                    )}\r\n                </form>\r\n            );\r\n        },\r\n    };\r\n\r\n    return components;\r\n};\r\n","import { PaymentMethodCreateParams, SetupIntent } from '@stripe/stripe-js';\r\nimport { PaymentProviderSavedPaymentMethodClientSetupToken, PaymentProviderSavedPaymentMethodClientToken } from '../../../common/types';\r\n\r\nexport type StripeCustomerBillingDetails = PaymentMethodCreateParams.BillingDetails;\r\n\r\nexport type StripePaymentClientSetupToken = {\r\n    clientSecret: string;\r\n    customerBillingDetails: StripeCustomerBillingDetails;\r\n};\r\n\r\nexport const stripeEncodeClientSetupToken = (params: StripePaymentClientSetupToken): PaymentProviderSavedPaymentMethodClientSetupToken => {\r\n    return params as unknown as PaymentProviderSavedPaymentMethodClientSetupToken;\r\n};\r\nexport const stripeDecodeClientSetupToken = (params: PaymentProviderSavedPaymentMethodClientSetupToken): StripePaymentClientSetupToken => {\r\n    return params as unknown as StripePaymentClientSetupToken;\r\n};\r\n\r\nexport type StripePaymentClientToken = {\r\n    setupIntent: SetupIntent;\r\n};\r\n\r\nexport const stripeEncodeClientToken = (params: StripePaymentClientToken): PaymentProviderSavedPaymentMethodClientToken => {\r\n    return params as unknown as PaymentProviderSavedPaymentMethodClientToken;\r\n};\r\nexport const stripeDecodeClientToken = (params: PaymentProviderSavedPaymentMethodClientToken): StripePaymentClientToken => {\r\n    return params as unknown as StripePaymentClientToken;\r\n};\r\n","// 20.2.2.28 Math.sign(x)\nmodule.exports = Math.sign || function sign(x) {\n  // eslint-disable-next-line no-self-compare\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n","export var IconsManifest = [{\n  \"id\": \"fa\",\n  \"name\": \"Font Awesome\",\n  \"projectUrl\": \"https://fontawesome.com/\",\n  \"license\": \"CC BY 4.0 License\",\n  \"licenseUrl\": \"https://creativecommons.org/licenses/by/4.0/\"\n}, {\n  \"id\": \"io\",\n  \"name\": \"Ionicons\",\n  \"projectUrl\": \"https://ionicons.com/\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://github.com/ionic-team/ionicons/blob/master/LICENSE\"\n}, {\n  \"id\": \"md\",\n  \"name\": \"Material Design icons\",\n  \"projectUrl\": \"http://google.github.io/material-design-icons/\",\n  \"license\": \"Apache License Version 2.0\",\n  \"licenseUrl\": \"https://github.com/google/material-design-icons/blob/master/LICENSE\"\n}, {\n  \"id\": \"ti\",\n  \"name\": \"Typicons\",\n  \"projectUrl\": \"http://s-ings.com/typicons/\",\n  \"license\": \"CC BY-SA 3.0\",\n  \"licenseUrl\": \"https://creativecommons.org/licenses/by-sa/3.0/\"\n}, {\n  \"id\": \"go\",\n  \"name\": \"Github Octicons icons\",\n  \"projectUrl\": \"https://octicons.github.com/\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://github.com/primer/octicons/blob/master/LICENSE\"\n}, {\n  \"id\": \"fi\",\n  \"name\": \"Feather\",\n  \"projectUrl\": \"https://feathericons.com/\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://github.com/feathericons/feather/blob/master/LICENSE\"\n}, {\n  \"id\": \"gi\",\n  \"name\": \"Game Icons\",\n  \"projectUrl\": \"https://game-icons.net/\",\n  \"license\": \"CC BY 3.0\",\n  \"licenseUrl\": \"https://creativecommons.org/licenses/by/3.0/\"\n}, {\n  \"id\": \"wi\",\n  \"name\": \"Weather Icons\",\n  \"projectUrl\": \"https://erikflowers.github.io/weather-icons/\",\n  \"license\": \"SIL OFL 1.1\",\n  \"licenseUrl\": \"http://scripts.sil.org/OFL\"\n}, {\n  \"id\": \"di\",\n  \"name\": \"Devicons\",\n  \"projectUrl\": \"https://vorillaz.github.io/devicons/\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n}, {\n  \"id\": \"ai\",\n  \"name\": \"Ant Design Icons\",\n  \"projectUrl\": \"https://github.com/ant-design/ant-design-icons\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n}, {\n  \"id\": \"bs\",\n  \"name\": \"Bootstrap Icons\",\n  \"projectUrl\": \"https://github.com/twbs/icons\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n}, {\n  \"id\": \"ri\",\n  \"name\": \"Remix Icon\",\n  \"projectUrl\": \"https://github.com/Remix-Design/RemixIcon\",\n  \"license\": \"Apache License Version 2.0\",\n  \"licenseUrl\": \"http://www.apache.org/licenses/\"\n}, {\n  \"id\": \"fc\",\n  \"name\": \"Flat Color Icons\",\n  \"projectUrl\": \"https://github.com/icons8/flat-color-icons\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n}, {\n  \"id\": \"gr\",\n  \"name\": \"Grommet-Icons\",\n  \"projectUrl\": \"https://github.com/grommet/grommet-icons\",\n  \"license\": \"Apache License Version 2.0\",\n  \"licenseUrl\": \"http://www.apache.org/licenses/\"\n}];","import * as React from 'react';\nexport var DefaultContext = {\n  color: undefined,\n  size: undefined,\n  className: undefined,\n  style: undefined,\n  attr: undefined\n};\nexport var IconContext = React.createContext && React.createContext(DefaultContext);","import \"core-js/modules/es6.array.map\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/es6.array.index-of\";\nimport \"core-js/modules/es6.object.assign\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport * as React from 'react';\nimport { IconContext, DefaultContext } from './iconContext';\n\nfunction Tree2Element(tree) {\n  return tree && tree.map(function (node, i) {\n    return React.createElement(node.tag, __assign({\n      key: i\n    }, node.attr), Tree2Element(node.child));\n  });\n}\n\nexport function GenIcon(data) {\n  return function (props) {\n    return React.createElement(IconBase, __assign({\n      attr: __assign({}, data.attr)\n    }, props), Tree2Element(data.child));\n  };\n}\nexport function IconBase(props) {\n  var elem = function elem(conf) {\n    var computedSize = props.size || conf.size || \"1em\";\n    var className;\n    if (conf.className) className = conf.className;\n    if (props.className) className = (className ? className + ' ' : '') + props.className;\n\n    var attr = props.attr,\n        title = props.title,\n        svgProps = __rest(props, [\"attr\", \"title\"]);\n\n    return React.createElement(\"svg\", __assign({\n      stroke: \"currentColor\",\n      fill: \"currentColor\",\n      strokeWidth: \"0\"\n    }, conf.attr, attr, svgProps, {\n      className: className,\n      style: __assign({\n        color: props.color || conf.color\n      }, conf.style, props.style),\n      height: computedSize,\n      width: computedSize,\n      xmlns: \"http://www.w3.org/2000/svg\"\n    }), title && React.createElement(\"title\", null, title), props.children);\n  };\n\n  return IconContext !== undefined ? React.createElement(IconContext.Consumer, null, function (conf) {\n    return elem(conf);\n  }) : elem(DefaultContext);\n}","import { Platform } from 'react-native-lite';\r\n\r\nexport const createSpeechService = (): {\r\n    speak: (text: string, languange?: string) => void;\r\n    getVoicesForLanguange: (languange: string) => { voice: SpeechSynthesisVoice, isSelected: boolean }[];\r\n    setVoiceForLanguange: (languange: string, voice: SpeechSynthesisVoice) => void;\r\n} => {\r\n    if (Platform.OS !== `web`) {\r\n        return {\r\n            speak: () => { },\r\n            getVoicesForLanguange: () => [],\r\n            setVoiceForLanguange: () => { },\r\n        };\r\n    }\r\n\r\n    const synth = window.speechSynthesis;\r\n\r\n    const selectedVoices = {} as { [languange: string]: SpeechSynthesisVoice };\r\n\r\n    const speak = (text: string, languange?: string) => {\r\n        const voiceLang = selectedVoices[languange ?? `en`] ?? null;\r\n\r\n        try {\r\n            const u = new SpeechSynthesisUtterance(text);\r\n            u.voice = voiceLang;\r\n            synth.speak(u);\r\n        } catch {\r\n            // Ignore\r\n        }\r\n    };\r\n\r\n    return {\r\n        speak,\r\n        getVoicesForLanguange: (languange) => {\r\n            const voices = synth.getVoices();\r\n            console.log(`voices`, { voices });\r\n            const v = voices.filter(x => x.lang.startsWith(languange)).map(x => ({\r\n                voice: x,\r\n                isSelected: selectedVoices[languange] === x,\r\n            }));\r\n            return v;\r\n        },\r\n        setVoiceForLanguange: (language, voice) => {\r\n            selectedVoices[language] = voice;\r\n        },\r\n    };\r\n};\r\n\r\nexport type SpeechService = ReturnType<typeof createSpeechService>;\r\n","\r\nexport enum IconKind {\r\n    // common icons\r\n    menu,\r\n    back,\r\n    error,\r\n    expanded,\r\n    collapsed,\r\n    copy,\r\n    retry,\r\n    dashboard,\r\n    add,\r\n    remove,\r\n    eye,\r\n    eyeSlash,\r\n\r\n    // navigation icons\r\n    account,\r\n    message,\r\n    subscription,\r\n    calendar,\r\n    contacts,\r\n    keys,\r\n    resources,\r\n    admin,\r\n}\r\n","export type JsonTyped<T> = string & { __json: T };\r\n\r\nexport const jsonParse = <T>(json: JsonTyped<T>): T => {\r\n    return JSON.parse(json) as T;\r\n};\r\nexport const jsonParse_smart = <T>(json: T | JsonTyped<T>): T => {\r\n    if (typeof json === `string`) {\r\n        return JSON.parse(json) as T;\r\n    }\r\n    return json as T;\r\n};\r\nexport const jsonStringify = <T>(obj: T) => JSON.stringify(obj) as JsonTyped<T>;\r\n\r\nexport const jsonStringify_safe = (obj: unknown, shouldFormat?: boolean): string => {\r\n    const visited = [] as unknown[];\r\n\r\n    return JSON.stringify(obj, (_, val: unknown) => {\r\n        if (val != null && typeof val == `object`) {\r\n            if (visited.includes(val)) {\r\n                return `[OBJ-DUPLICATED]`;\r\n            }\r\n            visited.push(val);\r\n        }\r\n        return val;\r\n    }, shouldFormat ? 2 : 0);\r\n};\r\n","import React from 'react';\r\nimport { ThemeIconStyle, theme } from 'themes/theme';\r\nimport { MdMenu, MdArrowBack, MdCheckBoxOutlineBlank, MdErrorOutline, MdContentCopy, MdDashboard } from 'react-icons/md';\r\nimport { FiChevronRight, FiChevronDown } from 'react-icons/fi';\r\nimport { FaRedo, FaPlus, FaMinus, FaEye, FaEyeSlash } from 'react-icons/fa';\r\nimport { View } from 'react-native-lite';\r\nimport { IconKind } from './icon-kind';\r\n\r\nfunction getIcon(kind: IconKind) {\r\n    switch (kind) {\r\n        case IconKind.menu: return { name: `menu`, component: MdMenu };\r\n        case IconKind.back: return { name: `arrow-back`, component: MdArrowBack };\r\n        case IconKind.error: return { name: `error-outline`, component: MdErrorOutline };\r\n        case IconKind.expanded: return { name: `chevron-down`, component: FiChevronDown };\r\n        case IconKind.collapsed: return { name: `chevron-right`, component: FiChevronRight };\r\n        case IconKind.copy: return { name: `content-copy`, component: MdContentCopy };\r\n        case IconKind.retry: return { name: `reload`, component: FaRedo };\r\n        case IconKind.dashboard: return { name: `dashboard`, component: MdDashboard };\r\n        case IconKind.add: return { name: `plus`, component: FaPlus };\r\n        case IconKind.remove: return { name: `minus`, component: FaMinus };\r\n        case IconKind.eye: return { name: `eye`, component: FaEye };\r\n        case IconKind.eyeSlash: return { name: `eye-slash`, component: FaEyeSlash };\r\n\r\n        // case IconKind.Account: return { name: `account-circle`, component: MaterialIcons };\r\n        // case IconKind.Message: return { name: `message`, component: MaterialIcons };\r\n        // case IconKind.Subscription: return { name: `ticket-account`, component: MaterialCommunityIcons };\r\n        // case IconKind.Campaigns: return { name: `calendar-multiselect`, component: MaterialCommunityIcons };\r\n        // case IconKind.Contacts: return { name: `contacts`, component: MaterialIcons };\r\n        // case IconKind.Keywords: return { name: `key-variant`, component: MaterialCommunityIcons };\r\n        // case IconKind.Resources: return { name: `collections-bookmark`, component: MaterialIcons };\r\n        // case IconKind.Admin: return { name: `settings`, component: MaterialIcons };\r\n        // case IconKind.Solutions: return { name: '', component: FontAwesome };\r\n        // case IconKind.Texting: return { name: '', component: FontAwesome };\r\n        // case IconKind.Pricing: return { name: '', component: FontAwesome };\r\n        // case IconKind.Download: return { name: '', component: FontAwesome };\r\n\r\n        default:\r\n            return { name: `unknown`, component: MdCheckBoxOutlineBlank };\r\n    }\r\n}\r\n\r\nexport const Icon = (props: { kind: IconKind, style?: ThemeIconStyle }) => {\r\n    const icon = getIcon(props.kind);\r\n    const IconComponent = icon.component;\r\n    const size = props.style?.size ?? theme.icon.size ?? theme.sizes.fontSize;\r\n    return (\r\n        <View style={{ width: size, height: size }}>\r\n            <IconComponent name={icon.name} size={size} color={props.style?.color ?? theme.icon.color} />\r\n        </View>\r\n    );\r\n};\r\n","import React, { useState } from 'react';\r\nimport { View, Text, TouchableOpacity, Clipboard } from 'react-native-lite';\r\nimport { theme } from 'themes/theme';\r\nimport { ErrorState } from 'utils/error';\r\nimport { jsonStringify_safe } from 'utils/json';\r\nimport { Icon } from './icon';\r\nimport { IconKind } from './icon-kind';\r\n\r\nconst DEBUG = true;\r\n\r\nconst errorBoxStyle = {\r\n    view: theme.view_error,\r\n    text: theme.text_error,\r\n    text_errorMessage: theme.text_errorMessage,\r\n    icon: theme.icon,\r\n    icon_errorMessage: theme.icon_errorMessage,\r\n    button: { outlineColor: theme.colors.outline },\r\n};\r\n\r\nexport const ErrorBox = ({ error }: { error: ErrorState | null | undefined }) => {\r\n    if (!error) { return (<></>); }\r\n    return (<ErrorBox_Inner error={error} />);\r\n};\r\n\r\nconst ErrorBox_Inner = (props: { error: ErrorState }) => {\r\n    const [expanded, setExpanded] = useState(false);\r\n\r\n    // console.log(`ErrorBox`, { error: props.error, expanded });\r\n\r\n    const errorAsString = typeof props.error === `string` ? `${props.error}` : null;\r\n    const errorMessage = props.error.message ?? errorAsString ?? `Unknown Error`;\r\n    const errorDetails = props.error.data && jsonStringify_safe(props.error.data, true) || undefined;\r\n    const errorObjText = DEBUG && props.error && jsonStringify_safe(props.error, true) || undefined;\r\n    const canExpand = !!errorDetails || !!errorObjText;\r\n\r\n    return (\r\n        <View style={errorBoxStyle.view}>\r\n            <View style={{ flexDirection: `row` }}>\r\n                <TouchableOpacity style={{ flex: 1, flexDirection: `row`, alignItems: `center`, ...errorBoxStyle.button }} onPress={() => setExpanded(!expanded)}>\r\n                    {canExpand && (expanded ? <Icon style={errorBoxStyle.icon} kind={IconKind.expanded} /> : <Icon style={errorBoxStyle.icon} kind={IconKind.collapsed} />)}\r\n                    <View style={{ paddingRight: 8 }}>\r\n                        <Icon style={errorBoxStyle.icon} kind={IconKind.error} />\r\n                    </View>\r\n                    <View style={{ flex: 1, overflow: `hidden` }}>\r\n                        <Text style={errorBoxStyle.text} numberOfLines={!expanded ? 1 : undefined}>{errorMessage}</Text>\r\n                    </View>\r\n                </TouchableOpacity>\r\n                {DEBUG && (\r\n                    <TouchableOpacity style={{ flexDirection: `row`, alignItems: `center`, paddingLeft: 8, ...errorBoxStyle.button }} onPress={() => Clipboard.setString(jsonStringify_safe({ errorMessage, errorDetails, errorObjText }, true))}>\r\n                        <Icon style={errorBoxStyle.icon} kind={IconKind.copy} />\r\n                    </TouchableOpacity>\r\n                )}\r\n                {props.error.retryCallback && (\r\n                    <TouchableOpacity style={{ flexDirection: `row`, alignItems: `center`, paddingLeft: 8, ...errorBoxStyle.button }} onPress={props.error.retryCallback}>\r\n                        <Icon style={errorBoxStyle.icon} kind={IconKind.retry} />\r\n                    </TouchableOpacity>\r\n                )}\r\n            </View>\r\n            {canExpand && expanded && !!errorDetails && (<Text style={{ ...errorBoxStyle.text }}>{errorDetails}</Text>)}\r\n            {canExpand && expanded && !!errorObjText && (<Text style={{ ...errorBoxStyle.text }}>{errorObjText}</Text>)}\r\n        </View>\r\n    );\r\n};\r\n\r\n\r\nexport const ErrorMessage = (props: { children: string }) => {\r\n    return (\r\n        <View style={{ flexDirection: `row`, alignItems: `center` }}>\r\n            <View style={{ paddingLeft: 8, paddingRight: 8 }}>\r\n                <Icon style={errorBoxStyle.icon_errorMessage} kind={IconKind.error} />\r\n            </View>\r\n            <View style={{ overflow: `hidden` }}>\r\n                <Text style={errorBoxStyle.text_errorMessage} numberOfLines={1}>{props.children}</Text>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n","import React, { } from 'react';\r\nimport { Text, TouchableOpacity } from 'react-native-lite';\r\nimport { theme, ThemeTextStyle, ThemeViewStyle, extractViewStyle, extractTextStyle } from 'themes/theme';\r\n\r\nexport const Button = (props: { style?: ThemeTextStyle & ThemeViewStyle, styleAlt?: boolean, children: string, onPress: () => void }) => {\r\n    const s = props.style ?? (props.styleAlt ? theme.button_formAction_alt : theme.button_formAction);\r\n    return (\r\n        <TouchableOpacity style={extractViewStyle(s)} onPress={props.onPress}>\r\n            <Text style={extractTextStyle(s)}>{props.children}</Text>\r\n        </TouchableOpacity>\r\n    );\r\n};\r\n","import React, { } from 'react';\r\nimport { View, Text } from 'react-native-lite';\r\nimport { theme } from 'themes/theme';\r\nimport { Loading, LoadingInline } from './loading';\r\nimport { ErrorBox, ErrorMessage } from './error-box';\r\nimport { Input_Text, Input_Username, Input_Password, Input_Phone, Input_Email, Input_Currency } from './inputs';\r\nimport { Button } from './button';\r\n\r\ntype PropsOf<T> = T extends (props: infer P) => JSX.Element ? P : never;\r\n\r\nexport const C = {\r\n    Loading,\r\n    LoadingInline,\r\n    ErrorBox,\r\n    ErrorMessage,\r\n    View_Panel: (props: PropsOf<typeof View>) => (<View style={theme.view_panel} {...props} />),\r\n    View_Form: (props: PropsOf<typeof View>) => (<View style={theme.view_form} {...props} />),\r\n    View_FormFields: (props: PropsOf<typeof View>) => (<View style={theme.view_formFields} {...props} />),\r\n    View_FieldRow: (props: PropsOf<typeof View>) => (<View style={theme.view_fieldRow} {...props} />),\r\n    View_FormActionRow: (props: PropsOf<typeof View>) => (<View style={theme.view_formActionRow} {...props} />),\r\n    Text_FormTitle: (props: PropsOf<typeof Text>) => (<Text style={theme.text_formTitle} {...props} />),\r\n    Text_FieldLabel: (props: PropsOf<typeof Text>) => (<Text style={theme.text_fieldLabel} numberOfLines={1} {...props} />),\r\n    Button_FieldInline: (props: PropsOf<typeof Button>) => (<Button style={props.styleAlt ? theme.button_fieldInline_alt : theme.button_fieldInline} {...props} />),\r\n    Button_FormAction: (props: PropsOf<typeof Button>) => (<Button style={props.styleAlt ? theme.button_formAction_alt : theme.button_formAction} {...props} />),\r\n    Input_Text,\r\n    Input_Username,\r\n    Input_Password,\r\n    Input_Phone,\r\n    Input_Email,\r\n    Input_Currency,\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { ActivityIndicator, View } from 'react-native-lite';\r\nimport { theme } from 'themes/theme';\r\n\r\nexport const Loading = ({ loading }: { loading?: boolean }) => {\r\n\r\n    const visible = loading;\r\n\r\n    // // Show loading for a min time\r\n    // const [visible, setVisible] = useState(loading);\r\n    // const MIN_TIME_MS = 500;\r\n    // useEffect(() => {\r\n    //     if (loading) { setVisible(true); return () => { }; }\r\n    //     const timeoutId = setTimeout(() => {\r\n    //         setVisible(false);\r\n    //     }, MIN_TIME_MS);\r\n    //     return () => {\r\n    //         clearTimeout(timeoutId);\r\n    //     };\r\n    // }, [loading]);\r\n\r\n    if (!visible) { return <></>; }\r\n\r\n    return (\r\n        <View>\r\n            <ActivityIndicator size='large' color={theme.colors.loader} />\r\n        </View>\r\n    );\r\n};\r\n\r\nexport const LoadingInline = ({ loading }: { loading?: boolean }) => {\r\n\r\n    const visible = loading;\r\n\r\n    // // Show loading for a min time\r\n    // const [visible, setVisible] = useState(loading);\r\n    // const MIN_TIME_MS = 500;\r\n    // useEffect(() => {\r\n    //     if (loading) { setVisible(true); return () => { }; }\r\n    //     const timeoutId = setTimeout(() => {\r\n    //         setVisible(false);\r\n    //     }, MIN_TIME_MS);\r\n    //     return () => {\r\n    //         clearTimeout(timeoutId);\r\n    //     };\r\n    // }, [loading]);\r\n\r\n    if (!visible) { return <></>; }\r\n\r\n    return (\r\n        <>\r\n            <ActivityIndicator size='small' color={theme.colors.loader} />\r\n        </>\r\n    );\r\n};\r\n","import React, { useState } from 'react';\r\nimport { TextInput, View, TouchableOpacity } from 'react-native-lite';\r\nimport { theme, ThemeTextStyle } from 'themes/theme';\r\nimport { PhoneNumber, toStandardPhoneNumber, formatPhoneNumber_UsaCanada } from 'utils/phone-number';\r\nimport { EmailAddress, toEmailAddress } from 'utils/email-address';\r\nimport { Icon } from './icon';\r\nimport { IconKind } from './icon-kind';\r\n\r\nexport const Input_Text = (props: { style?: ThemeTextStyle, value: string, onChange: (value: string) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='default'\r\n            autoCompleteType='off'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={`${props.value}`}\r\n            onChange={(x) => props.onChange(x)}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n\r\nexport const Input_Username = (props: { style?: ThemeTextStyle, value: string, onChange: (value: string) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='default'\r\n            autoCompleteType='username'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={`${props.value}`}\r\n            onChange={(x) => props.onChange(x)}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n\r\nexport const Input_Password = (props: { style?: ThemeTextStyle, value: string, onChange: (value: string) => void, onSubmit?: () => void, onBlur?: () => void, placeholder?: string, editable?: boolean }) => {\r\n\r\n    const [showPassword, setShowPassword] = useState(false);\r\n\r\n    const inputStyle = props.style ?? theme.input_fieldEntry;\r\n    const { marginRight } = inputStyle;\r\n    return (\r\n        <View style={{ flexDirection: `row`, alignItems: `center` }}>\r\n            <TextInput style={{ ...inputStyle, marginRight: 0 }}\r\n                keyboardType='default'\r\n                autoCompleteType='password'\r\n                secureTextEntry={!showPassword}\r\n                placeholder={props.placeholder}\r\n                editable={props.editable}\r\n                value={`${props.value}`}\r\n                onChange={(x) => props.onChange(x)}\r\n                onSubmitEditing={props.onSubmit}\r\n                onBlur={props.onBlur}\r\n            />\r\n            <TouchableOpacity onPress={() => setShowPassword(s => !s)} style={{ outlineColor: theme.icon.outlineColor }}>\r\n                <View style={{ paddingLeft: 4, paddingRight: 4, marginRight }}>\r\n                    <Icon style={theme.icon} kind={showPassword ? IconKind.eye : IconKind.eyeSlash} />\r\n                </View>\r\n            </TouchableOpacity>\r\n        </View>\r\n    );\r\n};\r\n\r\nexport type Currency = number;// & { __type: 'currency' };\r\nexport const Input_Currency = (props: { style?: ThemeTextStyle, value: Currency, onChange: (value: Currency) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='numeric'\r\n            autoCompleteType='off'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={`${props.value}`}\r\n            onChange={(x) => props.onChange(Number.parseFloat(x) || 0)}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n\r\nexport const Input_Phone = (props: { style?: ThemeTextStyle, value: PhoneNumber, onChange: (value: PhoneNumber) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n\r\n    const [valueActual, setValueActual] = useState(formatPhoneNumber_UsaCanada(props.value));\r\n    const changeValueActual = (v: string) => {\r\n        setValueActual(formatPhoneNumber_UsaCanada(v));\r\n        props.onChange(toStandardPhoneNumber(v));\r\n    };\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='phone-pad'\r\n            autoCompleteType='tel'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={valueActual}\r\n            onChange={changeValueActual}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n\r\n\r\nexport const Input_Email = (props: { style?: ThemeTextStyle, value: EmailAddress, onChange: (value: EmailAddress) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n\r\n    const [valueActual, setValueActual] = useState(toEmailAddress(props.value));\r\n    const changeValueActual = (v: string) => {\r\n        setValueActual(toEmailAddress(v));\r\n        props.onChange(toEmailAddress(v));\r\n    };\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='email-address'\r\n            autoCompleteType='email'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={valueActual}\r\n            onChange={changeValueActual}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n","// 20.2.2.28 Math.sign(x)\nvar $export = require('./_export');\n\n$export($export.S, 'Math', { sign: require('./_math-sign') });\n","export async function delay(timeout: number): Promise<void> {\r\n    return await new Promise((resolve) => {\r\n        setTimeout(resolve, timeout);\r\n    });\r\n}\r\n","/* eslint-disable @typescript-eslint/no-unused-vars */\r\nexport type ThemeViewStyle = {\r\n    display?: 'flex';\r\n    flexDirection?: 'row' | 'column' | 'row-reverse' | 'column-reverse';\r\n    flexWrap?: 'wrap' | 'nowrap';\r\n    flex?: number;\r\n    justifyContent?: 'flex-start' | 'center' | 'flex-end' | 'space-around' | 'space-between';\r\n    alignItems?: 'center';\r\n    alignSelf?: 'center' | 'stretch';\r\n    overflow?: 'visible' | 'hidden';\r\n\r\n    background?: string;\r\n\r\n    margin?: number;\r\n    marginLeft?: number;\r\n    marginRight?: number;\r\n    marginTop?: number;\r\n    marginBottom?: number;\r\n    padding?: number;\r\n    paddingRight?: number;\r\n    paddingLeft?: number;\r\n    paddingTop?: number;\r\n    paddingBottom?: number;\r\n\r\n    width?: number;\r\n    minWidth?: number;\r\n    maxWidth?: number;\r\n    height?: number;\r\n\r\n    borderWidth?: number;\r\n    borderLeftWidth?: number;\r\n    borderRightWidth?: number;\r\n    borderTopWidth?: number;\r\n    borderBottomWidth?: number;\r\n\r\n    borderColor?: string;\r\n    borderLeftColor?: string;\r\n    borderRightColor?: string;\r\n    borderTopColor?: string;\r\n    borderBottomColor?: string;\r\n\r\n\r\n    borderRadius?: number;\r\n    borderStyle?: 'solid';\r\n    outlineColor?: string;\r\n    outline?: `none`;\r\n\r\n    transform?: string;\r\n\r\n    opacity?: number;\r\n\r\n    position?: 'absolute' | 'relative';\r\n    top?: number;\r\n    bottom?: number;\r\n    left?: number;\r\n    right?: number;\r\n    zIndex?: number;\r\n};\r\nexport type ThemeTextStyle = {\r\n    margin?: number;\r\n    marginLeft?: number;\r\n    marginRight?: number;\r\n    marginTop?: number;\r\n    marginBottom?: number;\r\n    padding?: number;\r\n    paddingRight?: number;\r\n    paddingLeft?: number;\r\n    paddingTop?: number;\r\n    paddingBottom?: number;\r\n\r\n    color?: string;\r\n\r\n    fontFamily?: string;\r\n    fontSize?: number;\r\n    fontWeight?: 'normal' | 'bold' | 'lighter';\r\n    lineHeight?: string;\r\n    whiteSpace?: 'normal' | 'nowrap' | 'pre' | 'pre-wrap';\r\n    minWidth?: number;\r\n\r\n    outlineColor?: string;\r\n    userSelect?: `none`;\r\n};\r\nexport type ThemeIconStyle = {\r\n    color?: string;\r\n    size?: number;\r\n    outlineColor?: string;\r\n};\r\n\r\nexport const extractViewStyle = (style: ThemeViewStyle & ThemeTextStyle): ThemeViewStyle => {\r\n    return {\r\n        display: style.display,\r\n        flexDirection: style.flexDirection,\r\n        flex: style.flex,\r\n        justifyContent: style.justifyContent,\r\n        alignItems: style.alignItems,\r\n        overflow: style.overflow,\r\n\r\n        background: style.background,\r\n\r\n        margin: style.margin,\r\n        marginLeft: style.margin ?? style.marginLeft,\r\n        marginRight: style.margin ?? style.marginRight,\r\n        marginTop: style.margin ?? style.marginTop,\r\n        marginBottom: style.margin ?? style.marginBottom,\r\n        padding: style.padding,\r\n        paddingRight: style.padding ?? style.paddingRight,\r\n        paddingLeft: style.padding ?? style.paddingLeft,\r\n        paddingTop: style.padding ?? style.paddingTop,\r\n        paddingBottom: style.padding ?? style.paddingBottom,\r\n\r\n        width: style.width,\r\n        minWidth: style.minWidth,\r\n        maxWidth: style.maxWidth,\r\n        height: style.height,\r\n\r\n        borderWidth: style.borderWidth,\r\n        borderRadius: style.borderRadius,\r\n        borderColor: style.borderColor,\r\n        borderStyle: style.borderStyle,\r\n\r\n        outlineColor: style.outlineColor,\r\n    };\r\n};\r\nexport const extractTextStyle = (style: ThemeViewStyle & ThemeTextStyle): ThemeTextStyle => {\r\n    return {\r\n        // padding: style.padding,\r\n        color: style.color,\r\n\r\n        fontFamily: style.fontFamily,\r\n        fontSize: style.fontSize,\r\n        fontWeight: style.fontWeight,\r\n        lineHeight: style.lineHeight,\r\n        // whiteSpace: style.whiteSpace,\r\n\r\n        outlineColor: style.outlineColor,\r\n    };\r\n};\r\n\r\nexport const basicThemeColors = {\r\n    text: `#333333`,\r\n    text_header: `#333333`,\r\n    text_button: `#333333`,\r\n    text_error: `#333333`,\r\n    text_errorMessage: `#ff3333`,\r\n    border: `#cccccc`,\r\n    border_minor: `#cccccc`,\r\n    border_input: `#cccccc`,\r\n    outline: `#888888`,\r\n    background: `#ffffff`,\r\n    background_field: `#dddddd`,\r\n    background_button: `#eeeeee`,\r\n    background_error: `#ffcccc`,\r\n    loader: `#3333ff`,\r\n    icon: `#3333ff`,\r\n};\r\nexport type RectSize = { all?: number, left?: number, right?: number, top?: number, bottom?: number };\r\nconst getBorderSizes = (size: RectSize) => {\r\n    return {\r\n        borderWidth: size.all,\r\n        borderLeftWidth: size.left ?? size.all,\r\n        borderRightWidth: size.right ?? size.all,\r\n        borderTopWidth: size.top ?? size.all,\r\n        borderBottomWidth: size.bottom ?? size.all,\r\n    };\r\n};\r\n\r\nexport const basicThemeSizes = {\r\n    textPadding: 4,\r\n    borderWidth: { all: 1 } as RectSize,\r\n    borderWidth_minor: { all: 1 } as RectSize,\r\n    borderWidth_input: { all: 1 } as RectSize,\r\n    borderRadius: 4,\r\n    sectionGap: 16,\r\n    elementGap: 8,\r\n    rowGap: 4,\r\n    rowPadding: 4,\r\n\r\n    fontSize: 14,\r\n    fontSize_input: 16,\r\n    fontSize_button: 14,\r\n    fontSize_header: 16,\r\n\r\n    lineHeight: `18px`,\r\n\r\n    minWidth_label: 120,\r\n    minWidth_input: 120,\r\n    minWidth_button: 120,\r\n\r\n    icon: 14,\r\n};\r\n\r\nexport const basicFont = {\r\n    fontFamily: `\"Trebuchet MS\", Helvetica, Roboto, sans-serif`,\r\n    fontWeight_normal: `normal` as 'normal' | 'bold',\r\n    fontWeight_button: `bold` as 'normal' | 'bold',\r\n    fontWeight_header: `bold` as 'normal' | 'bold',\r\n};\r\n\r\nexport type ThemeColors = typeof basicThemeColors;\r\nexport type ThemeSizes = typeof basicThemeSizes;\r\nexport type ThemeFont = typeof basicFont;\r\n\r\nconst createTheme = (colors: ThemeColors, sizes: ThemeSizes, font: ThemeFont) => {\r\n\r\n    const borderProps = {\r\n        ...getBorderSizes(sizes.borderWidth),\r\n\r\n        borderRadius: sizes.borderRadius,\r\n        borderColor: colors.border,\r\n        borderStyle: `solid`,\r\n        outlineColor: colors.outline,\r\n    } as const;\r\n\r\n    const borderProps_minor = {\r\n        ...getBorderSizes(sizes.borderWidth_minor),\r\n\r\n        borderRadius: sizes.borderRadius,\r\n        borderColor: colors.border_minor,\r\n        borderStyle: `solid`,\r\n        outlineColor: colors.outline,\r\n    } as const;\r\n\r\n    const borderProps_input = {\r\n        ...getBorderSizes(sizes.borderWidth_input),\r\n\r\n        borderRadius: sizes.borderRadius,\r\n        borderColor: colors.border_input,\r\n        borderStyle: `solid`,\r\n        outlineColor: colors.outline,\r\n    } as const;\r\n\r\n    let sView: ThemeViewStyle = {};\r\n    let sText: ThemeTextStyle = {};\r\n    let sIcon: ThemeIconStyle = {};\r\n    let sTextView: ThemeTextStyle & ThemeViewStyle = {};\r\n\r\n    const theme = {\r\n        colors,\r\n        sizes,\r\n        font,\r\n\r\n        view_panel: sView = {\r\n            background: colors.background,\r\n            padding: sizes.elementGap,\r\n        },\r\n        view_form: sView = {\r\n            ...borderProps,\r\n            marginBottom: sizes.sectionGap,\r\n            padding: sizes.elementGap,\r\n            // background: colors.background_field,\r\n        },\r\n        text_formTitle: sText = {\r\n            padding: sizes.textPadding,\r\n            color: colors.text_header,\r\n            fontSize: sizes.fontSize_header,\r\n            fontFamily: font.fontFamily,\r\n            fontWeight: font.fontWeight_header,\r\n        },\r\n        view_formFields: sView = {\r\n            // ...borderProps,\r\n            ...borderProps_minor,\r\n            // padding: sizes.elementGap,\r\n            marginBottom: sizes.rowGap,\r\n            background: colors.background_field,\r\n            // alignItems: `center`,\r\n        },\r\n        view_fieldRow: sView = {\r\n            // ...borderProps,\r\n            // ...borderProps_minor,\r\n            // marginBottom: sizes.rowGap,\r\n            // padding: sizes.rowPadding,\r\n            marginLeft: sizes.rowPadding,\r\n            // background: colors.background_field,\r\n            display: `flex`,\r\n            flexDirection: `row`,\r\n\r\n            alignItems: `center`,\r\n            flexWrap: `wrap`,\r\n        },\r\n        text_fieldLabel: sText = {\r\n            padding: sizes.textPadding,\r\n            color: colors.text,\r\n            fontSize: sizes.fontSize,\r\n            fontWeight: font.fontWeight_normal,\r\n            minWidth: sizes.minWidth_label,\r\n            //  whiteSpace: `nowrap`,\r\n        },\r\n        input_fieldEntry: sText = {\r\n            ...borderProps_input,\r\n            marginBottom: sizes.rowGap,\r\n            marginRight: sizes.rowGap,\r\n            padding: sizes.textPadding,\r\n            color: colors.text,\r\n            fontSize: sizes.fontSize_input,\r\n            fontWeight: font.fontWeight_normal,\r\n            lineHeight: sizes.lineHeight,\r\n            minWidth: sizes.minWidth_input,\r\n        },\r\n        button_fieldInline: sTextView = {\r\n            ...borderProps,\r\n            // marginLeft: sizes.elementGap,\r\n            marginBottom: sizes.rowGap,\r\n            marginRight: sizes.rowGap,\r\n            padding: sizes.textPadding,\r\n            background: colors.background_button,\r\n            color: colors.text_button,\r\n            fontSize: sizes.fontSize_button,\r\n            fontWeight: font.fontWeight_button,\r\n            lineHeight: sizes.lineHeight,\r\n            display: `flex`,\r\n            minWidth: sizes.minWidth_button,\r\n        },\r\n        button_fieldInline_alt: sTextView = {\r\n            ...sTextView,\r\n            background: colors.text_button,\r\n            color: colors.background_button,\r\n            borderColor: colors.background_button,\r\n        },\r\n        view_formActionRow: sView = {\r\n            display: `flex`,\r\n            flexDirection: `row`,\r\n            justifyContent: `flex-end`,\r\n            marginBottom: sizes.elementGap,\r\n        },\r\n        button_formAction: sTextView = {\r\n            ...borderProps,\r\n            marginLeft: sizes.elementGap,\r\n            padding: sizes.textPadding,\r\n            background: colors.background_button,\r\n            color: colors.text_button,\r\n            fontSize: sizes.fontSize_button,\r\n            fontWeight: font.fontWeight_button,\r\n            lineHeight: sizes.lineHeight,\r\n            minWidth: sizes.minWidth_button,\r\n        },\r\n        button_formAction_alt: sTextView = {\r\n            ...sTextView,\r\n            background: colors.text_button,\r\n            color: colors.background_button,\r\n            borderColor: colors.background_button,\r\n        },\r\n\r\n        view_error: sView = {\r\n            ...borderProps,\r\n            marginBottom: sizes.sectionGap,\r\n            padding: sizes.rowPadding,\r\n            background: colors.background_error,\r\n        },\r\n        text_error: sText = {\r\n            padding: sizes.textPadding,\r\n            color: colors.text_error,\r\n            fontSize: sizes.fontSize,\r\n            fontFamily: font.fontFamily,\r\n            fontWeight: font.fontWeight_button,\r\n        },\r\n        text_errorMessage: sText = {\r\n            padding: sizes.textPadding,\r\n            color: colors.text_errorMessage,\r\n            fontSize: sizes.fontSize,\r\n            fontFamily: font.fontFamily,\r\n            fontWeight: font.fontWeight_button,\r\n        },\r\n\r\n        icon: sIcon = {\r\n            size: sizes.icon,\r\n            color: colors.icon,\r\n            outlineColor: colors.outline,\r\n        },\r\n        icon_errorMessage: sIcon = {\r\n            size: sizes.icon,\r\n            color: colors.text_errorMessage,\r\n            outlineColor: colors.outline,\r\n        },\r\n    } as const;\r\n\r\n    return theme;\r\n};\r\n\r\nexport const purpleColors = {\r\n    purple: `#863d8f`,\r\n    purpleLite: `#a75da7`,\r\n    purpleBackgroundLite: `#ddbfdd`,\r\n    blue: `#3baccf`,\r\n    gray: `#656364`,\r\n    lightGray: `#f8f6f7`,\r\n    lightBackgroundGray: `#e8e6e7`,\r\n    borderGray: `#d7c7d7`,\r\n    headerWhite: `#ffffff`,\r\n    headerGray: `#cecece`,\r\n    menuWhite: `#ffffff`,\r\n    bodyWhite: `#ffffff`,\r\n    buttonGray: `#a0a1a5`,\r\n    buttonWhite: `#e2e3e9`,\r\n    headingGray: `#f8f6f7`,\r\n    cardLightGray: `#f8f8f8`,\r\n    textWhite: `#ffffff`,\r\n    textBlack: `#2b2b2b`,\r\n    textGray: `#696768`,\r\n\r\n    // New Colors\r\n    warnRed: `#C56364`,\r\n    errorRed: `#C56364`,\r\n    deleteRed: `#C56364`,\r\n    changedYellow: `#F5F5C5`,\r\n};\r\n\r\nexport const purpleThemeColors: typeof basicThemeColors = {\r\n    ...basicThemeColors,\r\n    text: `#2b2b2b`,\r\n    text_header: `#863d8f`,\r\n    text_button: `#ffffff`,\r\n    // text_error: `#ffffff`,\r\n    border: `#863d8f`,\r\n    border_minor: `#863d8f`,\r\n    // border_minor: `#aaaaaa`,\r\n    border_input: `#aaaaaa`,\r\n    background: `#ffffff`,\r\n    background_field: `#dddddd`,\r\n    background_button: `#863d8f`,\r\n    // background_error: `#C56364`,\r\n    loader: `#863d8f`,\r\n    icon: `#863d8f`,\r\n};\r\n\r\nexport const purpleSizes: typeof basicThemeSizes = {\r\n    ...basicThemeSizes,\r\n    borderWidth: { all: 1, bottom: 4 },\r\n    borderWidth_minor: { all: 0, bottom: 1 },\r\n};\r\n\r\nexport const vscodeThemeColors = {\r\n    colors: {\r\n        text: `#569CD6`,\r\n        border: `#6796E6`,\r\n        background: `#1e1e1e`,\r\n        background_field: `#2e2e2e`,\r\n    },\r\n};\r\n\r\n// eslint-disable-next-line import/no-mutable-exports\r\n// export let theme = createTheme(basicThemeColors, basicThemeSizes, basicFont);\r\n// eslint-disable-next-line import/no-mutable-exports\r\nexport let theme = createTheme(purpleThemeColors, purpleSizes, basicFont);\r\n\r\nexport const setTheme = (colors: ThemeColors, sizes: ThemeSizes, font: ThemeFont) => {\r\n    theme = createTheme(purpleThemeColors, basicThemeSizes, basicFont);\r\n};\r\n","import { shuffle, distinct } from 'utils/arrays';\r\nimport { ProblemService, ProblemResult, ProblemAnswer } from './problems-service';\r\n\r\nexport const createMultiplesProblemService = ({ min = 1, max = 12, maxAnswers = 4 }: { min?: number, max?: number, maxAnswers?: number }): ProblemService => {\r\n    let n = min - 1;\r\n    let m = min;\r\n\r\n    const problemService: ProblemService = {\r\n        getSections: () => [...new Array(max - min + 1)].map((x, i) => `Multiples of ${i + min}`),\r\n        gotoSection: (name: string) => {\r\n            const parts = name.split(` `);\r\n            const v = parts[parts.length - 1];\r\n            const bVal = Number.parseInt(v, 10);\r\n            m = bVal;\r\n            n = min - 1;\r\n        },\r\n        getNextProblem: (): ProblemResult => {\r\n            n++;\r\n            if (n > max) {\r\n                n = min;\r\n                m++;\r\n                if (m > max) {\r\n                    // Loop\r\n                    n = min;\r\n                    m = min;\r\n                    // return { done: true, key: `done` };\r\n                }\r\n            }\r\n\r\n            const correctValue = n * m;\r\n            const wrongAnswerCount = maxAnswers - 1;\r\n            const wrongValues =\r\n                distinct(\r\n                    [...new Array(100)].map(() =>\r\n                        Math.round(n + 1 - 2 * Math.random())\r\n                        * Math.round(m + 1 - 2 * Math.random())\r\n                        + Math.round(2 - 4 * Math.random()))\r\n                        .filter(x => x !== correctValue)\r\n                        .filter(x => x > 0),\r\n                ).slice(0, wrongAnswerCount);\r\n\r\n            const answers: ProblemAnswer[] = shuffle([...wrongValues.map(x => ({ value: `${x}`, isCorrect: false })), { value: `${correctValue}`, isCorrect: true }]).map(x => ({ ...x, key: x.value }));\r\n\r\n            return {\r\n                key: `${m} x ${n}`,\r\n                question: `${m} x ${n}`,\r\n                answers,\r\n            };\r\n        },\r\n        recordAnswer: () => { },\r\n    };\r\n\r\n    return problemService;\r\n};\r\n","import { getValuesAsItems } from './objects';\r\n\r\nexport const moveItem = <T>(obj: T, from: T[], to: T[]) => {\r\n    const i = from.indexOf(obj);\r\n    if (i < 0) { throw new Error(`moveItem Failed to find an item in the from array: ${JSON.stringify({ obj, from, to })}`); }\r\n    from.splice(i, 1);\r\n    to.push(obj);\r\n};\r\n\r\nexport const distinct = <T>(items: T[]): T[] => {\r\n    const set = new Set(items);\r\n    return [...set];\r\n};\r\n\r\nexport const shuffle = <T>(items: T[]): T[] => {\r\n    return items.map(x => ({ x, value: Math.random() })).sort((a, b) => a.value - b.value).map(x => x.x);\r\n};\r\n\r\nexport const distinct_key = <T>(items: T[], getKey: (item: T) => string): T[] => {\r\n    const set = {} as { [key: string]: T };\r\n    items.forEach(x => { set[getKey(x)] = x; });\r\n    return getValuesAsItems(set);\r\n};\r\n\r\nexport const groupItems = <T>(items: T[], getKey: (item: T) => string): { [key: string]: T[] } => {\r\n    const groups = {} as { [key: string]: T[] };\r\n    for (const x of items) {\r\n        const g = groups[getKey(x)] ?? (groups[getKey(x)] = []);\r\n        g.push(x);\r\n    }\r\n    return groups;\r\n};\r\n\r\nexport const mergeItems = <T>(items: T[], getKey: (item: T) => string, getMerged: (item: T[], key: string) => T): T[] => {\r\n    const groups = groupItems(items, getKey);\r\n    const merged = getValuesAsItems(groups).map(g => getMerged(g, getKey(g[0])));\r\n    return merged;\r\n};\r\n\r\nexport function sameArrayContents<T>(a: undefined | null | T[], b?: undefined | null | T[]) {\r\n    if (a === b) { return true; }\r\n    if (a == null && b == null) { return true; }\r\n    if (a == null || b == null) { return false; }\r\n    if (a.length !== b.length) { return false; }\r\n    for (const i in a) {\r\n        if (a[i] !== b[i]) { return false; }\r\n    }\r\n    return true;\r\n}\r\n","import { useEffect, useState, useRef } from 'react';\r\nimport { sameArrayContents } from 'utils/arrays';\r\nimport { ErrorState } from 'utils/error';\r\n\r\ntype TDoWork = (\r\n    doWorkInner: (stopIfObsolete: (() => void)) => Promise<void>,\r\n    getContext?: () => unknown[]) => void;\r\n\r\n\r\nexport function useMounted() {\r\n    const mounted = useRef(true);\r\n    useEffect(() => {\r\n        // Unmount on unsub\r\n        return () => {\r\n            mounted.current = false;\r\n        };\r\n    }, [/* Init Only */]);\r\n    return { mounted };\r\n}\r\n\r\n/** Automatically handle loading and error objects with asyncronous calls\r\n * @return The { loading, error, doWork } values\r\n * @example\r\n *\r\n *      const { loading, error, doWork } = ChatHooks.useAutoLoadingError();\r\n *      ...\r\n *          doWork(async (stopIfObsolete) => {\r\n *              ...\r\n *              const result = async DoAsyncWork());\r\n *              stopIfObsolete(); // Stop work if component has been unmounted, or if contextValues have changed since beginning of doWork\r\n *              ...\r\n *              setResult(result);\r\n *          }, () => [ contextValueA, contextValueB ]); // Optional context values to stop work if changed\r\n *    \r\n */\r\nexport function useAutoLoadingError() {\r\n    const { mounted } = useMounted();\r\n    const [loadingError, setLoadingError] = useState({ loading: false, error: null as null | ErrorState });\r\n\r\n    const UNMOUNTED = `unmounted`;\r\n    const CHANGED_CONTEXT = `changedContext`;\r\n\r\n    const doWork: TDoWork = (\r\n        doWorkInner: (stopIfObsolete: (() => void)) => Promise<void>,\r\n        getContext?: () => unknown[]) => {\r\n\r\n        let contextInit = undefined as undefined | unknown[];\r\n\r\n        const stopIfObsolete = () => {\r\n            if (!mounted.current) {\r\n                // eslint-disable-next-line @typescript-eslint/no-throw-literal\r\n                throw UNMOUNTED;\r\n            }\r\n            const c = getContext?.();\r\n\r\n            if (!sameArrayContents(contextInit, c)) {\r\n                // eslint-disable-next-line @typescript-eslint/no-throw-literal\r\n                throw CHANGED_CONTEXT;\r\n            }\r\n        };\r\n\r\n        const doCall = async () => {\r\n            contextInit = getContext?.();\r\n            setLoadingError({ loading: true, error: null });\r\n\r\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n            let hadError = false;\r\n\r\n            try {\r\n                try {\r\n                    await doWorkInner(stopIfObsolete);\r\n                    stopIfObsolete();\r\n                    setLoadingError({ loading: false, error: null });\r\n                }\r\n                catch (error) {\r\n                    // Ignore unmounted or changed context\r\n                    if (error !== UNMOUNTED && error !== CHANGED_CONTEXT) {\r\n                        throw error;\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                // console.log(`doWork catch`, { err: error });\r\n                hadError = true;\r\n\r\n                if (!mounted.current) {\r\n                    // console.warn(`doWork Error when not Mounted`, { err: error });\r\n                    return;\r\n                }\r\n\r\n                setLoadingError({ loading: false, error: { message: error.message ?? `Unknown Error in doWork`, error, retryCallback: doCall } });\r\n            }\r\n        };\r\n\r\n        // Start Async\r\n        (async () => await doCall())();\r\n    };\r\n\r\n    return { loading: loadingError.loading, error: loadingError.error, doWork };\r\n}\r\n\r\nexport function useLoadData<T>(doWork: TDoWork, getData: () => Promise<T>, getDataDeps?: () => unknown[]) {\r\n    const [data, setData] = useState(null as null | T);\r\n    useEffect(() => {\r\n        // console.log(`useLoadData.useEffect`);\r\n        doWork(async (stopIfObsolete) => {\r\n            // console.log(`useLoadData.useEffect.doWork`);\r\n            const d = await getData();\r\n            stopIfObsolete();\r\n            setData(d);\r\n        }, getDataDeps);\r\n    }, getDataDeps?.() ?? []);\r\n    return { data };\r\n}\r\n","/* eslint-disable react/no-array-index-key */\r\n/* eslint-disable jsx-a11y/accessible-emoji */\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { View, Text, Pressable, TouchableOpacity, Platform } from 'react-native-lite';\r\nimport { createMultiplesProblemService } from './problems/multiples';\r\nimport { ProblemService, Problem } from './problems/problems-service';\r\nimport { GamepadAnalogStateful, GamepadPressState } from './components/game-pad-analog';\r\nimport { getDistanceSq, Vector2 } from './utils/vectors';\r\nimport { createReviewProblemService } from './problems/problems-reviewer';\r\n\r\nexport const EducationalGame_StarBlastSideways_Multiples = (props: {}) => {\r\n    return <EducationalGame_StarBlastSideways problemService={createReviewProblemService(createMultiplesProblemService({ min: 1, max: 12 }), {})} />;\r\n};\r\n\r\nexport const EducationalGame_StarBlastSideways = (props: { problemService: ProblemService }) => {\r\n\r\n    const [pauseState, setPauseState] = useState({ paused: false } as { paused: boolean });\r\n    const [pressState, setPressState] = useState({ moveDirection: { x: 0, y: 0 }, buttons: [] } as GamepadPressState);\r\n    const onPressStateChange = (value: GamepadPressState) => {\r\n        // console.log(`onPressStateChange`, { ...x, dir: { ...x.moveDirection }, buttons: x.buttons.map(b => ({ ...b })) });\r\n        setPressState(value);\r\n    };\r\n\r\n    const [problemSourceKey, setProblemSourceKey] = useState(0);\r\n\r\n    return (\r\n        <>\r\n            <View>\r\n                <SubjectNavigator problemService={props.problemService}\r\n                    onOpen={() => setPauseState({ paused: true })}\r\n                    onClose={() => setPauseState({ paused: false })}\r\n                    onSubjectNavigation={() => { setPauseState({ paused: false }); setProblemSourceKey(s => s + 1); }}\r\n                />\r\n                <View style={{ alignItems: `center`, alignSelf: `stretch` }} >\r\n                    <View style={{ overflow: `hidden`, padding: 10, paddingTop: 48, paddingBottom: 64 }}>\r\n                        <View style={{ position: `relative` }}>\r\n                            <GameView pressState={pressState} pauseState={pauseState} problemService={props.problemService} problemSourceKey={`${problemSourceKey}`} />\r\n                            <Pressable style={{ position: `absolute`, top: 0, bottom: 0, left: 0, right: 0, opacity: 0 }} onPressIn={() => { }} onPressOut={() => { }} />\r\n                            <View style={{ zIndex: 10, flex: 1, alignSelf: `stretch` }}>\r\n                                <GamepadAnalogStateful style={colors.gamepad} onPressStateChange={onPressStateChange} buttons={[{ key: `A`, text: `🔥` }]} />\r\n                            </View>\r\n                        </View>\r\n                    </View>\r\n                </View>\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n\r\nconst subjectStyles = {\r\n    container: {\r\n        margin: 16,\r\n    },\r\n    header: {\r\n        view: {\r\n            margin: 4,\r\n        },\r\n        text: {\r\n            fontSize: 16,\r\n        },\r\n    },\r\n    section: {\r\n        view: {\r\n            margin: 4,\r\n        },\r\n        text: {\r\n            fontSize: 16,\r\n        },\r\n    },\r\n};\r\n\r\nconst SubjectNavigator = (props: { problemService: ProblemService, onOpen: () => void, onClose: () => void, onSubjectNavigation: () => void }) => {\r\n\r\n    const [isExpanded, setIsExpanded] = useState(false);\r\n    const toggle = () => {\r\n        if (!isExpanded) {\r\n            props.onOpen();\r\n        }\r\n        if (isExpanded) {\r\n            props.onClose();\r\n        }\r\n        setIsExpanded(s => !s);\r\n    };\r\n\r\n    return (\r\n        <View style={subjectStyles.container}>\r\n            <TouchableOpacity onPress={toggle}>\r\n                <View style={subjectStyles.header.view}>\r\n                    <Text style={subjectStyles.header.text}>Sections</Text>\r\n                </View>\r\n            </TouchableOpacity>\r\n            {isExpanded && (\r\n                <View>\r\n                    {props.problemService.getSections().map(s => (\r\n                        <TouchableOpacity key={s} onPress={() => {\r\n                            console.log(`SubjectNavigator onSection`, { s });\r\n                            props.problemService.gotoSection(s);\r\n                            props.onSubjectNavigation();\r\n                            setIsExpanded(false);\r\n                            if (Platform.OS === `web`) {\r\n                                window.scrollTo(0, 0);\r\n                            }\r\n                        }}>\r\n                            <View style={subjectStyles.section.view}>\r\n                                <Text style={subjectStyles.section.text}>{s}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </View>\r\n            )}\r\n\r\n        </View>\r\n    );\r\n};\r\n\r\nconst colors = {\r\n    gamepad: {\r\n        backgroundColor: `#333333`,\r\n        borderColor: `#000033`,\r\n    },\r\n    viewscreen: {\r\n        borderColor: `#000033`,\r\n        backgroundColor: `#000000`,\r\n    },\r\n};\r\n\r\nconst gameStyles = {\r\n    viewscreenView: {\r\n        height: 300,\r\n        width: 300,\r\n        backgroundColor: colors.viewscreen.backgroundColor,\r\n        borderColor: colors.viewscreen.borderColor,\r\n        borderWidth: 1,\r\n        borderStyle: `solid`,\r\n    },\r\n    sprite: {\r\n        viewSize: { width: 32, height: 32 },\r\n        text: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 32,\r\n            textAlign: `center`,\r\n        },\r\n    },\r\n    answer: {\r\n        text: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 24,\r\n            fontSize_small: 14,\r\n            textAlign: `center`,\r\n            whiteSpace: `pre-wrap`,\r\n        },\r\n    },\r\n    question: {\r\n        view: { flex: 1, justifyContent: `center`, padding: 4 },\r\n        text: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 24,\r\n            fontSize_small: 14,\r\n            whiteSpace: `pre-wrap`,\r\n        },\r\n    },\r\n    gameOver: {\r\n        view: { flex: 1, justifyContent: `center`, padding: 4 },\r\n        text: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 24,\r\n            textAlign: `center`,\r\n        },\r\n    },\r\n} as const;\r\n\r\ntype GamePosition = {\r\n    x: number;\r\n    y: number;\r\n    rotation: number;\r\n};\r\n\r\ntype GameState = {\r\n    gameStartTimeMs: number;\r\n    lives: number;\r\n    deadTime?: number;\r\n    gameOverTime?: number;\r\n    score: number;\r\n\r\n    weaponsLock?: {\r\n        lockedAtPlayerPosition: GamePosition;\r\n        lockedEnemy: { pos: GamePosition };\r\n    };\r\n};\r\n\r\n\r\ntype AnswerState = { key: string, value: string, isCorrect: boolean, isAnsweredWrong: boolean };\r\nconst GameView = (props: { pressState: GamepadPressState, pauseState: { paused: boolean }, problemService: ProblemService, problemSourceKey: string }) => {\r\n\r\n    const pressState = useRef(props.pressState);\r\n    pressState.current = props.pressState;\r\n\r\n    const pauseState = useRef(props.pauseState);\r\n    pauseState.current = props.pauseState;\r\n\r\n    const gameState = useRef({ lives: 3, gameStartTimeMs: Date.now(), score: 0 } as GameState);\r\n    const getGameTime = () => {\r\n        return {\r\n            gameTime: (Date.now() - gameState.current.gameStartTimeMs) / 1000,\r\n        };\r\n    };\r\n\r\n    const playerPositionState = useRef({\r\n        y: gameStyles.viewscreenView.height * 0.5, x: gameStyles.viewscreenView.width * 0.15, rotation: 0,\r\n    } as GamePosition);\r\n    const projectilesState = useRef({ lastShotTime: 0, shots: [], debris: [] } as ProjectilesState);\r\n    const enemiesState = useRef({ enemies: [] } as EnemiesState);\r\n\r\n    const problemsState = useRef(null as null | { problemTime: number, question: string, answers: (Problem['answers'][0] & { key: string, pos: GamePosition, isAnsweredWrong: boolean })[] });\r\n    const [renderId, setRenderId] = useState(0);\r\n\r\n    const restartGame = () => {\r\n        // Move enemies back\r\n        enemiesState.current.enemies.forEach(e2 => { e2.pos.x += gameStyles.viewscreenView.width * 0.5; });\r\n\r\n        // Reset Player\r\n        playerPositionState.current.y = gameStyles.viewscreenView.height * 0.5;\r\n        playerPositionState.current.x = gameStyles.viewscreenView.width * 0.15;\r\n\r\n        gameState.current = {\r\n            gameStartTimeMs: gameState.current.gameStartTimeMs,\r\n            lives: 3,\r\n            score: 0,\r\n        };\r\n    };\r\n\r\n    const gameOver = () => {\r\n        gameState.current = {\r\n            ...gameState.current,\r\n            lives: 0,\r\n            gameOverTime: getGameTime().gameTime,\r\n        };\r\n    };\r\n\r\n    const gotoNextProblem = () => {\r\n        const p = props.problemService.getNextProblem();\r\n\r\n        console.log(`gotoNextProblem`, { p });\r\n\r\n        if (!p.question) {\r\n            // Game over - problems done\r\n            return;\r\n        }\r\n\r\n        const pSize = gameStyles.viewscreenView.width / (p.answers.length + 1);\r\n        const newProblemState = {\r\n            problemTime: getGameTime().gameTime,\r\n            question: p.question,\r\n            answers: p.answers.map((x, i) => ({ ...x, key: `${p.question} ${x.value}`, pos: { y: pSize * (0.5 + i), x: gameStyles.viewscreenView.width - gameStyles.sprite.viewSize.width * 0.5, rotation: 0 }, isAnsweredWrong: false })),\r\n        };\r\n        const newEnemyState = {\r\n            enemies: newProblemState.answers.map((ans, i) => {\r\n                const enemy = {\r\n                    key: `${p.question} ${ans.value}`,\r\n                    answer: ans,\r\n                    pos: { y: pSize * (0.5 + i), x: gameStyles.viewscreenView.width - gameStyles.sprite.viewSize.width * 1.5, rotation: 0 },\r\n                    vel: { x: -5, y: 0 },\r\n                    onHit: () => {\r\n                        setTimeout(() => {\r\n                            console.log(`onHit`, { ans });\r\n                            props.problemService.recordAnswer(p, ans);\r\n                            if (ans.isCorrect) {\r\n                                // TODO: Update score, etc.\r\n                                // Let bullets clear\r\n                                projectilesState.current.shots.forEach(x => { x.ignore = true; });\r\n                                gotoNextProblem();\r\n\r\n                                gameState.current = {\r\n                                    ...gameState.current,\r\n                                    score: gameState.current.score += Math.floor(enemy.pos.x) * 1000,\r\n                                };\r\n                            } else {\r\n                                ans.isAnsweredWrong = true;\r\n\r\n                                gameState.current = {\r\n                                    ...gameState.current,\r\n                                    score: gameState.current.score -= Math.floor(enemy.pos.x) * 1500,\r\n                                };\r\n                            }\r\n                        });\r\n                    },\r\n                    destroyed: false,\r\n                };\r\n\r\n                return enemy;\r\n            }),\r\n        };\r\n\r\n        problemsState.current = newProblemState;\r\n        enemiesState.current = newEnemyState;\r\n        setRenderId(s => s + 1);\r\n\r\n        setTimeout(() => {\r\n            p.onQuestion?.();\r\n        }, 250);\r\n    };\r\n\r\n    useEffect(() => {\r\n        gotoNextProblem();\r\n    }, [props.problemSourceKey]);\r\n\r\n    useEffect(() => {\r\n        // Game Loop\r\n        let gameLastTime = Date.now();\r\n        const gameLoop = () => {\r\n            const { gameTime } = getGameTime();\r\n            const gameDeltaTime = Math.min(0.1, (Date.now() - gameLastTime) / 1000);\r\n            gameLastTime = Date.now();\r\n\r\n            if (pauseState.current.paused) {\r\n                requestAnimationFrame(gameLoop);\r\n                return;\r\n            }\r\n\r\n            // if (!pressState.current.moveDirection.x\r\n            //     && !pressState.current.moveDirection.y) {\r\n            //     // No change\r\n            //     requestAnimationFrame(gameLoop);\r\n            //     return;\r\n            // }\r\n\r\n            // console.log(`gameLoop Update`);\r\n\r\n            // Update\r\n\r\n            const getCommonState = (): CommonGameState => {\r\n                return {\r\n                    gameTime,\r\n                    gameDeltaTime,\r\n                    gameState: gameState.current,\r\n                    pressState: pressState.current,\r\n                    playerPosition: playerPositionState.current,\r\n                    projectilesState: projectilesState.current,\r\n                    enemiesState: enemiesState.current,\r\n                    onLoseLife: () => {\r\n                        if (gameState.current.deadTime || gameState.current.gameOverTime) { return; }\r\n\r\n                        projectilesState.current.debris.push({ key: `player${gameTime}`, kind: `player-character`, pos: { ...playerPositionState.current }, vel: { x: 0, y: 0 } });\r\n\r\n\r\n                        if (gameState.current.lives <= 1) {\r\n                            // Game over\r\n                            gameOver();\r\n                            return;\r\n                        }\r\n\r\n                        // Move enemies back\r\n                        // enemiesState.current.enemies.forEach(e2 => { e2.pos.x += gameStyles.viewscreenView.width * 0.5; });\r\n\r\n                        gameState.current = {\r\n                            ...gameState.current,\r\n                            lives: gameState.current.lives - 1,\r\n                            deadTime: gameTime,\r\n                        };\r\n                    },\r\n                };\r\n            };\r\n\r\n\r\n            // Game\r\n            const gameResult = updateGame(getCommonState());\r\n            gameState.current = gameResult;\r\n\r\n            if (!gameState.current.gameOverTime) {\r\n                // Player\r\n                const playerResult = updatePlayer(getCommonState());\r\n                playerPositionState.current = playerResult.playerPosition;\r\n            } else if (getGameTime().gameTime > 1 + gameState.current.gameOverTime\r\n                && pressState.current.buttons[0]?.isDown) {\r\n                setTimeout(() => {\r\n                    restartGame();\r\n                }, 250);\r\n            }\r\n\r\n            // Projectiles\r\n            const projectilesResult = updateProjectiles(getCommonState());\r\n            projectilesState.current = projectilesResult;\r\n\r\n            // Enemies\r\n            const enemiesResult = updateEnemies(getCommonState());\r\n            enemiesState.current = enemiesResult;\r\n\r\n\r\n            // Game Loop\r\n            requestAnimationFrame(gameLoop);\r\n            setRenderId(s => s + 1);\r\n        };\r\n\r\n        requestAnimationFrame(gameLoop);\r\n    }, []);\r\n\r\n\r\n    // console.log(`GameView render`, { playerStylePosition });\r\n\r\n    const timeSinceProblem = getGameTime().gameTime - (problemsState.current?.problemTime ?? 0);\r\n\r\n    return (\r\n        <>\r\n            <View style={gameStyles.viewscreenView} >\r\n                <TextPositioned text={`${gameState.current.score.toLocaleString()}`} position={{ x: 0, y: -0.8 * gameStyles.sprite.viewSize.height, rotation: 0 }} />\r\n                {[... new Array(gameState.current.lives)].map((x, i) => (\r\n                    <Sprite key={`life${i}`} kind='life' position={{ x: gameStyles.viewscreenView.width - (gameStyles.sprite.viewSize.width * (1 + i)), y: -0.8 * gameStyles.sprite.viewSize.height, rotation: 0 }} />\r\n                ))}\r\n                {projectilesState.current.debris.map(x => (\r\n                    <Sprite key={x.key} kind={x.hasHitGround ? `${x.kind}-splat` as SpriteKind : x.kind} position={x.pos} />\r\n                ))}\r\n                {enemiesState.current?.enemies.filter(e => !e.destroyed).map(e => (\r\n                    <React.Fragment key={e.key}>\r\n                        {!e.answer.isAnsweredWrong && (<TextPositioned position={{ y: e.pos.y, x: e.pos.x + gameStyles.sprite.viewSize.width, rotation: 0 }} text={e.answer.value} />)}\r\n                        {e.answer.isAnsweredWrong && (<Sprite kind='answer-wrong' position={{ y: e.pos.y, x: e.pos.x + gameStyles.sprite.viewSize.width, rotation: 0 }} />)}\r\n                    </React.Fragment>\r\n                ))}\r\n                {enemiesState.current?.enemies.filter(x => !x.destroyed).map(x => (\r\n                    <React.Fragment key={x.key}>\r\n                        <Sprite kind={x.explodeTime ? `enemy-explode` : `enemy`} position={x.pos} />\r\n                        {x === gameState.current.weaponsLock?.lockedEnemy && (\r\n                            <Sprite kind='lock' position={x.pos} />\r\n                        )}\r\n                    </React.Fragment>\r\n                ))}\r\n                {!gameState.current.gameOverTime && !gameState.current.deadTime && (\r\n                    <Sprite kind='player' position={playerPositionState.current} />\r\n                )}\r\n                {projectilesState.current.shots.map(x => (\r\n                    <Sprite key={x.key} kind={x.explodeTime ? `shot-explode` : `shot`} position={x.pos} />\r\n                ))}\r\n                {gameState.current.gameOverTime && (\r\n                    <View>\r\n                        <View style={{ position: `absolute`, top: gameStyles.viewscreenView.height * 0.5, width: gameStyles.viewscreenView.width }}>\r\n                            <Text style={gameStyles.gameOver.text}>Game Over</Text>\r\n                            {getGameTime().gameTime > 1 + gameState.current.gameOverTime && (<Text style={gameStyles.gameOver.text}>Continue?</Text>)}\r\n                        </View>\r\n                    </View>\r\n                )}\r\n            </View>\r\n            <View style={{ position: `relative`, height: gameStyles.question.text.fontSize * 3, alignSelf: `stretch` }}>\r\n                <TextPositioned text={problemsState.current?.question ?? ``} position={{ x: gameStyles.viewscreenView.width * 0.25, y: gameStyles.question.text.fontSize * 1 - Math.max(0, gameStyles.viewscreenView.height * 0.5 - 125 * timeSinceProblem), rotation: 0 }} />\r\n            </View>\r\n            {/* <View>\r\n                <Text>{`${renderId}`}</Text>\r\n            </View> */}\r\n            {/* <View style={[gameStyles.question.view, { transform: `translate(0px,${-Math.max(0, gameStyles.viewscreenView.height * 0.5 - 125 * timeSinceProblem)}px)` }]}>\r\n                <Text style={{...gameStyles.question.text, text.length > 10 ? s.fontSize_small * 0.5 : s.fontSize}} >{problemsState.current?.question}</Text>\r\n            </View> */}\r\n        </>\r\n    );\r\n};\r\n\r\ntype CommonGameState = { gameTime: number, gameDeltaTime: number, gameState: GameState, pressState: GamepadPressState, playerPosition: GamePosition, projectilesState: ProjectilesState, enemiesState: EnemiesState, onLoseLife: () => void };\r\n\r\nconst updateGame = ({ gameTime, gameDeltaTime, pressState, playerPosition, gameState, enemiesState }: CommonGameState): GameState => {\r\n\r\n    // Respawn Player\r\n    if (gameState.deadTime && gameTime > 3 + gameState.deadTime) {\r\n        playerPosition.y = gameStyles.viewscreenView.height * 0.5;\r\n        playerPosition.x = gameStyles.viewscreenView.width * 0.15;\r\n\r\n        enemiesState.enemies.forEach(e2 => { e2.pos.x += gameStyles.viewscreenView.width * 0.5; });\r\n\r\n        return { ...gameState, deadTime: undefined };\r\n    }\r\n\r\n    return gameState;\r\n};\r\n\r\nconst updatePlayer = ({ gameTime, gameDeltaTime, pressState, playerPosition, gameState }: CommonGameState): { playerPosition: GamePosition } => {\r\n    if (gameState.deadTime) { return { playerPosition }; }\r\n\r\n    const targetRotation = -pressState.moveDirection.y * 0.05;\r\n\r\n    const pos = {\r\n        x: playerPosition.x + pressState.moveDirection.x * gameDeltaTime * 250,\r\n        y: playerPosition.y - pressState.moveDirection.y * gameDeltaTime * 250,\r\n        rotation: playerPosition.rotation * 0.9 + targetRotation * 0.1,\r\n    };\r\n\r\n    const w = gameStyles.viewscreenView.width;\r\n    const gw = gameStyles.sprite.viewSize.width * 0.5;\r\n    const h = gameStyles.viewscreenView.height;\r\n    const gh = gameStyles.sprite.viewSize.height * 0.5;\r\n    pos.x = pos.x < gw ? gw : pos.x > w - gw ? w - gw : pos.x;\r\n    pos.y = pos.y < gh ? gh : pos.y > h - gh ? h - gh : pos.y;\r\n\r\n    return { playerPosition: pos };\r\n};\r\n\r\ntype ProjectilesState = {\r\n    lastShotTime: number;\r\n    shots: { key: string, pos: GamePosition, explodeTime?: number, ignore?: boolean, lockedEnemy?: { pos: GamePosition } }[];\r\n    debris: { key: string, vel: Vector2, pos: GamePosition, kind: SpriteKind, hasHitGround?: boolean }[];\r\n};\r\nconst updateProjectiles = ({ gameTime, gameDeltaTime, pressState, playerPosition: playerPos, enemiesState, projectilesState, gameState, onLoseLife }: CommonGameState): ProjectilesState => {\r\n    const { shots, debris, lastShotTime } = projectilesState;\r\n\r\n    const canShoot = !gameState.deadTime && !gameState.gameOverTime && gameTime > 0.25 + lastShotTime;\r\n\r\n    // console.log(`updateProjectiles`, { canShoot, gameTime, lastShotTime });\r\n\r\n    const didShoot = canShoot && pressState.buttons.find(x => x.key === `A`)?.isDown;\r\n    if (didShoot) {\r\n        const lockedEnemy = gameState.weaponsLock?.lockedEnemy;\r\n        shots.push({ key: `${lastShotTime}`, pos: { ...playerPos }, lockedEnemy });\r\n    }\r\n\r\n    // Move shots\r\n    shots.forEach(x => {\r\n        if (x.explodeTime) { return; }\r\n\r\n        x.pos.x += +250 * gameDeltaTime;\r\n        if (x.lockedEnemy) {\r\n            x.pos.y += (x.lockedEnemy.pos.y - x.pos.y) * 0.25;\r\n        }\r\n    });\r\n\r\n    // Move debris\r\n    debris.forEach(d => {\r\n        if (d.hasHitGround) { return; }\r\n\r\n        // Gravity\r\n        d.vel.y += 100 * gameDeltaTime;\r\n\r\n        d.pos.y += d.vel.y * gameDeltaTime;\r\n        d.pos.x += d.vel.x * gameDeltaTime;\r\n\r\n        const pad = gameStyles.sprite.viewSize.width * 0.5;\r\n        const w = gameStyles.viewscreenView.width;\r\n        if (d.pos.x < pad) { d.pos.x = pad; d.vel.x = -d.vel.x; }\r\n        if (d.pos.x > w - pad) { d.pos.x = w - pad; d.vel.x = -d.vel.x; }\r\n\r\n        const hPad = gameStyles.sprite.viewSize.width * 0.8;\r\n        const h = gameStyles.viewscreenView.height;\r\n        if (d.pos.y > h - hPad + Math.random() * 10) {\r\n            d.hasHitGround = true;\r\n\r\n            if (d.kind === `kitten`) {\r\n                onLoseLife();\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n    // Clean up too much debris\r\n    if (debris.length > 25) {\r\n        debris.shift();\r\n    }\r\n\r\n    const newShots = shots\r\n        // Remove shots offscreen\r\n        .filter(x => x.pos.x < gameStyles.viewscreenView.width)\r\n        // Remove exploded\r\n        .filter(x => !x.explodeTime || gameTime < 1 + x.explodeTime)\r\n        ;\r\n\r\n    return {\r\n        ...projectilesState,\r\n        lastShotTime: didShoot ? gameTime : lastShotTime,\r\n        shots: newShots,\r\n    };\r\n};\r\n\r\ntype EnemiesState = {\r\n    enemies: {\r\n        key: string;\r\n        pos: GamePosition;\r\n        vel: Vector2;\r\n        explodeTime?: number;\r\n        answer: AnswerState;\r\n        onHit: () => void;\r\n        destroyed?: boolean;\r\n    }[];\r\n};\r\nconst updateEnemies = ({ gameTime, gameDeltaTime, projectilesState, enemiesState, gameState, playerPosition, onLoseLife }: CommonGameState): EnemiesState => {\r\n    const { enemies } = enemiesState;\r\n    const { shots } = projectilesState;\r\n\r\n    // Detect Collisions\r\n\r\n    // Enemies - Bullets\r\n    const radius = gameStyles.sprite.viewSize.width * 0.75;\r\n    const radiusSq = radius * radius;\r\n\r\n    enemies.forEach(e => shots.forEach(s => {\r\n        // console.log(`Checking!`, { e, s });\r\n\r\n        if (e.explodeTime) { return; }\r\n        if (s.explodeTime || s.ignore) { return; }\r\n\r\n        if (getDistanceSq(e.pos, s.pos) < radiusSq) {\r\n            console.log(`Exploded!`, { e, s });\r\n\r\n            e.explodeTime = gameTime;\r\n            s.explodeTime = gameTime;\r\n\r\n            e.onHit();\r\n\r\n            if (e.answer.isCorrect) {\r\n                projectilesState.debris.push({ key: `${e.key} ${gameTime}`, kind: `alien`, pos: { ...e.pos }, vel: { ...e.vel } });\r\n            } else {\r\n                projectilesState.debris.push({ key: `${e.key} ${gameTime}`, kind: `kitten`, pos: { ...e.pos }, vel: { ...e.vel } });\r\n            }\r\n        }\r\n    }));\r\n\r\n    // Enemies - Enemies (bounce)\r\n    const radiusSq_enemies = radius * radius * 1.5 * 1.5;\r\n    enemies.forEach((e, i) => enemies.forEach((e2, i2) => {\r\n\r\n        if (i >= i2) { return; }\r\n        if (e.explodeTime) { return; }\r\n        if (e2.explodeTime) { return; }\r\n\r\n        if (getDistanceSq(e.pos, e2.pos) < radiusSq_enemies) {\r\n\r\n            // Transfer momentum\r\n            const frictionRatio = 0.95;\r\n            const swap = e.vel.y;\r\n            e.vel.y = e2.vel.y * frictionRatio;\r\n            e2.vel.y = swap * frictionRatio;\r\n            // }\r\n\r\n            // if (getDistanceSq(e.pos, e2.pos) < radiusSq_enemies * 0.8 * 0.8) {\r\n            // Move apart\r\n            const a = e.pos.y < e2.pos.y ? e : e2;\r\n            const b = e.pos.y < e2.pos.y ? e2 : e;\r\n\r\n            a.pos.y -= 10 * gameDeltaTime;\r\n            b.pos.y += 10 * gameDeltaTime;\r\n            a.vel.y -= 10 * gameDeltaTime;\r\n            b.vel.y += 10 * gameDeltaTime;\r\n        }\r\n    }));\r\n\r\n    // Enemies - Player\r\n    const radiusSq_player = radius * radius * 0.8 * 0.8;\r\n    enemies.forEach((e, i) => {\r\n        if (e.explodeTime) { return; }\r\n        if (gameState.deadTime || gameState.gameOverTime) { return; }\r\n\r\n        if (getDistanceSq(e.pos, playerPosition) < radiusSq_player) {\r\n            onLoseLife();\r\n\r\n            // e.explodeTime = gameTime;\r\n            // e.onHit();\r\n\r\n            return;\r\n        }\r\n    });\r\n\r\n    // Enemies move\r\n    enemies.forEach(e => {\r\n        if (e.explodeTime) { return; }\r\n\r\n        e.vel.y += (-1 + 2 * Math.random()) * 250 * gameDeltaTime;\r\n        // e.vel.x += -3 * gameDeltaTime;\r\n\r\n        if (!gameState.deadTime && !gameState.gameOverTime) {\r\n            e.vel.x = -25;\r\n        } else {\r\n            e.vel.x = 0;\r\n        }\r\n\r\n        // Move away from ground\r\n        if (e.pos.y > gameStyles.viewscreenView.height * 0.7) {\r\n            // e.vel.y += -100 * gameDeltaTime;\r\n            e.vel.y = -5;\r\n        }\r\n\r\n        // Keep on screen\r\n        if (e.pos.x > gameStyles.viewscreenView.width - gameStyles.sprite.viewSize.width * 2) {\r\n            e.pos.x = gameStyles.viewscreenView.width - gameStyles.sprite.viewSize.width * 2;\r\n        }\r\n\r\n        e.pos.x += e.vel.x * gameDeltaTime;\r\n        e.pos.y += e.vel.y * gameDeltaTime;\r\n\r\n        const pad = gameStyles.sprite.viewSize.height * 0.5;\r\n        const h = gameStyles.viewscreenView.height;\r\n        if (e.pos.y < pad) { e.pos.y = pad; e.vel.y = 5; }\r\n        if (e.pos.y > h - pad) { e.pos.y = h - pad; e.vel.y = -e.vel.y; }\r\n\r\n        const wPad = gameStyles.sprite.viewSize.width * 0.5;\r\n        if (e.pos.x < wPad) {\r\n            e.pos.x = wPad;\r\n        }\r\n\r\n        // // Attack player\r\n        // if (e.pos.x < playerPosition.x) {\r\n        //     e.pos.y = playerPosition.y;\r\n        //     // e.vel.y = (playerPosition.y - e.pos.y) * 5;\r\n        // }\r\n    });\r\n\r\n    // Closest Enemy\r\n    const closestEnemyToPlayer = enemiesState.enemies.filter(x => !x.explodeTime && !x.destroyed)\r\n        .sort((a, b) => Math.abs(a.pos.y - playerPosition.y) < Math.abs(b.pos.y - playerPosition.y) ? -1 : 1)[0];\r\n\r\n    const updateWeaponsLock = (enemy: typeof enemiesState.enemies[0]) => {\r\n        // Only update on player movement\r\n        if (gameState.weaponsLock?.lockedAtPlayerPosition.y === playerPosition.y) {\r\n            return;\r\n        }\r\n\r\n        gameState.weaponsLock = {\r\n            lockedAtPlayerPosition: playerPosition,\r\n            lockedEnemy: enemy,\r\n        };\r\n    };\r\n\r\n    // Attack Player\r\n    if (closestEnemyToPlayer?.pos.x < playerPosition.x + gameStyles.sprite.viewSize.width * 0.5) {\r\n        closestEnemyToPlayer.pos.y = playerPosition.y;\r\n    } else {\r\n        // Lock on Enemy\r\n        updateWeaponsLock(closestEnemyToPlayer);\r\n    }\r\n\r\n    // Cleanup\r\n    const newEnemies = enemies;\r\n    newEnemies.filter(x => x.explodeTime && gameTime > 1 + x.explodeTime).forEach(x => {\r\n        x.destroyed = true;\r\n\r\n    });\r\n    // // Remove exploded\r\n    // .filter(x => !x.explodeTime || gameTime < 1 + x.explodeTime)\r\n    // ;\r\n\r\n    return {\r\n        enemies: newEnemies,\r\n    };\r\n};\r\n\r\ntype SpriteKind = 'text' | 'player' | 'player-character' | 'player-character-splat' | 'shot' | 'shot-explode' | 'lock' | 'enemy' | 'enemy-explode' | 'answer-wrong' | 'alien' | 'kitten' | 'alien-splat' | 'kitten-splat' | 'super-kitten' | 'life';\r\nconst getSpriteEmoji = (kind: SpriteKind) => {\r\n    // ❤💙💚😀🤣😃😁😂😄😉😆😅😊😋😎🥰😙☺🤩🙄😑😐😣🤐😫🤢😬😭🤯🤒😡🤓🤠\r\n    // 👽💀👻☠🤖👾😺🙀🙈🙉🙊🐵🐱‍🐉🐶🦁🐯🐺🐱🦒🦊🦝🐗🐷🐮🐭🐹🐰🐼🐨🐻🐸🦓🐴\r\n    // 🚀🛸⛵🛰🚁💺🚤🛥⛴⚓🪐🌌🌍🌏🌎\r\n    // ✈🛩🚂🚘🚔🚍🚖🔥💧❄⚡🌀🌈☄🌠⭐❌💥♨🎇🎆✨🎡🍖🥓🍗🥩💚👁‍🗨🥫🍥🍤🧆🥝🥑🧪🧫💉🩸⚰💜🦵\r\n    // 🐱‍🚀🐱‍🐉🐱‍🏍😾🐱‍👤😾😿😽😹😸😻🐲🐉💢⭕\r\n    switch (kind) {\r\n        case `player`: return { text: `🚀`, rotation: +0.125, offsetX: 0, offsetY: -0.25 };\r\n        case `player-character`: return { text: `😭` };\r\n        case `player-character-splat`: return { text: `😫`, rotation: 0.15 };\r\n        case `shot`: return { text: `🔥`, rotation: -0.25 };\r\n        case `shot-explode`: return { text: `✨`, rotation: 0, scale: 0.5 };\r\n        case `lock`: return { text: `💢`, offsetX: -0.25, offsetY: -0.125, scale: 1.5 };\r\n        case `enemy`: return { text: `🛸`, offsetX: -0.125, offsetY: -0.125 };\r\n        case `enemy-explode`: return { text: `💥`, offsetX: -0.125, offsetY: -0.125 };\r\n        case `answer-wrong`: return { text: `❌`, offsetX: -0.125, offsetY: -0.125 };\r\n        case `alien`: return { text: `👽`, offsetX: 0, offsetY: 0 };\r\n        // case `kitten`: return { text: `🐱‍🚀`, offsetX: 0, offsetY: 0 };\r\n        case `kitten`: return { text: `🙀`, offsetX: 0, offsetY: 0 };\r\n        case `alien-splat`: return { text: `💀`, offsetX: 0, offsetY: 0 };\r\n        case `kitten-splat`: return { text: `🥩`, offsetX: 0, offsetY: 0 };\r\n        case `super-kitten`: return { text: `🐱‍🏍`, offsetX: 0, offsetY: 0 };\r\n        // case `kitten-splat`: return { text: `👻`, offsetX: 0, offsetY: 0 };\r\n        case `life`: return { text: `🚀`, scale: 0.5 };\r\n        case `text`: return { text: ``, offsetX: 0, offsetY: -0.125 };\r\n        default: return { text: `😀` };\r\n    }\r\n};\r\n\r\nconst Sprite = ({ kind, position, text }: { kind: SpriteKind, position: { x: number, y: number, rotation: number }, text?: string }) => {\r\n    const s = getSpriteEmoji(kind);\r\n    const size = gameStyles.sprite.viewSize;\r\n    const { fontSize } = gameStyles.sprite.text;\r\n\r\n    const stylePosition = {\r\n        position: `absolute`,\r\n        ...size,\r\n        transform: `translate(${position.x}px, ${position.y}px) rotate(${position.rotation ?? 0}turn)`,\r\n        // backgroundColor: `red`,\r\n        pointerEvents: `none`,\r\n    } as const;\r\n    const styleRotation = {\r\n        ...size,\r\n        transform: `translate( ${size.width * -0.5 + Math.floor((s.offsetX ?? 0) * fontSize)}px, ${size.height * -0.5 + Math.floor((s.offsetY ?? 0) * fontSize)}px) rotate(${s.rotation ?? 0}turn) scale(${s.scale ?? 1})`,\r\n    };\r\n    return (\r\n        <View style={stylePosition}>\r\n            <View style={styleRotation}>\r\n                <Text style={gameStyles.sprite.text}>{text ?? s.text}</Text>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n\r\nconst TextPositioned = ({ text, position }: { text: string, position: { x: number, y: number, rotation: number } }) => {\r\n    const s = gameStyles.answer.text;\r\n    const fontSize = text.length > 10 ? s.fontSize_small : s.fontSize;\r\n\r\n    const offsetY = -fontSize * 0.5 - 4;\r\n\r\n    const stylePosition = {\r\n        position: `absolute`,\r\n        transform: `translate(${position.x}px, ${position.y + offsetY}px) rotate(${position.rotation ?? 0}turn)`,\r\n        pointerEvents: `none`,\r\n        maxWidth: gameStyles.viewscreenView.width * 0.5,\r\n        // backgroundColor: `red`,\r\n    } as const;\r\n\r\n    return (\r\n        <View style={stylePosition}>\r\n            <Text style={{ ...gameStyles.answer.text, fontSize }}>{text}</Text>\r\n        </View>\r\n    );\r\n};\r\n","import React, { useState } from 'react';\r\nimport { View, Text, TouchableOpacity, TextInput } from 'react-native-lite';\r\n\r\n\r\nexport const createLeaderboard = <TScoreState extends {}>(args: {\r\n    storageKey: string;\r\n    sortKey: (item: TScoreState) => string | number;\r\n    sortDescending?: boolean;\r\n    scoreColumns: { name: string, getValue: (item: TScoreState) => string }[];\r\n}) => {\r\n\r\n    type LeaderboardScore = { name: string, score: TScoreState };\r\n    const leaderboard = {\r\n        saveScore: (name: string, score: TScoreState) => {\r\n            const data = leaderboard.loadScore();\r\n\r\n            data.push({ name, score });\r\n            data.sort((a, b) => args.sortKey(a.score) < args.sortKey(b.score) ? -1 : 1);\r\n\r\n            localStorage.setItem(args.storageKey, JSON.stringify(data));\r\n        },\r\n        loadScore: () => {\r\n            const json = localStorage.getItem(args.storageKey);\r\n            if (!json) { return []; }\r\n\r\n            const data = JSON.parse(json) as LeaderboardScore[];\r\n            data.sort((a, b) => (args.sortKey(a.score) > args.sortKey(b.score) ? -1 : 1) * (args.sortDescending ? -1 : 1));\r\n            return data;\r\n        },\r\n    };\r\n\r\n    const leaderboardInputStyles = {\r\n        container: {\r\n            flex: 1,\r\n            alignItems: `center`,\r\n            margin: 16,\r\n        },\r\n        textInput: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 16,\r\n            color: `#0000FF`,\r\n        },\r\n        buttonView: {\r\n            margin: 4,\r\n            padding: 4,\r\n            borderColor: `#FFFF00`,\r\n            borderStyle: `solid`,\r\n            borderWidth: 1,\r\n            borderRadius: 4,\r\n        },\r\n        buttonText: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 16,\r\n            color: `#FFFF00`,\r\n        },\r\n    } as const;\r\n\r\n    const LeaderboardNameInput = (props: { onSubmit: (value: string) => void }) => {\r\n        const [name, setName] = useState(``);\r\n        return (\r\n            <View style={leaderboardInputStyles.container}>\r\n                <TextInput style={leaderboardInputStyles.textInput} value={name} onChange={setName} placeholder='Name' keyboardType='default' autoCompleteType='off' />\r\n                <TouchableOpacity onPress={() => !!name && props.onSubmit(name)} style={!name ? { opacity: 0.5 } : {}}>\r\n                    <View style={leaderboardInputStyles.buttonView}>\r\n                        <Text style={leaderboardInputStyles.buttonText}>Save Score</Text>\r\n                    </View>\r\n                </TouchableOpacity>\r\n            </View >\r\n        );\r\n    };\r\n\r\n    const leaderboardStyles = {\r\n        container: {\r\n            marginTop: 16,\r\n            borderColor: `#FFFFFF`,\r\n            borderStyle: `solid`,\r\n            borderWidth: 1,\r\n            borderRadius: 0,\r\n        },\r\n        scoreView: {\r\n            flexDirection: `row`,\r\n            justifyContent: `space-around`,\r\n            padding: 4,\r\n            borderColor: `#FFFFFF`,\r\n            borderStyle: `solid`,\r\n            borderWidth: 1,\r\n            borderRadius: 0,\r\n        },\r\n        nameText: {\r\n            flex: 2,\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 12,\r\n            color: `#FFFFFF`,\r\n            overflow: `hidden`,\r\n        },\r\n        scoreText: {\r\n            flex: 1,\r\n            textAlign: `right`,\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 12,\r\n            color: `#FFFF00`,\r\n        },\r\n    } as const;\r\n\r\n    const LeaderboardViewInner = (props: { scores: LeaderboardScore[] }) => {\r\n\r\n        return (\r\n            <View style={leaderboardStyles.container}>\r\n                <View style={leaderboardStyles.scoreView}>\r\n                    <Text style={leaderboardStyles.nameText}>Leaderboard</Text>\r\n                    {args.scoreColumns.map(x => (\r\n                        <Text key={x.name} style={leaderboardStyles.scoreText} />\r\n                    ))}\r\n                </View>\r\n                <View style={leaderboardStyles.scoreView}>\r\n                    <Text style={leaderboardStyles.nameText}>Name</Text>\r\n                    {args.scoreColumns.map(x => (\r\n                        <Text key={x.name} style={leaderboardStyles.scoreText} >{x.name}</Text>\r\n                    ))}\r\n                </View>\r\n                {props.scores.map(x => (\r\n                    <View style={leaderboardStyles.scoreView}>\r\n                        <Text style={leaderboardStyles.nameText}>{x.name}</Text>\r\n                        {args.scoreColumns.map(c => (\r\n                            <Text key={x.name} style={leaderboardStyles.scoreText} >{c.getValue(x.score)}</Text>\r\n                        ))}\r\n                    </View>\r\n                ))}\r\n            </View>\r\n        );\r\n    };\r\n\r\n    const useLeaderboard = ({\r\n        getScore,\r\n    }: {\r\n        getScore: () => TScoreState;\r\n    }) => {\r\n\r\n        const [leaderboardScores, setLeaderboardScores] = useState({ scores: leaderboard.loadScore() } as { scores: LeaderboardScore[] });\r\n\r\n        const LeaderboardArea = (props: { gameOver: boolean, onScoreSaved: () => void }) => {\r\n\r\n            const onSaveScore = (name: string) => {\r\n                leaderboard.saveScore(name, getScore());\r\n                setLeaderboardScores({ scores: leaderboard.loadScore() });\r\n                props.onScoreSaved();\r\n            };\r\n\r\n            return (\r\n                <>\r\n                    {!!props.gameOver && (<LeaderboardNameInput onSubmit={onSaveScore} />)}\r\n                    <LeaderboardViewInner scores={leaderboardScores.scores} />\r\n                </>\r\n            );\r\n        };\r\n\r\n        return {\r\n            LeaderboardArea,\r\n        };\r\n    };\r\n\r\n\r\n    return {\r\n        useLeaderboard,\r\n    };\r\n};\r\n","export { delay } from 'utils/delay';\r\nexport { randomIndex, randomItem } from 'utils/random';\r\nexport { getValuesAsItems } from 'utils/objects';\r\nexport { moveItem } from 'utils/arrays';\r\nexport const randomBinary = (length: number) => String.fromCharCode(...[...new Array(length)].map(x => Math.random() * (126 - 32) + 32));\r\n"],"sourceRoot":""}