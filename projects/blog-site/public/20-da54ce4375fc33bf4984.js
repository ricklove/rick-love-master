(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[20],{"9GY0":function(e,t,n){"use strict";n.r(t),n.d(t,"EducationalGame_Doodle_Spelling",(function(){return X}));n("yKDW"),n("dtAy");var r=n("a1TR"),a=n.n(r),o=(n("3yYM"),n("ERkP")),i=n.n(o),c=n("DTYs"),u=(n("yIC7"),n("p+GS"),n("4oWw"),n("nruA"),n("LnO1"),n("XjK0"),n("SCO9"),n("KI7T"),n("PN9k"),n("4cHy")),l=n("hsFx"),s=n("1U25"),d=n("X2o9"),f=n("+tC1"),p=n("MWkW"),m="doodle/drawings",v="doodle/votes";function w(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,a)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){g(o,r,a,i,c,"next",e)}function c(e){g(o,r,a,i,c,"throw",e)}i(void 0)}))}}var b=function(){try{var e;return JSON.parse(null!==(e=localStorage.getItem("doodleStorage"))&&void 0!==e?e:"NULL!{}")}catch(t){return null}},x=function(e){localStorage.setItem("doodleStorage",JSON.stringify(e))},k=function(){var e=h(a.a.mark((function e(){var t,n,r,o,i,c,y,g,k;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Object(d.a)({getUploadUrl:function(){var e=h(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!==(t=null===(n=b())||void 0===n?void 0:n.doodleUploadUrl)&&void 0!==t?t:null);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setUploadUrl:function(){var e=h(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x(Object.assign(Object.assign({},null!==(n=b())&&void 0!==n?n:{}),{},{doodleUploadUrl:t})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),uploadApiUrl:s.a.uploadApiUrl,uploadUrlPrefix:m}),c=Object(d.a)({getUploadUrl:function(){var e=h(a.a.mark((function e(){var t,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",null!==(t=null===(n=b())||void 0===n?void 0:n.scoresUploadUrl)&&void 0!==t?t:null);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),setUploadUrl:function(){var e=h(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x(Object.assign(Object.assign({},null!==(n=b())&&void 0!==n?n:{}),{},{scoresUploadUrl:t})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),uploadApiUrl:s.a.uploadApiUrl,uploadUrlPrefix:v}),y={doodles:[],doodleScores:[],doodleVotes:[]},e.next=5,i.load();case 5:if(e.t2=n=e.sent,e.t1=null===e.t2,e.t1){e.next=9;break}e.t1=void 0===n;case 9:if(!e.t1){e.next=13;break}e.t3=void 0,e.next=14;break;case 13:e.t3=n.doodles.map((function(e){return{key:e.k,prompt:e.p,timestamp:e.t,drawing:e.d?Object(p.a)(e.d):e.drawing}}));case 14:if(e.t4=t=e.t3,e.t0=null!==e.t4,!e.t0){e.next=18;break}e.t0=void 0!==t;case 18:if(!e.t0){e.next=22;break}e.t5=t,e.next=23;break;case 22:e.t5=[];case 23:return y.doodles=e.t5,e.next=26,c.load();case 26:if(e.t8=o=e.sent,e.t7=null===e.t8,e.t7){e.next=30;break}e.t7=void 0===o;case 30:if(!e.t7){e.next=34;break}e.t9=void 0,e.next=35;break;case 34:e.t9=o.doodleVotes;case 35:if(e.t10=r=e.t9,e.t6=null!==e.t10,!e.t6){e.next=39;break}e.t6=void 0!==r;case 39:if(!e.t6){e.next=43;break}e.t11=r,e.next=44;break;case 43:e.t11=[];case 44:return y.doodleVotes=e.t11,g={},y.doodleVotes.forEach((function(e){var t;g[e.k]=(null!==(t=g[e.k])&&void 0!==t?t:0)+1})),y.doodleScores=Object(f.b)(g).map((function(e){return{doodleKey:e.key,score:e.value}})),k={saveDrawing:function(){var e=h(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={key:t.substr(0,8)+":"+Date.now()+":"+Math.floor(999999*Math.random()),drawing:n,prompt:t,timestamp:Date.now()},y.doodles.push(r),setTimeout(h(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.save({doodles:y.doodles.map((function(e){return{k:e.key,p:e.prompt,t:e.timestamp,d:Object(p.d)(e.drawing)}}))});case 2:case"end":return e.stop()}}),e)}))));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),saveBestDrawingSelection:function(){var e=h(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y.doodleVotes.push({k:t.key,t:Date.now()}),(r=y.doodleScores.find((function(e){return e.doodleKey===t.key})))||(r={doodleKey:t.key,score:0},y.doodleScores.push(r)),r.score=(null!==(n=r.score)&&void 0!==n?n:0)+1,setTimeout(h(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.save({doodleVotes:y.doodleVotes});case 2:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getDrawings:function(){var e=h(a.a.mark((function e(t,n){var r,o,i,c,s,d,f,p,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=(r=null!=n?n:{}).includeOtherPrompts,i=void 0!==o&&o,c=r.maxCount,s=void 0===c?4:c,d=y.doodles.filter((function(e){return e.prompt===t})),f=i?y.doodles.filter((function(e){return e.prompt!==t})):[],p=i?[Object(u.b)(d)].concat(w(Object(l.e)(f).slice(0,s-1))):d,m=Object(l.e)(p).slice(0,s),e.abrupt("return",{doodles:m});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},e.abrupt("return",k);case 50:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),E=n("njmQ"),S=n("pAyS"),O=n("yxiS");n("T3IU"),n("DZyD"),n("3eMz"),n("ZXCn"),n("T7D0");function j(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var D={rows:[{keys:"qwertyuiop".split("")},{keys:" asdfghjkl".split("")},{keys:"  zxcvbnm ".split("")}]},C={container:{},rowView:{flex:1,flexDirection:"row"},keyView:{margin:2,padding:2,width:20,height:20,backgroundColor:"#111111",justifyContent:"center",alignItems:"center"},keyView_disabled:{opacity:.5},keyText:{fontSize:16},keyText_wrong:{fontSize:16,color:"#FF0000"}},U=function(e){var t=e.expectedCharacter,n=e.showHints,r=e.onExpectedKeyPress,a=D,u=Object(o.useState)(null),s=u[0],d=u[1],f=Object(o.useState)([]),p=f[0],m=f[1];Object(o.useEffect)((function(){n||d(null);var e=[t].concat(j(Object(l.e)(a.rows.flatMap((function(e){return e.keys})).map((function(e){return e.trim()})).filter((function(e){return e}))).slice(0,3)));d(e),m([])}),[t,n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(c.h,{style:C.container},a.rows.map((function(e,a){return i.a.createElement(c.h,{style:C.rowView,key:""+a},e.keys.map((function(e,a){return i.a.createElement(c.g,{key:""+e+a,style:{outline:"none"},onPress:function(){var a;(a=e)!==t?n&&(d((function(e){return(null!=e?e:[]).filter((function(e){return e!==a}))})),m((function(e){return[].concat(j(e),[a])}))):r()}},i.a.createElement(c.h,{style:!s||s.includes(e)?{}:C.keyView_disabled},i.a.createElement(c.h,{style:C.keyView},i.a.createElement(c.e,{style:p.includes(e)?C.keyText_wrong:C.keyText},e))))})))}))))};function V(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,a)}function T(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){V(o,r,a,i,c,"next",e)}function c(e){V(o,r,a,i,c,"throw",e)}i(void 0)}))}}var A={container:{alignItems:"center"},drawing:{width:312,height:312,color:"#FFFFFF",backgroundColor:"#000000"},drawingChoicesView:{maxWidth:332,flexDirection:"row",flexWrap:"wrap"},drawingChoiceWrapper:{padding:4},drawingChoice:{width:78,height:78,color:"#FFFFFF",backgroundColor:"#000000"},titleView:{justifyContent:"center",alignItems:"center"},titleText:{fontSize:20,color:"#FFFFFF"},promptView:{justifyContent:"center",alignItems:"center"},promptText:{fontSize:20,color:"#FFFF00"},buttonView:{padding:8,backgroundColor:"#111111"},buttonText:{fontSize:20,color:"#FFFF00"}},P=function(e){var t=Object(o.useState)(0),n=t[0],r=t[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement(_,Object.assign({},e,{problemSourceKey:n})),i.a.createElement(O.a,{problemService:e.problemService,onOpen:function(){},onClose:function(){},onSubjectNavigation:function(){r((function(e){return e+1}))}}))},_=function(e){var t,n,r,c,u=Object(o.useState)(null),l=u[0],s=u[1],d=Object(o.useState)("type"),f=d[0],p=d[1],m=Object(o.useState)(null),v=m[0],w=m[1],y=Object(o.useRef)(null!==(t=null==l||null===(n=l.answers.find((function(e){return e.isCorrect})))||void 0===n?void 0:n.value)&&void 0!==t?t:"");y.current=null!==(r=null==l||null===(c=l.answers.find((function(e){return e.isCorrect})))||void 0===c?void 0:c.value)&&void 0!==r?r:"";var g=function(){var t,n=e.problemService.getNextProblem();n.question&&(s(n),setTimeout(x),null===(t=n.onQuestion)||void 0===t||t.call(n))};Object(o.useEffect)((function(){g()}),[e.problemSourceKey]);var h=Object(E.a)(),b=(h.loading,h.error,h.doWork),x=function(){b(function(){var t=T(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.drawingStorage.getDrawings(y.current);case 2:r=t.sent,w(r.doodles),p("type");case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},k=function(){p("drawPrompt")},S=function(){b(function(){var t=T(a.a.mark((function t(n){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.drawingStorage.getDrawings(y.current);case 2:if(r=t.sent,n(),!(r.doodles.length<=1)){t.next=7;break}return g(),t.abrupt("return");case 7:w(r.doodles),p("chooseBest");case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())};return l?"type"===f?i.a.createElement(i.a.Fragment,null,i.a.createElement(z,{prompt:y.current,drawings:null!=v?v:[],onDone:function(){b(function(){var e=T(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout(k);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}})):"chooseBest"===f&&v?i.a.createElement(i.a.Fragment,null,i.a.createElement(K,{prompt:y.current,drawings:v,onChooseBest:function(t){b(function(){var n=T(a.a.mark((function n(r){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.drawingStorage.saveBestDrawingSelection(t);case 2:r(),g();case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}})):i.a.createElement(i.a.Fragment,null,i.a.createElement(I,{prompt:y.current,onDone:function(t){b(function(){var n=T(a.a.mark((function n(r){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t.segments.length>0)){n.next=3;break}return n.next=3,e.drawingStorage.saveDrawing(y.current,t);case 3:r(),setTimeout(S);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}})):i.a.createElement(i.a.Fragment,null)},I=function(e){var t=Object(o.useState)(Object(p.b)()),n=t[0],r=t[1];return Object(o.useEffect)((function(){r(Object(p.b)())}),[e.prompt]),i.a.createElement(c.h,{style:A.container},i.a.createElement(c.h,{style:A.titleView},i.a.createElement(c.e,{style:A.titleText},"Draw")),i.a.createElement(S.DoodleDrawerView,{style:A.drawing,drawing:n,onChange:function(e){r(e)}}),i.a.createElement(c.h,{style:A.promptView},i.a.createElement(c.e,{style:A.promptText},e.prompt)),i.a.createElement(c.g,{onPress:function(){e.onDone(n)}},i.a.createElement(c.h,{style:A.buttonView},i.a.createElement(c.e,{style:A.buttonText},"Done"))))},K=function(e){return i.a.createElement(c.h,{style:A.container},i.a.createElement(c.h,{style:A.titleView},i.a.createElement(c.e,{style:A.titleText},"Choose Best")),i.a.createElement(c.h,{style:A.promptView},i.a.createElement(c.e,{style:A.promptText},e.prompt)),i.a.createElement(c.h,{style:A.drawingChoicesView},e.drawings.map((function(t){return i.a.createElement(c.g,{onPress:function(){return e.onChooseBest(t)}},i.a.createElement(c.h,{style:A.drawingChoiceWrapper},i.a.createElement(S.DoodleDisplayView,{style:A.drawingChoice,drawing:t.drawing})))}))))},W={completedText:{fontSize:16,color:"#FFFF00"}},z=function(e){var t,n=Object(o.useState)({completed:"",remaining:e.prompt}),r=n[0],a=n[1];Object(o.useEffect)((function(){a({completed:"",remaining:e.prompt})}),[e.prompt,e.drawings]);return i.a.createElement(c.h,{style:A.container},i.a.createElement(c.h,{style:A.titleView},i.a.createElement(c.e,{style:A.titleText},"Type Word")),i.a.createElement(c.h,{style:A.drawingChoicesView},e.drawings.map((function(e){return i.a.createElement(c.h,{style:A.drawingChoiceWrapper},i.a.createElement(S.DoodleDisplayView,{style:A.drawingChoice,drawing:e.drawing}))}))),i.a.createElement(c.h,null,i.a.createElement(c.e,{style:W.completedText},r.completed+(r.remaining.length>0?"_":""))),i.a.createElement(U,{expectedCharacter:null!==(t=r.remaining[0])&&void 0!==t?t:" ",showHints:!0,onExpectedKeyPress:function(){a((function(t){t.remaining.length<=1&&e.onDone();var n=t.remaining[0];return{completed:t.completed+n,remaining:t.remaining.substr(1)}}))}}))},L=n("aLR2"),B=n("9u8u"),M=n("oo7O"),N=n("DZ/V"),R=n("yyXn");function H(e,t,n,r,a,o,i){try{var c=e[o](i),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,a)}var X=function(e){var t=Object(o.useRef)(Object(L.a)()),n=Object(o.useState)("web"!==c.c.OS),r=n[0],u=n[1],l=Object(E.a)(),s=l.loading,d=(l.error,l.doWork),f=Object(o.useRef)(null);if(Object(o.useEffect)((function(){d(function(){var e,t=(e=a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:f.current=e.sent;case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){H(o,r,a,i,c,"next",e)}function c(e){H(o,r,a,i,c,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}())}),[]),!r){return i.a.createElement(c.h,null,i.a.createElement(N.a,{languange:"en",speechService:t.current}),i.a.createElement("div",{onClick:function(){return t.current.speak("Start"),void u(!0)}},i.a.createElement(c.h,{style:{height:300,alignSelf:"center",alignItems:"center",justifyContent:"center"}},i.a.createElement(c.e,{style:{fontSize:36}},"Start"))))}return s||!f.current?i.a.createElement(i.a.Fragment,null,i.a.createElement(c.a,{size:"large",color:"#FFFF00"})):i.a.createElement(P,{problemService:Object(R.a)(Object(B.a)(Object(M.a)({speechService:t.current,sectionSize:8}),{}),"ProblemsSpellingDoodle"),drawingStorage:f.current})}}}]);
//# sourceMappingURL=20-da54ce4375fc33bf4984.js.map