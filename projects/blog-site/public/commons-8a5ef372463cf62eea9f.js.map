{"version":3,"sources":["webpack:///D:/Projects/rick-love-master/code/utils/objects.ts","webpack:///D:/Projects/rick-love-master/node_modules/vscode-diff/dist/index.js","webpack:///D:/Projects/rick-love-master/code/networking/websockets-api/client/websocket-client-smart.ts","webpack:///D:/Projects/rick-love-master/code/networking/web-mesh/web-mesh-client.ts","webpack:///D:/Projects/rick-love-master/code/utils/random.ts","webpack:///D:/Projects/rick-love-master/code/controls-react/icon-kind.ts","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/core-js/modules/es.string.trim-end.js","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/lesson-render-view.tsx","webpack:///D:/Projects/rick-love-master/code/games/doodle/doodle-storage.ts","webpack:///D:/Projects/rick-love-master/code/networking/user-data-service/user-profile-selection-view.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/progress-games/emoji-idle-game/emoji-skills/emoji-skill-tree.ts","webpack:///D:/Projects/rick-love-master/code/games/educational-games/progress-games/emoji-idle-game/emoji-idle-service.ts","webpack:///D:/Projects/rick-love-master/code/games/educational-games/progress-games/emoji-idle-game/emoji-idle-view.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/progress-games/progress-game.tsx","webpack:///D:/Projects/rick-love-master/code/utils/email-address.ts","webpack:///D:/Projects/rick-love-master/node_modules/vscode-diff/dist/charCode.js","webpack:///D:/Projects/rick-love-master/code/utils/error.ts","webpack:///D:/Projects/rick-love-master/code/games/educational-games/problems/problems-reviewer.ts","webpack:///D:/Projects/rick-love-master/code/utils/string-span.ts","webpack:///D:/Projects/rick-love-master/code/networking/upload-api/client/config.ts","webpack:///D:/Projects/rick-love-master/node_modules/dayjs/dayjs.min.js","webpack:///D:/Projects/rick-love-master/node_modules/dayjs/plugin/localizedFormat.js","webpack:///D:/Projects/rick-love-master/code/react-native-lite/index.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/utils/voice-chooser.tsx","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/core-js/modules/es.string.trim-start.js","webpack:///D:/Projects/rick-love-master/code/utils/subscribable.ts","webpack:///D:/Projects/rick-love-master/code/networking/upload-api/client/uploader.ts","webpack:///D:/Projects/rick-love-master/code/utils/json.ts","webpack:///D:/Projects/rick-love-master/code/controls-react/error-box.tsx","webpack:///D:/Projects/rick-love-master/code/games/doodle/doodle-view.tsx","webpack:///D:/Projects/rick-love-master/code/networking/websockets-api/client/websocket-client.ts","webpack:///D:/Projects/rick-love-master/code/utils/hash-code.ts","webpack:///D:/Projects/rick-love-master/code/code-training/common/lesson-hash.ts","webpack:///D:/Projects/rick-love-master/node_modules/@stripe/react-stripe-js/dist/react-stripe.umd.js","webpack:///D:/Projects/rick-love-master/code/utils/phone-number.ts","webpack:///D:/Projects/rick-love-master/code/code-training/lesson-editor/lesson-defaults.ts","webpack:///D:/Projects/rick-love-master/code/code-training/lesson-editor/lesson-editor.tsx","webpack:///D:/Projects/rick-love-master/code/code-training/lesson-editor/lesson-module-editor.tsx","webpack:///D:/Projects/rick-love-master/node_modules/@stripe/stripe-js/dist/stripe.esm.js","webpack:///D:/Projects/rick-love-master/code/payments/common/process-steps.ts","webpack:///D:/Projects/rick-love-master/code/payments/common/types.ts","webpack:///D:/Projects/rick-love-master/code/payments/providers/stripe/common/stripe-process-steps.ts","webpack:///D:/Projects/rick-love-master/code/payments/providers/stripe/client/stripe-payment-react.tsx","webpack:///D:/Projects/rick-love-master/code/games/doodle/doodle.ts","webpack:///D:/Projects/rick-love-master/node_modules/vscode-diff/dist/diff.js","webpack:///D:/Projects/rick-love-master/code/payments/providers/stripe/client/stripe-client-tokens.ts","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/lesson-view.tsx","webpack:///D:/Projects/rick-love-master/node_modules/prismjs/components/prism-tsx.js","webpack:///D:/Projects/rick-love-master/node_modules/vscode-diff/dist/strings.js","webpack:///D:/Projects/rick-love-master/code/games/doodle/doodle-paths.ts","webpack:///D:/Projects/rick-love-master/node_modules/react-icons/lib/esm/iconsManifest.js","webpack:///D:/Projects/rick-love-master/node_modules/react-icons/lib/esm/iconContext.js","webpack:///D:/Projects/rick-love-master/node_modules/react-icons/lib/esm/iconBase.js","webpack:///D:/Projects/rick-love-master/code/networking/upload-api/client/web-client.ts","webpack:///D:/Projects/rick-love-master/code/games/educational-games/utils/speech.ts","webpack:///D:/Projects/rick-love-master/code/controls-react/button.tsx","webpack:///D:/Projects/rick-love-master/code/controls-react/index.tsx","webpack:///D:/Projects/rick-love-master/code/controls-react/inputs.tsx","webpack:///D:/Projects/rick-love-master/code/utils/dates.ts","webpack:///D:/Projects/rick-love-master/node_modules/vscode-diff/dist/diffChange.js","webpack:///D:/Projects/rick-love-master/code/utils/delay.ts","webpack:///(webpack)/buildin/global.js","webpack:///D:/Projects/rick-love-master/code/controls-react/icon.tsx","webpack:///D:/Projects/rick-love-master/code/themes/theme.ts","webpack:///D:/Projects/rick-love-master/code/utils/arrays.ts","webpack:///D:/Projects/rick-love-master/node_modules/prismjs/components/prism-typescript.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/core-js/internals/flatten-into-array.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/core-js/modules/es.array.unscopables.flat-map.js","webpack:///D:/Projects/rick-love-master/node_modules/prismjs/prism.js","webpack:///D:/Projects/rick-love-master/code/utils-react/hooks.tsx","webpack:///D:/Projects/rick-love-master/code/controls-react/loading.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/problems/spelling/spelling-problem-service.ts","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/tabs.tsx","webpack:///D:/Projects/rick-love-master/node_modules/prismjs/components/prism-jsx.js","webpack:///D:/Projects/rick-love-master/code/games/educational-games/components/game-pad-analog.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/utils/vectors.ts","webpack:///D:/Projects/rick-love-master/code/games/educational-games/star-blast-sideways.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/problems/multiples.ts","webpack:///D:/Projects/rick-love-master/code/games/doodle/keyboard-simplified.tsx","webpack:///D:/Projects/rick-love-master/code/games/doodle/doodle-components.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/components/leaderboard.tsx","webpack:///D:/Projects/rick-love-master/code/networking/user-data-service/user-profile-emojis.tsx","webpack:///D:/Projects/rick-love-master/code/networking/user-data-service/user-profile-manager-view.tsx","webpack:///D:/Projects/rick-love-master/code/code-training/lesson-player/lesson-module-player.tsx","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/@babel/runtime/helpers/esm/construct.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack:///D:/Projects/rick-love-master/code/utils/web-request.ts","webpack:///D:/Projects/rick-love-master/node_modules/vscode-diff/dist/diffComputer.js","webpack:///D:/Projects/rick-love-master/code/code-training/common/diff.ts","webpack:///D:/Projects/rick-love-master/code/code-training/common/replacements.ts","webpack:///D:/Projects/rick-love-master/node_modules/dayjs/plugin/relativeTime.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/core-js/internals/string-trim-forced.js","webpack:///D:/Projects/rick-love-master/code/networking/websockets-api/client/config.ts","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/core-js/modules/es.array.flat-map.js","webpack:///D:/Projects/rick-love-master/code/games/educational-games/utils/subject-navigator.tsx","webpack:///D:/Projects/rick-love-master/code/games/educational-games/problems/problem-state-storage.ts","webpack:///D:/Projects/rick-love-master/code/networking/user-data-service/user-data-service.ts","webpack:///D:/Projects/rick-love-master/code/games/console-simulator/utils.ts","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/code-editor-helpers.ts","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/code-display.tsx","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/emojis.ts","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/lesson-file-editor-construct-code.tsx","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/lesson-file-editor-understand-code.tsx","webpack:///D:/Projects/rick-love-master/code/code-training/common/components/lesson-file-editor.tsx"],"names":["getValuesAsItems","obj","Object","keys","map","k","filter","x","toKeyValueObject","items","v","forEach","key","value","toMap","Map","toKeyValueArray","__export","m","p","exports","hasOwnProperty","defineProperty","createWebMeshClient","channelKey","initialMeshState","initialState","reduceState","reduceClientsState","clientKey","localStorage","getItem","Date","now","Math","floor","random","setItem","config","messageHandler","messages","events","sendRef","outbox","connection","subMessages","subEvents","sendIntervalId","sendOutbox","stateSub","createSubscribable","state","meshState","meshMetaData","clients","firstMessageTimestamp","lastMessageTimestamp","messageHistory","sendSyncStateTimeoutId","setTimeout","websocket","websocketsApiUrl","websocketsApiConfig","message","kind","clearTimeout","c","onStateChange","oldClients","push","lastActivityTimestamp","t","sort","a","b","join","updateClients","pingPongDropTimeoutId","clientKeys","includes","sendPong","some","sendSyncState","distinct_key","clientPriority","findIndex","send","createWebsocketClient","connect","subscribeMessages","_r","subscribeConnectionEvents","event","isConnected","setInterval","splice","length","unsubscribe","clearInterval","close","history","sendWebSocketMessage","unshift","pingPongInterval","deadClients2","oldClients2","isClosed","_webSocket","sendMessage","AppError","subscribe","randomIndex","randomItem","IconKind","$","$trimEnd","end","FORCED","forcedStringTrimMethod","trimEnd","this","target","proto","forced","trimRight","styles","container","iFrame","width","height","border","background","LessonRenderView","props","containerRef","useRef","lastWidth","lastHeight","intervalId","onResizeHeight","current","clientWidth","borderSize","contentWindow","document","body","scrollHeight","style","useEffect","iFrameUrl","ref","src","title","onLoad","e","LessonProjectStatePreview","projectState","setProjectState","useAutoLoadingError","loading","doWork","error","useState","setIFrameUrl","stopIfObsolete","r","storageAccess","JSON","parse","stringify","createDoodleDrawingStorageService","remoteDoodle","createSmartUploader","getUploadUrl","doodleUploadUrl","setUploadUrl","uploadApiUrl","uploadApiConfig","uploadUrlPrefix","doodleStoragePaths","doodleDrawingsPrefix","remoteVotes","scoresUploadUrl","doodleVotesPrefix","getSummaryData","uploadUrl","uploadApiWebClient","createUploadApiWebClient","createUploadUrl","serverUrl","getUrl","replace","relativePath","summaryUrl","doodleSummary","console","log","downloadData","summaryDataRaw","summaryData","doodles","prompt","timestamp","drawing","decodeDoodleDrawing","d","score","s","memory","doodleScores","doodleVotes","load","voteTotals","doodleKey","service","saveDrawing","doodle","substr","save","encodeDoodleDrawing","saveBestDrawingSelection","find","getDrawings","options","includeOtherPrompts","maxCount","allDoodles","samePromptDrawings","otherPromptDrawings","allDrawings","shuffle","slice","drawings","getAllDrawings","flexDirection","flexWrap","justifyContent","profileContainer","alignItems","profileCharacterView","borderWidth","borderStyle","borderColor","profileCharacterText","fontSize","textAlign","profileNameView","profileNameText","UserProfileSelectionView","userProfiles","setUserProfiles","isManagerVisible","setIsManagerVisible","reload","UserDataService","get","setup","getUserProfiles","profiles","onClose","onPress","setActiveUser","onUserSelected","emoji","name","buildEmojiSkillTree","maleSkillDoc","child_male","student_male","skillDoc","femaleSkillDoc","child_female","student_female","getFemaleVariant","maleNodes","parseSkillDoc","femaleNodes","babyNode","babyEmoji","gender","pay","requirementEmojis","startEmoji","parent","children","allNodes","root","child","allRequirements","parseRequirementsDoc","requirementsDoc","node","allCosts","cost","summary","totalCost","reduce","out","debug_totalRequirementsCost","doc","split","trim","line","parts","Number","parseInt","parseSkillLine","skillLine","payText","p1","RegExp","genderCharCodes","male","female","man","woman","String","fromCodePoint","storage","createService","skillTree","reqMap","defaultState","characterEmoji","emotion","lastEmotionTimestamp","money","multiplier","lastMultiplierChangeTimestamp","lastPurchaseTimestamp","townState","characters","sub","changeState","partialState","rewardInner","min","targetEmoji","targetOptions","skillNode","remainingSkills","targetSkillNode","reqs","reqs_remaining","requirementsPurchased","reqs_available","requirementsAvailable","requirementsNeeded","requirementsRemaining","undefined","subscribePetStateChange","reward","reward_major","reward_extreme","punish","max","selectOption","finishedTimestamp","serviceState","instance","EmojiIdleService","fixed","position","top","right","left","zIndex","inner","emotionEmoji","fontFamily","characterEmoji_small","costText","color","costText_small","targetCharacterEmoji","objectEmoji","marginLeft","money_small","foodText","EmojiIdleView","gameState","setGameState","isExpanded","setIsExpanded","purchased","townStyles","payText_disabled","moneyText","townMoneyText","TownView","townPersons","character","skill","n","years","missingSkills","townMoney","flex","padding","toLocaleString","toFixed","opacity","CommandsView","offset","setOffset","targetOptionsLength","i","canBuy","borderRadius","paddingLeft","paddingRight","ScoreView","moneySizeOffset","setMoneySizeOffset","multiplierSizeOffset","setMultiplierSizeOffset","lastMultiplier","multiplierDelta","setMultiplierDelta","update","id","transform","padStart","EmojiCharacterView","PurchasedView","EmotionView","text","isEmotion","display","setDisplay","showEmotion","variant","getEmoji","ProgressGameService","onCorrect","onCompleteSection","onCompleteSubject","onWrong","createProgressGameProblemService","problemSource","recordAnswer","problem","answer","isCorrect","isReview","isLastOfSubject","uploadUserData","isLastOfSection","ProgressGameView","hasSelectedProfile","setHasSelectedProfile","userProfile","setUserProfile","getActiveUser","lastPurchase","Platform","OS","window","location","toEmailAddress","email","data","Error","ApiError","createReviewProblemService","maxNewReviewCount","reviewSequencePreviousLength","reviewQuestionPrefix","requiredCorrectInRow","problemSourceHistory","reviewProblems","lastReviewProblem","reviewSequence","repeatState","startReview","getSections","gotoSection","getNextProblem","reviewProblem","rSeq","iNext","iEnd","index","lastReviewProblemIndex","iStart","seq","question","answers","getReviewProblem","correctsInRow","newProblem","problemAlreadyInReview","newReview","_debug_problemKey","StringSpan","source","start","debug","indexOf","lastIndexOf","indexOfAny","indexes","indexOfRegExp","lastIndex","exec","lastIndexOfRegex","len","splitOn","spans","iMin","iLast","splitOnRegExp","startsWith","trimStart","patterns","offsetStart","offsetEnd","newRange","toText","getChar","module","u","o","h","f","Array","z","utcOffset","abs","year","month","clone","add","ceil","M","y","w","D","ms","Q","toLowerCase","weekdays","months","l","g","date","args","arguments","locale","$L","utc","$u","$offset","prototype","$d","NaN","test","match","UTC","init","$y","getFullYear","$M","getMonth","$D","getDate","$W","getDay","$H","getHours","$m","getMinutes","$s","getSeconds","$ms","getMilliseconds","$utils","isValid","toString","isSame","startOf","endOf","isAfter","isBefore","$g","set","day","hour","minute","second","millisecond","unix","valueOf","getTime","toDate","apply","$locale","weekStart","$set","daysInMonth","round","subtract","format","meridiem","YY","YYYY","MM","MMM","monthsShort","MMMM","DD","dd","weekdaysMin","ddd","weekdaysShort","dddd","H","HH","hh","A","mm","ss","SSS","Z","getTimezoneOffset","diff","toJSON","toISOString","toUTCString","extend","isDayjs","en","Ls","LTS","LT","L","LL","LLL","LLLL","formats","toUpperCase","call","mergeStyles","isArray","item","viewStyleDefaults","textStyleDefaults","whiteSpace","finalizeTextStyle","userSelect","MozUserSelect","WebkitUserSelect","View","Text","numberOfLines","allStyles","overflow","wordWrap","textOverflow","TextInput","type","keyboardType","secureTextEntry","autoCompleteType","onKeyPress","onSubmitEditing","shiftKey","preventDefault","multiline","placeholder","disabled","editable","onFocus","onChange","onBlur","rows","onSelect","eTarget","selectionRange","selectionStart","selectionEnd","onSelectionChange","TouchableOpacity","lastPressTime","hasTouchStarted","onClick","onTouchStart","onTouchMove","onTouchEnd","role","tabIndex","Pressable","onIgnore","stopPropagation","cancelBubble","returnValue","onPressIn","onPressOut","onMouseDown","onMouseUp","onTouchCancel","onMouseLeave","onTouchEndCapture","ActivityIndicator","size","sizePx","CircleSvg","thickness","dashLength","PI","maxWidth","viewBox","xmlns","fill","stroke","strokeWidth","cx","cy","className","strokeDasharray","transformOrigin","Clipboard","setString","navigator","clipboard","writeText","VoiceChooser","languange","speechService","setLoading","setRenderId","refresh","getVoicesForLanguange","voice","setVoiceForLanguange","speak","margin","isSelected","lang","localService","$trimStart","trimLeft","lastState","callbacks","callback","fetchWithTimeout","method","headers","result","json","createUploader","uploadData","putUrl","ok","_uploadUrl","setupUploadUrl","prefix","uploader","renewUploadUrl","backupUrl","backupUploader","jsonStringify_safe","shouldFormat","visited","_","val","errorBoxStyle","view","theme","view_error","text_error","text_errorMessage","icon","icon_errorMessage","button","outlineColor","colors","outline","ErrorBox","ErrorBox_Inner","expanded","setExpanded","errorAsString","errorMessage","errorDetails","errorObjText","canExpand","collapsed","copy","retryCallback","retry","ErrorMessage","backgroundColor","DoodleTestView","defaultDoodleDrawing","setDoodle","DoodleDrawerView","DoodleDisplayView","scale","segment","setSegment","segmentClientStart","divHost","nativeEvent","pos","div","rect","getBoundingClientRect","clientX","clientY","points","segments","onClientMove","lastPos","onMove","onIgnoreNative","addEventListener","passive","removeEventListener","preserveAspectRatio","doodleSegmentToSvgPath_line","bottom","onMouseMove","touches","redrawId","setRedrawId","enableRedraw","DoodleDisplayView_Inner","shouldAnimate","animatePointsPerSecond","tick","setTick","totalPoints","flatMap","remainingPoints","MAX_SAFE_INTEGER","maxPoints","DoodleBrowser","setDoodles","DoodleBrowseView","grouped","groupItems","subscribable","subscribableEvents","createSocket","socket","WebSocket","activeSocket","connectionStatus","messageContainer","reconnect","readyState","OPEN","hashCode","str","seed","ch","h1","h2","charCodeAt","imul","calculateFilesHashCode","files","allText","content","path","language","React","_typeof","Symbol","iterator","constructor","_objectWithoutProperties","excluded","sourceKeys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_slicedToArray","arr","_arrayWithHoles","_arr","_n","_d","_e","_s","_i","next","done","err","_iterableToArrayLimit","TypeError","_nonIterableRest","emptyFunction","emptyFunctionWithReset","resetWarningCache","propTypes","fn","createCommonjsModule","shim","propName","componentName","propFullName","secret","getShim","isRequired","ReactPropTypes","array","bool","func","number","object","string","symbol","any","arrayOf","element","elementType","instanceOf","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","factoryWithThrowingShims","isUnknownObject","raw","isEqual","leftArray","leftPlainObject","leftKeys","rightKeys","keySet","allKeys","every","usePrevious","validateStripe","maybeStripe","elements","createToken","createPaymentMethod","confirmCardPayment","parseStripeProp","then","isPromise","tag","stripePromise","Promise","resolve","stripe","ElementsContext","createContext","displayName","useElementsContextWithUseCase","useCaseMessage","ctx","useCase","concat","parseElementsContext","useContext","ElementsConsumer","_ref2","useCallbackReference","cb","extractUpdateableOptions","paymentRequest","noop","createElementComponent","isServer","charAt","Element","createElement","_ref","_ref$options","_ref$onBlur","_ref$onFocus","_ref$onReady","onReady","_ref$onChange","_ref$onEscape","onEscape","_ref$onClick","elementRef","domNode","callOnReady","callOnBlur","callOnFocus","callOnClick","callOnChange","callOnEscape","useLayoutEffect","create","mount","on","prevOptions","warn","updateableOptions","destroy","__elementType","AuBankAccountElement","CardElement","CardNumberElement","CardExpiryElement","CardCvcElement","FpxBankElement","IbanElement","IdealBankElement","PaymentRequestButtonElement","Elements","rawStripeProp","_final","isMounted","parsed","useMemo","_React$useState2","setContext","prevStripe","anyStripe","_registerWrapper","version","Provider","useElements","useStripe","factory","formatPhoneNumber_UsaCanada","phoneNumberMask_UsaCanada","corrected","toStandardPhoneNumber","digitsNo1","digits","letters","iDigit","full","createDefaultLesson","file","file0","file2","focusIndex","focusLength","filesHashCode","focus","filePath","objective","explanation","task","descriptions","experiments","cloneLesson","lesson","newLesson","createDefaultLessonModule","lessons","containerPanel","editorModeTabRowView","editorModeTabView","alignSelf","marginRight","editorModeTabView_selected","editorModeTabText","editorModeTabText_selected","buttonView","buttonText","sectionHeaderText","infoView","infoText","wrap","lessonFieldView","lessonFieldLabelText","minWidth","lessonFieldText","jsonText","createLessonState","lessonJson","lessonSteps","constructCode","lessonData","understandCode","LessonEditor","setData","editorMode","setEditorMode","projectEditorMode","fileEditorMode_focus","fileEditorMode_noFocus","changeLessonState","onLessonChange","label","projectData","onProjectDataChange","LessonField","LessonField_Descriptions","LessonField_Experiments","j","onDelete","replacements","comment","LessonField_Experiment","modifiedProjectState","setModifiedProjectState","lastFocus","setLastFocus","commentText","setCommentText","lessonExperiments_createReplacementProjectState","lessonExperiments_calculateProjectStateReplacements","selection","textDecoration","LessonModuleEditor","setModule","activeLesson","setActiveLesson","mode","setMode","header","getKey","getLabel","selected","newModule","selectedTabText","onCreateNewItem","_toConsumableArray","arr2","_arrayWithoutHoles","iter","from","_iterableToArray","_nonIterableSpread","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","loadScript","params","reject","Stripe","script","scripts","querySelectorAll","findScript","queryString","advancedFraudSignals","headOrBody","head","appendChild","injectScript","initStripe","registerWrapper","stripePromise$1","loadCalled","ProcessSteps_CreateSavedPaymentMethod","PaymentError","ProcessSteps_CreateSavedPaymentMethod_Stripe","_02_Server_SetupSavedPaymentMethod","_03_Client_CollectPaymentDetails","_04_Server_ObtainPaymentMethod","logProcessStep_CreateSavedPaymentMethod_Stripe","step","status","wrapProcessStep_CreateSavedPaymentMethod_Stripe","execute","createPaymentClientComponents_stripe","_len","_key","loadStripe","stripePublicKey","AppWrapperComponent","PaymentMethodEntryComponent","paymentMethodSetupToken","onPaymentMethodReady","stripeError","setStripeError","handleSubmit","_03A_Client_CollectPaymentDetails","setupInfo","stripeDecodeClientSetupToken","confirmCardSetup","clientSecret","payment_method","card","getElement","billing_details","customerBillingDetails","setupIntent","stripeEncodeClientToken","inputStyle","base","textColor","fontSmoothing","invalid","textColor_invalid","iconColor","inputContainerStyle","marginBottom","elementPadding","textPadding","buttonStyle","fontWeight","buttonJustifyContent","buttonAlignment","errorContainerStyle","errorMessageStyle","onSubmit","encodeDoodleSegmentPoints","last","decodeDoodleSegmentPoints","pointsString","point","doodleText","diffChange_1","createStringSequence","getLength","getElementAtIndex","stringDiff","original","modified","pretty","LcsDiff","ComputeDiff","Debug","Assert","condition","MyArray","Copy","sourceArray","sourceIndex","destinationArray","destinationIndex","DiffChangeHelper","m_changes","m_originalStart","MAX_VALUE","m_modifiedStart","m_originalCount","m_modifiedCount","MarkNextChange","DiffChange","AddOriginalElement","originalIndex","modifiedIndex","AddModifiedElement","getChanges","getReverseChanges","reverse","originalSequence","newSequence","continueProcessingPredicate","OriginalSequence","ModifiedSequence","ContinueProcessingPredicate","m_forwardHistory","m_reverseHistory","ElementsAreEqual","newIndex","OriginalElementsAreEqual","index1","index2","ModifiedElementsAreEqual","_ComputeDiff","originalStart","originalEnd","modifiedStart","modifiedEnd","changes","ComputeDiffRecursive","PrettifyChanges","quitEarlyArr","midOriginalArr","midModifiedArr","ComputeRecursionPoint","midOriginal","midModified","leftChanges","rightChanges","ConcatenateChanges","WALKTRACE","diagonalForwardBase","diagonalForwardStart","diagonalForwardEnd","diagonalForwardOffset","diagonalReverseBase","diagonalReverseStart","diagonalReverseEnd","diagonalReverseOffset","forwardPoints","reversePoints","deltaIsEven","forwardChanges","diagonal","reverseChanges","changeHelper","diagonalMin","diagonalMax","diagonalRelative","lastOriginalIndex","MIN_VALUE","historyIndex","originalStartPoint","modifiedStartPoint","lastForwardChange","getOriginalEnd","getModifiedEnd","numDifferences","tempOriginalIndex","maxDifferences","numDiagonals","furthestOriginalIndex","furthestModifiedIndex","ClipDiagonalBound","MaxDifferencesHistory","matchLengthOfLongest","temp","change","originalStop","modifiedStop","checkOriginal","originalLength","checkModified","modifiedLength","mergedChangeArr","ChangesOverlap","prevChange","bestDelta","bestScore","_boundaryScore","delta","_OriginalIsBoundary","_OriginalRegionIsBoundary","_ModifiedIsBoundary","_ModifiedRegionIsBoundary","diagonalBaseIndex","diffEven","stripeEncodeClientSetupToken","sectionHeader2Text","LessonView_PreviewResult","onDone","isDone","setIsDone","onTaskDone","LessonView_ConstructCode","LessonView_UnderstandCode","experimentStyles","instructionsText","experimentView","experimentItemRow","experimentItemView","experimentItemView_active","borderLeft","experimentItemText","LessonView_ExperimentCode","activeExperiment","setActiveExperiment","activeFocus","setActiveFocus","changeExperiment","focusReplacements","minIndex","maxEndIndex","lengthDeltas","lengthDelta","typescript","Prism","util","languages","tsx","firstNonWhitespaceIndex","chCode","lastNonWhitespaceIndex","startIndex","doodlePartyDrawingsPrefix","DefaultContext","attr","IconContext","__assign","assign","__rest","GenIcon","IconBase","Tree2Element","tree","elem","conf","computedSize","svgProps","Consumer","apiRequest","endpoint","url","requestData","webRequest","resultObj","createSpeechService","synth","speechSynthesis","selectedVoices","voiceLang","SpeechSynthesisUtterance","voices","getVoices","Button","styleAlt","button_formAction_alt","button_formAction","extractViewStyle","extractTextStyle","C","Loading","LoadingInline","View_Panel","view_panel","View_Form","view_form","View_FormFields","view_formFields","View_FieldRow","view_fieldRow","View_FormActionRow","view_formActionRow","Text_FormTitle","text_formTitle","Text_FieldLabel","text_fieldLabel","Button_FieldInline","button_fieldInline_alt","button_fieldInline","Button_FormAction","Input_Text","input_fieldEntry","Input_Username","Input_Password","showPassword","setShowPassword","eye","eyeSlash","Input_Phone","valueActual","setValueActual","Input_Email","Input_Currency","parseFloat","dayjs","localizedFormat","relativeTime","formatDate","formatDate_FromNow","fromNow","delay","timeout","Function","Icon","menu","component","MdMenu","back","MdArrowBack","MdErrorOutline","FiChevronDown","FiChevronRight","MdContentCopy","FaRedo","dashboard","MdDashboard","FaPlus","remove","FaMinus","FaEye","FaEyeSlash","checkChecked","FaCheckSquare","checkUnchecked","FaSquare","MdCheckBoxOutlineBlank","getIcon","IconComponent","sizes","marginTop","paddingTop","paddingBottom","lineHeight","basicThemeColors","text_header","text_button","border_minor","border_input","background_field","background_button","background_error","loader","getBorderSizes","all","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","basicThemeSizes","borderWidth_minor","borderWidth_input","sectionGap","elementGap","rowGap","rowPadding","fontSize_input","fontSize_button","fontSize_header","minWidth_label","minWidth_input","minWidth_button","basicFont","fontWeight_normal","fontWeight_button","fontWeight_header","createTheme","font","borderProps","borderProps_minor","borderProps_input","sTextView","moveItem","to","distinct","Set","groups","sameArrayContents","pattern","lookbehind","greedy","inside","typeInside","insertBefore","alias","ts","toLength","bind","flattenIntoArray","sourceLen","depth","mapper","thisArg","targetIndex","mapFn","addToUnscopables","_self","uniqueId","manual","disableWorkerMessageHandler","encode","tokens","Token","objId","deepClone","getLanguage","parentElement","currentScript","stack","getElementsByTagName","isActive","defaultActivation","no","classList","contains","redef","before","insert","grammar","ret","token","newToken","old","DFS","property","propertyType","plugins","highlightAll","async","highlightAllUnder","env","selector","hooks","run","highlightElement","nodeName","code","textContent","insertHighlightedCode","highlightedCode","innerHTML","Worker","worker","filename","onmessage","evt","postMessage","immediateClose","highlight","tokenize","rest","tokenList","LinkedList","addAfter","matchGrammar","startNode","startPos","rematch","cause","patternObj","lookbehindLength","global","flags","currentNode","tail","reach","removeCount","prev","matchStr","after","removeFrom","removeRange","wrapped","list","toArray","matchedStr","newNode","count","classes","attributes","aliases","highlightAutomaticallyCallback","hasAttribute","defer","requestAnimationFrame","WorkerGlobalScope","self","markup","tagName","includedCdataInside","def","html","mathml","svg","xml","ssml","atom","rss","css","addInlined","clike","javascript","js","EXTENSIONS","SELECTOR","pre","matches","setAttribute","getAttribute","extension","setLanguageClass","autoloader","loadLanguages","xhr","XMLHttpRequest","open","onreadystatechange","responseText","statusText","fileHighlight","logged","useMounted","mounted","useDebounce","timeMs","debouncer","timeoutId","debounce","action","loadingError","setLoadingError","doWorkInner","getContext","contextInit","doCall","createSpellingProblemService","maxAnswers","sectionSize","speech","spellingEntries","getSpellingEntries","sectionCount","nextIndex","completedSectionKeys","getSectionKey","sectionIndex","loaded","isComplete","correctValue","word","wrongAnswerCount","wrongValues","mispellings","onQuestion","sectionKey","mainView","mainView_column","tabView","tabView_selected","tabText","tabText_selected","headerTabView","headerTabText","moveButtonView","justifyContents","TabsListEditorComponent","TabsComponent","oldIndex","newItems","onAdd","newItem","jsx","stringifyToken","walkTokens","openedTags","notTagNorBrace","pop","openedBraces","plainText","GamepadAnalogStateful","moveDirection","buttons","isDown","onPressStateChange","onMovePressIn","dir","onMovePressOut","inputStyles","section","moveSectionWrapper","moveSectionRotation","row","cellTouch","cellView","pointerEvents","cellText","moveCellText","cellEmptyView","cellTextOcclusionView","GamepadAnalog","cellViewStyle","onKeyDown","onKeyUp","DirectionButton","direction","ActionButton","Fragment","getDistanceSq","EducationalGame_StarBlastSideways_Multiples","problemService","createAutoSavedProblemService","bVal","EducationalGame_StarBlastSideways","EducationalGame_StarBlastSideways_Inner","paused","pauseState","setPauseState","pressState","setPressState","problemSourceKey","setProblemSourceKey","gamepad","onOpen","onSubjectNavigation","viewscreen","gameStyles","directAnswerButtonContainer","directAnswerButton","directAnswerButton_hidden","viewscreenView","sprite","viewSize","fontSize_small","gameOver","GameView","getDefaultGameState","lastActualTimeMs","lastGameTime","gameSpeed","lives","getGameTime","actualTimePassed","gameTime","gameTimePassed","playerPositionState","rotation","projectilesState","lastShotActualTime","shots","debris","enemiesState","enemies","problemsState","restartGame","e2","gotoNextProblem","pSize","newProblemState","problemTime","isAnsweredWrong","newEnemyState","ans","enemy","vel","onHit","ignore","destroyed","gameLastTime","gameLoop","gameDeltaTime","getCommonState","playerPosition","onLoseLife","deadTime","gameOverTime","gameResult","updateGame","playerResult","updatePlayer","projectilesResult","updateProjectiles","enemiesResult","updateEnemies","timeSinceProblem","hasHitGround","explodeTime","weaponsLock","lockedEnemy","lockedAtPlayerPosition","playerTargetPosition","directAnswer","dirPress","targetPos","sign","targetRotation","gw","gh","playerPos","didShoot","destoyed","pad","hPad","shift","newShots","radius","radiusSq","radiusSq_enemies","i2","swap","radiusSq_player","wPad","closestEnemyToPlayer","newEnemies","Sprite","offsetX","offsetY","getSpriteEmoji","stylePosition","styleRotation","TextPositioned","englishKeyboard","rowView","keyView","keyView_disabled","keyText","keyText_wrong","KeyboardSimplified","expectedCharacter","showHints","onExpectedKeyPress","keyboard","hintKeys","setHintKeys","wrongKeys","setWrongKeys","hints","iRow","drawingChoicesView","drawingChoiceWrapper","drawingChoice","titleView","titleText","promptView","promptText","hintText","buttonRowView","DoodleGameView_DrawWord","setDrawing","hint","onSkip","DoodleGameView_ChooseBest","onChooseBest","typeStyles","completedText","DoodleGameView_TypeExpected","completed","remaining","setStatus","sayAgain","nextChar","createLeaderboard","leaderboard","saveScore","loadScore","sortKey","storageKey","sortDescending","leaderboardInputStyles","textInput","LeaderboardNameInput","setName","leaderboardStyles","scoreView","nameText","scoreText","LeaderboardViewInner","scoreColumns","scores","getValue","useLeaderboard","getScore","leaderboardScores","setLeaderboardScores","LeaderboardArea","onScoreSaved","userProfileChracters","UserProfileManagerView","onActiveUserChange","onUserProfileChange","onUserAdded","AddUserProfileView","shareCode","setShareCode","addUserFromShareCode","UserProfileView","setCharacters","setUserProfileInfo","onNameChange","createShareCode","UserProfileName","isEditingName","setIsEditingName","changeName","getLessonNavigatorItems","lastLesson","lastLessonMainFile","LessonModulePlayer","setItems","activeItem","setActiveItem","nextStep","useTimeout","itemsToUse","activeItemToUse","itemSteps","activeItemStepIndex","activeItemIndex","nextItem","LessonModuleNavigator","targetItem","borderTop","repo","navigatorStyles","outerContainer","contentContainer","itemsContainer","itemView_header","itemView","itemView_selected","itemText","itemText_selected","hasLoadedHash","isNarrowScreen","setIsNarrowScreen","hash","matchItem","replaceState","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","_setPrototypeOf","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Parent","Class","_cache","has","Wrapper","enumerable","writable","configurable","timeoutMs","race","fetch","reqData","catch","responseStatus","request","diff_1","strings","computeDiff","modifiedSequence","LineMarkerSequence","lines","startColumns","endColumns","length_1","_getFirstNonBlankColumn","_getLastNonBlankColumn","_lines","_startColumns","_endColumns","substring","getStartLineNumber","getStartColumn","getEndLineNumber","getEndColumn","txt","defaultValue","getCharSequence","shouldIgnoreTrimWhitespace","endIndex","charCodes","lineNumbers","columns","lineContent","startColumn","endColumn","col","CharSequence","_charCodes","_lineNumbers","_columns","CharChange","originalStartLineNumber","originalStartColumn","originalEndLineNumber","originalEndColumn","modifiedStartLineNumber","modifiedStartColumn","modifiedEndLineNumber","modifiedEndColumn","createFromDiffChange","diffChange","originalCharSequence","modifiedCharSequence","LineChange","charChanges","createFromDiffResult","originalLineSequence","modifiedLineSequence","shouldComputeCharChanges","shouldPostProcessCharChanges","rawChanges","currChange","originalMatchingLength","modifiedMatchingLength","postProcessCharChanges","length_2","DiffComputer","originalLines","modifiedLines","opts","shouldMakePrettyDiff","maximumRunTimeMs","computationStartTime","_continueProcessingPredicate","lineChanges","length_3","originalLineIndex","modifiedLineIndex","nextChange","originalLine","modifiedLine","_pushTrimWhitespaceCharChange","originalMaxColumn","modifiedMaxColumn","originalLineNumber","modifiedLineNumber","_mergeTrimWhitespaceCharChange","getSpanRange","endLine","startLine","otherAtStart","afterEnd","span","cAfterEnd","lineSpans","otherAtEnd","cStart","aSpan","bSpan","aLineSpans","bLineSpans","aSpanRange","bSpanRange","finalProjectState","newProjectState","oldFile","newFile","future","past","yy","thresholds","rounding","toNow","fails","whitespaces","METHOD_NAME","toObject","aFunction","arraySpeciesCreate","callbackfn","O","subjectStyles","SubjectNavigator","scrollTo","createProblemStateStorage","uploadApi","getUserProfile","getActiveUserProfile","uploadBackup","uploadWithAutoRenew","updateUserProfileFromServer","updateAllProfilesFromServer","isSetupStarted","isSetupDone","getUserDataServiceState","setUserDataServiceState","getUserData","userState","activeUserProfileKey","metadata","clearUserData","removeItem","lastUploadTimestamp","setUserData","userData","userProfileKey","upload","newUploarUrl","doSetup","newUploadUrlResult","newState","changeTimestamp","user","stateJson","downloadUserDataIfNewer","info","uData","shareablePath","shareUrlResult","shareGetUrl","sharedUploadUrl","userKey","randomBinary","fromCharCode","getCodeParts","codeWithClasses","tagsWithCode","iTagLast","iTagLength","tagContext","tagsWithClasses","context","classInfos","cParts","classContentParts","classContent","parseHighlightedSpans","codeParts","indexAfterEnd","_rawCode","codePartsFailed","codePartsAll","modifyCodeParts","isInSelection","inRange","codeFocus","range","getCodePart","shouldSplitStart","shouldSplitEnd","iCodeStart","iCodeAfterEnd","within","getAutoComplete","codeFocusCompleted","nextPartIndexRaw","nextPartIndex","activePartText","iDone","lengthCompleted","activePartTextCompleted","matchWords","choices","textCompleted","isWrong","activeIndex","CodeDisplay","inputOptions","Cursor","CodeSpan","cursorIndex","promptIndex","hasCursor","hasActive","hasPrompt","CursorComponent","cursorBlinkState","setCursorBlinkState","autoCompleteStyles","wrapper","item_selected","textNew","AutoCompleteComponent","autoComplete","onAutocomplete","promptStyles","text_positive","text_negative","PromptComponent","promptRaw","feedback","hideFeedback","setHideFeedback","showFeedback","textStyle","isNegative","goodEmojis","badEmojis","LessonFileContentEditor_ConstructCode","setCodeParts","inputRef","setAutoComplete","inputText","setInputText","setIsActive","setFeedback","nextLetter","changeInputText","valueRaw","newInput","wasBackspace","wasTab","endsWith","wasReturn","wasPeriod","wasSpace","isWhitespace","wasCorrectRaw","wasAutoComplete","activeAutoComplete","value2","wasCorrect_ignoreWhitespace","wasCorrect","activeCodeParts","incomplete","codePartsCompleted","isIncomplete","showBlank","getCodePartsCompleted","choice","keyCode","iSelected","iSelectedNew","LessonFileContentEditor_UnderstandCode","fillInBlanks","setFillInBlanks","fillInBlank","setFillInBlank","descriptionsWithBlanks","textWithBlanks","textWithoutBlanks","onPressCodePart","part","iBlank","nextWithBlanks","withoutBlank","activePrompt","LessonProjectFilesEditor","activeFilePath","setActiveFilePath","lastFocusSet","focusFile","newFocus","activeFile","attempt","fileEditorMode","LessonFileEditor","filePathEdit","setFilePathEdit","onCodeChange","LessonFileContentEditor","LessonFileContentEditor_Display","LessonFileContentEditor_Edit"],"mappings":"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","file":"commons-8a5ef372463cf62eea9f.js","sourcesContent":["export const getValuesAsItems = <T>(obj: T) => {\r\n    return Object.keys(obj).map(k => k as keyof typeof obj).map(k => obj[k]).filter(x => x);\r\n};\r\n\r\nexport const toKeyValueObject = <T>(items: { key: string, value: T }[]): { [key: string]: T } => {\r\n    const v = {} as { [key: string]: T };\r\n    items.forEach(x => { v[x.key] = x.value; });\r\n    return v;\r\n};\r\n\r\nexport const toMap = <T>(items: { key: string, value: T }[]): Map<string, T> => {\r\n    const v = new Map(items.map(x => [x.key, x.value]));\r\n    return v;\r\n};\r\n\r\nexport const toKeyValueArray = <T>(obj: { [key: string]: T }): { key: string, value: T }[] => {\r\n    return Object.keys(obj).map(k => k as keyof typeof obj).map(k => ({ key: k as string, value: obj[k] }));\r\n};\r\n","\"use strict\";\n\nfunction __export(m) {\n  for (var p in m) {\n    if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n  }\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\n__export(require(\"./diffComputer\"));\n\n__export(require(\"./diff\"));\n\n__export(require(\"./charCode\"));\n\n__export(require(\"./diffChange\"));\n\n__export(require(\"./strings\"));","import { WebsocketConnectionEvent } from './types';\r\nimport { createWebsocketClient } from './websocket-client';\r\n\r\nexport const createWebsocketConnection_smart = <TWebsocketMessage>(config: { websocketsApiUrl: string, channelKey: string }, messageHandler: (message: TWebsocketMessage) => void) => {\r\n    const messages = [] as (TWebsocketMessage & { _r: number })[];\r\n    const events = [] as WebsocketConnectionEvent[];\r\n    const sendRef = {\r\n        send: null as null | ((message: TWebsocketMessage) => void),\r\n    };\r\n    const outbox = [] as TWebsocketMessage[];\r\n\r\n    const connection = createWebsocketClient({ websocketsApiUrl: config.websocketsApiUrl })\r\n        .connect<TWebsocketMessage>({ channelKey: config.channelKey });\r\n\r\n    const subMessages = connection.subscribeMessages(message => {\r\n        messageHandler(message);\r\n        messages.push({ ...message, _r: Date.now() });\r\n    });\r\n    const subEvents = connection.subscribeConnectionEvents(event => {\r\n        sendRef.send = connection.isConnected() ? connection.send : null;\r\n        events.push(event);\r\n    });\r\n\r\n    const sendIntervalId = setInterval(() => sendOutbox(), 250);\r\n\r\n    const unsubscribe = () => {\r\n        clearInterval(sendIntervalId);\r\n        sendRef.send = null;\r\n        subMessages.unsubscribe();\r\n        subEvents.unsubscribe();\r\n        connection.close();\r\n    };\r\n\r\n    const sendOutbox = () => {\r\n        if (!sendRef.send) { return; }\r\n\r\n        const o = outbox.splice(0, outbox.length);\r\n        for (const x of o) {\r\n            sendRef.send(x);\r\n        }\r\n    };\r\n\r\n    const sendMessageWithOutbox = (message: TWebsocketMessage) => {\r\n        if (!sendRef.send) {\r\n            outbox.push(message);\r\n            return;\r\n        }\r\n\r\n        sendOutbox();\r\n        sendRef.send(message);\r\n    };\r\n\r\n\r\n    return {\r\n        send: sendMessageWithOutbox,\r\n        unsubscribe,\r\n        history: {\r\n            messages,\r\n            events,\r\n        },\r\n    };\r\n};\r\n","import { createWebsocketConnection_smart } from 'websockets-api/client/websocket-client-smart';\r\nimport { createSubscribable } from 'utils/subscribable';\r\nimport { AppError } from 'utils/error';\r\nimport { websocketsApiConfig } from 'websockets-api/client/config';\r\nimport { distinct_key } from 'utils/arrays';\r\n\r\ntype Timestamp = number & { __type: 'Timestamp' }\r\ntype ClientKey = string & { __type: 'ClientKey' }\r\nconst createWebMeshClient_websocketOnly = <TMeshState, TMeshMessage>({\r\n    channelKey,\r\n    initialState: initialMeshState,\r\n    reduceState,\r\n    reduceClientsState,\r\n}: {\r\n    channelKey: string;\r\n    initialState: TMeshState;\r\n    reduceState: (previousState: TMeshState, message: TMeshMessage) => TMeshState;\r\n    reduceClientsState: (previousState: TMeshState, clients: { key: string, lastActivityTimestamp: Timestamp }[]) => TMeshState;\r\n}) => {\r\n    const WEB_MESH_CLIENT_KEY = `_webMeshClientKey`;\r\n    const clientKey = (localStorage.getItem(WEB_MESH_CLIENT_KEY) ?? (`${Date.now()}-${Math.floor(Math.random() * 999999)}`)) as ClientKey;\r\n    localStorage.setItem(WEB_MESH_CLIENT_KEY, clientKey);\r\n\r\n    const stateSub = createSubscribable<TMeshState>();\r\n    const state = {\r\n        meshState: initialMeshState,\r\n        meshMetaData: {\r\n            clients: [] as { key: string, lastActivityTimestamp: Timestamp }[],\r\n            firstMessageTimestamp: 0 as Timestamp,\r\n            lastMessageTimestamp: 0 as Timestamp,\r\n        },\r\n    };\r\n    const messageHistory = [] as WebSocketMessageWithSenderInfo[];\r\n\r\n    type WebSocketMessage = (\r\n        { kind: 'join' }\r\n        | { kind: 'close' }\r\n        | { kind: 'sync', state: typeof state }\r\n        | { kind: 'ping', clientKeys: string[] }\r\n        | { kind: 'pong' }\r\n        | { kind: 'drop', clientKeys: string[] }\r\n        | { kind: 'message', message: TMeshMessage }\r\n    );\r\n    type WebSocketMessageWithSenderInfo = { t: Timestamp, c: ClientKey } & WebSocketMessage;\r\n\r\n    const updateClients = (message: { c: ClientKey, t: Timestamp }) => {\r\n        const oldClients = [...state.meshMetaData.clients];\r\n        state.meshMetaData.clients = state.meshMetaData.clients.filter(x => x.key !== message.c);\r\n        state.meshMetaData.clients.push({ key: message.c, lastActivityTimestamp: message.t });\r\n        state.meshMetaData.clients.sort((a, b) => -(a.lastActivityTimestamp - b.lastActivityTimestamp));\r\n\r\n        if (oldClients.map(x => x.key).join(`;`) !== state.meshMetaData.clients.map(x => x.key).join(`;`)) {\r\n            state.meshState = reduceClientsState(state.meshState, state.meshMetaData.clients);\r\n            stateSub.onStateChange(state.meshState);\r\n        }\r\n    };\r\n\r\n    let sendSyncStateTimeoutId = setTimeout(() => { }, 0);\r\n    const websocket = createWebsocketConnection_smart<WebSocketMessageWithSenderInfo>({ websocketsApiUrl: websocketsApiConfig.websocketsApiUrl, channelKey: `wm_${channelKey}` }, message => {\r\n\r\n        if (message.kind === `close`) {\r\n            clearTimeout(sendSyncStateTimeoutId);\r\n            state.meshMetaData.clients = state.meshMetaData.clients.filter(x => x.key !== message.c);\r\n            state.meshState = reduceClientsState(state.meshState, state.meshMetaData.clients);\r\n            stateSub.onStateChange(state.meshState);\r\n            return;\r\n        }\r\n\r\n        updateClients(message);\r\n\r\n        if (message.kind === `pong`) {\r\n            clearTimeout(pingPongDropTimeoutId ?? 0);\r\n            pingPongDropTimeoutId = null;\r\n            return;\r\n        }\r\n        if (message.kind === `ping`) {\r\n            clearTimeout(pingPongDropTimeoutId ?? 0);\r\n            pingPongDropTimeoutId = null;\r\n            if (message.clientKeys.includes(clientKey)) {\r\n                setTimeout(sendPong);\r\n            }\r\n            return;\r\n        }\r\n        if (message.kind === `drop`) {\r\n            clearTimeout(pingPongDropTimeoutId ?? 0);\r\n            pingPongDropTimeoutId = null;\r\n            state.meshMetaData.clients = state.meshMetaData.clients.filter(x => !message.clientKeys.some(c => c === x.key));\r\n            state.meshState = reduceClientsState(state.meshState, state.meshMetaData.clients);\r\n            stateSub.onStateChange(state.meshState);\r\n            return;\r\n        }\r\n\r\n        if (message.kind === `join`) {\r\n            clearTimeout(sendSyncStateTimeoutId);\r\n\r\n            // Is self, ignore\r\n            if (message.c === clientKey) { return; }\r\n\r\n            // Respond with sync\r\n            const clientPriority = state.meshMetaData.clients.findIndex(x => x.key === clientKey) - 1;\r\n            const waitTime = clientPriority >= 0 ? clientPriority * 2000 : 10 * 1000;\r\n            sendSyncStateTimeoutId = setTimeout(sendSyncState, waitTime);\r\n            return;\r\n        }\r\n        if (message.kind === `sync`) {\r\n            // Is self, ignore\r\n            if (message.c === clientKey) { return; }\r\n\r\n            if (state.meshMetaData.firstMessageTimestamp\r\n                && state.meshMetaData.firstMessageTimestamp < message.state.meshMetaData.firstMessageTimestamp) {\r\n                // Ignore if the data is not complete (and send new sync message if needed)\r\n                sendSyncStateTimeoutId = setTimeout(sendSyncState, 10 * 1000);\r\n                return;\r\n            }\r\n\r\n            clearTimeout(sendSyncStateTimeoutId);\r\n\r\n            state.meshMetaData.firstMessageTimestamp = message.state.meshMetaData.firstMessageTimestamp;\r\n            state.meshMetaData.lastMessageTimestamp = message.state.meshMetaData.lastMessageTimestamp;\r\n            // state.meshMetaData.clients = message.state.meshMetaData.clients;\r\n            state.meshMetaData.clients = distinct_key([...state.meshMetaData.clients, ...message.state.meshMetaData.clients], x => x.key);\r\n            state.meshState = message.state.meshState;\r\n\r\n            // TODO: What about out of order messages?\r\n            // Replay missing messages\r\n            const missingMessages = messageHistory.filter(x => x.t > state.meshMetaData.lastMessageTimestamp);\r\n            for (const m of missingMessages) {\r\n                if (m.kind !== `message`) { return; }\r\n                state.meshState = reduceState(state.meshState, m.message);\r\n                state.meshMetaData.lastMessageTimestamp = m.t;\r\n            }\r\n\r\n            state.meshState = reduceClientsState(state.meshState, state.meshMetaData.clients);\r\n            stateSub.onStateChange(state.meshState);\r\n            return;\r\n        }\r\n        if (message.kind === `message`) {\r\n            // Accept own message into state once it returns\r\n            messageHistory.push(message);\r\n\r\n            if (!state.meshMetaData.firstMessageTimestamp) { state.meshMetaData.firstMessageTimestamp = message.t; }\r\n            state.meshMetaData.lastMessageTimestamp = message.t;\r\n            state.meshState = reduceState(state.meshState, message.message);\r\n            stateSub.onStateChange(state.meshState);\r\n        }\r\n    });\r\n\r\n    const sendWebSocketMessage = (message: WebSocketMessage) => {\r\n        websocket.send({ ...message, c: clientKey, t: Date.now() as Timestamp });\r\n    };\r\n    const connect = () => {\r\n        sendWebSocketMessage({ kind: `join` });\r\n    };\r\n    const sendSyncState = () => {\r\n        // Move self to front of client list\r\n        state.meshMetaData.clients = state.meshMetaData.clients.filter(x => x.key !== clientKey);\r\n        state.meshMetaData.clients.unshift({ key: clientKey, lastActivityTimestamp: Date.now() as Timestamp });\r\n\r\n        sendWebSocketMessage({ kind: `sync`, state });\r\n    };\r\n\r\n    // Ping-pong (Keep Alive)\r\n    const sendPong = () => {\r\n        sendWebSocketMessage({ kind: `pong` });\r\n    };\r\n    let pingPongDropTimeoutId = null as null | ReturnType<typeof setTimeout>;\r\n    const pingPongInterval = setInterval(() => {\r\n        if (pingPongDropTimeoutId) { return; }\r\n\r\n        const deadClients = state.meshMetaData.clients.filter(x => Date.now() > 45 * 1000 + x.lastActivityTimestamp);\r\n        if (deadClients.length > 0) {\r\n            // state.meshMetaData.clients = state.meshMetaData.clients.filter(x => !deadClients.some(d => d.key === x.key));\r\n            const clientPriority = state.meshMetaData.clients.findIndex(x => x.key === clientKey);\r\n            pingPongDropTimeoutId = setTimeout(() => {\r\n                pingPongDropTimeoutId = null;\r\n                const deadClients2 = state.meshMetaData.clients.filter(x => Date.now() > 45 * 1000 + x.lastActivityTimestamp);\r\n                if (deadClients2.length <= 0) { return; }\r\n                sendWebSocketMessage({ kind: `drop`, clientKeys: deadClients2.map(x => x.key) });\r\n            }, clientPriority * 5000);\r\n            return;\r\n        }\r\n\r\n        const oldClients = state.meshMetaData.clients.filter(x => Date.now() > 30 * 1000 + x.lastActivityTimestamp);\r\n        if (oldClients.length <= 0) { return; }\r\n\r\n        const clientPriority = state.meshMetaData.clients.findIndex(x => x.key === clientKey);\r\n        pingPongDropTimeoutId = setTimeout(() => {\r\n            pingPongDropTimeoutId = null;\r\n            const oldClients2 = state.meshMetaData.clients.filter(x => Date.now() > 30 * 1000 + x.lastActivityTimestamp);\r\n            if (oldClients2.length <= 0) { return; }\r\n\r\n            sendWebSocketMessage({ kind: `ping`, clientKeys: oldClients2.map(x => x.key) });\r\n        }, clientPriority * 5000);\r\n    }, 5000);\r\n\r\n    // Close\r\n    let isClosed = false;\r\n    const close = () => {\r\n        if (isClosed) { return; }\r\n        isClosed = true;\r\n        sendWebSocketMessage({ kind: `close` });\r\n        websocket.unsubscribe();\r\n        clearInterval(pingPongInterval);\r\n    };\r\n    const sendMessage = (message: TMeshMessage) => {\r\n        if (isClosed) { throw new AppError(`The connection is closed`); }\r\n        sendWebSocketMessage({ kind: `message`, message });\r\n    };\r\n\r\n\r\n    // Begin\r\n    connect();\r\n\r\n    return {\r\n        _webSocket: {\r\n            history: websocket.history,\r\n        },\r\n        clientKey,\r\n        sendMessage,\r\n        subscribe: stateSub.subscribe,\r\n        close,\r\n    };\r\n};\r\n\r\nexport type WebMeshClient = ReturnType<typeof createWebMeshClient>;\r\nexport type WebMeshClientWebSocketHistory = WebMeshClient['_webSocket']['history'];\r\nexport const createWebMeshClient = createWebMeshClient_websocketOnly;\r\n","export const randomIndex = (length: number) => {\r\n    const x = Math.floor(length * Math.random());\r\n    return x >= length ? length - 1 : x;\r\n};\r\nexport const randomItem = <T>(items: T[]) => items[randomIndex(items.length)];\r\n","\r\nexport enum IconKind {\r\n    // common icons\r\n    menu,\r\n    back,\r\n    error,\r\n    expanded,\r\n    collapsed,\r\n    copy,\r\n    retry,\r\n    dashboard,\r\n    add,\r\n    remove,\r\n    eye,\r\n    eyeSlash,\r\n\r\n    checkChecked,\r\n    checkUnchecked,\r\n\r\n    // navigation icons\r\n    account,\r\n    message,\r\n    subscription,\r\n    calendar,\r\n    contacts,\r\n    keys,\r\n    resources,\r\n    admin,\r\n}\r\n","'use strict';\nvar $ = require('../internals/export');\nvar $trimEnd = require('../internals/string-trim').end;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\nvar FORCED = forcedStringTrimMethod('trimEnd');\n\nvar trimEnd = FORCED ? function trimEnd() {\n  return $trimEnd(this);\n} : ''.trimEnd;\n\n// `String.prototype.{ trimEnd, trimRight }` methods\n// https://github.com/tc39/ecmascript-string-left-right-trim\n$({ target: 'String', proto: true, forced: FORCED }, {\n  trimEnd: trimEnd,\n  trimRight: trimEnd\n});\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { Loading } from 'controls-react/loading';\r\nimport { useAutoLoadingError } from 'utils-react/hooks';\r\nimport { LessonProjectState, SetProjectState } from '../lesson-types';\r\n\r\nconst styles = {\r\n    container: {\r\n\r\n    },\r\n    iFrame: {\r\n        width: `100%`,\r\n        height: 300,\r\n        border: `solid 4px #888888`,\r\n        background: `#FFFFFF`,\r\n    },\r\n} as const;\r\n\r\nexport const LessonRenderView = (props: { iFrameUrl: string }) => {\r\n\r\n    const containerRef = useRef(null as null | HTMLDivElement);\r\n    const lastWidth = useRef(``);\r\n    const lastHeight = useRef(``);\r\n    const intervalId = useRef(setInterval(() => { }, 100 * 1000));\r\n    const onResizeHeight = (target: HTMLIFrameElement) => {\r\n        if (!containerRef.current) { return; }\r\n\r\n        try {\r\n            const borderSize = 4;\r\n            const width = `${containerRef.current.clientWidth - borderSize * 2}px`;\r\n            const height = `${(target.contentWindow?.document.body.scrollHeight ?? 300) + borderSize * 2}px`;\r\n            if (height !== lastHeight.current\r\n                || width !== lastWidth.current) {\r\n                lastWidth.current = width;\r\n                lastHeight.current = height;\r\n                target.style.width = width;\r\n                target.style.height = height;\r\n                target.style.border = `solid ${borderSize}px #888888`;\r\n            }\r\n        } catch {\r\n            // Ignore cross-domain error\r\n        }\r\n    };\r\n\r\n    const onLoad = (target: HTMLIFrameElement) => {\r\n        onResizeHeight(target);\r\n        clearInterval(intervalId.current);\r\n        intervalId.current = setInterval(() => onResizeHeight(target), 100);\r\n    };\r\n    useEffect(() => {\r\n        lastHeight.current = ``;\r\n        clearInterval(intervalId.current);\r\n        intervalId.current = setInterval(() => { }, 100 * 1000);\r\n        return () => {\r\n            clearInterval(intervalId.current);\r\n        };\r\n    }, [props.iFrameUrl]);\r\n\r\n    return (\r\n        <>\r\n            <div style={styles.container} ref={containerRef}>\r\n                <iframe style={styles.iFrame} src={props.iFrameUrl} title='Preview'\r\n                    onLoad={e => { onLoad(e.target as HTMLIFrameElement); }}\r\n                />\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport const LessonProjectStatePreview = ({ projectState, setProjectState }: { projectState: LessonProjectState, setProjectState: SetProjectState }) => {\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const [iFrameUrl, setIFrameUrl] = useState(null as null | string);\r\n    useEffect(() => {\r\n        doWork(async (stopIfObsolete) => {\r\n            const r = await setProjectState(projectState);\r\n            setIFrameUrl(r.iFrameUrl);\r\n        });\r\n    }, [\r\n        projectState,\r\n    ]);\r\n    return (\r\n        <>\r\n            <Loading loading={loading} />\r\n            {!loading && iFrameUrl && (\r\n                <LessonRenderView iFrameUrl={iFrameUrl} />\r\n            )}\r\n        </>\r\n    );\r\n};\r\n","import { randomItem } from 'utils/random';\r\nimport { shuffle, distinct_key } from 'utils/arrays';\r\nimport { UploadUrl } from 'upload-api/client/types';\r\nimport { uploadApiConfig } from 'upload-api/client/config';\r\nimport { createSmartUploader, downloadData } from 'upload-api/client/uploader';\r\nimport { toKeyValueArray } from 'utils/objects';\r\nimport { createUploadApiWebClient } from 'upload-api/client/web-client';\r\nimport { DoodleDrawingStorageService, DoodleData, decodeDoodleDrawing, encodeDoodleDrawing, DoodleScoreVote, DoodleScore, DoodleUserDrawingDataJson, DoodleUserVotesDataJson, DoodleSummaryDataJson } from './doodle';\r\nimport { doodleStoragePaths } from './doodle-paths';\r\n\r\ntype DoodleStorageData = {\r\n    doodleUploadUrl?: UploadUrl;\r\n    scoresUploadUrl?: UploadUrl;\r\n};\r\n\r\nconst storageAccess = {\r\n    load: (): null | DoodleStorageData => {\r\n        try {\r\n            return JSON.parse(localStorage.getItem(`doodleStorage.v2`) ?? `NULL!{}`);\r\n        } catch{ return null; }\r\n    },\r\n    save: (value: DoodleStorageData) => {\r\n        localStorage.setItem(`doodleStorage.v2`, JSON.stringify(value));\r\n    },\r\n};\r\n\r\n\r\nexport const createDoodleDrawingStorageService = async () => {\r\n\r\n    const remoteDoodle = createSmartUploader<DoodleUserDrawingDataJson>({\r\n        getUploadUrl: async () => storageAccess.load()?.doodleUploadUrl ?? null,\r\n        setUploadUrl: async (x) => storageAccess.save({ ...(storageAccess.load() ?? {}), doodleUploadUrl: x }),\r\n        uploadApiUrl: uploadApiConfig.uploadApiUrl,\r\n        uploadUrlPrefix: doodleStoragePaths.doodleDrawingsPrefix,\r\n    });\r\n    const remoteVotes = createSmartUploader<DoodleUserVotesDataJson>({\r\n        getUploadUrl: async () => storageAccess.load()?.scoresUploadUrl ?? null,\r\n        setUploadUrl: async (x) => storageAccess.save({ ...(storageAccess.load() ?? {}), scoresUploadUrl: x }),\r\n        uploadApiUrl: uploadApiConfig.uploadApiUrl,\r\n        uploadUrlPrefix: doodleStoragePaths.doodleVotesPrefix,\r\n    });\r\n\r\n    const getSummaryData = async () => {\r\n        try {\r\n            let uploadUrl = storageAccess.load()?.doodleUploadUrl;\r\n\r\n            if (!uploadUrl) {\r\n                const uploadApiWebClient = createUploadApiWebClient(uploadApiConfig);\r\n                uploadUrl = (await uploadApiWebClient.createUploadUrl({})).uploadUrl;\r\n            }\r\n\r\n            const serverUrl = uploadUrl?.getUrl.replace(uploadUrl.relativePath, ``);\r\n            const summaryUrl = `${serverUrl}${doodleStoragePaths.doodleSummary}`;\r\n            console.log(`getSummaryData`, { uploadUrl, serverUrl, summaryUrl });\r\n\r\n            const summaryDataRaw = await downloadData(summaryUrl) as DoodleSummaryDataJson;\r\n            const summaryData = {\r\n                doodles: summaryDataRaw.doodles.map(x => ({\r\n                    key: x.k,\r\n                    prompt: x.p,\r\n                    timestamp: x.t,\r\n                    drawing: decodeDoodleDrawing(x.d),\r\n                    score: x.s,\r\n                })),\r\n            };\r\n            return summaryData;\r\n        } catch{\r\n            return { doodles: [] };\r\n        }\r\n    };\r\n    const summaryData = await getSummaryData();\r\n\r\n    const memory = {\r\n        doodles: [] as DoodleData[],\r\n        doodleScores: [] as DoodleScore[],\r\n        doodleVotes: [] as DoodleScoreVote[],\r\n    };\r\n\r\n\r\n    // Load from server\r\n    memory.doodles = (await remoteDoodle.load())?.doodles.map(x => ({\r\n        key: x.k,\r\n        prompt: x.p,\r\n        timestamp: x.t,\r\n        drawing: x.d ? decodeDoodleDrawing(x.d) : (x as unknown as DoodleData).drawing,\r\n    })) ?? [];\r\n    memory.doodleVotes = (await remoteVotes.load())?.doodleVotes ?? [];\r\n\r\n    const voteTotals = {} as { [key: string]: number };\r\n    // memory.doodleVotes.forEach(x => { voteTotals[x.k] = (voteTotals[x.k] ?? 0) + 1; });\r\n    summaryData.doodles.forEach(x => { voteTotals[x.key] = (voteTotals[x.key] ?? 0) + x.score; });\r\n    memory.doodleScores = toKeyValueArray(voteTotals).map(x => ({\r\n        doodleKey: x.key,\r\n        score: x.value,\r\n    }));\r\n\r\n    const service: DoodleDrawingStorageService = {\r\n        saveDrawing: async (prompt, drawing) => {\r\n            const doodle = { key: `${prompt.substr(0, 8)}:${Date.now()}:${Math.floor(Math.random() * 999999)}`, drawing, prompt, timestamp: Date.now() };\r\n            memory.doodles.push(doodle);\r\n\r\n            // Save to server\r\n            setTimeout(async () => {\r\n                await remoteDoodle.save({\r\n                    doodles: memory.doodles.map(x => ({\r\n                        k: x.key,\r\n                        p: x.prompt,\r\n                        t: x.timestamp,\r\n                        d: encodeDoodleDrawing(x.drawing),\r\n                    })),\r\n                });\r\n            });\r\n        },\r\n        saveBestDrawingSelection: async (doodle) => {\r\n            memory.doodleVotes.push({\r\n                k: doodle.key,\r\n                t: Date.now(),\r\n            });\r\n\r\n            let d = memory.doodleScores.find(x => x.doodleKey === doodle.key);\r\n            if (!d) {\r\n                d = {\r\n                    doodleKey: doodle.key,\r\n                    score: 0,\r\n                };\r\n                memory.doodleScores.push(d);\r\n            }\r\n            d.score = (d.score ?? 0) + 1;\r\n\r\n            // Save to server\r\n            setTimeout(async () => {\r\n                await remoteVotes.save({\r\n                    doodleVotes: memory.doodleVotes,\r\n                });\r\n            });\r\n        },\r\n        getDrawings: async (prompt, options) => {\r\n            const {\r\n                includeOtherPrompts = false,\r\n                maxCount = 4,\r\n            } = options ?? {};\r\n\r\n            const allDoodles = distinct_key([...summaryData.doodles, ...memory.doodles.map(x => ({ ...x, score: memory.doodleScores.find(s => s.doodleKey === x.key)?.score ?? 0 }))], x => x.key);\r\n\r\n            const samePromptDrawings = allDoodles.filter(x => x.prompt === prompt).sort((a, b) => -(a.score - b.score));\r\n            console.log(`getDrawings`, { samePromptDrawings });\r\n\r\n            const otherPromptDrawings = includeOtherPrompts ? allDoodles.filter(x => x.prompt !== prompt) : [];\r\n            const allDrawings =\r\n                includeOtherPrompts ? [randomItem(samePromptDrawings), ...shuffle(otherPromptDrawings).slice(0, maxCount - 1)]\r\n                    : samePromptDrawings;\r\n            const drawings = shuffle(allDrawings).slice(0, maxCount);\r\n            return { doodles: drawings };\r\n        },\r\n        getAllDrawings: async () => {\r\n            const allDoodles = distinct_key([...summaryData.doodles, ...memory.doodles.map(x => ({ ...x, score: memory.doodleScores.find(s => s.doodleKey === x.key)?.score ?? 0 }))], x => x.key);\r\n            return { doodles: allDoodles };\r\n        },\r\n    };\r\n\r\n    return service;\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { View, Text, TouchableOpacity } from 'react-native-lite';\r\nimport { useAutoLoadingError } from 'utils-react/hooks';\r\nimport { UserDataService, UserProfileInfo } from './user-data-service';\r\nimport { UserProfileManagerView } from './user-profile-manager-view';\r\n\r\nconst styles = {\r\n    container: {\r\n        flexDirection: `row`,\r\n        flexWrap: `wrap`,\r\n        justifyContent: `space-around`,\r\n    },\r\n    profileContainer: {\r\n        flexDirection: `column`,\r\n        alignItems: `center`,\r\n    },\r\n    profileCharacterView: {\r\n        width: 80,\r\n        height: 80,\r\n        borderWidth: 1,\r\n        borderStyle: `solid`,\r\n        borderColor: `#888888`,\r\n    },\r\n    profileCharacterText: {\r\n        fontSize: 48,\r\n        textAlign: `center`,\r\n    },\r\n    profileNameView: {\r\n    },\r\n    profileNameText: {\r\n\r\n    },\r\n} as const;\r\n\r\nexport const UserProfileSelectionView = (props: { onUserSelected: () => void }) => {\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const [userProfiles, setUserProfiles] = useState(null as null | UserProfileInfo[]);\r\n    const [isManagerVisible, setIsManagerVisible] = useState(false);\r\n\r\n    const reload = () => doWork(async (stopIfObsolete) => {\r\n        await UserDataService.get().setup();\r\n        stopIfObsolete();\r\n\r\n        const profiles = await UserDataService.get().getUserProfiles();\r\n        setUserProfiles(profiles);\r\n    });\r\n\r\n    const selectUser = (key: string) => doWork(async (stopIfObsolete) => {\r\n        await UserDataService.get().setActiveUser(key);\r\n        props.onUserSelected();\r\n    });\r\n\r\n    const onEditProfiles = () => {\r\n        setIsManagerVisible(true);\r\n    };\r\n\r\n    useEffect(() => {\r\n        reload();\r\n    }, []);\r\n\r\n    if (!userProfiles) {\r\n        return (<></>);\r\n    }\r\n\r\n    if (isManagerVisible) {\r\n        return <UserProfileManagerView onClose={() => { setIsManagerVisible(false); reload(); }} />;\r\n    }\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            {userProfiles.map(x => (\r\n                <TouchableOpacity key={x.key} onPress={() => selectUser(x.key)}>\r\n                    <View style={styles.profileContainer}>\r\n                        <View style={styles.profileCharacterView}>\r\n                            <Text style={styles.profileCharacterText}>{x.emoji ?? ``}</Text>\r\n                        </View>\r\n                        <View style={styles.profileNameView}>\r\n                            <Text style={styles.profileNameText}>{x.name}</Text>\r\n                        </View>\r\n                    </View>\r\n                </TouchableOpacity>\r\n            ))}\r\n            <TouchableOpacity onPress={onEditProfiles}>\r\n                <View style={styles.profileContainer}>\r\n                    <View style={styles.profileCharacterView}>\r\n                        <Text style={styles.profileCharacterText}>{`  `}</Text>\r\n                    </View>\r\n                    <View style={styles.profileNameView}>\r\n                        <Text style={styles.profileNameText}>Edit</Text>\r\n                    </View>\r\n                </View>\r\n            </TouchableOpacity>\r\n        </View>\r\n    );\r\n};\r\n","export type EmojiSkillNode = {\r\n    emoji: string;\r\n    name: string;\r\n    gender: `baby` | `male` | `female`;\r\n    pay: number;\r\n    startEmoji: null | string;\r\n    requirementEmojis: string[];\r\n    debug_totalRequirementsCost?: string;\r\n\r\n    parent: null | EmojiSkillNode;\r\n    children: EmojiSkillNode[];\r\n};\r\nexport type EmojiSkillRequirement = {\r\n    emoji: string;\r\n    cost: number;\r\n};\r\nexport type EmojiSkillTree = {\r\n    allNodes: EmojiSkillNode[];\r\n    allRequirements: EmojiSkillRequirement[];\r\n    root: EmojiSkillNode;\r\n};\r\n\r\n\r\nexport const buildEmojiSkillTree = (): EmojiSkillTree => {\r\n    const maleSkillDoc = `${child_male}\\n${student_male}\\n${skillDoc}`;\r\n    const femaleSkillDoc = `${child_female}\\n${student_female}\\n\\n${getFemaleVariant(skillDoc)}`;\r\n    const maleNodes = parseSkillDoc(maleSkillDoc, `male`);\r\n    const femaleNodes = parseSkillDoc(femaleSkillDoc, `female`);\r\n    const babyNode: EmojiSkillNode = {\r\n        emoji: babyEmoji,\r\n        name: `baby`,\r\n        gender: `baby`,\r\n        pay: 0,\r\n        requirementEmojis: [],\r\n        startEmoji: null,\r\n        parent: null,\r\n        children: [],\r\n    };\r\n    const allNodes = [babyNode, ...maleNodes, ...femaleNodes];\r\n    const root = babyNode;\r\n\r\n    allNodes.forEach(child => {\r\n        const parent = allNodes.find(x => child.startEmoji === x.emoji);\r\n        if (!parent) { return; }\r\n\r\n        parent.children.push(child);\r\n        child.parent = parent;\r\n    });\r\n\r\n    const allRequirements = parseRequirementsDoc(requirementsDoc);\r\n\r\n    allNodes.forEach(node => {\r\n        const allCosts = node.requirementEmojis\r\n            .map(r => allRequirements.find(x => x.emoji === r) ?? { emoji: r, cost: 0 });\r\n\r\n        const summary = allCosts\r\n            .map(x => `${x.emoji} = ${x.cost}`)\r\n            .join(`\\n`);\r\n\r\n        // eslint-disable-next-line unicorn/no-reduce\r\n        const totalCost = allCosts.reduce((out, x) => { out += x.cost; return out; }, 0);\r\n        node.debug_totalRequirementsCost = `${totalCost} =\\n${summary}`;\r\n    });\r\n\r\n    const tree: EmojiSkillTree = {\r\n        allNodes,\r\n        root,\r\n        allRequirements,\r\n    };\r\n\r\n    // const allRequirements = distinct(allNodes.flatMap(x => x.requirementEmojis));\r\n    // const allRequirementsDoc = allRequirements.map(x => `${x} = 0`).join(`\\n`);\r\n\r\n    // console.log(`buildSkillTree`, { tree, maleSkillDoc, femaleSkillDoc });\r\n    return tree;\r\n};\r\n// setTimeout(buildEmojiSkillTree);\r\n\r\nconst parseRequirementsDoc = (doc: string) => {\r\n    const lines = doc.split(`\\n`).map(x => x.trim()).filter(x => x);\r\n    const nodes = lines.map(line => {\r\n        const parts = line.split(`=`).map(x => x.trim()).filter(x => x);\r\n        const r: EmojiSkillRequirement = {\r\n            emoji: parts[0],\r\n            cost: Number.parseInt(parts[1], 10),\r\n        };\r\n        return r;\r\n    });\r\n    return nodes;\r\n};\r\n\r\nconst parseSkillDoc = (doc: string, gender: 'male' | 'female') => {\r\n    const lines = doc.split(`\\n`).map(x => x.trim()).filter(x => x);\r\n    const nodes = lines.map(x => parseSkillLine(x, gender));\r\n    return nodes;\r\n};\r\n\r\nconst parseSkillLine = (skillLine: string, gender: 'male' | 'female'): EmojiSkillNode => {\r\n    const [name, payText, p1] = skillLine.split(`:`).map(x => x.trim());\r\n    const pay = Number.parseInt(payText, 10);\r\n    const [end, p2] = p1.split(`=`).map(x => x.trim());\r\n    const [start, requirementsStr] = p2.split(`+`).map(x => x.trim());\r\n    const requirements = requirementsStr.split(` `).map(x => x.trim()).filter(x => x);\r\n    return { name, pay, emoji: end, startEmoji: start, requirementEmojis: requirements, children: [], parent: null, gender };\r\n};\r\n\r\nconst getFemaleVariant = (emoji: string) => {\r\n    return emoji\r\n        .replace(new RegExp(genderCharCodes.male, `g`), genderCharCodes.female)\r\n        .replace(new RegExp(genderCharCodes.man, `g`), genderCharCodes.woman);\r\n};\r\n\r\nconst genderCharCodes = {\r\n    man: String.fromCodePoint(0x1F468),\r\n    woman: String.fromCodePoint(0x1F469),\r\n    male: String.fromCodePoint(0x1F469),\r\n    female: String.fromCodePoint(0x1F469),\r\n};\r\n\r\nconst babyEmoji = ``;\r\nconst child_male = `boy               : 0 :  =  +           `;\r\nconst child_female = `girl            : 0 :  =  +           `;\r\nconst student_male = `  student_boy   : 0 :  =  +          `;\r\nconst student_female = `student_girl  : 0 :  =  +          `;\r\n\r\nconst skillDoc = `\r\nfactory_worker      :   20000 :  =  +                    \r\nmechanic            :   30000 :  =  +               \r\nconstruction_worker :   75000 :  =  +                             \r\nartist              :   35000 :  =  +                     \r\nsinger              :   40000 :  =  +               \r\nfarmer              :   50000 :  =  +                   \r\ncook                :   40000 :  =  +                   \r\nfirefighter         :   55000 :  =  +          \r\npolice_officer      :   60000 :  =  +                    \r\ndetective           :   70000 :  =  +                 \r\nteacher             :   50000 :  =  +       \r\noffice_worker       :   60000 :  =  +                     \r\ntechnologist        :   80000 :  =  +                      \r\nscientist           :   90000 :  =  +                    \r\njudge               :  120000 :  =  +          \r\nhealth_worker       :  100000 :  =  +          \r\npilot               :  110000 :  =  +            \r\nastronaut           :  130000 :  =  +       \r\n`;\r\n\r\nconst requirementsDoc = `\r\n = 10\r\n = 10\r\n = 20\r\n = 20\r\n = 10\r\n = 20\r\n = 30\r\n = 50\r\n = 25\r\n = 150\r\n = 200\r\n\r\n = 20\r\n = 20\r\n = 10\r\n = 20\r\n = 30\r\n\r\n = 30\r\n = 10\r\n = 20\r\n = 500\r\n = 15\r\n = 350\r\n = 1250\r\n = 7000\r\n = 800\r\n = 10000\r\n\r\n = 20\r\n = 80\r\n = 110\r\n = 25\r\n = 15\r\n = 300\r\n = 700\r\n = 35000\r\n = 150\r\n = 75\r\n = 150\r\n = 3000\r\n = 16000\r\n = 32000\r\n = 100\r\n = 70\r\n = 50\r\n = 35\r\n = 15\r\n = 15\r\n = 80\r\n = 150\r\n = 400\r\n = 150\r\n = 120\r\n = 750\r\n = 320\r\n = 450\r\n = 320\r\n = 1450\r\n = 25\r\n = 10\r\n = 35\r\n = 25\r\n = 30\r\n = 350\r\n = 150\r\n = 120\r\n = 100\r\n = 15000\r\n = 25\r\n = 30\r\n = 20\r\n = 75\r\n = 100\r\n = 50\r\n = 120\r\n = 350\r\n = 120\r\n = 225\r\n = 150\r\n = 250\r\n = 50\r\n = 75\r\n = 135000\r\n = 15000\r\n = 750\r\n = 500\r\n = 1250\r\n = 150\r\n = 55000\r\n = 250\r\n = 55\r\n = 85\r\n = 125\r\n = 25\r\n = 75\r\n = 25\r\n = 60\r\n = 30\r\n = 16000\r\n = 250\r\n = 150\r\n = 50\r\n = 750\r\n = 75\r\n = 150\r\n = 50\r\n = 1500\r\n = 150\r\n = 25\r\n = 3500\r\n = 150\r\n = 300\r\n = 250\r\n = 150\r\n = 650\r\n = 150\r\n = 100\r\n = 120\r\n = 1200\r\n = 1500\r\n = 75000\r\n = 550\r\n = 50\r\n = 850\r\n = 1500000\r\n = 350\r\n = 150000000\r\n`;\r\n","import { createSubscribable } from 'utils/subscribable';\r\nimport { toMap } from 'utils/objects';\r\nimport { buildEmojiSkillTree } from './emoji-skills/emoji-skill-tree';\r\n\r\nexport type EmojiIdleEmotionKind = 'excited' | 'happy' | 'normal' | 'angry' | 'sick' | 'dead';\r\nexport type EmojiIdleState = {\r\n    characterEmoji: string;\r\n    targetEmoji?: string;\r\n    targetOptions?: { emoji: string }[];\r\n    requirementsPurchased?: string[];\r\n    requirementsAvailable?: { emoji: string, cost: number }[];\r\n    requirementsRemaining?: { emoji: string, cost: number }[];\r\n    requirementsNeeded?: { emoji: string, cost: number }[];\r\n    lastPurchaseTimestamp: number;\r\n\r\n    emotion: EmojiIdleEmotionKind;\r\n    lastEmotionTimestamp: number;\r\n\r\n    money: number;\r\n\r\n    multiplier: number;\r\n    lastMultiplierChangeTimestamp: number;\r\n\r\n    townState: {\r\n        characters: {\r\n            characterEmoji: string;\r\n            finishedTimestamp: number;\r\n            // requirementsPurchased: string[];\r\n        }[];\r\n    };\r\n};\r\n\r\nconst storageKey = `EmojiIdleState`;\r\nconst storage = {\r\n    save: (value: EmojiIdleState) => { localStorage.setItem(storageKey, JSON.stringify(value)); },\r\n    load: () => {\r\n        if (!localStorage.getItem(storageKey)) { return null; }\r\n        try {\r\n            return JSON.parse(localStorage.getItem(storageKey) ?? ``);\r\n        } catch{\r\n            return null;\r\n        }\r\n    },\r\n};\r\n\r\nconst createService = () => {\r\n    const skillTree = buildEmojiSkillTree();\r\n    const reqMap = toMap(skillTree.allRequirements.map(x => ({ key: x.emoji, value: x })));\r\n\r\n    const defaultState: EmojiIdleState = {\r\n        characterEmoji: skillTree.root.emoji,\r\n        emotion: `normal`,\r\n        lastEmotionTimestamp: Date.now(),\r\n        money: 0,\r\n        multiplier: 1,\r\n        lastMultiplierChangeTimestamp: Date.now(),\r\n        lastPurchaseTimestamp: Date.now(),\r\n        townState: {\r\n            characters: [],\r\n        },\r\n    };\r\n    let s: EmojiIdleState = storage.load() ?? defaultState;\r\n\r\n    // Load missing state fields\r\n    s = { ...defaultState, ...s };\r\n\r\n    // // Hard code Missing Town Characters for Kids Accounts\r\n    // s.townState = {\r\n    //     // characters: [...skillTree.allNodes.filter(x => x.children.length <= 0).slice(0, 5).map(x => ({\r\n    //     //     characterEmoji: x.emoji,\r\n    //     //     finishedTimestamp: Date.now() - Math.random() * 1000 * 60 * 60 * 24 * 7,\r\n    //     // }))],\r\n    //     characters: [...skillTree.allNodes\r\n    //         .filter(x => x.name === `artist` && x.gender === `female`)\r\n    //         .map(x => ({\r\n    //             characterEmoji: x.emoji,\r\n    //             finishedTimestamp: Math.floor(Date.now() - 0.25 * 1000 * 60 * 60 * 24),\r\n    //         }))],\r\n    // };\r\n\r\n    const sub = createSubscribable<EmojiIdleState>(s);\r\n\r\n    const changeState = (partialState: Partial<EmojiIdleState>) => {\r\n        // console.log(`changePetState`, { partialState, before: { ...s } });\r\n        s = { ...s, ...partialState };\r\n        sub.onStateChange(s);\r\n        storage.save(s);\r\n    };\r\n\r\n    const rewardInner = (value: number) => {\r\n        // max multiplier - keeps things more linear?\r\n        const maxMultiplier = 100;\r\n        changeState({\r\n            money: s.money + s.multiplier,\r\n            multiplier: Math.min(maxMultiplier, s.multiplier + value),\r\n            lastMultiplierChangeTimestamp: Date.now(),\r\n        });\r\n    };\r\n\r\n    const punish = () => {\r\n        // This is the only way to lose multiplier\r\n        changeState({\r\n            multiplier: Math.max(1, s.multiplier - 5),\r\n            lastMultiplierChangeTimestamp: Date.now(),\r\n        });\r\n    };\r\n\r\n    const selectOption = (emoji: string) => {\r\n        // console.log(`selectOption`, { emoji });\r\n\r\n        // Choose character\r\n        if (s.targetOptions?.find(x => x.emoji === emoji)) {\r\n            if (emoji === skillTree.root.emoji) {\r\n                // Add finished character to town\r\n                s.townState.characters.push({\r\n                    characterEmoji: s.characterEmoji,\r\n                    finishedTimestamp: Date.now(),\r\n                });\r\n            }\r\n\r\n            changeState({\r\n                targetEmoji: emoji,\r\n                targetOptions: undefined,\r\n                emotion: `excited`,\r\n                lastEmotionTimestamp: Date.now(),\r\n                lastPurchaseTimestamp: Date.now(),\r\n\r\n                money: 0,\r\n                // money: emoji === skillTree.root.emoji ? 0 : s.money,\r\n            });\r\n        }\r\n\r\n        // Purchases\r\n        const r = s.requirementsAvailable?.find(x => x.emoji === emoji);\r\n        if (r && r.cost <= s.money) {\r\n            // Purchase \r\n            changeState({\r\n                requirementsPurchased: [...s.requirementsPurchased ?? [], r.emoji],\r\n                requirementsRemaining: undefined,\r\n                money: s.money - r.cost,\r\n                requirementsAvailable: undefined,\r\n                emotion: `excited`,\r\n                lastEmotionTimestamp: Date.now(),\r\n                lastPurchaseTimestamp: Date.now(),\r\n            });\r\n        }\r\n\r\n        // Ignore\r\n    };\r\n\r\n    // Update state\r\n    setInterval(() => {\r\n        const second = 1000;\r\n        const minute = 60 * second;\r\n        const hour = 60 * minute;\r\n\r\n        // console.log(`emoji - idle - service update`, {});\r\n\r\n        // This is too powerful against slow players\r\n        // // Decrease Multiplier over time\r\n        // const decTime = 3 * second;\r\n        // if (s.multiplier > 1 && Date.now() > s.lastMultiplierChangeTimestamp + decTime) {\r\n        //     const timeDelta = Date.now() - s.lastMultiplierChangeTimestamp;\r\n        //     const multChange = Math.floor(timeDelta / decTime);\r\n\r\n        //     // console.log(`emoji - idle - service`, { timeDelta, multChange });\r\n        //     changeState({\r\n        //         multiplier: Math.max(1, s.multiplier - multChange),\r\n        //         lastMultiplierChangeTimestamp: Date.now(),\r\n        //     });\r\n        // }\r\n\r\n        // Choose target\r\n        if (!s.targetEmoji && !s.targetOptions) {\r\n            const skillNode = skillTree.allNodes.find(x => x.emoji === s.characterEmoji);\r\n            if (skillNode) {\r\n                let t = skillNode.children.map(x => ({ emoji: x.emoji }));\r\n                const remainingSkills = t.filter(x => !s.townState.characters.find(c => c.characterEmoji));\r\n\r\n                if (remainingSkills.length > 0) {\r\n                    t = remainingSkills;\r\n                }\r\n\r\n                if (t.length === 0) {\r\n                    // Top of skill tree\r\n                    changeState({\r\n                        targetOptions: [{ emoji: skillTree.root.emoji }],\r\n                    });\r\n                }\r\n                // else if (t.length === 1) {\r\n                //     // Auto select\r\n                //     changeState({\r\n                //         targetEmoji: t[0].emoji,\r\n                //     });\r\n                // } \r\n                else {\r\n                    changeState({\r\n                        targetOptions: t,\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        // Populate Available Requirements\r\n        if (s.targetEmoji) {\r\n            const targetSkillNode = skillTree.allNodes.find(x => x.emoji === s.targetEmoji);\r\n            if (targetSkillNode) {\r\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n                const reqs = targetSkillNode.requirementEmojis.map(x => reqMap.get(x)).filter(x => x).map(x => x!);\r\n                const reqs_remaining = reqs.filter(x => !s.requirementsPurchased?.includes(x.emoji));\r\n                reqs_remaining.sort((a, b) => a.cost - b.cost);\r\n                const reqs_available = reqs_remaining.filter(x => x.cost <= s.money);\r\n\r\n                if (reqs_available.length !== s.requirementsAvailable?.length) {\r\n                    changeState({\r\n                        requirementsNeeded: reqs,\r\n                        requirementsAvailable: reqs_available,\r\n                    });\r\n                }\r\n\r\n                if (reqs_remaining.length !== s.requirementsRemaining?.length) {\r\n                    changeState({\r\n                        requirementsRemaining: reqs_remaining,\r\n                    });\r\n                }\r\n\r\n                // Target completed\r\n                if (reqs_remaining.length <= 0) {\r\n                    changeState({\r\n                        characterEmoji: s.targetEmoji,\r\n                        targetEmoji: undefined,\r\n                        targetOptions: undefined,\r\n                        requirementsAvailable: undefined,\r\n                        requirementsNeeded: undefined,\r\n                        requirementsPurchased: undefined,\r\n                    });\r\n                }\r\n            }\r\n\r\n            // Emotion\r\n            if (Date.now() > (s.lastEmotionTimestamp ?? 0) + 15 * second) {\r\n                // TODO: Sickness\r\n                const emotion = Date.now() > (s.lastPurchaseTimestamp ?? 0) + 5 * minute ? `angry`\r\n                    : `normal`;\r\n\r\n                if (s.emotion !== emotion) {\r\n                    changeState({ emotion, lastEmotionTimestamp: Date.now() });\r\n                }\r\n            }\r\n        }\r\n\r\n    }, 1000);\r\n\r\n    return {\r\n        subscribePetStateChange: sub.subscribe,\r\n        reward: () => rewardInner(1),\r\n        reward_major: () => rewardInner(10),\r\n        reward_extreme: () => rewardInner(100),\r\n        punish,\r\n\r\n        selectOption,\r\n    };\r\n};\r\n\r\nexport type EmojiIdleService = ReturnType<typeof createService>;\r\n\r\nconst serviceState = {\r\n    instance: null as null | EmojiIdleService,\r\n};\r\nexport const EmojiIdleService = {\r\n    get: () => {\r\n        // eslint-disable-next-line no-return-assign\r\n        return serviceState.instance ?? (serviceState.instance = createService());\r\n    },\r\n    reset: () => {\r\n        serviceState.instance = createService();\r\n    },\r\n};\r\n","import React, { useState, useEffect, useRef } from 'react';\r\nimport { View, Text, TouchableOpacity } from 'react-native-lite';\r\nimport { shuffle } from 'utils/arrays';\r\nimport { EmojiIdleService, EmojiIdleState, EmojiIdleEmotionKind } from './emoji-idle-service';\r\nimport { buildEmojiSkillTree } from './emoji-skills/emoji-skill-tree';\r\n\r\nexport const styles = {\r\n    container: {\r\n        height: 40,\r\n    },\r\n    fixed: {\r\n        position: `fixed`,\r\n        top: 0, right: 0, left: 0,\r\n        zIndex: 1000,\r\n    },\r\n    inner: {\r\n        position: `relative`,\r\n        height: 40,\r\n    },\r\n    emotionEmoji: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 24,\r\n    },\r\n    characterEmoji: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 24,\r\n    },\r\n    characterEmoji_small: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 16,\r\n    },\r\n    costText: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 16,\r\n        color: `#00FF00`,\r\n    },\r\n    costText_small: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 10,\r\n        color: `#00FF00`,\r\n    },\r\n    targetCharacterEmoji: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 16,\r\n    },\r\n    objectEmoji: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 12,\r\n    },\r\n\r\n    money: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 20,\r\n        color: `#FFFF00`,\r\n        marginLeft: 8,\r\n    },\r\n    money_small: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 16,\r\n        color: `#FFFF00`,\r\n    },\r\n    multiplier: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 14,\r\n        color: `#FF00FF`,\r\n        marginLeft: 8,\r\n    },\r\n    foodText: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 12,\r\n        color: `#333300`,\r\n    },\r\n} as const;\r\n\r\nexport const EmojiIdleView = (props: {}) => {\r\n    const [gameState, setGameState] = useState(null as null | EmojiIdleState);\r\n    const [isExpanded, setIsExpanded] = useState(false);\r\n    useEffect(() => {\r\n        const service = EmojiIdleService.get();\r\n        const sub = service.subscribePetStateChange(setGameState);\r\n        return () => sub.unsubscribe();\r\n    });\r\n\r\n    if (isExpanded && gameState) {\r\n        return (\r\n            <TownView gameState={gameState} onClose={() => setIsExpanded(false)} />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            <View style={styles.fixed}>\r\n                <View style={styles.inner}>\r\n                    <EmojiCharacterView\r\n                        emoji={gameState?.characterEmoji ?? ``}\r\n                        targetEmoji={gameState?.targetEmoji ?? ``}\r\n                        emotion={gameState?.emotion ?? null}\r\n                        purchased={gameState?.requirementsPurchased ?? []}\r\n                        onPress={() => setIsExpanded(s => !s)}\r\n                    />\r\n                    {gameState && <CommandsView gameState={gameState} />}\r\n                    {/* {gameState && gameState.food > 0 && [...new Array(gameState.food)].map((x, i) => (\r\n                        // eslint-disable-next-line react/no-array-index-key\r\n                        <View key={`${i}`} style={{ position: `absolute`, transform: `translate(${100 + i * 87 % 100}px,${4 + i * 43 % 12}px)` }} >\r\n                            <Text style={styles.foodText}>{getFoodVariant(i)}</Text>\r\n                        </View>\r\n                    ))} */}\r\n                </View>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n\r\nexport const townStyles = {\r\n    container: {\r\n        background: `#555555`,\r\n    },\r\n    payText: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 14,\r\n        color: `#FFFFFF`,\r\n    },\r\n    payText_disabled: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 14,\r\n        color: `#CCCCCC`,\r\n    },\r\n    moneyText: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 16,\r\n        color: `#FFFF00`,\r\n    },\r\n    townMoneyText: {\r\n        fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n        fontSize: 16,\r\n        color: `#00FF00`,\r\n    },\r\n} as const;\r\n\r\nconst skillTree = buildEmojiSkillTree();\r\nconst TownView = ({ gameState, onClose }: { gameState: EmojiIdleState, onClose: () => void }) => {\r\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n    const townPersons = gameState.townState.characters.map(x => ({\r\n        character: x,\r\n        skill: skillTree.allNodes.find(n => n.emoji === x.characterEmoji) ?? skillTree.root,\r\n    }))\r\n        .filter(x => x.skill.pay)\r\n        .map(x => ({\r\n            ...x,\r\n            years: (Date.now() - x.character.finishedTimestamp) / (24 * 60 * 60 * 1000),\r\n            money: Math.floor((Date.now() - x.character.finishedTimestamp) / (24 * 60 * 60 * 1000) * x.skill.pay),\r\n        }));\r\n    const missingSkills = skillTree.allNodes.filter(x => x.children.length <= 0 && !gameState.townState.characters.find(t => t.characterEmoji === x.emoji));\r\n    // eslint-disable-next-line unicorn/no-reduce\r\n    const townMoney = townPersons.reduce((out, x) => { out += x.money ?? 0; return out; }, 0);\r\n    return (\r\n        <View style={townStyles.container}>\r\n            <View>\r\n                <View style={{ background: `#333333`, flexDirection: `row`, alignItems: `center` }}>\r\n                    <View style={{ position: `relative`, width: 100, height: 40 }}>\r\n                        <View style={{ position: `absolute`, left: 0, top: 0, flexDirection: `column`, alignItems: `flex-end` }} >\r\n                            <TouchableOpacity onPress={() => onClose()}>\r\n                                <Text style={styles.characterEmoji}>{`  `}</Text>\r\n                            </TouchableOpacity>\r\n                        </View>\r\n                    </View>\r\n                    <View style={{ flex: 1 }} />\r\n                    <View style={{ padding: 4 }}>\r\n                        <Text style={townStyles.townMoneyText}>{`$${(townMoney).toLocaleString()}`}</Text>\r\n                    </View>\r\n                </View>\r\n            </View>\r\n            <View style={{ background: `#333333`, flexDirection: `row`, alignItems: `center` }}>\r\n                <View style={{ position: `relative`, width: 100, height: 40 }}>\r\n                    <EmojiCharacterView\r\n                        emoji={gameState?.characterEmoji ?? ``}\r\n                        targetEmoji={gameState?.targetEmoji ?? ``}\r\n                        emotion={gameState?.emotion ?? null}\r\n                        purchased={gameState?.requirementsPurchased ?? []}\r\n                        onPress={() => onClose()}\r\n                    />\r\n                </View>\r\n            </View>\r\n            {/* Finished Characters */}\r\n            {townPersons.map(x => (\r\n                <View style={{ background: `#333333`, flexDirection: `row`, alignItems: `center` }}>\r\n                    <View style={{ position: `relative`, width: 100, height: 40 }}>\r\n                        <EmojiCharacterView\r\n                            emoji={x.character.characterEmoji}\r\n                            targetEmoji=''\r\n                            emotion='happy'\r\n                            purchased={x.skill?.requirementEmojis ?? []}\r\n                        />\r\n                    </View>\r\n                    <View style={{ padding: 4 }}>\r\n                        <Text style={townStyles.payText}>{`$${(x.skill?.pay ?? 0).toLocaleString()}`}</Text>\r\n                    </View>\r\n                    <View style={{ padding: 4 }}>\r\n                        <Text style={townStyles.payText}>{`x${(x.years).toFixed(1)}`}</Text>\r\n                    </View>\r\n                    <View style={{ flex: 1 }} />\r\n                    <View style={{ padding: 4 }}>\r\n                        <Text style={townStyles.moneyText}>{`$${(x.money).toLocaleString()}`}</Text>\r\n                    </View>\r\n                </View>\r\n            ))}\r\n            {/* Missing Characters */}\r\n            {missingSkills.map(x => (\r\n                <View style={{ background: `#555555`, flexDirection: `row`, alignItems: `center` }}>\r\n                    <View style={{ position: `relative`, width: 100, height: 40, opacity: 0.5 }}>\r\n                        <EmojiCharacterView\r\n                            emoji={x.emoji}\r\n                            targetEmoji=''\r\n                            emotion={null}\r\n                            purchased={[]}\r\n                        />\r\n                    </View>\r\n                    <View style={{ padding: 4 }}>\r\n                        <Text style={townStyles.payText_disabled}>{`$${(x.pay).toLocaleString()}`}</Text>\r\n                    </View>\r\n                </View>\r\n            ))}\r\n        </View>\r\n    );\r\n};\r\n\r\nconst CommandsView = ({ gameState }: { gameState: EmojiIdleState }) => {\r\n\r\n    const [offset, setOffset] = useState(0);\r\n    useEffect(() => {\r\n        setOffset(0);\r\n    }, [gameState.targetOptions, gameState.requirementsAvailable]);\r\n\r\n    if (gameState.targetOptions && gameState.targetOptions.length > 0) {\r\n        const listSize = 4;\r\n        const targetOptionsLength = gameState.targetOptions.length;\r\n        return (\r\n            <View style={{ position: `absolute`, top: 0, left: 0, right: 0 }} >\r\n                <View style={{ flexDirection: `row`, justifyContent: `center` }}>\r\n                    {gameState.targetOptions.slice(offset, offset + listSize).map(x => (\r\n                        <TouchableOpacity key={x.emoji} onPress={() => EmojiIdleService.get().selectOption(x.emoji)}>\r\n                            <View>\r\n                                <Text style={styles.characterEmoji}>{x.emoji}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                    {targetOptionsLength > listSize && (\r\n                        <TouchableOpacity onPress={() => setOffset(s => { const i = s + 5; return i >= targetOptionsLength ? 0 : i; })}>\r\n                            <View>\r\n                                <Text style={styles.characterEmoji}>{offset + listSize < targetOptionsLength ? `` : ``}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    )}\r\n                </View>\r\n            </View>\r\n        );\r\n    }\r\n\r\n    // if (gameState.requirementsAvailable && gameState.requirementsAvailable.length > 0) {\r\n    //     return (\r\n    //         <View style={{ position: `absolute`, top: 0, left: 0, right: 0 }} >\r\n    //             <View style={{ alignSelf: `center`, alignItems: `center`, background: `#222222`, borderRadius: 4, padding: 4 }}>\r\n    //                 <View style={{ flexDirection: `row`, justifyContent: `center` }}>\r\n    //                     {gameState.requirementsAvailable.slice(0, 5).map(x => (\r\n    //                         <TouchableOpacity key={x.emoji} onPress={() => EmojiIdleService.get().selectOption(x.emoji)}>\r\n    //                             <View style={{ flexDirection: `column`, margin: 4, alignItems: `center`, background: `#333333`, borderRadius: 4 }}>\r\n    //                                 <Text style={styles.characterEmoji}>{x.emoji}</Text>\r\n    //                                 <Text style={styles.costText}>{`$${x.cost.toLocaleString()}`}</Text>\r\n    //                             </View>\r\n    //                         </TouchableOpacity>\r\n    //                     ))}\r\n    //                 </View>\r\n    //                 <Text style={styles.money_small}>{`$${(gameState.money ?? 0).toLocaleString()}`}</Text>\r\n    //             </View>\r\n    //         </View>\r\n    //     );\r\n    // }\r\n\r\n    const reqs = gameState.requirementsRemaining ?? [];\r\n    const reqShowLength = 3;\r\n    return (\r\n        <View>\r\n            <ScoreView {...gameState ?? { money: 0, multiplier: 1 }} />\r\n            <View style={{ position: `absolute`, left: 90, top: 0, flexDirection: `row`, zIndex: 10 }} >\r\n                {reqs.slice(0, reqShowLength).map(x => {\r\n                    const canBuy = x.cost <= gameState.money;\r\n                    return (\r\n                        <TouchableOpacity key={x.emoji} onPress={() => EmojiIdleService.get().selectOption(x.emoji)}>\r\n                            <View style={{ flexDirection: `column`, alignItems: `center`, background: canBuy ? `#003300` : `#553300`, borderRadius: 4, paddingLeft: 2, paddingRight: 2 }}>\r\n                                <Text style={styles.characterEmoji_small}>{x.emoji}</Text>\r\n                                <Text style={{ ...styles.costText_small, ...(canBuy ? {} : { color: `#FF0000` }) }}>{`$${x.cost.toLocaleString()}`}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    );\r\n                })}\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n\r\n\r\nconst ScoreView = ({ money, multiplier }: { money: number, multiplier: number }) => {\r\n\r\n    const [moneySizeOffset, setMoneySizeOffset] = useState(0);\r\n    const [multiplierSizeOffset, setMultiplierSizeOffset] = useState(0);\r\n    const lastMultiplier = useRef(multiplier);\r\n    const [multiplierDelta, setMultiplierDelta] = useState(0);\r\n\r\n\r\n    useEffect(() => {\r\n        setMoneySizeOffset(5);\r\n\r\n        const update = () => {\r\n            setMoneySizeOffset(s => {\r\n                if (s > 0) {\r\n                    return s - 1;\r\n                }\r\n                clearInterval(id);\r\n                return 0;\r\n            });\r\n        };\r\n        update();\r\n\r\n        const id = setInterval(update, 25);\r\n        return () => clearInterval(id);\r\n    }, [money]);\r\n\r\n    useEffect(() => {\r\n        setMultiplierSizeOffset(10);\r\n        setMultiplierDelta(multiplier - lastMultiplier.current);\r\n        lastMultiplier.current = multiplier;\r\n\r\n        const update = () => {\r\n            setMultiplierSizeOffset(s => {\r\n                if (s > 0) {\r\n                    return s - 1;\r\n                }\r\n                clearInterval(id);\r\n                return 0;\r\n            });\r\n        };\r\n        update();\r\n\r\n        const id = setInterval(update, 25);\r\n        return () => clearInterval(id);\r\n    }, [multiplier]);\r\n\r\n\r\n    return (\r\n        <View style={{ position: `absolute`, top: 0, right: 4 }} >\r\n            <View style={{ flexDirection: `row`, justifyContent: `flex-end` }}>\r\n                <View style={{ transform: `translate(-${moneySizeOffset}px,${2 * moneySizeOffset}px) scale(${moneySizeOffset * 0.1 + 1})` }}>\r\n                    <Text style={styles.money}>{`$${(money ?? 0).toLocaleString()}`}</Text>\r\n                </View>\r\n                <View style={{ transform: `translate(-${multiplierSizeOffset}px,${2 * multiplierSizeOffset}px) scale(${multiplierSizeOffset * 0.1 + 1})` }}>\r\n                    <Text style={{ ...styles.multiplier, ...(multiplierDelta < -5 ? { color: `#FF0000` } : multiplierDelta < 0 ? { color: `#FFFF00` } : { color: `#00FF00` }) }}>{`x${(multiplier ?? 1).toLocaleString()}`.padStart(4, ` `)}</Text>\r\n                </View>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n\r\nconst EmojiCharacterView = ({ emoji, targetEmoji, emotion, purchased, onPress }: { emoji: string, targetEmoji: string, emotion: null | EmojiIdleEmotionKind, purchased: string[], onPress?: () => void }) => {\r\n    return (\r\n        <>\r\n            <PurchasedView purchased={purchased} />\r\n            <View style={{ position: `absolute`, left: 20, top: 0, flexDirection: `column`, alignItems: `flex-end` }} >\r\n                <TouchableOpacity onPress={() => onPress?.()}>\r\n                    <EmotionView emotion={emotion ?? null} emoji={emoji} />\r\n                </TouchableOpacity>\r\n            </View>\r\n            <View style={{ position: `absolute`, left: 66, top: 0, flexDirection: `column`, alignItems: `flex-end` }} >\r\n                <Text style={styles.targetCharacterEmoji}>{`${targetEmoji}`}</Text>\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n\r\nconst PurchasedView = ({ purchased }: { purchased: string[] }) => {\r\n    const [offset, setOffset] = useState(0);\r\n    useEffect(() => {\r\n        const update = () => {\r\n            setOffset(s => s + 1);\r\n        };\r\n        update();\r\n\r\n        const id = setInterval(update, 200);\r\n        return () => clearInterval(id);\r\n    }, [purchased.length]);\r\n\r\n    return (\r\n        <>\r\n            {purchased.map((x, i) => (\r\n                <View key={x} style={{ position: `absolute`, left: 0, top: 0, flexDirection: `column`, alignItems: `flex-end` }} >\r\n                    <View style={{ transform: `translate(${((i * 17) + offset) % 60}px,${((i * 5) + offset) % 24}px)` }}>\r\n                        <Text style={styles.objectEmoji}>{`${x}`}</Text>\r\n                    </View>\r\n                </View>\r\n            ))}\r\n        </>\r\n    );\r\n};\r\n\r\nconst EmotionView = ({ emotion, emoji }: { emotion: null | EmojiIdleEmotionKind, emoji: string }) => {\r\n    const [display, setDisplay] = useState({ text: emoji, isEmotion: false });\r\n    useEffect(() => {\r\n        if (!emotion) {\r\n            return () => { };\r\n        }\r\n        let showEmotion = false;\r\n        let variant = 0;\r\n        const update = () => {\r\n            showEmotion = !showEmotion;\r\n            if (!showEmotion) {\r\n                setDisplay({ text: emoji, isEmotion: false });\r\n                return;\r\n            }\r\n            setDisplay({ text: getEmoji(emotion, variant++), isEmotion: true });\r\n        };\r\n        update();\r\n\r\n        const id = setInterval(update, 3000);\r\n        return () => clearInterval(id);\r\n    }, [emotion, emoji]);\r\n\r\n    return (\r\n        <Text style={display.isEmotion ? styles.emotionEmoji : styles.characterEmoji}>{display.text}</Text>\r\n    );\r\n};\r\n\r\n// \r\n// \r\n// \r\n// \r\n// \r\nconst getEmoji = (emotion: null | EmojiIdleEmotionKind, variant: number) => {\r\n    // console.log(`getEmoji`, { emotion, variant });\r\n\r\n    // Setup State\r\n    if (!emotion) { return ``; }\r\n\r\n    if (emotion === `excited`) {\r\n        const items = shuffle([``, ``, ``, ``, ``, ``, ``]);\r\n        return items[variant % items.length];\r\n    }\r\n    if (emotion === `happy`) {\r\n        const items = [``, ``, ``, ``, ``];\r\n        return items[variant % items.length];\r\n    }\r\n    if (emotion === `normal`) {\r\n        // const items = [``, ``, ``, ``, ``, ``, ``];\r\n        const items = [``, ``, ``, ``];\r\n        return items[variant % items.length];\r\n    }\r\n    if (emotion === `angry`) {\r\n        const items = [``, ``, ``, ``, ``, ``, ``];\r\n        return items[variant % items.length];\r\n    }\r\n    if (emotion === `sick`) {\r\n        const items = [``, ``, ``, ``, ``, ``, ``];\r\n        return items[variant % items.length];\r\n    }\r\n    if (emotion === `dead`) {\r\n        const items = [``, ``, ``];\r\n        return items[variant % items.length];\r\n    }\r\n\r\n    // Unknown\r\n    return ``;\r\n};\r\n\r\nconst foodItems = shuffle(` \r\n                             \r\n                            \r\n                       `\r\n    .replace(`\\n`, ` `).split(` `).map(x => x.trim()).filter(x => x));\r\n\r\nconst getFoodVariant = (variant: number) => {\r\n    return foodItems[variant % foodItems.length];\r\n};\r\n","import React, { useEffect, useState } from 'react';\r\nimport { UserDataService, UserProfileInfo } from 'user-data-service/user-data-service';\r\nimport { useAutoLoadingError } from 'utils-react/hooks';\r\nimport { UserProfileManagerView } from 'user-data-service/user-profile-manager-view';\r\nimport { UserProfileSelectionView } from 'user-data-service/user-profile-selection-view';\r\nimport { View, Text, TouchableOpacity, Platform } from 'react-native-lite';\r\nimport { ProblemService } from '../problems/problems-service';\r\nimport { EmojiIdleView } from './emoji-idle-game/emoji-idle-view';\r\nimport { EmojiIdleService } from './emoji-idle-game/emoji-idle-service';\r\n\r\nexport const ProgressGameService = {\r\n    onCorrect: () => {\r\n        EmojiIdleService.get().reward();\r\n    },\r\n    onCompleteSection: () => {\r\n        EmojiIdleService.get().reward_major();\r\n    },\r\n    onCompleteSubject: () => {\r\n        EmojiIdleService.get().reward_extreme();\r\n    },\r\n    onWrong: () => {\r\n        EmojiIdleService.get().punish();\r\n    },\r\n};\r\n\r\nexport const createProgressGameProblemService = (problemSource: ProblemService, options?: {}): ProblemService => {\r\n    const service: ProblemService = {\r\n        ...problemSource,\r\n        recordAnswer: (problem, answer) => {\r\n            // (async () => UserDataService.get().markUserDataChanged())();\r\n\r\n            if (answer.isCorrect) {\r\n                ProgressGameService.onCorrect();\r\n\r\n                if (!problem.isReview && problem.isLastOfSubject) {\r\n                    ProgressGameService.onCompleteSubject();\r\n\r\n                    // Save User Data (delayed to let other state update)\r\n                    setTimeout(async () => {\r\n                        await UserDataService.get().uploadUserData();\r\n                    }, 1000);\r\n                } else if (!problem.isReview && problem.isLastOfSection) {\r\n                    ProgressGameService.onCompleteSection();\r\n\r\n                    // Save User Data (delayed to let other state update)\r\n                    setTimeout(async () => {\r\n                        await UserDataService.get().uploadUserData();\r\n                    }, 1000);\r\n                }\r\n\r\n            } else {\r\n                ProgressGameService.onWrong();\r\n            }\r\n\r\n            return problemSource.recordAnswer(problem, answer);\r\n        },\r\n    };\r\n    return service;\r\n};\r\n\r\nexport const ProgressGameView = () => {\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const [hasSelectedProfile, setHasSelectedProfile] = useState(false);\r\n    const [userProfile, setUserProfile] = useState(null as null | UserProfileInfo);\r\n\r\n    // Save UserData after Purchase\r\n    const subscribeToSaveOnPurchase = () => {\r\n        let lastPurchase = Date.now();\r\n        const subscription = EmojiIdleService.get().subscribePetStateChange((x) => {\r\n            console.log(`ProgressGameView subscribePetStateChange`, { lastPurchase, x });\r\n            if (lastPurchase >= x.lastPurchaseTimestamp) { return; }\r\n            lastPurchase = x.lastPurchaseTimestamp;\r\n            // Save User Data (delayed to let other state update)\r\n            setTimeout(async () => {\r\n                await UserDataService.get().uploadUserData();\r\n            }, 1000);\r\n        });\r\n        return subscription;\r\n    };\r\n\r\n    useEffect(() => {\r\n        setUserProfile(UserDataService.get().getActiveUser() ?? null);\r\n        EmojiIdleService.reset();\r\n\r\n        const sub = subscribeToSaveOnPurchase();\r\n        return () => {\r\n            sub.unsubscribe();\r\n        };\r\n    }, [hasSelectedProfile]);\r\n\r\n    useEffect(() => {\r\n        // Load User Data\r\n        doWork(async () => {\r\n            await UserDataService.get().setup();\r\n            EmojiIdleService.reset();\r\n        });\r\n    }, []);\r\n\r\n    const onChangeProfile = () => {\r\n        // setHasSelectedProfile(false);\r\n        // Force Reload Page\r\n        if (Platform.OS === `web`) {\r\n            window.location.reload();\r\n        }\r\n    };\r\n\r\n    if (loading) {\r\n        return <></>;\r\n    }\r\n\r\n    if (!hasSelectedProfile) {\r\n        return <UserProfileSelectionView onUserSelected={() => setHasSelectedProfile(true)} />;\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <EmojiIdleView />\r\n            <View>\r\n                <TouchableOpacity onPress={onChangeProfile}>\r\n                    <View style={{ flexDirection: `row`, alignItems: `center`, justifyContent: `flex-start`, padding: 4 }}>\r\n                        <Text style={{ fontSize: 32 }}>{userProfile?.emoji ?? ``}</Text>\r\n                        <Text style={{ fontSize: 14 }}>{userProfile?.name ?? ``}</Text>\r\n                    </View>\r\n                </TouchableOpacity>\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n","\r\nexport type EmailAddress = string & { __type: 'email' };\r\nexport const toEmailAddress = (email: string): EmailAddress => {\r\n    return email.trim() as EmailAddress;\r\n};\r\n","\"use strict\"; // Updated from commit 8087b0a - vscode/src/vs/base/common/charCode.ts\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});","/* eslint-disable max-classes-per-file */\r\nexport type ErrorState = { message: string, data?: unknown, error?: unknown, retryCallback?: () => void };\r\n\r\nexport class AppError extends Error implements ErrorState {\r\n    constructor(public message: string, public data?: unknown) {\r\n        super();\r\n    }\r\n}\r\n\r\nexport class ApiError extends Error implements ErrorState {\r\n    constructor(public message: string, public data?: unknown) {\r\n        super();\r\n    }\r\n}\r\n\r\nexport class MockError extends Error implements ErrorState {\r\n    constructor(public message: string, public data?: unknown) {\r\n        super();\r\n    }\r\n}\r\n\r\nexport class NotImplementedError extends Error implements ErrorState {\r\n    constructor(public message: string = `Not Implemented`, public data?: unknown) {\r\n        super();\r\n    }\r\n}\r\n","import { shuffle } from 'utils/arrays';\r\nimport { ProblemService, Problem, ProblemResult } from './problems-service';\r\n\r\nexport const createReviewProblemService = (problemSource: ProblemService, {\r\n    maxNewReviewCount = 3,\r\n    reviewSequencePreviousLength = 1,\r\n    reviewQuestionPrefix = ` `,\r\n    requiredCorrectInRow = 3,\r\n}: {\r\n    maxNewReviewCount?: number;\r\n    reviewSequencePreviousLength?: number;\r\n    reviewQuestionPrefix?: string;\r\n    requiredCorrectInRow?: number;\r\n}): ProblemService => {\r\n    const state = {\r\n        problemSourceHistory: [] as Problem[],\r\n        reviewProblems: [] as { index: number, correctsInRow: number }[],\r\n        lastReviewProblem: null as null | { index: number, correctsInRow: number },\r\n        reviewSequence: null as null | { iNext: number, iStart: number, iEnd: number },\r\n        repeatState: `new` as 'new' | 'review',\r\n    };\r\n\r\n    const startReview = () => {\r\n        console.log(`createReviewProblemService startReview`, state);\r\n        state.repeatState = `review`;\r\n    };\r\n\r\n    const getReviewProblem = (): null | Problem => {\r\n        console.log(`createReviewProblemService getReviewProblem`, state);\r\n\r\n        const rSeq = state.reviewSequence;\r\n        if (rSeq && rSeq.iNext > rSeq.iEnd) {\r\n            console.log(`createReviewProblemService getReviewProblem - End of Sequence`, { rSeq, state });\r\n            state.reviewSequence = null;\r\n        }\r\n\r\n        if (!state.reviewSequence) {\r\n            // If reached end of review problems, exit review mode\r\n            const reviewProblem = state.reviewProblems.find(x => x.index > (state.lastReviewProblem?.index ?? -1));\r\n            if (!reviewProblem) {\r\n                console.log(`createReviewProblemService getReviewProblem - No Review Problem (with greater order than last)`, { reviewProblems: state.reviewProblems, lastReviewProblem: state.lastReviewProblem, state });\r\n                state.lastReviewProblem = null;\r\n                return null;\r\n            }\r\n\r\n            const lastReviewProblemIndex = state.lastReviewProblem?.index ?? -1;\r\n            state.lastReviewProblem = reviewProblem;\r\n\r\n            console.log(`createReviewProblemService getReviewProblem - Start Review Sequence`, state);\r\n            const iStart = Math.max(0, reviewProblem.index - reviewSequencePreviousLength, lastReviewProblemIndex + 1);\r\n\r\n            state.reviewSequence = {\r\n                iNext: iStart,\r\n                iStart,\r\n                iEnd: reviewProblem.index,\r\n            };\r\n        }\r\n\r\n        // Next in sequence\r\n        const seq = state.reviewSequence;\r\n        const p = state.problemSourceHistory[seq.iNext];\r\n        seq.iNext++;\r\n\r\n        return {\r\n            ...p,\r\n            question: reviewQuestionPrefix + p.question,\r\n            answers: shuffle(p.answers),\r\n        };\r\n    };\r\n\r\n    const service: ProblemService = {\r\n        load: problemSource.load,\r\n        save: problemSource.save,\r\n\r\n        getSections: problemSource.getSections,\r\n        gotoSection: problemSource.gotoSection,\r\n\r\n        getNextProblem: (): ProblemResult => {\r\n            console.log(`createReviewProblemService getNextProblem`, state);\r\n\r\n            if (state.repeatState === `review`) {\r\n                const reviewProblem = getReviewProblem();\r\n                if (reviewProblem) {\r\n                    return { ...reviewProblem, isReview: true };\r\n                }\r\n\r\n                console.log(`createReviewProblemService getNextProblem - No Review Problem - Change Mode to NEW`, state);\r\n                state.repeatState = `new`;\r\n            }\r\n\r\n            if (state.reviewProblems.filter(x => x.correctsInRow <= 1).length >= maxNewReviewCount) {\r\n                startReview();\r\n                return service.getNextProblem();\r\n            }\r\n\r\n            const newProblem = problemSource.getNextProblem();\r\n            if (newProblem.question) {\r\n                state.problemSourceHistory.push(newProblem);\r\n            } else {\r\n                // Done - Finish Review\r\n                startReview();\r\n                return service.getNextProblem();\r\n            }\r\n            return newProblem;\r\n        },\r\n        recordAnswer: (problem, answer) => {\r\n            console.log(`createReviewProblemService recordAnswer`, state);\r\n\r\n            // if (answer.isCorrect) {\r\n\r\n            //     problemSource.recordAnswer(problem, answer);\r\n            //     return;\r\n            // }\r\n\r\n            const i = state.problemSourceHistory.findIndex(x => x.key === problem.key);\r\n            if (i < 0) {\r\n                problemSource.recordAnswer(problem, answer);\r\n                return;\r\n            }\r\n\r\n            const problemAlreadyInReview = state.reviewProblems.find(x => x.index === i);\r\n            if (answer.isCorrect) {\r\n                // Correct\r\n                if (problemAlreadyInReview) {\r\n                    problemAlreadyInReview.correctsInRow++;\r\n\r\n                    // Remove if enough corrects in a row \r\n                    state.reviewProblems = state.reviewProblems.filter(x => x.correctsInRow <= requiredCorrectInRow);\r\n                }\r\n            } else {\r\n                // Wrong \r\n                // eslint-disable-next-line no-lonely-if\r\n                if (problemAlreadyInReview) {\r\n                    problemAlreadyInReview.correctsInRow = 0;\r\n                } else {\r\n                    // Insert Review Problem in Index order\r\n                    const newReview = { index: i, correctsInRow: 0, _debug_problemKey: problem.key };\r\n                    state.reviewProblems.push(newReview);\r\n                    state.reviewProblems.sort((a, b) => a.index - b.index);\r\n                    // state.problemsToReview = distinct_key(state.problemsToReview, x => `${x.index}`);\r\n                }\r\n            }\r\n\r\n\r\n            problemSource.recordAnswer(problem, answer);\r\n        },\r\n    };\r\n\r\n    return service;\r\n};\r\n","/* eslint-disable no-cond-assign */\r\nimport { AppError } from './error';\r\n\r\nconst DEBUG = true;\r\n\r\nexport class StringSpan {\r\n    readonly debug?: string = undefined;\r\n\r\n    public readonly source: string;\r\n\r\n    public readonly start: number;\r\n\r\n    public readonly length: number;\r\n\r\n    constructor(source: string, start?: number, length?: number) {\r\n        this.source = source;\r\n        this.start = start ?? 0;\r\n        this.length = length ?? source.length;\r\n\r\n        if (DEBUG) {\r\n            this.debug = this.toText();\r\n        }\r\n    }\r\n\r\n    toText() { return this.source.substr(this.start, this.length); }\r\n\r\n    getChar(index: number) {\r\n        if (index < this.start || index >= this.start + this.length) { throw new AppError(`StringSpan.getChar(): Out of range`, { index, s: this }); }\r\n        return this.source[index];\r\n    }\r\n\r\n    indexOf = (d: string) => {\r\n        const i = this.source.indexOf(d, this.start);\r\n        if (i < this.start) { return -1; }\r\n        if (i >= this.start + this.length) { return -1; }\r\n        return i;\r\n    }\r\n\r\n    lastIndexOf = (d: string) => {\r\n        const i = this.source.lastIndexOf(d, this.start + this.length);\r\n        if (i < this.start) { return -1; }\r\n        if (i >= this.start + this.length) { return -1; }\r\n        return i;\r\n    }\r\n\r\n    indexOfAny = (d: string[]) => {\r\n        const indexes = d.map(x => this.source.indexOf(x, this.start)).filter(x => x >= 0);\r\n        if (indexes.length <= 0) { return -1; }\r\n\r\n        const i = Math.min(...indexes);\r\n        if (i < 0) { return -1; }\r\n        if (i > this.start + this.length) { return -1; }\r\n        return i;\r\n    }\r\n\r\n    indexOfRegExp = (d: RegExp) => {\r\n        d.lastIndex = this.start;\r\n        const m = d.exec(this.source);\r\n        const i = m?.index ?? -1;\r\n        if (i < 0) { return { index: -1, length: 0 }; }\r\n        if (i > this.start + this.length) { return { index: -1, length: 0 }; }\r\n        return { index: i, length: m?.length ?? 0 };\r\n    }\r\n\r\n    lastIndexOfRegex = (d: RegExp) => {\r\n        d.lastIndex = this.start;\r\n        let m: null | RegExpExecArray;\r\n        let i = -1;\r\n        let len = 0;\r\n        while (m = d.exec(this.source)) {\r\n            if (m.index > this.start + this.length) { break; }\r\n            if (m.index < 0) { break; }\r\n            i = m.index;\r\n            len = m.length;\r\n        };\r\n        return { index: i, length: len };\r\n    }\r\n\r\n    splitOn = (d: string, maxCount: number | null = null) => {\r\n        const spans = [] as StringSpan[];\r\n\r\n        const s = this.source;\r\n        const iMin = this.start;\r\n        const iEnd = this.start + this.length;\r\n\r\n        let iLast = iMin;\r\n        let i = this.indexOf(d);\r\n\r\n        while (i >= 0\r\n            && i <= iEnd\r\n            && (!maxCount || spans.length < maxCount - 1)) {\r\n            spans.push(new StringSpan(s, iLast, i - iLast));\r\n\r\n            iLast = i;\r\n            i = s.indexOf(d, i + d.length);\r\n        }\r\n\r\n        i = iEnd;\r\n        spans.push(new StringSpan(s, iLast, i - iLast));\r\n\r\n        const spans_inRange = spans.filter(x => x.length > 0\r\n            && x.start >= this.start\r\n            && x.start + x.length <= this.start + this.length);\r\n\r\n        return spans_inRange;\r\n    };\r\n\r\n    splitOnRegExp = (d: RegExp, maxCount: number | null = null) => {\r\n        const spans = [] as StringSpan[];\r\n\r\n        const s = this.source;\r\n        const iMin = this.start;\r\n        const iEnd = this.start + this.length;\r\n\r\n        let iLast = iMin;\r\n\r\n        // Reset regexp\r\n        d.lastIndex = this.start;\r\n        let m = d.exec(s);\r\n\r\n        while (m\r\n            && m.index <= iEnd\r\n            && (!maxCount || spans.length < maxCount - 1)) {\r\n            spans.push(new StringSpan(s, iLast, m.index - iLast));\r\n\r\n            iLast = m.index;\r\n            m = d.exec(s);\r\n        }\r\n\r\n        const i = iEnd;\r\n        spans.push(new StringSpan(s, iLast, i - iLast));\r\n\r\n        const spans_inRange = spans.filter(x => x.length > 0\r\n            && x.start >= this.start\r\n            && x.start + x.length <= this.start + this.length);\r\n\r\n        return spans_inRange;\r\n    };\r\n\r\n    // private static regex_spaces = new RegExp('\\\\s', 'g');\r\n    // trimStart = (regex?: RegExp) => {\r\n    //     const r = regex ?? StringSpan.regex_spaces;\r\n    //     r.lastIndex = this.start;\r\n\r\n    //     let m: null | RegExpExecArray;\r\n    //     let i = -1;\r\n    //     let len = 0;\r\n\r\n    //     let iNext = this.start;\r\n    //     while (m = r.exec(this.source)) {\r\n    //         if (m.index !== iNext) { break; }\r\n    //         iNext += m.length;\r\n    //         r.lastIndex = iNext;\r\n    //     };\r\n\r\n    //     if (iNext === this.start) { return this; }\r\n    //     return this.transform(iNext - this.start, 0);\r\n    // }\r\n    // trimEnd = (regex?: RegExp) => {\r\n    //     const r = regex ?? StringSpan.regex_spaces;\r\n    //     const matches = this.source.match(r);\r\n\r\n    //     const mInRange = matches?.filter(x => x.);\r\n\r\n    //     if (iNext === this.start) { return this; }\r\n    //     return this.transform(iNext - this.start, 0);\r\n    // }\r\n    // trim = (regex?: RegExp) => {\r\n    //     return this.trimStart(regex).trimEnd(regex);\r\n    // }\r\n\r\n    startsWith = (text: string) => {\r\n        return this.source.startsWith(text, this.start);\r\n    }\r\n\r\n    trimStart = (patterns: string | string[] = [` `, `\\t`, `\\r`, `\\n`]) => {\r\n        const s = this.source;\r\n        patterns = typeof patterns === `string` ? [patterns] : patterns;\r\n\r\n        let i = this.start;\r\n        let iLast = -1;\r\n\r\n        while (i !== iLast) {\r\n            iLast = i;\r\n            for (const p of patterns) {\r\n                if (s.startsWith(p, i)) {\r\n                    i += p.length;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return this.transform(i - this.start, 0);\r\n    }\r\n\r\n    trimEnd = (patterns: string | string[] = [` `, `\\t`, `\\r`, `\\n`]) => {\r\n        const s = this.source;\r\n        patterns = typeof patterns === `string` ? [patterns] : patterns;\r\n\r\n        let i = this.start + this.length;\r\n        let iLast = -1;\r\n\r\n        while (i !== iLast) {\r\n            iLast = i;\r\n            for (const p of patterns) {\r\n                if (i - p.length >= 0 && s.startsWith(p, i - p.length)) {\r\n                    i -= p.length;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return this.transform(0, i - (this.start + this.length));\r\n    }\r\n\r\n    trim = (patterns: string | string[] = [` `, `\\t`, `\\r`, `\\n`]) => {\r\n        return this.trimStart(patterns).trimEnd(patterns);\r\n    }\r\n\r\n    transform = (offsetStart: number, offsetEnd: number) => {\r\n        return new StringSpan(this.source, this.start + offsetStart, this.length + offsetEnd - offsetStart);\r\n    };\r\n\r\n    newRange = (start: number, length: number) => {\r\n        return new StringSpan(this.source, start, length);\r\n    };\r\n};\r\n\r\n\r\nconst runStringSpanTests = () => {\r\n    const text = ` This is a new test! `;\r\n    const s = new StringSpan(text, 0, text.length);\r\n\r\n    const test = (name: string, actual: unknown, expected: unknown) => {\r\n        if (actual !== expected) { console.error(`FAIL - ${name}`, { actual, expected }); }\r\n        else { console.log(`PASS - ${name}`); }\r\n    };\r\n\r\n    test(`new`, s.toText(), text);\r\n\r\n    test(`startsWith`, s.startsWith(` `), true);\r\n    test(`startsWith`, s.startsWith(`T`), false);\r\n\r\n    test(`indexOf(a)`, s.indexOf(`a`), text.indexOf(`a`));\r\n    test(`indexOf(i)`, s.indexOf(`i`), text.indexOf(`i`));\r\n    test(`indexOf( )`, s.indexOf(` `), text.indexOf(` `));\r\n\r\n    test(`lastIndexOf(a)`, s.lastIndexOf(`a`), text.lastIndexOf(`a`));\r\n    test(`lastIndexOf(i)`, s.lastIndexOf(`i`), text.lastIndexOf(`i`));\r\n    test(`lastIndexOf( )`, s.lastIndexOf(` `), text.lastIndexOf(` `));\r\n\r\n    test(`splitOn`, s.splitOn(` `).join(``), text.split(` `).join(` `));\r\n    test(`splitOnRegExp`, s.splitOnRegExp(/\\W/g).join(``), text.split(` `).join(` `));\r\n    test(`splitOnRegExp`, s.splitOnRegExp(/\\W/g).join(`,`), ` This, is, a, new, test,!, `);\r\n    test(`splitOnRegExp`, s.splitOnRegExp(/is/g).join(`,`), ` Th,is ,is a new test! `);\r\n    test(`splitOnRegExp`, new StringSpan(`<span class=\"ca cb cc\">test</span>`).splitOnRegExp(/('|\")/g).join(`,`), `<span class=,\"ca cb cc,\">test</span>`);\r\n\r\n    const s2 = new StringSpan(`<span class=\"ca cb cc\">test</span>`).splitOn(`</span>`)[0].splitOn(`class`)[1];\r\n    test(`splitOn       - s2`, s2.toText(), `class=\"ca cb cc\">test`);\r\n    test(`splitOnRegExp - s2`, s2.splitOnRegExp(/</g).join(`,`), `class=\"ca cb cc\">test`);\r\n    test(`splitOnRegExp - s2`, s2.splitOnRegExp(/>/g).join(`,`), `class=\"ca cb cc\",>test`);\r\n    test(`splitOnRegExp - s2`, s2.splitOnRegExp(/('|\")/g).join(`,`), `class=,\"ca cb cc,\">test`);\r\n\r\n    test(`trimStart`, s.trimStart().toText(), text.trimStart());\r\n    test(`trimEnd`, s.trimEnd().toText(), text.trimEnd());\r\n    test(`trim`, s.trim().toText(), text.trim());\r\n    test(`trim Single`, s.trim(` `).toText(), `This is a new test!`);\r\n    test(`trim Multiple`, s.trim([` `, `!`]).toText(), `This is a new test`);\r\n    test(`trim Words`, s.trim([` `, `!`, `This`]).toText(), `is a new test`);\r\n    test(`trim Complex`, s.trim().trim([`This`, `test!`]).trim().toText(), `is a new`);\r\n};\r\n\r\n// runStringSpanTests();\r\n","export const uploadApiConfig = {\r\n    uploadApiUrl: `https://s7mrgkmtk5.execute-api.us-east-1.amazonaws.com/prod/upload-api`,\r\n};\r\n","!function (t, e) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = e() : \"function\" == typeof define && define.amd ? define(e) : t.dayjs = e();\n}(this, function () {\n  \"use strict\";\n\n  var t = \"millisecond\",\n      e = \"second\",\n      n = \"minute\",\n      r = \"hour\",\n      i = \"day\",\n      s = \"week\",\n      u = \"month\",\n      o = \"quarter\",\n      a = \"year\",\n      h = /^(\\d{4})-?(\\d{1,2})-?(\\d{0,2})[^0-9]*(\\d{1,2})?:?(\\d{1,2})?:?(\\d{1,2})?.?(\\d{1,3})?$/,\n      f = /\\[([^\\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,\n      c = function c(t, e, n) {\n    var r = String(t);\n    return !r || r.length >= e ? t : \"\" + Array(e + 1 - r.length).join(n) + t;\n  },\n      d = {\n    s: c,\n    z: function z(t) {\n      var e = -t.utcOffset(),\n          n = Math.abs(e),\n          r = Math.floor(n / 60),\n          i = n % 60;\n      return (e <= 0 ? \"+\" : \"-\") + c(r, 2, \"0\") + \":\" + c(i, 2, \"0\");\n    },\n    m: function m(t, e) {\n      var n = 12 * (e.year() - t.year()) + (e.month() - t.month()),\n          r = t.clone().add(n, u),\n          i = e - r < 0,\n          s = t.clone().add(n + (i ? -1 : 1), u);\n      return Number(-(n + (e - r) / (i ? r - s : s - r)) || 0);\n    },\n    a: function a(t) {\n      return t < 0 ? Math.ceil(t) || 0 : Math.floor(t);\n    },\n    p: function p(h) {\n      return {\n        M: u,\n        y: a,\n        w: s,\n        d: i,\n        D: \"date\",\n        h: r,\n        m: n,\n        s: e,\n        ms: t,\n        Q: o\n      }[h] || String(h || \"\").toLowerCase().replace(/s$/, \"\");\n    },\n    u: function u(t) {\n      return void 0 === t;\n    }\n  },\n      $ = {\n    name: \"en\",\n    weekdays: \"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday\".split(\"_\"),\n    months: \"January_February_March_April_May_June_July_August_September_October_November_December\".split(\"_\")\n  },\n      l = \"en\",\n      m = {};\n\n  m[l] = $;\n\n  var y = function y(t) {\n    return t instanceof v;\n  },\n      M = function M(t, e, n) {\n    var r;\n    if (!t) return l;\n    if (\"string\" == typeof t) m[t] && (r = t), e && (m[t] = e, r = t);else {\n      var i = t.name;\n      m[i] = t, r = i;\n    }\n    return !n && r && (l = r), r || !n && l;\n  },\n      g = function g(t, e) {\n    if (y(t)) return t.clone();\n    var n = \"object\" == typeof e ? e : {};\n    return n.date = t, n.args = arguments, new v(n);\n  },\n      D = d;\n\n  D.l = M, D.i = y, D.w = function (t, e) {\n    return g(t, {\n      locale: e.$L,\n      utc: e.$u,\n      $offset: e.$offset\n    });\n  };\n\n  var v = function () {\n    function c(t) {\n      this.$L = this.$L || M(t.locale, null, !0), this.parse(t);\n    }\n\n    var d = c.prototype;\n    return d.parse = function (t) {\n      this.$d = function (t) {\n        var e = t.date,\n            n = t.utc;\n        if (null === e) return new Date(NaN);\n        if (D.u(e)) return new Date();\n        if (e instanceof Date) return new Date(e);\n\n        if (\"string\" == typeof e && !/Z$/i.test(e)) {\n          var r = e.match(h);\n          if (r) return n ? new Date(Date.UTC(r[1], r[2] - 1, r[3] || 1, r[4] || 0, r[5] || 0, r[6] || 0, r[7] || 0)) : new Date(r[1], r[2] - 1, r[3] || 1, r[4] || 0, r[5] || 0, r[6] || 0, r[7] || 0);\n        }\n\n        return new Date(e);\n      }(t), this.init();\n    }, d.init = function () {\n      var t = this.$d;\n      this.$y = t.getFullYear(), this.$M = t.getMonth(), this.$D = t.getDate(), this.$W = t.getDay(), this.$H = t.getHours(), this.$m = t.getMinutes(), this.$s = t.getSeconds(), this.$ms = t.getMilliseconds();\n    }, d.$utils = function () {\n      return D;\n    }, d.isValid = function () {\n      return !(\"Invalid Date\" === this.$d.toString());\n    }, d.isSame = function (t, e) {\n      var n = g(t);\n      return this.startOf(e) <= n && n <= this.endOf(e);\n    }, d.isAfter = function (t, e) {\n      return g(t) < this.startOf(e);\n    }, d.isBefore = function (t, e) {\n      return this.endOf(e) < g(t);\n    }, d.$g = function (t, e, n) {\n      return D.u(t) ? this[e] : this.set(n, t);\n    }, d.year = function (t) {\n      return this.$g(t, \"$y\", a);\n    }, d.month = function (t) {\n      return this.$g(t, \"$M\", u);\n    }, d.day = function (t) {\n      return this.$g(t, \"$W\", i);\n    }, d.date = function (t) {\n      return this.$g(t, \"$D\", \"date\");\n    }, d.hour = function (t) {\n      return this.$g(t, \"$H\", r);\n    }, d.minute = function (t) {\n      return this.$g(t, \"$m\", n);\n    }, d.second = function (t) {\n      return this.$g(t, \"$s\", e);\n    }, d.millisecond = function (e) {\n      return this.$g(e, \"$ms\", t);\n    }, d.unix = function () {\n      return Math.floor(this.valueOf() / 1e3);\n    }, d.valueOf = function () {\n      return this.$d.getTime();\n    }, d.startOf = function (t, o) {\n      var h = this,\n          f = !!D.u(o) || o,\n          c = D.p(t),\n          d = function d(t, e) {\n        var n = D.w(h.$u ? Date.UTC(h.$y, e, t) : new Date(h.$y, e, t), h);\n        return f ? n : n.endOf(i);\n      },\n          $ = function $(t, e) {\n        return D.w(h.toDate()[t].apply(h.toDate(\"s\"), (f ? [0, 0, 0, 0] : [23, 59, 59, 999]).slice(e)), h);\n      },\n          l = this.$W,\n          m = this.$M,\n          y = this.$D,\n          M = \"set\" + (this.$u ? \"UTC\" : \"\");\n\n      switch (c) {\n        case a:\n          return f ? d(1, 0) : d(31, 11);\n\n        case u:\n          return f ? d(1, m) : d(0, m + 1);\n\n        case s:\n          var g = this.$locale().weekStart || 0,\n              v = (l < g ? l + 7 : l) - g;\n          return d(f ? y - v : y + (6 - v), m);\n\n        case i:\n        case \"date\":\n          return $(M + \"Hours\", 0);\n\n        case r:\n          return $(M + \"Minutes\", 1);\n\n        case n:\n          return $(M + \"Seconds\", 2);\n\n        case e:\n          return $(M + \"Milliseconds\", 3);\n\n        default:\n          return this.clone();\n      }\n    }, d.endOf = function (t) {\n      return this.startOf(t, !1);\n    }, d.$set = function (s, o) {\n      var h,\n          f = D.p(s),\n          c = \"set\" + (this.$u ? \"UTC\" : \"\"),\n          d = (h = {}, h[i] = c + \"Date\", h.date = c + \"Date\", h[u] = c + \"Month\", h[a] = c + \"FullYear\", h[r] = c + \"Hours\", h[n] = c + \"Minutes\", h[e] = c + \"Seconds\", h[t] = c + \"Milliseconds\", h)[f],\n          $ = f === i ? this.$D + (o - this.$W) : o;\n\n      if (f === u || f === a) {\n        var l = this.clone().set(\"date\", 1);\n        l.$d[d]($), l.init(), this.$d = l.set(\"date\", Math.min(this.$D, l.daysInMonth())).toDate();\n      } else d && this.$d[d]($);\n\n      return this.init(), this;\n    }, d.set = function (t, e) {\n      return this.clone().$set(t, e);\n    }, d.get = function (t) {\n      return this[D.p(t)]();\n    }, d.add = function (t, o) {\n      var h,\n          f = this;\n      t = Number(t);\n\n      var c = D.p(o),\n          d = function d(e) {\n        var n = g(f);\n        return D.w(n.date(n.date() + Math.round(e * t)), f);\n      };\n\n      if (c === u) return this.set(u, this.$M + t);\n      if (c === a) return this.set(a, this.$y + t);\n      if (c === i) return d(1);\n      if (c === s) return d(7);\n      var $ = (h = {}, h[n] = 6e4, h[r] = 36e5, h[e] = 1e3, h)[c] || 1,\n          l = this.$d.getTime() + t * $;\n      return D.w(l, this);\n    }, d.subtract = function (t, e) {\n      return this.add(-1 * t, e);\n    }, d.format = function (t) {\n      var e = this;\n      if (!this.isValid()) return \"Invalid Date\";\n\n      var n = t || \"YYYY-MM-DDTHH:mm:ssZ\",\n          r = D.z(this),\n          i = this.$locale(),\n          s = this.$H,\n          u = this.$m,\n          o = this.$M,\n          a = i.weekdays,\n          h = i.months,\n          c = function c(t, r, i, s) {\n        return t && (t[r] || t(e, n)) || i[r].substr(0, s);\n      },\n          d = function d(t) {\n        return D.s(s % 12 || 12, t, \"0\");\n      },\n          $ = i.meridiem || function (t, e, n) {\n        var r = t < 12 ? \"AM\" : \"PM\";\n        return n ? r.toLowerCase() : r;\n      },\n          l = {\n        YY: String(this.$y).slice(-2),\n        YYYY: this.$y,\n        M: o + 1,\n        MM: D.s(o + 1, 2, \"0\"),\n        MMM: c(i.monthsShort, o, h, 3),\n        MMMM: c(h, o),\n        D: this.$D,\n        DD: D.s(this.$D, 2, \"0\"),\n        d: String(this.$W),\n        dd: c(i.weekdaysMin, this.$W, a, 2),\n        ddd: c(i.weekdaysShort, this.$W, a, 3),\n        dddd: a[this.$W],\n        H: String(s),\n        HH: D.s(s, 2, \"0\"),\n        h: d(1),\n        hh: d(2),\n        a: $(s, u, !0),\n        A: $(s, u, !1),\n        m: String(u),\n        mm: D.s(u, 2, \"0\"),\n        s: String(this.$s),\n        ss: D.s(this.$s, 2, \"0\"),\n        SSS: D.s(this.$ms, 3, \"0\"),\n        Z: r\n      };\n\n      return n.replace(f, function (t, e) {\n        return e || l[t] || r.replace(\":\", \"\");\n      });\n    }, d.utcOffset = function () {\n      return 15 * -Math.round(this.$d.getTimezoneOffset() / 15);\n    }, d.diff = function (t, h, f) {\n      var c,\n          d = D.p(h),\n          $ = g(t),\n          l = 6e4 * ($.utcOffset() - this.utcOffset()),\n          m = this - $,\n          y = D.m(this, $);\n      return y = (c = {}, c[a] = y / 12, c[u] = y, c[o] = y / 3, c[s] = (m - l) / 6048e5, c[i] = (m - l) / 864e5, c[r] = m / 36e5, c[n] = m / 6e4, c[e] = m / 1e3, c)[d] || m, f ? y : D.a(y);\n    }, d.daysInMonth = function () {\n      return this.endOf(u).$D;\n    }, d.$locale = function () {\n      return m[this.$L];\n    }, d.locale = function (t, e) {\n      if (!t) return this.$L;\n      var n = this.clone(),\n          r = M(t, e, !0);\n      return r && (n.$L = r), n;\n    }, d.clone = function () {\n      return D.w(this.$d, this);\n    }, d.toDate = function () {\n      return new Date(this.valueOf());\n    }, d.toJSON = function () {\n      return this.isValid() ? this.toISOString() : null;\n    }, d.toISOString = function () {\n      return this.$d.toISOString();\n    }, d.toString = function () {\n      return this.$d.toUTCString();\n    }, c;\n  }();\n\n  return g.prototype = v.prototype, g.extend = function (t, e) {\n    return t(e, v, g), g;\n  }, g.locale = M, g.isDayjs = y, g.unix = function (t) {\n    return g(1e3 * t);\n  }, g.en = m[l], g.Ls = m, g;\n});","!function (e, t) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = t() : \"function\" == typeof define && define.amd ? define(t) : e.dayjs_plugin_localizedFormat = t();\n}(this, function () {\n  \"use strict\";\n\n  return function (e, t, o) {\n    var n = t.prototype,\n        r = n.format,\n        M = {\n      LTS: \"h:mm:ss A\",\n      LT: \"h:mm A\",\n      L: \"MM/DD/YYYY\",\n      LL: \"MMMM D, YYYY\",\n      LLL: \"MMMM D, YYYY h:mm A\",\n      LLLL: \"dddd, MMMM D, YYYY h:mm A\"\n    };\n    o.en.formats = M;\n\n    n.format = function (e) {\n      void 0 === e && (e = \"YYYY-MM-DDTHH:mm:ssZ\");\n      var t = this.$locale().formats,\n          o = void 0 === t ? {} : t,\n          n = e.replace(/(\\[[^\\]]+])|(LTS?|l{1,4}|L{1,4})/g, function (e, t, n) {\n        var r = n && n.toUpperCase();\n        return t || o[n] || M[n] || o[r].replace(/(\\[[^\\]]+])|(MMMM|MM|DD|dddd)/g, function (e, t, o) {\n          return t || o.slice(1);\n        });\n      });\n      return r.call(this, n);\n    };\n  };\n});","import './index.css';\r\nimport React, { ReactNode, useRef } from 'react';\r\nimport { ThemeTextStyle, ThemeViewStyle } from 'themes/theme';\r\n\r\nfunction mergeStyles<T>(items: (T | undefined | null) | (T | T[] | undefined | null)[]): T {\r\n    if (Array.isArray(items)) {\r\n        if (items.length === 1) { return mergeStyles(items[0]) ?? {} as T; }\r\n        let item = { ...mergeStyles(items[0]) };\r\n        items.forEach(x => { item = { ...item, ...mergeStyles(x ?? {}) }; });\r\n        return (item ?? {}) as T;\r\n    }\r\n    return items as T;\r\n};\r\n\r\nconst viewStyleDefaults = {\r\n    display: `flex`,\r\n    flexDirection: `column`,\r\n} as const;\r\n\r\nconst textStyleDefaults = {\r\n    whiteSpace: `pre`,\r\n} as const;\r\n\r\nconst finalizeTextStyle = <T extends unknown>(style: T) => {\r\n    const s = style as {\r\n        userSelect?: 'none';\r\n        MozUserSelect?: 'none';\r\n        WebkitUserSelect?: 'none';\r\n    };\r\n    if (s.userSelect === `none`) {\r\n        s.MozUserSelect = `none`;\r\n        s.WebkitUserSelect = `none`;\r\n    }\r\n\r\n    return style;\r\n};\r\n\r\nexport const View = (props: { style?: ThemeViewStyle | ThemeViewStyle[], children?: ReactNode }) => { return (<div style={mergeStyles([viewStyleDefaults, props.style])}>{props.children}</div>); };\r\nexport const Text = (props: { style?: ThemeTextStyle | ThemeTextStyle[], children?: string, numberOfLines?: undefined | 1 }) => {\r\n    if (props.numberOfLines === 1) {\r\n        const singleLineStyle = {\r\n            overflow: `hidden`,\r\n            whiteSpace: `nowrap`,\r\n            wordWrap: `break-word`,\r\n            textOverflow: `ellipsis`,\r\n        } as const;\r\n        const allStyles = mergeStyles([textStyleDefaults, props.style, singleLineStyle]);\r\n        return (<span style={finalizeTextStyle(allStyles)}>{props.children}</span>);\r\n    }\r\n    const allStyles = mergeStyles([textStyleDefaults, props.style]);\r\n    return (<span style={finalizeTextStyle(allStyles)}>{props.children}</span>);\r\n};\r\nexport const TextInput = (props: {\r\n    style?: ThemeTextStyle | ThemeTextStyle[];\r\n    keyboardType: 'default' | 'numeric' | 'phone-pad' | 'email-address';\r\n    autoCompleteType: 'off' | 'username' | 'password' | 'email' | 'name' | 'tel' | 'street-address' | 'postal-code';\r\n    secureTextEntry?: boolean;\r\n    placeholder?: string;\r\n    editable?: boolean;\r\n    value: string;\r\n    onChange: (value: string) => void;\r\n    onSubmitEditing?: () => void;\r\n    onFocus?: () => void;\r\n    onBlur?: () => void;\r\n    multiline?: boolean;\r\n    numberOfLines?: number;\r\n    onSelectionChange?: (value: {\r\n        start: number;\r\n        /** Exclusive (iNext actually) */\r\n        end: number;\r\n    }) => void;\r\n}) => {\r\n    const type = props.keyboardType === `numeric` ? `number`\r\n        : (props.secureTextEntry ? `password`\r\n            : `text`);\r\n\r\n    const name = props.autoCompleteType === `username` ? `username`\r\n        : (props.autoCompleteType === `password` ? `password`\r\n            : undefined);\r\n\r\n    const onKeyPress = props.onSubmitEditing && ((e: React.KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n        if (e.key === `Enter` && !e.shiftKey) {\r\n            e.preventDefault();\r\n            props.onSubmitEditing?.();\r\n        }\r\n    }) || undefined;\r\n\r\n    if (props.multiline) {\r\n        return (<textarea\r\n            name={name} id={name}\r\n            style={mergeStyles([textStyleDefaults, props.style])}\r\n            placeholder={props.placeholder}\r\n            disabled={!(props.editable ?? true)}\r\n            value={props.value}\r\n            onFocus={props.onFocus}\r\n            onChange={(e) => props.onChange(e.target.value)}\r\n            onKeyPress={onKeyPress}\r\n            onBlur={props.onBlur}\r\n            rows={props.numberOfLines}\r\n            onSelect={e => {\r\n                const eTarget = e.target as unknown as {\r\n                    selectionStart?: number;\r\n                    selectionEnd?: number;\r\n                };\r\n                const selectionRange = { start: eTarget.selectionStart ?? 0, end: eTarget.selectionEnd ?? 0 };\r\n                // console.log(`textare onSelect`, { selectionRange, eTarget });\r\n                if (!eTarget.selectionStart && !eTarget.selectionEnd) { return; }\r\n                props.onSelectionChange?.(selectionRange);\r\n            }}\r\n        />);\r\n    }\r\n\r\n    return (<input type={type}\r\n        name={name} id={name}\r\n        style={mergeStyles([textStyleDefaults, props.style])}\r\n        placeholder={props.placeholder}\r\n        disabled={!(props.editable ?? true)}\r\n        value={props.value}\r\n        onFocus={props.onFocus}\r\n        onChange={(e) => props.onChange(e.target.value)}\r\n        onKeyPress={onKeyPress}\r\n        onBlur={props.onBlur}\r\n    />);\r\n\r\n};\r\nexport const TouchableOpacity = (props: { style?: ThemeViewStyle | ThemeViewStyle[], children?: ReactNode, onPress: () => void }) => {\r\n\r\n    // Prevent Initial Press (already pressing when created)\r\n    const lastPressTime = useRef(Date.now());\r\n    const onPress = () => {\r\n        // Prevent duplicate triggers\r\n        if (Date.now() < lastPressTime.current + 250) {\r\n            // console.log(`TouchableOpacity - prevented duplicate trigger`, { lastPressTime: lastPressTime.current, now: Date.now() });\r\n            return;\r\n        }\r\n        lastPressTime.current = Date.now();\r\n\r\n        props.onPress();\r\n    };\r\n\r\n    const hasTouchStarted = useRef(true);\r\n\r\n    return (\r\n        <div style={mergeStyles([viewStyleDefaults, props.style])}\r\n            onClick={onPress}\r\n            onKeyPress={onPress}\r\n            onTouchStart={() => { hasTouchStarted.current = true; }}\r\n            onTouchMove={() => { hasTouchStarted.current = false; }}\r\n            onTouchEnd={() => { if (hasTouchStarted.current) { onPress(); } }}\r\n            role='button'\r\n            tabIndex={0}>\r\n            {props.children}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const Pressable = (props: { style?: ThemeViewStyle | ThemeViewStyle[], children?: ReactNode, onPressIn: () => void, onPressOut: () => void }) => {\r\n\r\n    const onIgnore = (e: React.MouseEvent | React.TouchEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation?.();\r\n        (e as unknown as { [key: string]: boolean }).cancelBubble = true;\r\n        (e as unknown as { [key: string]: boolean }).returnValue = false;\r\n        return false;\r\n    };\r\n\r\n    const onPressIn = (e: React.MouseEvent | React.TouchEvent) => {\r\n        props.onPressIn();\r\n        return onIgnore(e);\r\n    };\r\n    const onPressOut = (e: React.MouseEvent | React.TouchEvent) => {\r\n        props.onPressOut();\r\n        return onIgnore(e);\r\n    };\r\n\r\n    return (\r\n        <div style={mergeStyles([viewStyleDefaults, props.style])}\r\n            onMouseDown={onPressIn}\r\n            onMouseUp={onPressOut}\r\n            onTouchStart={onPressIn}\r\n            onTouchEnd={onPressOut}\r\n            onTouchCancel={onPressOut}\r\n            onTouchMove={onIgnore}\r\n            onMouseLeave={onPressOut}\r\n            onTouchEndCapture={onPressOut}\r\n            role='button'\r\n            tabIndex={0}>\r\n            {props.children}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const ActivityIndicator = ({ size, color }: { size: 'large' | 'small', color: string }) => {\r\n    const sizePx = size === `small` ? 16 : 32;\r\n    return (\r\n        <CircleSvg size={sizePx} thickness={sizePx / 8} color={color} />\r\n    );\r\n};\r\n\r\n// Based on: https://glennmccomb.com/articles/building-a-pure-css-animated-svg-spinner/\r\nconst CircleSvg = ({ size, thickness, color }: { size: number, thickness: number, color: string }) => {\r\n    const circumference = 2 * Math.PI * (size - thickness) * 0.5;\r\n    const dashLength = circumference * 0.6;\r\n    return (\r\n        <svg style={{ maxWidth: size }} viewBox={`0 0 ${size} ${size}`} xmlns='http://www.w3.org/2000/svg'>\r\n            <circle style={{\r\n                fill: `transparent`,\r\n                stroke: color,\r\n                strokeWidth: thickness,\r\n                opacity: 0.5,\r\n            }} cx={size * 0.5} cy={size * 0.5} r={size * 0.5 - thickness} />\r\n            <circle className='activity-spinner' style={{\r\n                strokeDasharray: dashLength,\r\n                fill: `transparent`,\r\n                stroke: color,\r\n                strokeWidth: thickness,\r\n                transformOrigin: `${size * 0.5}px ${size * 0.5}px`,\r\n            }} cx={size * 0.5} cy={size * 0.5} r={size * 0.5 - thickness} />\r\n        </svg>\r\n    );\r\n};\r\n\r\n\r\nexport const Platform = {\r\n    OS: `web` as 'web' | 'ios' | 'android',\r\n};\r\n\r\nexport const Clipboard = {\r\n    setString: async (value: string) => { await navigator.clipboard.writeText(value); },\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { Text, View, ActivityIndicator, TouchableOpacity } from 'react-native-lite';\r\nimport { SpeechService } from './speech';\r\n\r\nexport const VoiceChooser = ({ languange, speechService }: { languange: string, speechService: SpeechService }) => {\r\n    const [loading, setLoading] = useState(true);\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    const [renderId, setRenderId] = useState(0);\r\n\r\n    const refresh = () => {\r\n        setLoading(true);\r\n        setTimeout(() => {\r\n            setLoading(false);\r\n        }, 1000);\r\n    };\r\n\r\n    useEffect(() => {\r\n        refresh();\r\n    }, []);\r\n\r\n    const selectVoice = (voice: SpeechSynthesisVoice) => {\r\n        speechService.setVoiceForLanguange(languange, voice);\r\n        setRenderId(s => s + 1);\r\n        speechService.speak(voice.name, languange);\r\n    };\r\n\r\n    return (\r\n        <View>\r\n            <TouchableOpacity onPress={refresh}>\r\n                <Text style={{ fontSize: 24 }}>{`Voice for ${languange}`}</Text>\r\n            </TouchableOpacity>\r\n            {loading && <ActivityIndicator size='small' color='red' />}\r\n            {!loading && (\r\n                <>\r\n                    {speechService.getVoicesForLanguange(languange).map(x => (\r\n                        <TouchableOpacity key={x.voice.name} onPress={() => { selectVoice(x.voice); }}>\r\n                            <View>\r\n                                <Text style={{ margin: 4, fontSize: 14, whiteSpace: `normal` }} >{`${x.isSelected ? `` : ``} ${x.voice.lang} - ${x.voice.name} - ${x.voice.localService ? `local` : `web`}`}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </>\r\n            )}\r\n        </View>\r\n    );\r\n};\r\n","'use strict';\nvar $ = require('../internals/export');\nvar $trimStart = require('../internals/string-trim').start;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\nvar FORCED = forcedStringTrimMethod('trimStart');\n\nvar trimStart = FORCED ? function trimStart() {\n  return $trimStart(this);\n} : ''.trimStart;\n\n// `String.prototype.{ trimStart, trimLeft }` methods\n// https://github.com/tc39/ecmascript-string-left-right-trim\n$({ target: 'String', proto: true, forced: FORCED }, {\n  trimStart: trimStart,\n  trimLeft: trimStart\n});\n","\r\nexport type Subscription<T> = (state: T) => void;\r\nexport type Subscribe<T> = (callback: (state: T) => void) => { unsubscribe: () => void };\r\n\r\nexport const createSubscribable = <T>(initialState?: T) => {\r\n    let lastState = initialState;\r\n    const callbacks = [] as (null | Subscription<T>)[];\r\n    const subscribe = (callback: Subscription<T>) => {\r\n        const i = callbacks.length;\r\n        callbacks.push(callback);\r\n\r\n        // Send Initial State if it exists\r\n        setTimeout(() => {\r\n            if (!lastState) { return; }\r\n            callback(lastState);\r\n        });\r\n\r\n        return {\r\n            unsubscribe: () => {\r\n                callbacks[i] = null;\r\n            },\r\n        };\r\n    };\r\n    const onStateChange = (state: T) => {\r\n        lastState = state;\r\n        callbacks.forEach(x => x?.(state));\r\n    };\r\n    return {\r\n        subscribe,\r\n        onStateChange,\r\n    };\r\n};\r\n","import { fetchWithTimeout } from 'utils/web-request';\r\nimport { AppError } from 'utils/error';\r\nimport { UploadUrl } from './types';\r\nimport { createUploadApiWebClient } from './web-client';\r\n\r\nexport const downloadData = async (getUrl: string) => {\r\n    const result = await fetchWithTimeout(getUrl, {\r\n        method: `GET`,\r\n        headers: {\r\n            'Accept': `application/json`,\r\n        },\r\n    });\r\n    const json = await result.json() as { data: unknown };\r\n    return json.data;\r\n};\r\n\r\n\r\nexport const createUploader = (uploadUrl: UploadUrl) => {\r\n    return {\r\n        uploadData: async (data: unknown) => {\r\n            const body = JSON.stringify({ data });\r\n            const result = await fetchWithTimeout(uploadUrl.putUrl, {\r\n                method: `PUT`,\r\n                headers: {\r\n                    'Accept': `application/json`,\r\n                    'Content-Type': `application/json`,\r\n                    'Content-Length': `${body.length}`,\r\n                },\r\n                body,\r\n            });\r\n\r\n            if (!result.ok) {\r\n                throw new AppError(`Upload Failed`);\r\n            }\r\n        },\r\n        downloadData: async (): Promise<unknown> => {\r\n            return await downloadData(uploadUrl.getUrl);\r\n        },\r\n    };\r\n};\r\n\r\nexport const createSmartUploader = <T extends {}>(args: { getUploadUrl: () => Promise<null | UploadUrl>, setUploadUrl: (uploadUrl: UploadUrl) => Promise<void>, uploadUrlPrefix: string, uploadApiUrl: string }) => {\r\n    const uploadApiWebClient = createUploadApiWebClient(args);\r\n\r\n    let _uploadUrl = null as null | UploadUrl;\r\n\r\n    const setupUploadUrl = async () => {\r\n        if (_uploadUrl) { return _uploadUrl; }\r\n\r\n        _uploadUrl = await args.getUploadUrl();\r\n        if (_uploadUrl) { return _uploadUrl; }\r\n\r\n        _uploadUrl = (await uploadApiWebClient.createUploadUrl({ prefix: args.uploadUrlPrefix })).uploadUrl;\r\n        await args.setUploadUrl(_uploadUrl);\r\n        return _uploadUrl;\r\n    };\r\n\r\n    return {\r\n        load: async (): Promise<null | T> => {\r\n            const uploadUrl = await setupUploadUrl();\r\n\r\n            try {\r\n                const data = await downloadData(uploadUrl.getUrl);\r\n                return data as T;\r\n            } catch{\r\n                return null;\r\n            }\r\n        },\r\n        save: async (data: T) => {\r\n            let uploadUrl = await setupUploadUrl();\r\n\r\n            try {\r\n                const uploader = createUploader(uploadUrl);\r\n                await uploader.uploadData(data);\r\n            } catch{\r\n                // Try again after renew upload token\r\n                uploadUrl = (await uploadApiWebClient.renewUploadUrl({ uploadUrl })).uploadUrl;\r\n                await args.setUploadUrl(uploadUrl);\r\n                _uploadUrl = uploadUrl;\r\n\r\n                const uploader = createUploader(uploadUrl);\r\n                await uploader.uploadData(data);\r\n            }\r\n\r\n            // Upload backup (temp)\r\n            const backupUrl = (await uploadApiWebClient.createUploadUrl({ prefix: `backup/${uploadUrl.relativePath}` })).uploadUrl;\r\n            const backupUploader = createUploader(backupUrl);\r\n            await backupUploader.uploadData(data);\r\n        },\r\n    };\r\n};\r\n","export type JsonTyped<T> = string & { __json: T };\r\n\r\nexport const jsonParse = <T>(json: JsonTyped<T>): T => {\r\n    return JSON.parse(json) as T;\r\n};\r\nexport const jsonParse_smart = <T>(json: T | JsonTyped<T>): T => {\r\n    if (typeof json === `string`) {\r\n        return JSON.parse(json) as T;\r\n    }\r\n    return json as T;\r\n};\r\nexport const jsonStringify = <T>(obj: T) => JSON.stringify(obj) as JsonTyped<T>;\r\n\r\nexport const jsonStringify_safe = (obj: unknown, shouldFormat?: boolean): string => {\r\n    const visited = [] as unknown[];\r\n\r\n    return JSON.stringify(obj, (_, val: unknown) => {\r\n        if (val != null && typeof val == `object`) {\r\n            if (visited.includes(val)) {\r\n                return `[OBJ-DUPLICATED]`;\r\n            }\r\n            visited.push(val);\r\n        }\r\n        return val;\r\n    }, shouldFormat ? 2 : 0);\r\n};\r\n","import React, { useState } from 'react';\r\nimport { View, Text, TouchableOpacity, Clipboard } from 'react-native-lite';\r\nimport { theme } from 'themes/theme';\r\nimport { ErrorState } from 'utils/error';\r\nimport { jsonStringify_safe } from 'utils/json';\r\nimport { Icon } from './icon';\r\nimport { IconKind } from './icon-kind';\r\n\r\nconst DEBUG = true;\r\n\r\nconst errorBoxStyle = {\r\n    view: theme.view_error,\r\n    text: theme.text_error,\r\n    text_errorMessage: theme.text_errorMessage,\r\n    icon: theme.icon,\r\n    icon_errorMessage: theme.icon_errorMessage,\r\n    button: { outlineColor: theme.colors.outline },\r\n};\r\n\r\nexport const ErrorBox = ({ error }: { error: ErrorState | null | undefined }) => {\r\n    if (!error) { return (<></>); }\r\n    return (<ErrorBox_Inner error={error} />);\r\n};\r\n\r\nconst ErrorBox_Inner = (props: { error: ErrorState }) => {\r\n    const [expanded, setExpanded] = useState(false);\r\n\r\n    // console.log(`ErrorBox`, { error: props.error, expanded });\r\n\r\n    const errorAsString = typeof props.error === `string` ? `${props.error}` : null;\r\n    const errorMessage = props.error.message ?? errorAsString ?? `Unknown Error`;\r\n    const errorDetails = props.error.data && jsonStringify_safe(props.error.data, true) || undefined;\r\n    const errorObjText = DEBUG && props.error && jsonStringify_safe(props.error, true) || undefined;\r\n    const canExpand = !!errorDetails || !!errorObjText;\r\n\r\n    return (\r\n        <View style={errorBoxStyle.view}>\r\n            <View style={{ flexDirection: `row` }}>\r\n                <TouchableOpacity style={{ flex: 1, flexDirection: `row`, alignItems: `center`, ...errorBoxStyle.button }} onPress={() => setExpanded(!expanded)}>\r\n                    {canExpand && (expanded ? <Icon style={errorBoxStyle.icon} kind={IconKind.expanded} /> : <Icon style={errorBoxStyle.icon} kind={IconKind.collapsed} />)}\r\n                    <View style={{ paddingRight: 8 }}>\r\n                        <Icon style={errorBoxStyle.icon} kind={IconKind.error} />\r\n                    </View>\r\n                    <View style={{ flex: 1, overflow: `hidden` }}>\r\n                        <Text style={errorBoxStyle.text} numberOfLines={!expanded ? 1 : undefined}>{errorMessage}</Text>\r\n                    </View>\r\n                </TouchableOpacity>\r\n                {DEBUG && (\r\n                    <TouchableOpacity style={{ flexDirection: `row`, alignItems: `center`, paddingLeft: 8, ...errorBoxStyle.button }} onPress={() => Clipboard.setString(jsonStringify_safe({ errorMessage, errorDetails, errorObjText }, true))}>\r\n                        <Icon style={errorBoxStyle.icon} kind={IconKind.copy} />\r\n                    </TouchableOpacity>\r\n                )}\r\n                {props.error.retryCallback && (\r\n                    <TouchableOpacity style={{ flexDirection: `row`, alignItems: `center`, paddingLeft: 8, ...errorBoxStyle.button }} onPress={props.error.retryCallback}>\r\n                        <Icon style={errorBoxStyle.icon} kind={IconKind.retry} />\r\n                    </TouchableOpacity>\r\n                )}\r\n            </View>\r\n            {canExpand && expanded && !!errorDetails && (<Text style={{ ...errorBoxStyle.text }}>{errorDetails}</Text>)}\r\n            {canExpand && expanded && !!errorObjText && (<Text style={{ ...errorBoxStyle.text }}>{errorObjText}</Text>)}\r\n        </View>\r\n    );\r\n};\r\n\r\n\r\nexport const ErrorMessage = (props: { children: string }) => {\r\n    return (\r\n        <View style={{ flexDirection: `row`, alignItems: `center` }}>\r\n            <View style={{ paddingLeft: 8, paddingRight: 8 }}>\r\n                <Icon style={errorBoxStyle.icon_errorMessage} kind={IconKind.error} />\r\n            </View>\r\n            <View style={{ overflow: `hidden` }}>\r\n                <Text style={errorBoxStyle.text_errorMessage} numberOfLines={1}>{props.children}</Text>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\n/* eslint-disable jsx-a11y/no-static-element-interactions */\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport { View, Text, ActivityIndicator, TouchableOpacity } from 'react-native-lite';\r\nimport { groupItems } from 'utils/arrays';\r\nimport { toKeyValueArray } from 'utils/objects';\r\nimport { useAutoLoadingError } from 'utils-react/hooks';\r\nimport { defaultDoodleDrawing, DoodleSegment, DoodleDrawing, doodleSegmentToSvgPath_line, DoodleDataWithScore } from './doodle';\r\nimport { createDoodleDrawingStorageService } from './doodle-storage';\r\n\r\nexport const styles = {\r\n    drawing: {\r\n        width: 312,\r\n        height: 312,\r\n        color: `#FFFFFF`,\r\n        backgroundColor: `#000000`,\r\n    },\r\n};\r\n\r\nexport const DoodleTestView = (props: {}) => {\r\n    const [doodle, setDoodle] = useState(defaultDoodleDrawing());\r\n\r\n    return (\r\n        <>\r\n            <DoodleDrawerView style={styles.drawing} drawing={doodle} onChange={setDoodle} />\r\n            <DoodleDisplayView style={styles.drawing} drawing={doodle} />\r\n        </>\r\n    );\r\n};\r\n\r\n// export const DoodleDrawingView = (props: { drawing?: DoodleDrawing, onDrawingChanged: (drawing: DoodleDrawing) => void }) => {\r\n\r\n//     const [doodle, setDoodle] = useState(props.drawing ?? defaultDoodleDrawing());\r\n//     const changeDoodle = (value: DoodleDrawing) => {\r\n//         setDoodle(value);\r\n//         props.onDrawingChanged(value);\r\n//     };\r\n\r\n//     return (\r\n//         <>\r\n//             <DoodleDrawer style={styles.drawing} drawing={doodle} onChange={changeDoodle} />\r\n//             {/* <div>\r\n//                 {JSON.stringify(doodle)}\r\n//             </div> */}\r\n//             {/* <div>\r\n//                 {JSON.stringify(decodeDoodleDrawing(encodeDoodleDrawing(doodle)))}\r\n//             </div> */}\r\n\r\n//             {/* <div>\r\n//                 {encodeDoodleDrawing(doodle).doodleText}\r\n//             </div> */}\r\n//             {/* <div>\r\n//                 {encodeDoodleDrawing(decodeDoodleDrawing(encodeDoodleDrawing(doodle))).doodleText}\r\n//             </div>  */}\r\n//         </>\r\n//     );\r\n// };\r\n\r\n\r\nexport const DoodleDrawerView = (props: { style: { width: number, height: number, color: string, backgroundColor: string }, drawing: DoodleDrawing, onChange: (drawing: DoodleDrawing) => void }) => {\r\n    const { style, drawing, onChange } = props;\r\n    const scale = style.width / drawing.width;\r\n\r\n    const [segment, setSegment] = useState(null as null | DoodleSegment);\r\n    const segmentClientStart = useRef(null as null | { clientX: number, clientY: number, x: number, y: number });\r\n    const divHost = useRef(null as null | HTMLDivElement);\r\n\r\n    type Ev = React.SyntheticEvent;\r\n\r\n    const onIgnore = (e: Ev) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        e.nativeEvent.cancelBubble = true;\r\n        e.nativeEvent.returnValue = false;\r\n        return false;\r\n    };\r\n\r\n    const onPressIn = (event: (Ev) & { clientX?: number, clientY?: number }, pos?: { clientX: number, clientY: number }) => {\r\n        // console.log(`onPressIn`, { event, pos });\r\n        const div = divHost.current;\r\n        if (!div) { return onIgnore(event); }\r\n\r\n        const rect = div.getBoundingClientRect();\r\n\r\n\r\n        const p = {\r\n            clientX: pos?.clientX ?? event.clientX ?? 0,\r\n            clientY: pos?.clientY ?? event.clientY ?? 0,\r\n        };\r\n\r\n        segmentClientStart.current = {\r\n            clientX: p.clientX,\r\n            clientY: p.clientY,\r\n            x: Math.floor((p.clientX - rect.x) / scale),\r\n            y: Math.floor((p.clientY - rect.y) / scale),\r\n        };\r\n\r\n        setSegment({\r\n            points: [{\r\n                x: segmentClientStart.current.x,\r\n                y: segmentClientStart.current.y,\r\n            }],\r\n        });\r\n\r\n        return onIgnore(event);\r\n    };\r\n    const onPressOut = (event: Ev) => {\r\n        // console.log(`onPressOut`, { event });\r\n        const s = segment;\r\n        if (!s) { return onIgnore(event); }\r\n\r\n        onChange({\r\n            ...drawing,\r\n            segments: [...drawing.segments, s],\r\n        });\r\n        setSegment(null);\r\n        segmentClientStart.current = null;\r\n\r\n        return onIgnore(event);\r\n    };\r\n    const onMove = (pos: { x: number, y: number }) => {\r\n        setSegment(s => {\r\n            if (!s) { return null; }\r\n            const lastPos = s.points[s.points.length - 1];\r\n            if (Math.abs(lastPos.x - pos.x) + Math.abs(lastPos.y - pos.y) <= 2) {\r\n                return s;\r\n            }\r\n            return { points: [...s.points, pos] };\r\n        });\r\n    };\r\n    const onClientMove = (event: (Ev) & { clientX?: number, clientY?: number }, pos?: { clientX: number, clientY: number }) => {\r\n        if (!segmentClientStart.current) {\r\n            return onIgnore(event);\r\n        }\r\n\r\n        // console.log(`onClientMove`, { event, pos });\r\n        const p = {\r\n            clientX: pos?.clientX ?? event.clientX ?? 0,\r\n            clientY: pos?.clientY ?? event.clientY ?? 0,\r\n        };\r\n        const dPos = {\r\n            x: Math.floor((p.clientX - segmentClientStart.current.clientX) / scale) + segmentClientStart.current.x,\r\n            y: Math.floor((p.clientY - segmentClientStart.current.clientY) / scale) + segmentClientStart.current.y,\r\n        };\r\n\r\n        onMove(dPos);\r\n        return onIgnore(event);\r\n    };\r\n\r\n    // useEffect(() => {\r\n    //     console.log(`divHost`, { divHost });\r\n    //     const div = divHost.current;\r\n    //     if (!div) { return () => { }; }\r\n\r\n    //     const onTouchStart = (x: Event) => onPressIn(x, (x as TouchEvent).touches[0]);\r\n    //     const onTouchMove = (x: Event) => onClientMove(x, (x as TouchEvent).touches[0]);\r\n\r\n    //     div.addEventListener(`mouseDown`, onPressIn, { passive: false });\r\n    //     div.addEventListener(`onTouchStart`, onTouchStart, { passive: false });\r\n    //     div.addEventListener(`onMouseUp`, onPressOut, { passive: false });\r\n    //     div.addEventListener(`onTouchEnd`, onPressOut, { passive: false });\r\n    //     div.addEventListener(`onMouseLeave`, onPressOut, { passive: false });\r\n    //     div.addEventListener(`onTouchEndCapture`, onPressOut, { passive: false });\r\n    //     div.addEventListener(`onMouseMove`, onClientMove, { passive: false });\r\n    //     div.addEventListener(`onTouchMove`, onTouchMove, { passive: false });\r\n\r\n    //     return () => {\r\n    //         div.removeEventListener(`mouseDown`, onPressIn);\r\n    //         div.removeEventListener(`onTouchStart`, onTouchStart);\r\n    //         div.removeEventListener(`onMouseUp`, onPressOut);\r\n    //         div.removeEventListener(`onTouchEnd`, onPressOut);\r\n    //         div.removeEventListener(`onMouseLeave`, onPressOut);\r\n    //         div.removeEventListener(`onTouchEndCapture`, onPressOut);\r\n    //         div.removeEventListener(`onMouseMove`, onClientMove);\r\n    //         div.removeEventListener(`onTouchMove`, onTouchMove);\r\n    //     };\r\n    // }, [divHost.current]);\r\n\r\n    useEffect(() => {\r\n        // console.log(`Disable scroll on touch`);\r\n        // Disable document scroll\r\n        const onIgnoreNative = (e: Event) => {\r\n            // If not drawing, don't ignore\r\n            if (!segmentClientStart.current) { return true; }\r\n\r\n            // console.log(`Prevent scroll on touch`);\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n            e.cancelBubble = true;\r\n            e.returnValue = false;\r\n            return false;\r\n        };\r\n        document.addEventListener(`touchmove`, onIgnoreNative, { passive: false });\r\n        return () => {\r\n            document.removeEventListener(`touchmove`, onIgnoreNative);\r\n        };\r\n    }, []);\r\n\r\n    return (\r\n        <>\r\n            <div style={{ position: `relative`, width: style.width, height: style.height, backgroundColor: style.backgroundColor }}>\r\n                <svg style={{ width: style.width, height: style.height }} viewBox={`0 0 ${drawing.width} ${drawing.height}`} preserveAspectRatio='none' xmlns='http://www.w3.org/2000/svg'>\r\n                    {drawing.segments.map((x, i) => (\r\n                        <path key={i} d={doodleSegmentToSvgPath_line(x)} stroke={style.color} fill='transparent' />\r\n                    ))}\r\n                    {segment && (\r\n                        <path d={doodleSegmentToSvgPath_line(segment)} stroke={style.color} fill='transparent' />\r\n                    )}\r\n                </svg>\r\n                <div ref={divHost} style={{ position: `absolute`, left: 0, right: 0, top: 0, bottom: 0, zIndex: 10 }}\r\n                    onMouseDown={onPressIn}\r\n                    onMouseUp={onPressOut}\r\n                    onMouseMove={onClientMove}\r\n                    onMouseLeave={onPressOut}\r\n                    onTouchStart={x => onPressIn(x, x.touches[0])}\r\n                    onTouchEnd={onPressOut}\r\n                    onTouchCancel={onPressOut}\r\n                    onTouchMove={x => onClientMove(x, x.touches[0])}\r\n                    onTouchEndCapture={onPressOut}\r\n                />\r\n            </div>\r\n            {/* <div>{doodleToSvg(drawing)}</div>\r\n            <div>{encodeDoodleDrawing(drawing).doodleText}</div> */}\r\n        </>\r\n    );\r\n};\r\n\r\nexport const DoodleDisplayView = (props: {\r\n    style: { width: number, height: number, color: string, backgroundColor: string };\r\n    drawing: DoodleDrawing;\r\n    shouldAnimate?: boolean;\r\n    animatePointsPerSecond?: number;\r\n    enableRedraw?: boolean;\r\n}) => {\r\n\r\n    const [redrawId, setRedrawId] = useState(0);\r\n\r\n    const redraw = () => {\r\n        if (!props.enableRedraw) { return; }\r\n        setRedrawId(s => s + 1);\r\n    };\r\n\r\n    if (props.enableRedraw) {\r\n        return (\r\n            <TouchableOpacity onPress={redraw}>\r\n                <DoodleDisplayView_Inner key={redrawId} {...props} shouldAnimate={redrawId > 0 ? true : (props.shouldAnimate ?? true)} />\r\n            </TouchableOpacity>\r\n        );\r\n    }\r\n    return (\r\n        <DoodleDisplayView_Inner {...props} />\r\n    );\r\n};\r\nconst DoodleDisplayView_Inner = ({\r\n    style,\r\n    drawing,\r\n    shouldAnimate = true,\r\n    animatePointsPerSecond = 20,\r\n}: {\r\n    style: { width: number, height: number, color: string, backgroundColor: string };\r\n    drawing: DoodleDrawing;\r\n    shouldAnimate?: boolean;\r\n    animatePointsPerSecond?: number;\r\n}) => {\r\n    const [tick, setTick] = useState(0);\r\n    const totalPoints = drawing.segments.flatMap(x => x.points).length;\r\n\r\n    useEffect(() => {\r\n        if (!shouldAnimate) { return () => { }; }\r\n\r\n        // console.log(`DoodleDisplayView_Inner.useEffect`);\r\n        const id = setInterval(() => {\r\n            // console.log(`DoodleDisplayView_Inner.useEffect.setInterval`);\r\n            setTick(s => {\r\n                if (s > totalPoints) { clearInterval(id); }\r\n                return s + Math.ceil(animatePointsPerSecond / 10);\r\n            });\r\n        }, 10);\r\n\r\n        return () => {\r\n            clearInterval(id);\r\n        };\r\n    }, [drawing]);\r\n\r\n    let remainingPoints = shouldAnimate ? tick : Number.MAX_SAFE_INTEGER;\r\n    return (\r\n        <div style={{ width: style.width, height: style.height, backgroundColor: style.backgroundColor }}>\r\n            <svg style={{ width: style.width, height: style.height }} viewBox={`0 0 ${drawing.width} ${drawing.height}`} preserveAspectRatio='none' xmlns='http://www.w3.org/2000/svg'>\r\n                {drawing.segments.map((x, i) => {\r\n                    const maxPoints = remainingPoints;\r\n                    remainingPoints = Math.max(0, remainingPoints - x.points.length);\r\n                    return (\r\n                        <path key={i} d={doodleSegmentToSvgPath_line({ points: [...x.points.slice(0, maxPoints)] })} stroke={style.color} fill='transparent' />\r\n                    );\r\n                })}\r\n            </svg>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const DoodleBrowser = () => {\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const [doodles, setDoodles] = useState([] as DoodleDataWithScore[]);\r\n    useEffect(() => {\r\n        doWork(async () => {\r\n            const service = await createDoodleDrawingStorageService();\r\n            const result = await service.getAllDrawings();\r\n            setDoodles(result.doodles);\r\n        });\r\n    }, []);\r\n\r\n    if (loading) {\r\n        return (\r\n            <ActivityIndicator size='large' color='#FFFF00' />\r\n        );\r\n    }\r\n\r\n    return (\r\n        <DoodleBrowseView doodles={doodles} />\r\n    );\r\n};\r\nexport const DoodleBrowseView = ({ doodles }: { doodles: DoodleDataWithScore[] }) => {\r\n\r\n    const grouped = toKeyValueArray(groupItems(doodles, x => x.prompt));\r\n\r\n    return (\r\n        <>\r\n            {grouped.map(g => (\r\n                <View key={g.key} style={{ padding: 4 }}>\r\n                    <Text style={{ fontSize: 12 }} >{g.key}</Text>\r\n                    <View style={{ padding: 4, flexDirection: `row`, flexWrap: `wrap` }}>\r\n                        {g.value.map(x => (\r\n                            <View key={x.key} style={{ padding: 4, alignItems: `center` }}>\r\n                                <DoodleDisplayView style={{ width: 104, height: 104, color: `#FFFFFF`, backgroundColor: `#000000` }} drawing={x.drawing} shouldAnimate={false} enableRedraw />\r\n                                <Text >{`${x.score}`}</Text>\r\n                            </View>\r\n                        ))}\r\n                    </View>\r\n                </View>\r\n            ))}\r\n        </>\r\n    );\r\n};\r\n","import { createSubscribable } from 'utils/subscribable';\r\nimport { AppError } from 'utils/error';\r\nimport { WebsocketApi, WebsocketConnectionEvent, WebsocketConnectionData } from './types';\r\n\r\nexport const createWebsocketClient = (config: { websocketsApiUrl: string }): WebsocketApi => {\r\n\r\n    const api: WebsocketApi = {\r\n        connect: <T>({ channelKey }: WebsocketConnectionData) => {\r\n            // With this implementation, the server simply echos all messages to all clients\r\n            // The client will filter those messages client-side with the key\r\n            // NOTE: When the server filters via keys (providing privacy), this will continue to work without changes\r\n\r\n            type MessageContainer = {\r\n                message: T | null;\r\n                key: string;\r\n            };\r\n\r\n            const subscribable = createSubscribable<T>();\r\n            const subscribableEvents = createSubscribable<WebsocketConnectionEvent>();\r\n\r\n            // Connect to websocket (and reconnect, etc.)\r\n            const createSocket = () => {\r\n                const socket = new WebSocket(`${config.websocketsApiUrl}`);\r\n\r\n                // Connection opened\r\n                socket.addEventListener(`open`, (event) => {\r\n                    if (socket !== activeSocket) {\r\n                        socket.close();\r\n                        return;\r\n                    }\r\n\r\n                    subscribableEvents.onStateChange({ connectionStatus: `opened` });\r\n\r\n                    // Send a key message\r\n                    const messageContainer: MessageContainer = {\r\n                        message: null,\r\n                        key: channelKey,\r\n                    };\r\n                    socket.send(JSON.stringify(messageContainer));\r\n\r\n                });\r\n                socket.addEventListener(`close`, (event) => {\r\n                    if (socket !== activeSocket) {\r\n                        socket.close();\r\n                        return;\r\n                    }\r\n\r\n                    subscribableEvents.onStateChange({ connectionStatus: `closed` });\r\n                    reconnect();\r\n                });\r\n                socket.addEventListener(`error`, (event) => {\r\n                    if (socket !== activeSocket) {\r\n                        socket.close();\r\n                        return;\r\n                    }\r\n\r\n                    subscribableEvents.onStateChange({ connectionStatus: `error`, error: { message: `Websocket Error`, error: event } });\r\n                    reconnect();\r\n                });\r\n\r\n                // Listen for messages\r\n                socket.addEventListener(`message`, (event) => {\r\n                    // console.log(`socket message`, { event });\r\n                    if (socket !== activeSocket) {\r\n                        socket.close();\r\n                        return;\r\n                    }\r\n\r\n                    const m = JSON.parse(event.data) as MessageContainer;\r\n                    if (m.key !== channelKey || !m.message) { return; }\r\n                    subscribable.onStateChange(m.message);\r\n                });\r\n\r\n                return socket;\r\n            };\r\n\r\n            let isClosed = false;\r\n            let activeSocket: null | WebSocket = createSocket();\r\n            const reconnect = () => {\r\n                if (isClosed) { return; }\r\n\r\n                setTimeout(() => {\r\n                    activeSocket = createSocket();\r\n                }, 50);\r\n            };\r\n\r\n            // Send Messages\r\n            const send = (message: T) => {\r\n                if (!activeSocket || activeSocket.readyState !== WebSocket.OPEN) {\r\n                    throw new AppError(`Websocket is not open`);\r\n                }\r\n                const messageContainer: MessageContainer = {\r\n                    message,\r\n                    key: channelKey,\r\n                };\r\n                activeSocket.send(JSON.stringify(messageContainer));\r\n            };\r\n\r\n            return {\r\n                send,\r\n                isConnected: () => activeSocket?.readyState === WebSocket.OPEN,\r\n                subscribeMessages: subscribable.subscribe,\r\n                subscribeConnectionEvents: subscribableEvents.subscribe,\r\n                close: () => {\r\n                    isClosed = true;\r\n                    activeSocket?.close();\r\n                    activeSocket = null;\r\n                },\r\n            };\r\n        },\r\n    };\r\n\r\n    return api;\r\n};\r\n","/* eslint-disable no-bitwise */\r\n\r\n// From: https://stackoverflow.com/a/52171480\r\n/** Generate an integer hashCode */\r\nconst cyrb53 = (str: string, seed = 0): number => {\r\n    let h1 = 0xDEADBEEF ^ seed; let h2 = 0x41C6CE57 ^ seed;\r\n    for (let i = 0, ch; i < str.length; i++) {\r\n        ch = str.charCodeAt(i);\r\n        h1 = Math.imul(h1 ^ ch, 2654435761);\r\n        h2 = Math.imul(h2 ^ ch, 1597334677);\r\n    }\r\n    h1 = Math.imul(h1 ^ (h1 >>> 16), 2246822507) ^ Math.imul(h2 ^ (h2 >>> 13), 3266489909);\r\n    h2 = Math.imul(h2 ^ (h2 >>> 16), 2246822507) ^ Math.imul(h1 ^ (h1 >>> 13), 3266489909);\r\n\r\n    // 53-bit int\r\n    return 4294967296 * (2097151 & h2) + (h1 >>> 0);\r\n\r\n    // Generate a 64-bit hashcode as a string\r\n    // return (h2 >>> 0).toString(16).padStart(8, `0`) + (h1 >>> 0).toString(16).padStart(8, `0`);\r\n};\r\n\r\nexport const hashCode = cyrb53;\r\n","import { hashCode } from 'utils/hash-code';\r\nimport { LessonProjectState, LessonProjectStateFilesHashCode } from './lesson-types';\r\n\r\nexport const calculateFilesHashCode = (files: LessonProjectState['files']): LessonProjectStateFilesHashCode => {\r\n    const allText = files.map(x => `${x.content}:${x.path}:${x.language}::`).join(``);\r\n    return `${hashCode(allText)}` as LessonProjectStateFilesHashCode;\r\n};\r\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('react')) : typeof define === 'function' && define.amd ? define(['exports', 'react'], factory) : (global = global || self, factory(global.ReactStripe = {}, global.React));\n})(this, function (exports, React) {\n  'use strict';\n\n  React = React && React.hasOwnProperty('default') ? React['default'] : React;\n\n  function _typeof(obj) {\n    \"@babel/helpers - typeof\";\n\n    if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n      _typeof = function _typeof(obj) {\n        return typeof obj;\n      };\n    } else {\n      _typeof = function _typeof(obj) {\n        return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n      };\n    }\n\n    return _typeof(obj);\n  }\n\n  function _objectWithoutPropertiesLoose(source, excluded) {\n    if (source == null) return {};\n    var target = {};\n    var sourceKeys = Object.keys(source);\n    var key, i;\n\n    for (i = 0; i < sourceKeys.length; i++) {\n      key = sourceKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      target[key] = source[key];\n    }\n\n    return target;\n  }\n\n  function _objectWithoutProperties(source, excluded) {\n    if (source == null) return {};\n\n    var target = _objectWithoutPropertiesLoose(source, excluded);\n\n    var key, i;\n\n    if (Object.getOwnPropertySymbols) {\n      var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n      for (i = 0; i < sourceSymbolKeys.length; i++) {\n        key = sourceSymbolKeys[i];\n        if (excluded.indexOf(key) >= 0) continue;\n        if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n        target[key] = source[key];\n      }\n    }\n\n    return target;\n  }\n\n  function _slicedToArray(arr, i) {\n    return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest();\n  }\n\n  function _arrayWithHoles(arr) {\n    if (Array.isArray(arr)) return arr;\n  }\n\n  function _iterableToArrayLimit(arr, i) {\n    if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n      return;\n    }\n\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n  }\n\n  function createCommonjsModule(fn, module) {\n    return module = {\n      exports: {}\n    }, fn(module, module.exports), module.exports;\n  }\n  /**\n   * Copyright (c) 2013-present, Facebook, Inc.\n   *\n   * This source code is licensed under the MIT license found in the\n   * LICENSE file in the root directory of this source tree.\n   */\n\n\n  var ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n  var ReactPropTypesSecret_1 = ReactPropTypesSecret;\n\n  function emptyFunction() {}\n\n  function emptyFunctionWithReset() {}\n\n  emptyFunctionWithReset.resetWarningCache = emptyFunction;\n\n  var factoryWithThrowingShims = function factoryWithThrowingShims() {\n    function shim(props, propName, componentName, location, propFullName, secret) {\n      if (secret === ReactPropTypesSecret_1) {\n        // It is still safe when called from React.\n        return;\n      }\n\n      var err = new Error('Calling PropTypes validators directly is not supported by the `prop-types` package. ' + 'Use PropTypes.checkPropTypes() to call them. ' + 'Read more at http://fb.me/use-check-prop-types');\n      err.name = 'Invariant Violation';\n      throw err;\n    }\n\n    shim.isRequired = shim;\n\n    function getShim() {\n      return shim;\n    } // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n\n\n    var ReactPropTypes = {\n      array: shim,\n      bool: shim,\n      func: shim,\n      number: shim,\n      object: shim,\n      string: shim,\n      symbol: shim,\n      any: shim,\n      arrayOf: getShim,\n      element: shim,\n      elementType: shim,\n      instanceOf: getShim,\n      node: shim,\n      objectOf: getShim,\n      oneOf: getShim,\n      oneOfType: getShim,\n      shape: getShim,\n      exact: getShim,\n      checkPropTypes: emptyFunctionWithReset,\n      resetWarningCache: emptyFunction\n    };\n    ReactPropTypes.PropTypes = ReactPropTypes;\n    return ReactPropTypes;\n  };\n\n  var propTypes = createCommonjsModule(function (module) {\n    /**\n     * Copyright (c) 2013-present, Facebook, Inc.\n     *\n     * This source code is licensed under the MIT license found in the\n     * LICENSE file in the root directory of this source tree.\n     */\n    {\n      // By explicitly using `prop-types` you are opting into new production behavior.\n      // http://fb.me/prop-types-in-prod\n      module.exports = factoryWithThrowingShims();\n    }\n  });\n\n  var isUnknownObject = function isUnknownObject(raw) {\n    return raw !== null && _typeof(raw) === 'object';\n  };\n\n  var isPromise = function isPromise(raw) {\n    return isUnknownObject(raw) && typeof raw.then === 'function';\n  }; // We are using types to enforce the `stripe` prop in this lib,\n  // but in an untyped integration `stripe` could be anything, so we need\n  // to do some sanity validation to prevent type errors.\n\n\n  var isStripe = function isStripe(raw) {\n    return isUnknownObject(raw) && typeof raw.elements === 'function' && typeof raw.createToken === 'function' && typeof raw.createPaymentMethod === 'function' && typeof raw.confirmCardPayment === 'function';\n  };\n\n  var PLAIN_OBJECT_STR = '[object Object]';\n\n  var isEqual = function isEqual(left, right) {\n    if (!isUnknownObject(left) || !isUnknownObject(right)) {\n      return left === right;\n    }\n\n    var leftArray = Array.isArray(left);\n    var rightArray = Array.isArray(right);\n    if (leftArray !== rightArray) return false;\n    var leftPlainObject = Object.prototype.toString.call(left) === PLAIN_OBJECT_STR;\n    var rightPlainObject = Object.prototype.toString.call(right) === PLAIN_OBJECT_STR;\n    if (leftPlainObject !== rightPlainObject) return false;\n    if (!leftPlainObject && !leftArray) return false;\n    var leftKeys = Object.keys(left);\n    var rightKeys = Object.keys(right);\n    if (leftKeys.length !== rightKeys.length) return false;\n    var keySet = {};\n\n    for (var i = 0; i < leftKeys.length; i += 1) {\n      keySet[leftKeys[i]] = true;\n    }\n\n    for (var _i = 0; _i < rightKeys.length; _i += 1) {\n      keySet[rightKeys[_i]] = true;\n    }\n\n    var allKeys = Object.keys(keySet);\n\n    if (allKeys.length !== leftKeys.length) {\n      return false;\n    }\n\n    var l = left;\n    var r = right;\n\n    var pred = function pred(key) {\n      return isEqual(l[key], r[key]);\n    };\n\n    return allKeys.every(pred);\n  };\n\n  var usePrevious = function usePrevious(value) {\n    var ref = React.useRef(value);\n    React.useEffect(function () {\n      ref.current = value;\n    }, [value]);\n    return ref.current;\n  };\n\n  var INVALID_STRIPE_ERROR = 'Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.'; // We are using types to enforce the `stripe` prop in this lib, but in a real\n  // integration `stripe` could be anything, so we need to do some sanity\n  // validation to prevent type errors.\n\n  var validateStripe = function validateStripe(maybeStripe) {\n    if (maybeStripe === null || isStripe(maybeStripe)) {\n      return maybeStripe;\n    }\n\n    throw new Error(INVALID_STRIPE_ERROR);\n  };\n\n  var parseStripeProp = function parseStripeProp(raw) {\n    if (isPromise(raw)) {\n      return {\n        tag: 'async',\n        stripePromise: Promise.resolve(raw).then(validateStripe)\n      };\n    }\n\n    var stripe = validateStripe(raw);\n\n    if (stripe === null) {\n      return {\n        tag: 'empty'\n      };\n    }\n\n    return {\n      tag: 'sync',\n      stripe: stripe\n    };\n  };\n\n  var ElementsContext = React.createContext(null);\n  ElementsContext.displayName = 'ElementsContext';\n\n  var parseElementsContext = function parseElementsContext(ctx, useCase) {\n    if (!ctx) {\n      throw new Error(\"Could not find Elements context; You need to wrap the part of your app that \".concat(useCase, \" in an <Elements> provider.\"));\n    }\n\n    return ctx;\n  };\n  /**\n   * The `Elements` provider allows you to use [Element components](https://stripe.com/docs/stripe-js/react#element-components) and access the [Stripe object](https://stripe.com/docs/js/initializing) in any nested component.\n   * Render an `Elements` provider at the root of your React app so that it is available everywhere you need it.\n   *\n   * To use the `Elements` provider, call `loadStripe` from `@stripe/stripe-js` with your publishable key.\n   * The `loadStripe` function will asynchronously load the Stripe.js script and initialize a `Stripe` object.\n   * Pass the returned `Promise` to `Elements`.\n   *\n   * @docs https://stripe.com/docs/stripe-js/react#elements-provider\n   */\n\n\n  var Elements = function Elements(_ref) {\n    var rawStripeProp = _ref.stripe,\n        options = _ref.options,\n        children = _ref.children;\n\n    var _final = React.useRef(false);\n\n    var isMounted = React.useRef(true);\n    var parsed = React.useMemo(function () {\n      return parseStripeProp(rawStripeProp);\n    }, [rawStripeProp]);\n\n    var _React$useState = React.useState(function () {\n      return {\n        stripe: null,\n        elements: null\n      };\n    }),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        ctx = _React$useState2[0],\n        setContext = _React$useState2[1];\n\n    var prevStripe = usePrevious(rawStripeProp);\n    var prevOptions = usePrevious(options);\n\n    if (prevStripe !== null) {\n      if (prevStripe !== rawStripeProp) {\n        console.warn('Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.');\n      }\n\n      if (!isEqual(options, prevOptions)) {\n        console.warn('Unsupported prop change on Elements: You cannot change the `options` prop after setting the `stripe` prop.');\n      }\n    }\n\n    if (!_final.current) {\n      if (parsed.tag === 'sync') {\n        _final.current = true;\n        setContext({\n          stripe: parsed.stripe,\n          elements: parsed.stripe.elements(options)\n        });\n      }\n\n      if (parsed.tag === 'async') {\n        _final.current = true;\n        parsed.stripePromise.then(function (stripe) {\n          if (stripe && isMounted.current) {\n            // Only update Elements context if the component is still mounted\n            // and stripe is not null. We allow stripe to be null to make\n            // handling SSR easier.\n            setContext({\n              stripe: stripe,\n              elements: stripe.elements(options)\n            });\n          }\n        });\n      }\n    }\n\n    React.useEffect(function () {\n      return function () {\n        isMounted.current = false;\n      };\n    }, []);\n    React.useEffect(function () {\n      var anyStripe = ctx.stripe;\n\n      if (!anyStripe || !anyStripe._registerWrapper) {\n        return;\n      }\n\n      anyStripe._registerWrapper({\n        name: 'react-stripe-js',\n        version: \"1.1.2\"\n      });\n    }, [ctx.stripe]);\n    return React.createElement(ElementsContext.Provider, {\n      value: ctx\n    }, children);\n  };\n\n  var useElementsContextWithUseCase = function useElementsContextWithUseCase(useCaseMessage) {\n    var ctx = React.useContext(ElementsContext);\n    return parseElementsContext(ctx, useCaseMessage);\n  };\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#useelements-hook\n   */\n\n\n  var useElements = function useElements() {\n    var _useElementsContextWi = useElementsContextWithUseCase('calls useElements()'),\n        elements = _useElementsContextWi.elements;\n\n    return elements;\n  };\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#usestripe-hook\n   */\n\n\n  var useStripe = function useStripe() {\n    var _useElementsContextWi2 = useElementsContextWithUseCase('calls useStripe()'),\n        stripe = _useElementsContextWi2.stripe;\n\n    return stripe;\n  };\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#elements-consumer\n   */\n\n\n  var ElementsConsumer = function ElementsConsumer(_ref2) {\n    var children = _ref2.children;\n    var ctx = useElementsContextWithUseCase('mounts <ElementsConsumer>'); // Assert to satisfy the busted React.FC return type (it should be ReactNode)\n\n    return children(ctx);\n  };\n\n  ElementsConsumer.propTypes = {\n    children: propTypes.func.isRequired\n  };\n\n  var useCallbackReference = function useCallbackReference(cb) {\n    var ref = React.useRef(cb);\n    React.useEffect(function () {\n      ref.current = cb;\n    }, [cb]);\n    return function () {\n      if (ref.current) {\n        ref.current.apply(ref, arguments);\n      }\n    };\n  };\n\n  var extractUpdateableOptions = function extractUpdateableOptions(options) {\n    if (!isUnknownObject(options)) {\n      return {};\n    }\n\n    var _ = options.paymentRequest,\n        rest = _objectWithoutProperties(options, [\"paymentRequest\"]);\n\n    return rest;\n  };\n\n  var noop = function noop() {};\n\n  var capitalized = function capitalized(str) {\n    return str.charAt(0).toUpperCase() + str.slice(1);\n  };\n\n  var createElementComponent = function createElementComponent(type, isServer) {\n    var displayName = \"\".concat(capitalized(type), \"Element\");\n\n    var ClientElement = function ClientElement(_ref) {\n      var id = _ref.id,\n          className = _ref.className,\n          _ref$options = _ref.options,\n          options = _ref$options === void 0 ? {} : _ref$options,\n          _ref$onBlur = _ref.onBlur,\n          onBlur = _ref$onBlur === void 0 ? noop : _ref$onBlur,\n          _ref$onFocus = _ref.onFocus,\n          onFocus = _ref$onFocus === void 0 ? noop : _ref$onFocus,\n          _ref$onReady = _ref.onReady,\n          onReady = _ref$onReady === void 0 ? noop : _ref$onReady,\n          _ref$onChange = _ref.onChange,\n          onChange = _ref$onChange === void 0 ? noop : _ref$onChange,\n          _ref$onEscape = _ref.onEscape,\n          onEscape = _ref$onEscape === void 0 ? noop : _ref$onEscape,\n          _ref$onClick = _ref.onClick,\n          onClick = _ref$onClick === void 0 ? noop : _ref$onClick;\n\n      var _useElementsContextWi = useElementsContextWithUseCase(\"mounts <\".concat(displayName, \">\")),\n          elements = _useElementsContextWi.elements;\n\n      var elementRef = React.useRef(null);\n      var domNode = React.useRef(null);\n      var callOnReady = useCallbackReference(onReady);\n      var callOnBlur = useCallbackReference(onBlur);\n      var callOnFocus = useCallbackReference(onFocus);\n      var callOnClick = useCallbackReference(onClick);\n      var callOnChange = useCallbackReference(onChange);\n      var callOnEscape = useCallbackReference(onEscape);\n      React.useLayoutEffect(function () {\n        if (elementRef.current == null && elements && domNode.current != null) {\n          var element = elements.create(type, options);\n          elementRef.current = element;\n          element.mount(domNode.current);\n          element.on('ready', function () {\n            return callOnReady(element);\n          });\n          element.on('change', callOnChange);\n          element.on('blur', callOnBlur);\n          element.on('focus', callOnFocus);\n          element.on('escape', callOnEscape); // Users can pass an an onClick prop on any Element component\n          // just as they could listen for the `click` event on any Element,\n          // but only the PaymentRequestButton will actually trigger the event.\n\n          element.on('click', callOnClick);\n        }\n      });\n      var prevOptions = React.useRef(options);\n      React.useEffect(function () {\n        if (prevOptions.current && prevOptions.current.paymentRequest !== options.paymentRequest) {\n          console.warn('Unsupported prop change: options.paymentRequest is not a customizable property.');\n        }\n\n        var updateableOptions = extractUpdateableOptions(options);\n\n        if (Object.keys(updateableOptions).length !== 0 && !isEqual(updateableOptions, extractUpdateableOptions(prevOptions.current))) {\n          if (elementRef.current) {\n            elementRef.current.update(updateableOptions);\n            prevOptions.current = options;\n          }\n        }\n      }, [options]);\n      React.useEffect(function () {\n        return function () {\n          if (elementRef.current) {\n            elementRef.current.destroy();\n          }\n        };\n      }, []);\n      return React.createElement(\"div\", {\n        id: id,\n        className: className,\n        ref: domNode\n      });\n    }; // Only render the Element wrapper in a server environment.\n\n\n    var ServerElement = function ServerElement(props) {\n      // Validate that we are in the right context by calling useElementsContextWithUseCase.\n      useElementsContextWithUseCase(\"mounts <\".concat(displayName, \">\"));\n      var id = props.id,\n          className = props.className;\n      return React.createElement(\"div\", {\n        id: id,\n        className: className\n      });\n    };\n\n    var Element = isServer ? ServerElement : ClientElement;\n    Element.propTypes = {\n      id: propTypes.string,\n      className: propTypes.string,\n      onChange: propTypes.func,\n      onBlur: propTypes.func,\n      onFocus: propTypes.func,\n      onReady: propTypes.func,\n      onClick: propTypes.func,\n      options: propTypes.object\n    };\n    Element.displayName = displayName;\n    Element.__elementType = type;\n    return Element;\n  };\n\n  var isServer = typeof window === 'undefined';\n  /**\n   * Requires beta access:\n   * Contact [Stripe support](https://support.stripe.com/) for more information.\n   *\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var AuBankAccountElement = createElementComponent('auBankAccount', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var CardElement = createElementComponent('card', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var CardNumberElement = createElementComponent('cardNumber', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var CardExpiryElement = createElementComponent('cardExpiry', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var CardCvcElement = createElementComponent('cardCvc', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var FpxBankElement = createElementComponent('fpxBank', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var IbanElement = createElementComponent('iban', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var IdealBankElement = createElementComponent('idealBank', isServer);\n  /**\n   * @docs https://stripe.com/docs/stripe-js/react#element-components\n   */\n\n  var PaymentRequestButtonElement = createElementComponent('paymentRequestButton', isServer);\n  exports.AuBankAccountElement = AuBankAccountElement;\n  exports.CardCvcElement = CardCvcElement;\n  exports.CardElement = CardElement;\n  exports.CardExpiryElement = CardExpiryElement;\n  exports.CardNumberElement = CardNumberElement;\n  exports.Elements = Elements;\n  exports.ElementsConsumer = ElementsConsumer;\n  exports.FpxBankElement = FpxBankElement;\n  exports.IbanElement = IbanElement;\n  exports.IdealBankElement = IdealBankElement;\n  exports.PaymentRequestButtonElement = PaymentRequestButtonElement;\n  exports.useElements = useElements;\n  exports.useStripe = useStripe;\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n});","export type PhoneNumber = string & { __type: 'PhoneNumber', format: '+19785551234' };\r\nexport type PhoneNumberFormatted = string & { __type: 'PhoneNumber', format: '(###) ###-####' };\r\n\r\nexport function formatPhoneNumber_UsaCanada(text: string): PhoneNumberFormatted {\r\n    return phoneNumberMask_UsaCanada(text).corrected as PhoneNumberFormatted;\r\n}\r\n\r\nexport function toStandardPhoneNumber(text: string): PhoneNumber {\r\n    return `+1${phoneNumberMask_UsaCanada(text).digitsNo1}` as PhoneNumber;\r\n}\r\n\r\nexport function toStandardPhoneNumber_optional(text: string | null | undefined): PhoneNumber | undefined {\r\n    if (!text) { return undefined; }\r\n    return `+1${phoneNumberMask_UsaCanada(text).digitsNo1}` as PhoneNumber;\r\n}\r\n\r\nexport function phoneNumberMask_UsaCanada(x: string | null | undefined) {\r\n    const numberMask = `(###) ###-####`;\r\n    const digits = x\r\n        ?.replace(/^(\\+1|1)/, ``)\r\n        .replace(/\\D/g, ``)\r\n        .split(``) ?? [];\r\n    const letters = numberMask.split(``);\r\n    let iDigit = 0;\r\n    let iLast = -1;\r\n    for (let i = 0; i < letters.length; i++) {\r\n        if (letters[i] === `#` && iDigit < digits.length) {\r\n            letters[i] = digits[iDigit];\r\n            iDigit++;\r\n            iLast = i;\r\n        }\r\n    }\r\n    const full = letters.join(``);\r\n    const corrected = letters.slice(0, iLast + 1).join(``);\r\n    return { corrected, full, digitsNo1: digits.join(``) };\r\n}\r\n","import { LessonData, LessonModule } from '../common/lesson-types';\r\nimport { calculateFilesHashCode } from '../common/lesson-hash';\r\n\r\nexport const createDefaultLesson = (): LessonData => {\r\n    const file = {\r\n        path: `test.tsx`,\r\n        content: `\r\nimport React from 'react';\r\n\r\nexport const MinimalReactComponent = (props: {}) => {\r\n    return (\r\n        <span>Hello World!</span>\r\n    );\r\n};\r\n        `.trim(),\r\n        language: `tsx` as const,\r\n    };\r\n    const file0 = {\r\n        path: `test0.tsx`,\r\n        content: `\r\nimport React from 'react';\r\n\r\nexport const MinimalReactComponent0 = (props: {}) => {\r\n    return (\r\n        <span>Hello World 0!</span>\r\n    );\r\n};\r\n        `.trim(),\r\n        language: `tsx` as const,\r\n    };\r\n    const file2 = {\r\n        path: `test2.tsx`,\r\n        content: `\r\nimport React from 'react';\r\n\r\nexport const MinimalReactComponent2 = (props: {}) => {\r\n    return (\r\n        <span>Hello World 2!</span>\r\n    );\r\n};\r\n        `.trim(),\r\n        language: `tsx` as const,\r\n    };\r\n\r\n    const focusIndex = file.content.indexOf(`<span>Hello World!</span>`);\r\n    const focusLength = `<span>Hello World!</span>`.length;\r\n    const files = [file0, file, file2];\r\n    const lesson: LessonData = {\r\n        key: `Lesson-${Date.now()}-${(`${Math.random()}`).substr(2)}`,\r\n        projectState: {\r\n            files,\r\n            filesHashCode: calculateFilesHashCode(files),\r\n        },\r\n        focus: {\r\n            filePath: file.path,\r\n            index: focusIndex,\r\n            length: focusLength,\r\n        },\r\n        title: `Test Lesson`,\r\n        objective: `Test the Editor`,\r\n        explanation: `Learn some stuff`,\r\n        task: `Make a test variable true`,\r\n        descriptions: [],\r\n        experiments: [],\r\n    };\r\n    return lesson;\r\n};\r\n\r\nexport const cloneLesson = (lesson: LessonData): LessonData => {\r\n    const newLesson = JSON.parse(JSON.stringify(lesson));\r\n    return {\r\n        ...newLesson,\r\n        key: `Lesson-${Date.now()}-${(`${Math.random()}`).substr(2)}`,\r\n    };\r\n};\r\n\r\nexport const createDefaultLessonModule = (): LessonModule => {\r\n    return {\r\n        key: `Module-${Date.now()}-${(`${Math.random()}`).substr(2)}`,\r\n        title: `Module`,\r\n        lessons: [createDefaultLesson()],\r\n    };\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\nimport React, { useEffect, useState } from 'react';\r\nimport { View, Text, TextInput, TouchableOpacity } from 'react-native-lite';\r\nimport { LessonProjectFilesEditor, LessonProjectEditorMode, LessonFileEditorMode } from '../common/components/lesson-file-editor';\r\nimport { LessonData, LessonExperiment, LessonProjectFileSelection, LessonProjectState, LessonStep_ConstructCode, LessonStep_UnderstandCode, SetProjectState } from '../common/lesson-types';\r\nimport { lessonExperiments_createReplacementProjectState, lessonExperiments_calculateProjectStateReplacements } from '../common/replacements';\r\nimport { LessonView_ConstructCode, LessonView_ExperimentCode, LessonView_UnderstandCode } from '../common/components/lesson-view';\r\nimport { LessonProjectStatePreview, LessonRenderView } from '../common/components/lesson-render-view';\r\nimport { calculateFilesHashCode } from '../common/lesson-hash';\r\n\r\nconst styles = {\r\n    container: {\r\n        background: `#111111`,\r\n    },\r\n    containerPanel: {\r\n        background: `#292a2d`,\r\n    },\r\n    editorModeTabRowView: {\r\n        flexDirection: `row`,\r\n        paddingLeft: 16,\r\n    },\r\n    editorModeTabView: {\r\n        background: `#1e1e1e`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        marginRight: 1,\r\n    },\r\n    editorModeTabView_selected: {\r\n        background: `#292a2d`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        marginRight: 1,\r\n    },\r\n    editorModeTabText: {\r\n        fontSize: 14,\r\n        color: `#FFFFFFF`,\r\n    },\r\n    editorModeTabText_selected: {\r\n        fontSize: 14,\r\n        color: `#FFFF88`,\r\n    },\r\n    buttonView: {\r\n        background: `#1e1e1e`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        margin: 1,\r\n    },\r\n    buttonText: {\r\n        fontSize: 14,\r\n        color: `#FFFFFFF`,\r\n    },\r\n    sectionHeaderText: {\r\n        margin: 8,\r\n        fontSize: 18,\r\n        color: `#FFFF88`,\r\n    },\r\n    infoView: {\r\n    },\r\n    infoText: {\r\n        margin: 8,\r\n        fontSize: 12,\r\n        wrap: `wrap`,\r\n    },\r\n    lessonFieldView: {\r\n        flexDirection: `row`,\r\n    },\r\n    lessonFieldLabelText: {\r\n        minWidth: 80,\r\n        padding: 4,\r\n        fontSize: 12,\r\n    },\r\n    lessonFieldText: {\r\n        flex: 1,\r\n        padding: 4,\r\n        fontSize: 12,\r\n        wrap: `wrap`,\r\n    },\r\n    jsonText: {\r\n        padding: 4,\r\n        fontSize: 12,\r\n        color: `#FFFFFF`,\r\n        background: `#000000`,\r\n    },\r\n} as const;\r\n\r\nconst createLessonState = (lesson: LessonData, lessonJson?: string) => {\r\n    type LessonSteps = {\r\n        constructCode: LessonStep_ConstructCode;\r\n        understandCode: LessonStep_UnderstandCode;\r\n    };\r\n    const lessonSteps: LessonSteps = {\r\n        constructCode: {\r\n            lessonData: lesson,\r\n        },\r\n        understandCode: {\r\n            lessonData: lesson,\r\n        },\r\n    };\r\n\r\n    return {\r\n        lesson,\r\n        lessonJson: lessonJson ?? JSON.stringify(lesson, null, 2),\r\n        lessonSteps,\r\n    };\r\n};\r\n\r\nexport const LessonEditor = (props: { value: LessonData, onChange: (value: LessonData) => void, setProjectState: SetProjectState }) => {\r\n\r\n    const [data, setData] = useState(createLessonState(props.value));\r\n    type EditorMode = 'edit' | 'json' | 'construct-code' | 'understand-code' | 'experiment-code' | 'preview';\r\n    const [editorMode, setEditorMode] = useState(`edit` as EditorMode);\r\n    const editorModes = [\r\n        { value: `edit`, label: `Edit` },\r\n        { value: `json`, label: `Json` },\r\n        { value: `construct-code`, label: `Construct Code` },\r\n        { value: `understand-code`, label: `Understand Code` },\r\n        { value: `experiment-code`, label: `Experiment Code` },\r\n        { value: `preview`, label: `Preview` },\r\n    ] as { value: EditorMode, label: string }[];\r\n    const projectEditorMode: LessonProjectEditorMode =\r\n        editorMode === `edit` ? `edit`\r\n            : `display`;\r\n    const fileEditorMode_focus: LessonFileEditorMode =\r\n        editorMode === `edit` ? `edit`\r\n            : editorMode === `construct-code` ? `construct-code`\r\n                : `display`;\r\n    const fileEditorMode_noFocus: LessonFileEditorMode =\r\n        editorMode === `edit` ? `edit`\r\n            : editorMode === `construct-code` ? `display`\r\n                : `display`;\r\n\r\n    const changeLessonState = (value: typeof data) => {\r\n        setData(value);\r\n        props.onChange(value.lesson);\r\n    };\r\n    const changeLessonJson = (json: string) => {\r\n        changeLessonState(createLessonState(JSON.parse(json), json));\r\n    };\r\n\r\n    const onProjectDataChange = (projectData: { projectState?: LessonProjectState, focus?: LessonProjectFileSelection }) => {\r\n        changeLessonState(createLessonState({\r\n            ...data.lesson,\r\n            ...projectData,\r\n        }));\r\n    };\r\n    const onLessonChange = (lesson: Partial<LessonData>) => {\r\n        changeLessonState(createLessonState({\r\n            ...data.lesson,\r\n            ...lesson,\r\n        }));\r\n    };\r\n\r\n    const {\r\n        projectState,\r\n        focus,\r\n    } = data.lesson;\r\n\r\n    return (\r\n        <>\r\n            <View style={styles.container}>\r\n                <View style={styles.editorModeTabRowView}>\r\n                    {editorModes.map(x => (\r\n                        <TouchableOpacity key={x.value + editorMode} onPress={() => setEditorMode(x.value)}>\r\n                            <View style={x.value === editorMode ? styles.editorModeTabView_selected : styles.editorModeTabView}>\r\n                                <Text style={x.value === editorMode ? styles.editorModeTabText_selected : styles.editorModeTabText}>{x.label}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </View>\r\n                <View style={styles.containerPanel}>\r\n                    {editorMode === `json` && (\r\n                        <>\r\n                            <Text style={styles.sectionHeaderText}>Lesson Data</Text>\r\n                            <View>\r\n                                <TextInput\r\n                                    style={styles.jsonText}\r\n                                    value={data.lessonJson}\r\n                                    onChange={changeLessonJson}\r\n                                    autoCompleteType='off'\r\n                                    keyboardType='default'\r\n                                    multiline\r\n                                    numberOfLines={20}\r\n                                />\r\n                            </View>\r\n                        </>\r\n                    )}\r\n                    {editorMode === `edit` && (\r\n                        <>\r\n                            <Text style={styles.sectionHeaderText}>Project Files</Text>\r\n                            <LessonProjectFilesEditor\r\n                                projectData={{\r\n                                    projectState,\r\n                                    focus,\r\n                                }}\r\n                                fileEditorMode_focus={fileEditorMode_focus}\r\n                                fileEditorMode_noFocus={fileEditorMode_noFocus}\r\n                                projectEditorMode={projectEditorMode}\r\n                                onProjectDataChange={onProjectDataChange}\r\n                                lessonData={data.lesson}\r\n                            />\r\n                            <Text style={styles.sectionHeaderText}>Lesson</Text>\r\n                            <View style={styles.infoView}>\r\n                                <LessonField label='Title' value={data.lesson.title} onChange={x => onLessonChange({ title: x })} />\r\n                                <LessonField label='Objective' value={data.lesson.objective} onChange={x => onLessonChange({ objective: x })} />\r\n                                <LessonField label='Explanation' value={data.lesson.explanation} onChange={x => onLessonChange({ explanation: x })} />\r\n                                <LessonField label='Task' value={data.lesson.task} onChange={x => onLessonChange({ task: x })} />\r\n                                <LessonField_Descriptions label='Descriptions' value={data.lesson.descriptions} onChange={x => onLessonChange({ descriptions: x })} />\r\n                                <LessonField_Experiments label='Experiments' value={data.lesson.experiments} onChange={x => onLessonChange({ experiments: x })} lessonData={data.lesson} />\r\n                            </View>\r\n                        </>\r\n                    )}\r\n                    {editorMode === `construct-code` && (\r\n                        <LessonView_ConstructCode data={data.lesson} />\r\n                    )}\r\n                    {editorMode === `understand-code` && (\r\n                        <LessonView_UnderstandCode data={data.lesson} />\r\n                    )}\r\n                    {editorMode === `experiment-code` && (\r\n                        <LessonView_ExperimentCode data={data.lesson} setProjectState={props.setProjectState} />\r\n                    )}\r\n                    {editorMode === `preview` && (\r\n                        <LessonProjectStatePreview projectState={data.lesson.projectState} setProjectState={props.setProjectState} />\r\n                    )}\r\n                </View>\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n\r\nconst LessonField = ({ label, value, onChange }: { label: string, value: string, onChange: (value: string) => void }) => {\r\n    return (\r\n        <View style={styles.lessonFieldView}>\r\n            <Text style={styles.lessonFieldLabelText}>{label}</Text>\r\n            <TextInput\r\n                style={styles.lessonFieldText}\r\n                value={value}\r\n                onChange={onChange}\r\n                autoCompleteType='off'\r\n                keyboardType='default'\r\n            />\r\n        </View>\r\n    );\r\n};\r\n\r\nconst LessonField_Descriptions = ({ label, value, onChange }: { label: string, value: string[], onChange: (value: string[]) => void }) => {\r\n    return (\r\n        <View style={styles.lessonFieldView}>\r\n            <Text style={styles.lessonFieldLabelText}>{label}</Text>\r\n            <TextInput\r\n                style={styles.lessonFieldText}\r\n                value={value.join(`\\n`)}\r\n                onChange={x => onChange(x.replace(/\\r\\n/, `\\n`).split(`\\n`))}\r\n                autoCompleteType='off'\r\n                keyboardType='default'\r\n                multiline\r\n                numberOfLines={5}\r\n            />\r\n        </View>\r\n    );\r\n};\r\n\r\n\r\nconst LessonField_Experiments = ({ label, value, onChange, lessonData }: {\r\n    label: string; value: LessonExperiment[]; onChange: (value: LessonExperiment[]) => void;\r\n    lessonData: LessonData;\r\n}) => {\r\n    return (\r\n        <View style={{}}>\r\n            <Text style={styles.lessonFieldLabelText}>{label}</Text>\r\n            {value.map((x, i) => (\r\n                <LessonField_Experiment key={`${i}`} label={`Experiment ${i}`} value={x}\r\n                    onChange={v => onChange(value.map((y, j) => i === j ? v : y))}\r\n                    onDelete={() => { value.splice(i, 1); onChange(value); }} lessonData={lessonData} />\r\n            ))}\r\n            <TouchableOpacity onPress={() => { value.push({ replacements: [], comment: ``, filesHashCode: calculateFilesHashCode([]) }); onChange(value); }}>\r\n                <View style={styles.buttonView}>\r\n                    <Text style={styles.buttonText}>{`${``} Add Experiment`}</Text>\r\n                </View>\r\n            </TouchableOpacity>\r\n        </View>\r\n    );\r\n};\r\n\r\n\r\nconst LessonField_Experiment = ({\r\n    label,\r\n    value,\r\n    onChange,\r\n    onDelete,\r\n    lessonData,\r\n}: {\r\n    label: string;\r\n    value: LessonExperiment;\r\n    onChange: (value: LessonExperiment) => void;\r\n    onDelete: () => void;\r\n    lessonData: LessonData;\r\n}) => {\r\n    const [modifiedProjectState, setModifiedProjectState] = useState(lessonData.projectState);\r\n    const [lastFocus, setLastFocus] = useState({ filePath: modifiedProjectState.files[0].path, index: 0, length: modifiedProjectState.files[0].content.length });\r\n    const [commentText, setCommentText] = useState(value.comment ?? ``);\r\n\r\n    useEffect(() => {\r\n        setModifiedProjectState(s => (lessonExperiments_createReplacementProjectState(lessonData.projectState, value.replacements)));\r\n    }, [lessonData.projectState]);\r\n\r\n    const changeProjectData = (data: { projectState?: LessonProjectState, focus?: LessonProjectFileSelection }) => {\r\n        if (data.focus) {\r\n            setLastFocus(data.focus);\r\n        }\r\n\r\n        if (!data.projectState) { return; }\r\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n        setModifiedProjectState(data.projectState!);\r\n        onChange({ ...lessonExperiments_calculateProjectStateReplacements(lessonData.projectState, data.projectState), comment: commentText, filesHashCode: calculateFilesHashCode(lessonData.projectState.files) });\r\n    };\r\n\r\n    return (\r\n        <View style={{}}>\r\n            <View style={{ flexDirection: `row` }}>\r\n                <Text style={styles.lessonFieldLabelText}>{label}</Text>\r\n                <View style={{ flex: 1 }} />\r\n                <TouchableOpacity onPress={onDelete}>\r\n                    <View style={styles.buttonView}>\r\n                        <Text style={styles.buttonText}>{`${``} Delete Experiment`}</Text>\r\n                    </View>\r\n                </TouchableOpacity>\r\n            </View>\r\n            <View style={styles.lessonFieldView}>\r\n                <Text style={styles.lessonFieldLabelText}>Comment</Text>\r\n                <TextInput\r\n                    style={styles.lessonFieldText}\r\n                    value={commentText}\r\n                    onChange={setCommentText}\r\n                    onBlur={() => onChange({ ...value, comment: commentText })}\r\n                    autoCompleteType='off'\r\n                    keyboardType='default'\r\n                />\r\n            </View>\r\n            <LessonProjectFilesEditor\r\n                key={modifiedProjectState.filesHashCode}\r\n                projectData={{\r\n                    projectState: modifiedProjectState,\r\n                    focus: lastFocus,\r\n                }}\r\n                fileEditorMode_focus='edit'\r\n                fileEditorMode_noFocus='edit'\r\n                projectEditorMode='display'\r\n                onProjectDataChange={changeProjectData}\r\n                lessonData={lessonData}\r\n            />\r\n            {value.replacements.map(x => (\r\n                <View key={x.selection.filePath + x.selection.index} >\r\n                    <View style={{ flexDirection: `row` }}>\r\n                        <Text style={{ minWidth: 80 }}>File</Text>\r\n                        <Text style={{ marginLeft: 4, background: `#111111` }}>{`${x.selection.filePath}`}</Text>\r\n                    </View>\r\n                    <View style={{ flexDirection: `row` }}>\r\n                        <Text style={{ minWidth: 80 }}>Match</Text>\r\n                        <Text style={{ marginLeft: 4, background: `#111111`, color: `#FF8888`, textDecoration: `line-through` }}>{`${lessonData.projectState.files.find(f => f.path === x.selection.filePath)?.content.substr(x.selection.index, x.selection.length)}`}</Text>\r\n                    </View>\r\n                    <View style={{ flexDirection: `row` }}>\r\n                        <Text style={{ minWidth: 80 }}>Replace</Text>\r\n                        <Text style={{ marginLeft: 4, background: `#111111`, color: `#8888FF` }}>{`${x.content}`}</Text>\r\n                    </View>\r\n                </View>\r\n            ))}\r\n        </View>\r\n    );\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\nimport React, { useState } from 'react';\r\nimport { TouchableOpacity, View, Text, TextInput } from 'react-native-lite';\r\nimport { TabsComponent, TabsListEditorComponent } from '../common/components/tabs';\r\nimport { LessonData, LessonModule, LessonProjectState, SetProjectState } from '../common/lesson-types';\r\nimport { cloneLesson, createDefaultLesson, createDefaultLessonModule } from './lesson-defaults';\r\nimport { LessonEditor } from './lesson-editor';\r\n\r\n\r\nconst styles = {\r\n    container: {\r\n        background: `#111111`,\r\n    },\r\n    containerPanel: {\r\n        background: `#292a2d`,\r\n    },\r\n    sectionHeaderText: {\r\n        margin: 8,\r\n        fontSize: 18,\r\n        color: `#FFFF88`,\r\n    },\r\n    jsonText: {\r\n        padding: 4,\r\n        fontSize: 12,\r\n        color: `#FFFFFF`,\r\n        background: `#000000`,\r\n    },\r\n} as const;\r\n\r\n\r\nexport const LessonModuleEditor = (props: { value?: LessonModule, onChange?: (value: LessonModule) => void, setProjectState: SetProjectState }) => {\r\n    const [module, setModule] = useState(props.value ?? createDefaultLessonModule());\r\n    const [activeLesson, setActiveLesson] = useState(module.lessons[0]);\r\n    const [mode, setMode] = useState(`lesson` as 'lesson' | 'json');\r\n\r\n    const changeActiveLesson = (value: LessonData) => {\r\n        setModule(s => {\r\n            const newModule = {\r\n                ...s,\r\n                lessons: s.lessons.map(x => {\r\n                    if (x === activeLesson) {\r\n                        return value;\r\n                    }\r\n                    return x;\r\n                }),\r\n            };\r\n            setTimeout(() => {\r\n                props.onChange?.(newModule);\r\n            });\r\n            return newModule;\r\n        });\r\n        setActiveLesson(value);\r\n    };\r\n    const changeModuleTitle = (value: string) => {\r\n        setModule(s => {\r\n            const newModule = {\r\n                ...s,\r\n                title: value,\r\n            };\r\n            setTimeout(() => {\r\n                props.onChange?.(newModule);\r\n            });\r\n            return newModule;\r\n        });\r\n    };\r\n\r\n    return (\r\n        <>\r\n\r\n            <View style={styles.container}>\r\n                <TabsComponent\r\n                    header='Module'\r\n                    items={[`lesson` as const, `json` as const]}\r\n                    getKey={x => x}\r\n                    getLabel={x => x}\r\n                    selected={mode}\r\n                    onSelect={setMode}\r\n                />\r\n                <TextInput\r\n                    style={styles.jsonText}\r\n                    value={module.title}\r\n                    onChange={changeModuleTitle}\r\n                    autoCompleteType='off'\r\n                    keyboardType='default'\r\n                />\r\n                {mode === `lesson` && (\r\n                    <>\r\n                        <TabsListEditorComponent\r\n                            style={{ selectedTabText: { color: `#88FF88` } }}\r\n                            header='Lessons'\r\n                            items={module.lessons}\r\n                            onChange={x => setModule(s => ({ ...s, lessons: x }))}\r\n                            getKey={x => x.key}\r\n                            getLabel={x => x.title}\r\n                            selected={activeLesson}\r\n                            onSelect={x => setActiveLesson(x)}\r\n                            onCreateNewItem={() => cloneLesson(activeLesson) ?? createDefaultLesson()}\r\n                        />\r\n                        {activeLesson && (\r\n                            <>\r\n                                <LessonEditor key={activeLesson.key} value={activeLesson} onChange={changeActiveLesson} setProjectState={props.setProjectState} />\r\n                            </>\r\n                        )}\r\n                    </>\r\n                )}\r\n                {mode === `json` && (\r\n                    <>\r\n                        <Text style={styles.sectionHeaderText}>Module Data</Text>\r\n                        <View>\r\n                            <TextInput\r\n                                style={styles.jsonText}\r\n                                value={JSON.stringify(module, null, 2)}\r\n                                onChange={x => setModule(JSON.parse(x))}\r\n                                autoCompleteType='off'\r\n                                keyboardType='default'\r\n                                multiline\r\n                                numberOfLines={20}\r\n                            />\r\n                        </View>\r\n                    </>\r\n                )}\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n","function _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nfunction _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nvar V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\n\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.5.0\"\n  });\n};\n\nvar stripePromise = null;\n\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\n\nvar initStripe = function initStripe(maybeStripe, args) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(void 0, _toConsumableArray(args));\n  registerWrapper(stripe);\n  return stripe;\n}; // own script injection.\n\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\n\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args);\n  });\n};\n\nexport { loadStripe };","\r\nexport enum ProcessSteps_CreateSavedPaymentMethod {\r\n    _01_Client_BeginCreateSavedPaymentMethod = 100,\r\n    _02_Server_SetupSavedPaymentMethod = 200,\r\n    _03_Client_CollectPaymentDetails = 300,\r\n    _04_Server_ObtainPaymentMethod = 400,\r\n    _05_Server_SavePaymentMethod = 500,\r\n};\r\n\r\nexport const logProcessStep_CreateSavedPaymentMethod = (step: ProcessSteps_CreateSavedPaymentMethod, status?: 'BEGIN' | 'END' | 'FAIL', data?: unknown) => {\r\n    // TODO: Implement Universal Logger\r\n\r\n    // eslint-disable-next-line no-console\r\n    console.log(`CreateSavedPaymentMethod: ${ProcessSteps_CreateSavedPaymentMethod[step]} ${status}`, data);\r\n};\r\n\r\nexport const wrapProcessStep_CreateSavedPaymentMethod = async <TResult>(step: ProcessSteps_CreateSavedPaymentMethod, execute: () => Promise<TResult>): Promise<TResult> => {\r\n    try {\r\n        logProcessStep_CreateSavedPaymentMethod(step, `BEGIN`);\r\n\r\n        const result = await execute();\r\n        logProcessStep_CreateSavedPaymentMethod(step, `END`);\r\n        return result;\r\n    } catch (error) {\r\n        logProcessStep_CreateSavedPaymentMethod(step, `FAIL`, { error });\r\n        throw error;\r\n    }\r\n};\r\n","/** This token is used to identify a specific app user with the user's id in the provider's context (i.e. customer id) */\r\nexport type PaymentProviderUserToken = unknown & { __type: 'PaymentProviderUserToken' };\r\n/** This token is used to identify the client as it negotiates directly with the provider to enter payment method data */\r\nexport type PaymentProviderSavedPaymentMethodClientSetupToken = unknown & { __type: 'PaymentProviderSavedPaymentMethodClientSetupToken' };\r\n/** This token is used to identify the payment method obtained on the client from the provider */\r\nexport type PaymentProviderSavedPaymentMethodClientToken = unknown & { __type: 'PaymentProviderSavedPaymentMethodClientToken' };\r\n/** This token is used to identify the payment method long term after being verified by the provider on the server */\r\nexport type PaymentProviderSavedPaymentMethodStorageToken = unknown & { __type: 'PaymentProviderSavedPaymentMethodStorageToken' };\r\n\r\n/** PaymentProviderName identifies the payment provider and it's implementation (i.e. stripe, paypal, etc.) */\r\nexport type PaymentProviderName = string & { __type: 'PaymentProviderName' };\r\n\r\n/** PaymentMethodStorageKey is the auto generated storage key to uniquely identify a stored payment method */\r\nexport type PaymentMethodStorageKey = string & { __type: 'PaymentMethodStorageKey' };\r\n\r\nexport type PaymentMethodExpiration = {\r\n    year: number;\r\n    month: number;\r\n};\r\nexport type PaymentMethodClientInfo = {\r\n    key: PaymentMethodStorageKey;\r\n    providerName: PaymentProviderName;\r\n    title: string;\r\n    expiration: PaymentMethodExpiration;\r\n};\r\n\r\nexport type PaymentAmount = { currency: 'usd', usdCents: number };\r\n\r\nexport type PaymentTransaction = {\r\n    providerName: PaymentProviderName;\r\n    created: Date;\r\n    amount: PaymentAmount;\r\n    status: 'success' | 'incomplete' | 'terminated';\r\n}\r\n\r\n/** Payment Client to Server Calls\r\n * \r\n * These are the calls made on the client to the server, it supports multiple payment provider types\r\n * \r\n * Note: this is scoped to the user associated with the client\r\n */\r\nexport type PaymentClientApi = {\r\n    // Normal Flow\r\n    setupSavedPaymentMethod: (params: { providerName: PaymentProviderName }) => Promise<PaymentProviderSavedPaymentMethodClientSetupToken>;\r\n    saveSavedPaymentMethod: (params: { providerName: PaymentProviderName, paymentMethodClientToken: PaymentProviderSavedPaymentMethodClientToken }) => Promise<void>;\r\n\r\n    // Management of Payment Methods\r\n    getSavedPaymentMethods: () => Promise<PaymentMethodClientInfo[]>;\r\n    deleteSavedPaymentMethod: (params: { key: PaymentMethodStorageKey }) => Promise<void>;\r\n\r\n    // Management of Payments\r\n    debug_triggerPayment: (params: { amount: PaymentAmount }) => Promise<void>;\r\n    getPayments: () => Promise<PaymentTransaction[]>;\r\n    // getPaymentsRequiringUserAction: () => Promise<PaymentTransaction[]>;\r\n}\r\n\r\n\r\n/** Payment Server to Server Calls\r\n * \r\n * These are the calls intended to be used server-side to process payments\r\n * \r\n */\r\nexport type PaymentServerApi = {\r\n    /** This will use the payment methods in order until one succeeds */\r\n    chargeUsingSavedPaymentMethods: (params: { amount: PaymentAmount }) => Promise<void>;\r\n}\r\n\r\n/** Payment Server to Payment Provider Api Calls\r\n * \r\n * This wraps the provider-specific server code\r\n */\r\nexport type PaymentProviderApi = {\r\n    providerName: PaymentProviderName;\r\n    setupSavedPaymentMethod: (userToken: PaymentProviderUserToken | null) => Promise<{\r\n        newUserToken?: PaymentProviderUserToken;\r\n        setupToken: PaymentProviderSavedPaymentMethodClientSetupToken;\r\n    }>;\r\n    obtainSavedPaymentMethod: (userToken: PaymentProviderUserToken, clientToken: PaymentProviderSavedPaymentMethodClientToken) => Promise<{\r\n        token: PaymentProviderSavedPaymentMethodStorageToken;\r\n        title: string;\r\n        expiration: PaymentMethodExpiration;\r\n    }>;\r\n    chargeSavedPaymentMethod: (userToken: PaymentProviderUserToken, token: PaymentProviderSavedPaymentMethodStorageToken, amount: PaymentAmount) => Promise<void>;\r\n\r\n    getPayments: (userToken: PaymentProviderUserToken) => Promise<PaymentTransaction[]>;\r\n}\r\n\r\n/** Payment Server Dependencies */\r\nexport type PaymentMethodStorageData = {\r\n    /** Key should be auto-generated by storage provider */\r\n    key: PaymentMethodStorageKey;\r\n    title: string;\r\n    expiration: PaymentMethodExpiration;\r\n    providerName: PaymentProviderName;\r\n    paymentMethodStorageToken: PaymentProviderSavedPaymentMethodStorageToken;\r\n};\r\n\r\nexport type PaymentUserTokenData = {\r\n    providerName: PaymentProviderName;\r\n    userToken: PaymentProviderUserToken;\r\n};\r\n\r\nexport type PaymentStorageProviderApi = {\r\n    getUserToken: (params: { providerName: PaymentProviderName }) => Promise<PaymentUserTokenData | null>;\r\n    setUserToken: (params: PaymentUserTokenData) => Promise<void>;\r\n\r\n    savePaymentMethod: (params: Omit<PaymentMethodStorageData, 'key'>) => Promise<void>;\r\n    /** Return all saved payment methods - In the order that they were created */\r\n    getSavedPaymentMethods: () => Promise<PaymentMethodStorageData[]>;\r\n    deleteSavedPaymentMethod: (params: { key: PaymentMethodStorageKey }) => Promise<void>;\r\n}\r\n\r\nexport class PaymentError extends Error {\r\n    constructor(public message: string, public data?: unknown) { super(); }\r\n}\r\n","/* eslint-disable @typescript-eslint/quotes */\r\n/* eslint-disable prefer-template */\r\nimport { ProcessSteps_CreateSavedPaymentMethod } from '../../../common/process-steps';\r\n\r\n// Saved Payments: https://stripe.com/docs/payments/save-and-reuse\r\nexport enum ProcessSteps_CreateSavedPaymentMethod_Stripe {\r\n    _02A_Server_GetOrCreateCustomer = ProcessSteps_CreateSavedPaymentMethod._02_Server_SetupSavedPaymentMethod + 1,\r\n    _02B_Server_CreateSetupIntent = ProcessSteps_CreateSavedPaymentMethod._02_Server_SetupSavedPaymentMethod + 2,\r\n    _03A_Client_CollectPaymentDetails = ProcessSteps_CreateSavedPaymentMethod._03_Client_CollectPaymentDetails + 1,\r\n    _04A_Server_ObtainPaymentMethod = ProcessSteps_CreateSavedPaymentMethod._04_Server_ObtainPaymentMethod + 1,\r\n    _04B_Server_ObtainPaymentMethodDetails = ProcessSteps_CreateSavedPaymentMethod._04_Server_ObtainPaymentMethod + 2,\r\n};\r\n\r\nexport const logProcessStep_CreateSavedPaymentMethod_Stripe = (step: ProcessSteps_CreateSavedPaymentMethod_Stripe, status?: 'BEGIN' | 'END' | 'FAIL', data?: unknown) => {\r\n    // TODO: Implement Universal Logger\r\n\r\n    // eslint-disable-next-line no-console\r\n    console.log(`CreateSavedPaymentMethod_Stripe: ${ProcessSteps_CreateSavedPaymentMethod_Stripe[step]} ${status}`, data);\r\n};\r\n\r\nexport const wrapProcessStep_CreateSavedPaymentMethod_Stripe = async <TResult>(step: ProcessSteps_CreateSavedPaymentMethod_Stripe, execute: () => Promise<TResult>): Promise<TResult> => {\r\n    try {\r\n        logProcessStep_CreateSavedPaymentMethod_Stripe(step, `BEGIN`);\r\n\r\n        const result = await execute();\r\n        logProcessStep_CreateSavedPaymentMethod_Stripe(step, `END`);\r\n        return result;\r\n    } catch (error) {\r\n        logProcessStep_CreateSavedPaymentMethod_Stripe(step, `FAIL`, { error });\r\n        throw error;\r\n    }\r\n};\r\n","import React, { useState } from 'react';\r\nimport { Elements, CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\r\nimport { loadStripe, PaymentMethod, PaymentMethodCreateParams } from '@stripe/stripe-js';\r\nimport { PaymentClientComponents } from '../../../common/types-react';\r\nimport { PaymentError } from '../../../common/types';\r\nimport { stripeDecodeClientSetupToken, stripeEncodeClientToken } from './stripe-client-tokens';\r\nimport { wrapProcessStep_CreateSavedPaymentMethod_Stripe, ProcessSteps_CreateSavedPaymentMethod_Stripe } from '../common/stripe-process-steps';\r\n\r\nexport const createPaymentClientComponents_stripe = (params: { stripePublicKey: string }): PaymentClientComponents => {\r\n\r\n    const stripePromise = loadStripe(params.stripePublicKey);\r\n\r\n    const components: PaymentClientComponents = {\r\n        AppWrapperComponent: ({ children }) => (<Elements stripe={stripePromise}>{children}</Elements>),\r\n        PaymentMethodEntryComponent: ({ style, paymentMethodSetupToken, onPaymentMethodReady }) => {\r\n            const stripe = useStripe();\r\n            const elements = useElements();\r\n\r\n            const [stripeError, setStripeError] = useState(null as null | { message: string, error: unknown });\r\n\r\n            const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\r\n                event.preventDefault();\r\n                if (!stripe || !elements) { return; }\r\n\r\n                try {\r\n                    // Completed SetupIntent -> Used to get PaymentMethod\r\n                    const setupIntent = await wrapProcessStep_CreateSavedPaymentMethod_Stripe(\r\n                        ProcessSteps_CreateSavedPaymentMethod_Stripe._03A_Client_CollectPaymentDetails,\r\n                        async () => {\r\n\r\n                            const setupInfo = stripeDecodeClientSetupToken(paymentMethodSetupToken);\r\n\r\n                            const result = await stripe.confirmCardSetup(setupInfo.clientSecret, {\r\n                                payment_method: {\r\n                                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n                                    card: elements.getElement(CardElement)!,\r\n                                    billing_details: setupInfo.customerBillingDetails,\r\n                                },\r\n                            });\r\n\r\n                            if (result.error || !result.setupIntent) {\r\n                                throw new PaymentError(`Stripe Payment Error`, result.error);\r\n                            }\r\n\r\n                            return result.setupIntent;\r\n                        });\r\n                    if (!setupIntent) { return; }\r\n\r\n                    onPaymentMethodReady(stripeEncodeClientToken({ setupIntent }));\r\n                } catch (error) {\r\n                    setStripeError({ message: `Stripe Payment Error`, error });\r\n                }\r\n            };\r\n\r\n            const s = style;\r\n            const inputStyle = {\r\n                base: {\r\n                    color: s.textColor,\r\n                    fontSize: s.fontSize ? `${s.fontSize}px` : ``,\r\n                    fontFamily: s.fontFamily,\r\n                    fontSmoothing: `antialiased`,\r\n                    \"::placeholder\": {\r\n                        color: s.textColor,\r\n                        opacity: 0.8,\r\n                    },\r\n                },\r\n                invalid: {\r\n                    color: s.textColor_invalid,\r\n                    iconColor: s.textColor_invalid,\r\n                },\r\n            };\r\n            const inputContainerStyle = {\r\n                marginBottom: s.elementPadding,\r\n                padding: s.textPadding,\r\n                backgroundColor: s.backgroundColor,\r\n                borderWidth: 1, borderStyle: `solid`, borderColor: s.borderColor, borderRadius: s.borderRadius,\r\n            };\r\n            const buttonStyle = {\r\n                color: s.textColor,\r\n                backgroundColor: s.backgroundColor,\r\n                borderWidth: 1, borderStyle: `solid`, borderColor: s.borderColor, borderRadius: s.borderRadius,\r\n\r\n                fontSize: s.fontSize ? `${s.fontSize}px` : ``,\r\n                fontFamily: s.fontFamily,\r\n                fontSmoothing: `antialiased`,\r\n                fontWeight: `bold`,\r\n                padding: s.textPadding,\r\n                marginBottom: s.elementPadding,\r\n            } as const;\r\n            const buttonJustifyContent = s.buttonAlignment === `left` ? `flex-start`\r\n                : (s.buttonAlignment === `right` ? `flex-end`\r\n                    : `center`);\r\n\r\n            const errorContainerStyle = {\r\n                marginBottom: s.elementPadding,\r\n                padding: s.textPadding,\r\n                backgroundColor: s.backgroundColor,\r\n                borderWidth: 1, borderStyle: `solid`, borderColor: s.borderColor, borderRadius: s.borderRadius,\r\n            };\r\n            const errorMessageStyle = {\r\n                color: s.textColor_invalid,\r\n\r\n                fontSize: s.fontSize ? `${s.fontSize}px` : ``,\r\n                fontFamily: s.fontFamily,\r\n                fontSmoothing: `antialiased`,\r\n                fontWeight: `bold`,\r\n                padding: s.textPadding,\r\n                marginBottom: s.elementPadding,\r\n            } as const;\r\n\r\n            return (\r\n                <form onSubmit={handleSubmit}>\r\n                    <div style={inputContainerStyle}>\r\n                        <CardElement options={{ style: inputStyle }} />\r\n                    </div>\r\n                    {stripeError && (\r\n                        <>\r\n                            <div style={errorContainerStyle}>\r\n                                <span style={errorMessageStyle}>{stripeError.message}</span>\r\n                            </div>\r\n                        </>\r\n                    )}\r\n\r\n                    {!stripeError && (\r\n                        <div style={{ display: `flex`, flexDirection: `row`, justifyContent: buttonJustifyContent }}>\r\n                            <button type='submit' disabled={!stripe || !elements} style={buttonStyle}>{s.buttonText ?? `Subscribe`}</button>\r\n                        </div>\r\n                    )}\r\n                </form>\r\n            );\r\n        },\r\n    };\r\n\r\n    return components;\r\n};\r\n","export type DoodleDrawingStorageService = {\r\n    saveDrawing: (prompt: string, drawing: DoodleDrawing) => Promise<void>;\r\n    saveBestDrawingSelection: (doodle: DoodleData) => Promise<void>;\r\n    getDrawings: (prompt: string, options?: { includeOtherPrompts?: boolean, maxCount?: number }) => Promise<{ doodles: DoodleData[] }>;\r\n    getAllDrawings: () => Promise<{ doodles: DoodleDataWithScore[] }>;\r\n};\r\n\r\n\r\nexport type DoodleSummaryDataJson = {\r\n    doodles: DoodleData_EncodedWithScore[];\r\n};\r\nexport type DoodleData_EncodedWithScore = DoodleData_Encoded & {\r\n    s: number;\r\n};\r\n\r\nexport type DoodleUserDrawingDataJson = {\r\n    doodles: DoodleData_Encoded[];\r\n};\r\n\r\nexport type DoodleUserVotesDataJson = {\r\n    doodleVotes: DoodleScoreVote[];\r\n};\r\n\r\nexport type DoodleScoreVote = {\r\n    // Doodle Key\r\n    k: string;\r\n    // Doodle Timestamp\r\n    t: number;\r\n};\r\n\r\nexport type DoodleScore = {\r\n    doodleKey: string;\r\n    score: number;\r\n};\r\n\r\nexport type DoodleDataWithScore = {\r\n    key: string;\r\n    drawing: DoodleDrawing;\r\n    prompt: string;\r\n    timestamp: number;\r\n    score: number;\r\n};\r\n\r\nexport type DoodleData = {\r\n    key: string;\r\n    drawing: DoodleDrawing;\r\n    prompt: string;\r\n    timestamp: number;\r\n};\r\nexport type DoodleData_Encoded = {\r\n    // Doodle Key\r\n    k: string;\r\n    // Doodle Drawing\r\n    d: DoodleDrawingEncoded;\r\n    // Prompt\r\n    p: string;\r\n    // Doodle Timestamp\r\n    t: number;\r\n};\r\n\r\nexport type DoodleDrawing = {\r\n    width: number;\r\n    height: number;\r\n    segments: DoodleSegment[];\r\n};\r\nexport type DoodleSegment = {\r\n    points: { x: number, y: number }[];\r\n};\r\n\r\n// const sampleDrawing: DoodleDrawing = {\r\n//     width: 128,\r\n//     height: 128,\r\n//     segments: [{\r\n//         points: [\r\n//             { x: 10, y: 10 },\r\n//             { x: 50, y: 10 },\r\n//             { x: 50, y: 50 },\r\n//             { x: 10, y: 50 },\r\n//             { x: 10, y: 10 },\r\n//         ],\r\n//     }],\r\n// };\r\n\r\nexport const defaultDoodleDrawing = (): DoodleDrawing => ({\r\n    width: 104,\r\n    height: 104,\r\n    segments: [],\r\n});\r\n\r\nexport type DoodleDrawingEncoded = {\r\n    doodleText: string;\r\n};\r\ntype DoodleDrawingEncodedObj = {\r\n    w: number;\r\n    h: number;\r\n    s: {\r\n        x: number;\r\n        y: number;\r\n        p: string;\r\n    }[];\r\n};\r\nconst encodeDoodleSegmentPoints = (points: { x: number, y: number }[]): string => {\r\n    if (points.length <= 0) { return ``; }\r\n    let last = points[0];\r\n    let t = ``;\r\n\r\n    points.slice(1).forEach(p => {\r\n        t += `${p.x - last.x},${p.y - last.y};`;\r\n        last = p;\r\n    });\r\n\r\n    return t;\r\n};\r\nconst decodeDoodleSegmentPoints = (x: number, y: number, pointsString: string): { x: number, y: number }[] => {\r\n    if (!pointsString) { return [{ x, y }]; }\r\n    let last = { x, y };\r\n    const pointRelPos = pointsString.split(`;`).filter(p => p);\r\n    const points = pointRelPos.map(p => {\r\n        const parts = p.split(`,`);\r\n        const point = {\r\n            x: last.x + Number.parseInt(parts[0], 10),\r\n            y: last.y + Number.parseInt(parts[1], 10),\r\n        };\r\n        last = point;\r\n        return point;\r\n    });\r\n\r\n    return [...points];\r\n};\r\n\r\nexport const encodeDoodleDrawing = (doodle: DoodleDrawing): DoodleDrawingEncoded => {\r\n    const o: DoodleDrawingEncodedObj = {\r\n        w: doodle.width,\r\n        h: doodle.height,\r\n        s: doodle.segments.map(x => ({\r\n            x: x.points[0].x,\r\n            y: x.points[0].y,\r\n            p: encodeDoodleSegmentPoints(x.points),\r\n        })),\r\n    };\r\n    return { doodleText: JSON.stringify(o) };\r\n};\r\nexport const decodeDoodleDrawing = (doodle: DoodleDrawingEncoded): DoodleDrawing => {\r\n    const o: DoodleDrawingEncodedObj = JSON.parse(doodle.doodleText) as DoodleDrawingEncodedObj;\r\n    return {\r\n        width: o.w,\r\n        height: o.h,\r\n        segments: o.s.map(p => {\r\n            return {\r\n                points: [{ x: p.x, y: p.y }, ...decodeDoodleSegmentPoints(p.x, p.y, p.p)],\r\n            };\r\n        }),\r\n    };\r\n};\r\n\r\n\r\n// const doodleSegmentToSvgPath_bezier = (segment: DoodleSegment) => {\r\n//     const delta1 = {\r\n//         x: segment.points[2].x - segment.points[1].x,\r\n//         y: segment.points[2].y - segment.points[1].y,\r\n//     };\r\n//     const controlPoint = {\r\n//         x: segment.points[1].x - delta1.x * 0.5,\r\n//         y: segment.points[1].y - delta1.y * 0.5,\r\n//     };\r\n//     return `M${segment.points[0].x} ${segment.points[0].y} Q${controlPoint.x} ${controlPoint.y} ${segment.points[1].x} ${segment.points[1].y}T${segment.points.slice(2, -1).map(p => `${p.x} ${p.y}`).join(` `)}`;\r\n// };\r\n\r\n\r\nexport const doodleSegmentToSvgPath_line = (segment: DoodleSegment) => {\r\n    if (segment.points.length <= 0) { return ``; }\r\n    if (segment.points.length === 1) { return `M${segment.points[0].x} ${segment.points[0].y} L${segment.points[0].x} ${segment.points[0].y}`; }\r\n\r\n    let last = segment.points[0];\r\n    return `M${segment.points[0].x} ${segment.points[0].y} l${segment.points.slice(1).map(p => {\r\n        const t = `${p.x - last.x} ${p.y - last.y}`;\r\n        last = p;\r\n        return t;\r\n    }).join(` `)}`;\r\n};\r\n\r\nexport const doodleToSvg = (drawing: DoodleDrawing) => {\r\n    // preserveAspectRatio='none' stroke='#000000' fill='transparent' xmlns='http://www.w3.org/2000/svg'\r\n    return `\r\n<svg viewBox='0 0 ${drawing.width} ${drawing.height}' stroke='#000000' fill='transparent'>\r\n    ${drawing.segments.map((x, i) => (\r\n        `<path d='${doodleSegmentToSvgPath_line(x)}' />`\r\n    )).join(``)}\r\n</svg>\r\n    `.trim();\r\n};\r\n","\"use strict\"; // Updated from commit ae2f5e1 - vscode/src/vs/base/common/diff/diff.ts\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar diffChange_1 = require(\"./diffChange\");\n\nfunction createStringSequence(a) {\n  return {\n    getLength: function getLength() {\n      return a.length;\n    },\n    getElementAtIndex: function getElementAtIndex(pos) {\n      return a.charCodeAt(pos);\n    }\n  };\n}\n\nfunction stringDiff(original, modified, pretty) {\n  return new LcsDiff(createStringSequence(original), createStringSequence(modified)).ComputeDiff(pretty);\n}\n\nexports.stringDiff = stringDiff; //\n// The code below has been ported from a C# implementation in VS\n//\n\nvar Debug =\n/** @class */\nfunction () {\n  function Debug() {}\n\n  Debug.Assert = function (condition, message) {\n    if (!condition) {\n      throw new Error(message);\n    }\n  };\n\n  return Debug;\n}();\n\nexports.Debug = Debug;\n\nvar MyArray =\n/** @class */\nfunction () {\n  function MyArray() {}\n  /**\r\n   * Copies a range of elements from an Array starting at the specified source index and pastes\r\n   * them to another Array starting at the specified destination index. The length and the indexes\r\n   * are specified as 64-bit integers.\r\n   * sourceArray:\r\n   *\t\tThe Array that contains the data to copy.\r\n   * sourceIndex:\r\n   *\t\tA 64-bit integer that represents the index in the sourceArray at which copying begins.\r\n   * destinationArray:\r\n   *\t\tThe Array that receives the data.\r\n   * destinationIndex:\r\n   *\t\tA 64-bit integer that represents the index in the destinationArray at which storing begins.\r\n   * length:\r\n   *\t\tA 64-bit integer that represents the number of elements to copy.\r\n   */\n\n\n  MyArray.Copy = function (sourceArray, sourceIndex, destinationArray, destinationIndex, length) {\n    for (var i = 0; i < length; i++) {\n      destinationArray[destinationIndex + i] = sourceArray[sourceIndex + i];\n    }\n  };\n\n  return MyArray;\n}();\n\nexports.MyArray = MyArray; //*****************************************************************************\n// LcsDiff.cs\n//\n// An implementation of the difference algorithm described in\n// \"An O(ND) Difference Algorithm and its variations\" by Eugene W. Myers\n//\n// Copyright (C) 2008 Microsoft Corporation @minifier_do_not_preserve\n//*****************************************************************************\n// Our total memory usage for storing history is (worst-case):\n// 2 * [(MaxDifferencesHistory + 1) * (MaxDifferencesHistory + 1) - 1] * sizeof(int)\n// 2 * [1448*1448 - 1] * 4 = 16773624 = 16MB\n\nvar MaxDifferencesHistory = 1447; //let MaxDifferencesHistory = 100;\n\n/**\r\n * A utility class which helps to create the set of DiffChanges from\r\n * a difference operation. This class accepts original DiffElements and\r\n * modified DiffElements that are involved in a particular change. The\r\n * MarktNextChange() method can be called to mark the separation between\r\n * distinct changes. At the end, the Changes property can be called to retrieve\r\n * the constructed changes.\r\n */\n\nvar DiffChangeHelper =\n/** @class */\nfunction () {\n  /**\r\n   * Constructs a new DiffChangeHelper for the given DiffSequences.\r\n   */\n  function DiffChangeHelper() {\n    this.m_changes = [];\n    this.m_originalStart = Number.MAX_VALUE;\n    this.m_modifiedStart = Number.MAX_VALUE;\n    this.m_originalCount = 0;\n    this.m_modifiedCount = 0;\n  }\n  /**\r\n   * Marks the beginning of the next change in the set of differences.\r\n   */\n\n\n  DiffChangeHelper.prototype.MarkNextChange = function () {\n    // Only add to the list if there is something to add\n    if (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\n      // Add the new change to our list\n      this.m_changes.push(new diffChange_1.DiffChange(this.m_originalStart, this.m_originalCount, this.m_modifiedStart, this.m_modifiedCount));\n    } // Reset for the next change\n\n\n    this.m_originalCount = 0;\n    this.m_modifiedCount = 0;\n    this.m_originalStart = Number.MAX_VALUE;\n    this.m_modifiedStart = Number.MAX_VALUE;\n  };\n  /**\r\n   * Adds the original element at the given position to the elements\r\n   * affected by the current change. The modified index gives context\r\n   * to the change position with respect to the original sequence.\r\n   * @param originalIndex The index of the original element to add.\r\n   * @param modifiedIndex The index of the modified element that provides corresponding position in the modified sequence.\r\n   */\n\n\n  DiffChangeHelper.prototype.AddOriginalElement = function (originalIndex, modifiedIndex) {\n    // The 'true' start index is the smallest of the ones we've seen\n    this.m_originalStart = Math.min(this.m_originalStart, originalIndex);\n    this.m_modifiedStart = Math.min(this.m_modifiedStart, modifiedIndex);\n    this.m_originalCount++;\n  };\n  /**\r\n   * Adds the modified element at the given position to the elements\r\n   * affected by the current change. The original index gives context\r\n   * to the change position with respect to the modified sequence.\r\n   * @param originalIndex The index of the original element that provides corresponding position in the original sequence.\r\n   * @param modifiedIndex The index of the modified element to add.\r\n   */\n\n\n  DiffChangeHelper.prototype.AddModifiedElement = function (originalIndex, modifiedIndex) {\n    // The 'true' start index is the smallest of the ones we've seen\n    this.m_originalStart = Math.min(this.m_originalStart, originalIndex);\n    this.m_modifiedStart = Math.min(this.m_modifiedStart, modifiedIndex);\n    this.m_modifiedCount++;\n  };\n  /**\r\n   * Retrieves all of the changes marked by the class.\r\n   */\n\n\n  DiffChangeHelper.prototype.getChanges = function () {\n    if (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\n      // Finish up on whatever is left\n      this.MarkNextChange();\n    }\n\n    return this.m_changes;\n  };\n  /**\r\n   * Retrieves all of the changes marked by the class in the reverse order\r\n   */\n\n\n  DiffChangeHelper.prototype.getReverseChanges = function () {\n    if (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\n      // Finish up on whatever is left\n      this.MarkNextChange();\n    }\n\n    this.m_changes.reverse();\n    return this.m_changes;\n  };\n\n  return DiffChangeHelper;\n}();\n/**\r\n * An implementation of the difference algorithm described in\r\n * \"An O(ND) Difference Algorithm and its variations\" by Eugene W. Myers\r\n */\n\n\nvar LcsDiff =\n/** @class */\nfunction () {\n  /**\r\n   * Constructs the DiffFinder\r\n   */\n  function LcsDiff(originalSequence, newSequence, continueProcessingPredicate) {\n    if (continueProcessingPredicate === void 0) {\n      continueProcessingPredicate = null;\n    }\n\n    this.OriginalSequence = originalSequence;\n    this.ModifiedSequence = newSequence;\n    this.ContinueProcessingPredicate = continueProcessingPredicate;\n    this.m_forwardHistory = [];\n    this.m_reverseHistory = [];\n  }\n\n  LcsDiff.prototype.ElementsAreEqual = function (originalIndex, newIndex) {\n    return this.OriginalSequence.getElementAtIndex(originalIndex) === this.ModifiedSequence.getElementAtIndex(newIndex);\n  };\n\n  LcsDiff.prototype.OriginalElementsAreEqual = function (index1, index2) {\n    return this.OriginalSequence.getElementAtIndex(index1) === this.OriginalSequence.getElementAtIndex(index2);\n  };\n\n  LcsDiff.prototype.ModifiedElementsAreEqual = function (index1, index2) {\n    return this.ModifiedSequence.getElementAtIndex(index1) === this.ModifiedSequence.getElementAtIndex(index2);\n  };\n\n  LcsDiff.prototype.ComputeDiff = function (pretty) {\n    return this._ComputeDiff(0, this.OriginalSequence.getLength() - 1, 0, this.ModifiedSequence.getLength() - 1, pretty);\n  };\n  /**\r\n   * Computes the differences between the original and modified input\r\n   * sequences on the bounded range.\r\n   * @returns An array of the differences between the two input sequences.\r\n   */\n\n\n  LcsDiff.prototype._ComputeDiff = function (originalStart, originalEnd, modifiedStart, modifiedEnd, pretty) {\n    var quitEarlyArr = [false];\n    var changes = this.ComputeDiffRecursive(originalStart, originalEnd, modifiedStart, modifiedEnd, quitEarlyArr);\n\n    if (pretty) {\n      // We have to clean up the computed diff to be more intuitive\n      // but it turns out this cannot be done correctly until the entire set\n      // of diffs have been computed\n      return this.PrettifyChanges(changes);\n    }\n\n    return changes;\n  };\n  /**\r\n   * Private helper method which computes the differences on the bounded range\r\n   * recursively.\r\n   * @returns An array of the differences between the two input sequences.\r\n   */\n\n\n  LcsDiff.prototype.ComputeDiffRecursive = function (originalStart, originalEnd, modifiedStart, modifiedEnd, quitEarlyArr) {\n    quitEarlyArr[0] = false; // Find the start of the differences\n\n    while (originalStart <= originalEnd && modifiedStart <= modifiedEnd && this.ElementsAreEqual(originalStart, modifiedStart)) {\n      originalStart++;\n      modifiedStart++;\n    } // Find the end of the differences\n\n\n    while (originalEnd >= originalStart && modifiedEnd >= modifiedStart && this.ElementsAreEqual(originalEnd, modifiedEnd)) {\n      originalEnd--;\n      modifiedEnd--;\n    } // In the special case where we either have all insertions or all deletions or the sequences are identical\n\n\n    if (originalStart > originalEnd || modifiedStart > modifiedEnd) {\n      var changes = void 0;\n\n      if (modifiedStart <= modifiedEnd) {\n        Debug.Assert(originalStart === originalEnd + 1, 'originalStart should only be one more than originalEnd'); // All insertions\n\n        changes = [new diffChange_1.DiffChange(originalStart, 0, modifiedStart, modifiedEnd - modifiedStart + 1)];\n      } else if (originalStart <= originalEnd) {\n        Debug.Assert(modifiedStart === modifiedEnd + 1, 'modifiedStart should only be one more than modifiedEnd'); // All deletions\n\n        changes = [new diffChange_1.DiffChange(originalStart, originalEnd - originalStart + 1, modifiedStart, 0)];\n      } else {\n        Debug.Assert(originalStart === originalEnd + 1, 'originalStart should only be one more than originalEnd');\n        Debug.Assert(modifiedStart === modifiedEnd + 1, 'modifiedStart should only be one more than modifiedEnd'); // Identical sequences - No differences\n\n        changes = [];\n      }\n\n      return changes;\n    } // This problem can be solved using the Divide-And-Conquer technique.\n\n\n    var midOriginalArr = [0],\n        midModifiedArr = [0];\n    var result = this.ComputeRecursionPoint(originalStart, originalEnd, modifiedStart, modifiedEnd, midOriginalArr, midModifiedArr, quitEarlyArr);\n    var midOriginal = midOriginalArr[0];\n    var midModified = midModifiedArr[0];\n\n    if (result !== null) {\n      // Result is not-null when there was enough memory to compute the changes while\n      // searching for the recursion point\n      return result;\n    } else if (!quitEarlyArr[0]) {\n      // We can break the problem down recursively by finding the changes in the\n      // First Half:   (originalStart, modifiedStart) to (midOriginal, midModified)\n      // Second Half:  (midOriginal + 1, minModified + 1) to (originalEnd, modifiedEnd)\n      // NOTE: ComputeDiff() is inclusive, therefore the second range starts on the next point\n      var leftChanges = this.ComputeDiffRecursive(originalStart, midOriginal, modifiedStart, midModified, quitEarlyArr);\n      var rightChanges = [];\n\n      if (!quitEarlyArr[0]) {\n        rightChanges = this.ComputeDiffRecursive(midOriginal + 1, originalEnd, midModified + 1, modifiedEnd, quitEarlyArr);\n      } else {\n        // We did't have time to finish the first half, so we don't have time to compute this half.\n        // Consider the entire rest of the sequence different.\n        rightChanges = [new diffChange_1.DiffChange(midOriginal + 1, originalEnd - (midOriginal + 1) + 1, midModified + 1, modifiedEnd - (midModified + 1) + 1)];\n      }\n\n      return this.ConcatenateChanges(leftChanges, rightChanges);\n    } // If we hit here, we quit early, and so can't return anything meaningful\n\n\n    return [new diffChange_1.DiffChange(originalStart, originalEnd - originalStart + 1, modifiedStart, modifiedEnd - modifiedStart + 1)];\n  };\n\n  LcsDiff.prototype.WALKTRACE = function (diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr) {\n    var forwardChanges = null,\n        reverseChanges = null; // First, walk backward through the forward diagonals history\n\n    var changeHelper = new DiffChangeHelper();\n    var diagonalMin = diagonalForwardStart;\n    var diagonalMax = diagonalForwardEnd;\n    var diagonalRelative = midOriginalArr[0] - midModifiedArr[0] - diagonalForwardOffset;\n    var lastOriginalIndex = Number.MIN_VALUE;\n    var historyIndex = this.m_forwardHistory.length - 1;\n    var diagonal;\n\n    do {\n      // Get the diagonal index from the relative diagonal number\n      diagonal = diagonalRelative + diagonalForwardBase; // Figure out where we came from\n\n      if (diagonal === diagonalMin || diagonal < diagonalMax && forwardPoints[diagonal - 1] < forwardPoints[diagonal + 1]) {\n        // Vertical line (the element is an insert)\n        originalIndex = forwardPoints[diagonal + 1];\n        modifiedIndex = originalIndex - diagonalRelative - diagonalForwardOffset;\n\n        if (originalIndex < lastOriginalIndex) {\n          changeHelper.MarkNextChange();\n        }\n\n        lastOriginalIndex = originalIndex;\n        changeHelper.AddModifiedElement(originalIndex + 1, modifiedIndex);\n        diagonalRelative = diagonal + 1 - diagonalForwardBase; //Setup for the next iteration\n      } else {\n        // Horizontal line (the element is a deletion)\n        originalIndex = forwardPoints[diagonal - 1] + 1;\n        modifiedIndex = originalIndex - diagonalRelative - diagonalForwardOffset;\n\n        if (originalIndex < lastOriginalIndex) {\n          changeHelper.MarkNextChange();\n        }\n\n        lastOriginalIndex = originalIndex - 1;\n        changeHelper.AddOriginalElement(originalIndex, modifiedIndex + 1);\n        diagonalRelative = diagonal - 1 - diagonalForwardBase; //Setup for the next iteration\n      }\n\n      if (historyIndex >= 0) {\n        forwardPoints = this.m_forwardHistory[historyIndex];\n        diagonalForwardBase = forwardPoints[0]; //We stored this in the first spot\n\n        diagonalMin = 1;\n        diagonalMax = forwardPoints.length - 1;\n      }\n    } while (--historyIndex >= -1); // Ironically, we get the forward changes as the reverse of the\n    // order we added them since we technically added them backwards\n\n\n    forwardChanges = changeHelper.getReverseChanges();\n\n    if (quitEarlyArr[0]) {\n      // TODO: Calculate a partial from the reverse diagonals.\n      //       For now, just assume everything after the midOriginal/midModified point is a diff\n      var originalStartPoint = midOriginalArr[0] + 1;\n      var modifiedStartPoint = midModifiedArr[0] + 1;\n\n      if (forwardChanges !== null && forwardChanges.length > 0) {\n        var lastForwardChange = forwardChanges[forwardChanges.length - 1];\n        originalStartPoint = Math.max(originalStartPoint, lastForwardChange.getOriginalEnd());\n        modifiedStartPoint = Math.max(modifiedStartPoint, lastForwardChange.getModifiedEnd());\n      }\n\n      reverseChanges = [new diffChange_1.DiffChange(originalStartPoint, originalEnd - originalStartPoint + 1, modifiedStartPoint, modifiedEnd - modifiedStartPoint + 1)];\n    } else {\n      // Now walk backward through the reverse diagonals history\n      changeHelper = new DiffChangeHelper();\n      diagonalMin = diagonalReverseStart;\n      diagonalMax = diagonalReverseEnd;\n      diagonalRelative = midOriginalArr[0] - midModifiedArr[0] - diagonalReverseOffset;\n      lastOriginalIndex = Number.MAX_VALUE;\n      historyIndex = deltaIsEven ? this.m_reverseHistory.length - 1 : this.m_reverseHistory.length - 2;\n\n      do {\n        // Get the diagonal index from the relative diagonal number\n        diagonal = diagonalRelative + diagonalReverseBase; // Figure out where we came from\n\n        if (diagonal === diagonalMin || diagonal < diagonalMax && reversePoints[diagonal - 1] >= reversePoints[diagonal + 1]) {\n          // Horizontal line (the element is a deletion))\n          originalIndex = reversePoints[diagonal + 1] - 1;\n          modifiedIndex = originalIndex - diagonalRelative - diagonalReverseOffset;\n\n          if (originalIndex > lastOriginalIndex) {\n            changeHelper.MarkNextChange();\n          }\n\n          lastOriginalIndex = originalIndex + 1;\n          changeHelper.AddOriginalElement(originalIndex + 1, modifiedIndex + 1);\n          diagonalRelative = diagonal + 1 - diagonalReverseBase; //Setup for the next iteration\n        } else {\n          // Vertical line (the element is an insertion)\n          originalIndex = reversePoints[diagonal - 1];\n          modifiedIndex = originalIndex - diagonalRelative - diagonalReverseOffset;\n\n          if (originalIndex > lastOriginalIndex) {\n            changeHelper.MarkNextChange();\n          }\n\n          lastOriginalIndex = originalIndex;\n          changeHelper.AddModifiedElement(originalIndex + 1, modifiedIndex + 1);\n          diagonalRelative = diagonal - 1 - diagonalReverseBase; //Setup for the next iteration\n        }\n\n        if (historyIndex >= 0) {\n          reversePoints = this.m_reverseHistory[historyIndex];\n          diagonalReverseBase = reversePoints[0]; //We stored this in the first spot\n\n          diagonalMin = 1;\n          diagonalMax = reversePoints.length - 1;\n        }\n      } while (--historyIndex >= -1); // There are cases where the reverse history will find diffs that\n      // are correct, but not intuitive, so we need shift them.\n\n\n      reverseChanges = changeHelper.getChanges();\n    }\n\n    return this.ConcatenateChanges(forwardChanges, reverseChanges);\n  };\n  /**\r\n   * Given the range to compute the diff on, this method finds the point:\r\n   * (midOriginal, midModified)\r\n   * that exists in the middle of the LCS of the two sequences and\r\n   * is the point at which the LCS problem may be broken down recursively.\r\n   * This method will try to keep the LCS trace in memory. If the LCS recursion\r\n   * point is calculated and the full trace is available in memory, then this method\r\n   * will return the change list.\r\n   * @param originalStart The start bound of the original sequence range\r\n   * @param originalEnd The end bound of the original sequence range\r\n   * @param modifiedStart The start bound of the modified sequence range\r\n   * @param modifiedEnd The end bound of the modified sequence range\r\n   * @param midOriginal The middle point of the original sequence range\r\n   * @param midModified The middle point of the modified sequence range\r\n   * @returns The diff changes, if available, otherwise null\r\n   */\n\n\n  LcsDiff.prototype.ComputeRecursionPoint = function (originalStart, originalEnd, modifiedStart, modifiedEnd, midOriginalArr, midModifiedArr, quitEarlyArr) {\n    var originalIndex = 0,\n        modifiedIndex = 0;\n    var diagonalForwardStart = 0,\n        diagonalForwardEnd = 0;\n    var diagonalReverseStart = 0,\n        diagonalReverseEnd = 0;\n    var numDifferences; // To traverse the edit graph and produce the proper LCS, our actual\n    // start position is just outside the given boundary\n\n    originalStart--;\n    modifiedStart--; // We set these up to make the compiler happy, but they will\n    // be replaced before we return with the actual recursion point\n\n    midOriginalArr[0] = 0;\n    midModifiedArr[0] = 0; // Clear out the history\n\n    this.m_forwardHistory = [];\n    this.m_reverseHistory = []; // Each cell in the two arrays corresponds to a diagonal in the edit graph.\n    // The integer value in the cell represents the originalIndex of the furthest\n    // reaching point found so far that ends in that diagonal.\n    // The modifiedIndex can be computed mathematically from the originalIndex and the diagonal number.\n\n    var maxDifferences = originalEnd - originalStart + (modifiedEnd - modifiedStart);\n    var numDiagonals = maxDifferences + 1;\n    var forwardPoints = new Array(numDiagonals);\n    var reversePoints = new Array(numDiagonals); // diagonalForwardBase: Index into forwardPoints of the diagonal which passes through (originalStart, modifiedStart)\n    // diagonalReverseBase: Index into reversePoints of the diagonal which passes through (originalEnd, modifiedEnd)\n\n    var diagonalForwardBase = modifiedEnd - modifiedStart;\n    var diagonalReverseBase = originalEnd - originalStart; // diagonalForwardOffset: Geometric offset which allows modifiedIndex to be computed from originalIndex and the\n    //    diagonal number (relative to diagonalForwardBase)\n    // diagonalReverseOffset: Geometric offset which allows modifiedIndex to be computed from originalIndex and the\n    //    diagonal number (relative to diagonalReverseBase)\n\n    var diagonalForwardOffset = originalStart - modifiedStart;\n    var diagonalReverseOffset = originalEnd - modifiedEnd; // delta: The difference between the end diagonal and the start diagonal. This is used to relate diagonal numbers\n    //   relative to the start diagonal with diagonal numbers relative to the end diagonal.\n    // The Even/Oddn-ness of this delta is important for determining when we should check for overlap\n\n    var delta = diagonalReverseBase - diagonalForwardBase;\n    var deltaIsEven = delta % 2 === 0; // Here we set up the start and end points as the furthest points found so far\n    // in both the forward and reverse directions, respectively\n\n    forwardPoints[diagonalForwardBase] = originalStart;\n    reversePoints[diagonalReverseBase] = originalEnd; // Remember if we quit early, and thus need to do a best-effort result instead of a real result.\n\n    quitEarlyArr[0] = false; // A couple of points:\n    // --With this method, we iterate on the number of differences between the two sequences.\n    //   The more differences there actually are, the longer this will take.\n    // --Also, as the number of differences increases, we have to search on diagonals further\n    //   away from the reference diagonal (which is diagonalForwardBase for forward, diagonalReverseBase for reverse).\n    // --We extend on even diagonals (relative to the reference diagonal) only when numDifferences\n    //   is even and odd diagonals only when numDifferences is odd.\n\n    var diagonal, tempOriginalIndex;\n\n    for (numDifferences = 1; numDifferences <= maxDifferences / 2 + 1; numDifferences++) {\n      var furthestOriginalIndex = 0;\n      var furthestModifiedIndex = 0; // Run the algorithm in the forward direction\n\n      diagonalForwardStart = this.ClipDiagonalBound(diagonalForwardBase - numDifferences, numDifferences, diagonalForwardBase, numDiagonals);\n      diagonalForwardEnd = this.ClipDiagonalBound(diagonalForwardBase + numDifferences, numDifferences, diagonalForwardBase, numDiagonals);\n\n      for (diagonal = diagonalForwardStart; diagonal <= diagonalForwardEnd; diagonal += 2) {\n        // STEP 1: We extend the furthest reaching point in the present diagonal\n        // by looking at the diagonals above and below and picking the one whose point\n        // is further away from the start point (originalStart, modifiedStart)\n        if (diagonal === diagonalForwardStart || diagonal < diagonalForwardEnd && forwardPoints[diagonal - 1] < forwardPoints[diagonal + 1]) {\n          originalIndex = forwardPoints[diagonal + 1];\n        } else {\n          originalIndex = forwardPoints[diagonal - 1] + 1;\n        }\n\n        modifiedIndex = originalIndex - (diagonal - diagonalForwardBase) - diagonalForwardOffset; // Save the current originalIndex so we can test for false overlap in step 3\n\n        tempOriginalIndex = originalIndex; // STEP 2: We can continue to extend the furthest reaching point in the present diagonal\n        // so long as the elements are equal.\n\n        while (originalIndex < originalEnd && modifiedIndex < modifiedEnd && this.ElementsAreEqual(originalIndex + 1, modifiedIndex + 1)) {\n          originalIndex++;\n          modifiedIndex++;\n        }\n\n        forwardPoints[diagonal] = originalIndex;\n\n        if (originalIndex + modifiedIndex > furthestOriginalIndex + furthestModifiedIndex) {\n          furthestOriginalIndex = originalIndex;\n          furthestModifiedIndex = modifiedIndex;\n        } // STEP 3: If delta is odd (overlap first happens on forward when delta is odd)\n        // and diagonal is in the range of reverse diagonals computed for numDifferences-1\n        // (the previous iteration; we haven't computed reverse diagonals for numDifferences yet)\n        // then check for overlap.\n\n\n        if (!deltaIsEven && Math.abs(diagonal - diagonalReverseBase) <= numDifferences - 1) {\n          if (originalIndex >= reversePoints[diagonal]) {\n            midOriginalArr[0] = originalIndex;\n            midModifiedArr[0] = modifiedIndex;\n\n            if (tempOriginalIndex <= reversePoints[diagonal] && MaxDifferencesHistory > 0 && numDifferences <= MaxDifferencesHistory + 1) {\n              // BINGO! We overlapped, and we have the full trace in memory!\n              return this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr);\n            } else {\n              // Either false overlap, or we didn't have enough memory for the full trace\n              // Just return the recursion point\n              return null;\n            }\n          }\n        }\n      } // Check to see if we should be quitting early, before moving on to the next iteration.\n\n\n      var matchLengthOfLongest = (furthestOriginalIndex - originalStart + (furthestModifiedIndex - modifiedStart) - numDifferences) / 2;\n\n      if (this.ContinueProcessingPredicate !== null && !this.ContinueProcessingPredicate(furthestOriginalIndex, this.OriginalSequence, matchLengthOfLongest)) {\n        // We can't finish, so skip ahead to generating a result from what we have.\n        quitEarlyArr[0] = true; // Use the furthest distance we got in the forward direction.\n\n        midOriginalArr[0] = furthestOriginalIndex;\n        midModifiedArr[0] = furthestModifiedIndex;\n\n        if (matchLengthOfLongest > 0 && MaxDifferencesHistory > 0 && numDifferences <= MaxDifferencesHistory + 1) {\n          // Enough of the history is in memory to walk it backwards\n          return this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr);\n        } else {\n          // We didn't actually remember enough of the history.\n          //Since we are quiting the diff early, we need to shift back the originalStart and modified start\n          //back into the boundary limits since we decremented their value above beyond the boundary limit.\n          originalStart++;\n          modifiedStart++;\n          return [new diffChange_1.DiffChange(originalStart, originalEnd - originalStart + 1, modifiedStart, modifiedEnd - modifiedStart + 1)];\n        }\n      } // Run the algorithm in the reverse direction\n\n\n      diagonalReverseStart = this.ClipDiagonalBound(diagonalReverseBase - numDifferences, numDifferences, diagonalReverseBase, numDiagonals);\n      diagonalReverseEnd = this.ClipDiagonalBound(diagonalReverseBase + numDifferences, numDifferences, diagonalReverseBase, numDiagonals);\n\n      for (diagonal = diagonalReverseStart; diagonal <= diagonalReverseEnd; diagonal += 2) {\n        // STEP 1: We extend the furthest reaching point in the present diagonal\n        // by looking at the diagonals above and below and picking the one whose point\n        // is further away from the start point (originalEnd, modifiedEnd)\n        if (diagonal === diagonalReverseStart || diagonal < diagonalReverseEnd && reversePoints[diagonal - 1] >= reversePoints[diagonal + 1]) {\n          originalIndex = reversePoints[diagonal + 1] - 1;\n        } else {\n          originalIndex = reversePoints[diagonal - 1];\n        }\n\n        modifiedIndex = originalIndex - (diagonal - diagonalReverseBase) - diagonalReverseOffset; // Save the current originalIndex so we can test for false overlap\n\n        tempOriginalIndex = originalIndex; // STEP 2: We can continue to extend the furthest reaching point in the present diagonal\n        // as long as the elements are equal.\n\n        while (originalIndex > originalStart && modifiedIndex > modifiedStart && this.ElementsAreEqual(originalIndex, modifiedIndex)) {\n          originalIndex--;\n          modifiedIndex--;\n        }\n\n        reversePoints[diagonal] = originalIndex; // STEP 4: If delta is even (overlap first happens on reverse when delta is even)\n        // and diagonal is in the range of forward diagonals computed for numDifferences\n        // then check for overlap.\n\n        if (deltaIsEven && Math.abs(diagonal - diagonalForwardBase) <= numDifferences) {\n          if (originalIndex <= forwardPoints[diagonal]) {\n            midOriginalArr[0] = originalIndex;\n            midModifiedArr[0] = modifiedIndex;\n\n            if (tempOriginalIndex >= forwardPoints[diagonal] && MaxDifferencesHistory > 0 && numDifferences <= MaxDifferencesHistory + 1) {\n              // BINGO! We overlapped, and we have the full trace in memory!\n              return this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr);\n            } else {\n              // Either false overlap, or we didn't have enough memory for the full trace\n              // Just return the recursion point\n              return null;\n            }\n          }\n        }\n      } // Save current vectors to history before the next iteration\n\n\n      if (numDifferences <= MaxDifferencesHistory) {\n        // We are allocating space for one extra int, which we fill with\n        // the index of the diagonal base index\n        var temp = new Array(diagonalForwardEnd - diagonalForwardStart + 2);\n        temp[0] = diagonalForwardBase - diagonalForwardStart + 1;\n        MyArray.Copy(forwardPoints, diagonalForwardStart, temp, 1, diagonalForwardEnd - diagonalForwardStart + 1);\n        this.m_forwardHistory.push(temp);\n        temp = new Array(diagonalReverseEnd - diagonalReverseStart + 2);\n        temp[0] = diagonalReverseBase - diagonalReverseStart + 1;\n        MyArray.Copy(reversePoints, diagonalReverseStart, temp, 1, diagonalReverseEnd - diagonalReverseStart + 1);\n        this.m_reverseHistory.push(temp);\n      }\n    } // If we got here, then we have the full trace in history. We just have to convert it to a change list\n    // NOTE: This part is a bit messy\n\n\n    return this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset, diagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset, forwardPoints, reversePoints, originalIndex, originalEnd, midOriginalArr, modifiedIndex, modifiedEnd, midModifiedArr, deltaIsEven, quitEarlyArr);\n  };\n  /**\r\n   * Shifts the given changes to provide a more intuitive diff.\r\n   * While the first element in a diff matches the first element after the diff,\r\n   * we shift the diff down.\r\n   *\r\n   * @param changes The list of changes to shift\r\n   * @returns The shifted changes\r\n   */\n\n\n  LcsDiff.prototype.PrettifyChanges = function (changes) {\n    // Shift all the changes down first\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var originalStop = i < changes.length - 1 ? changes[i + 1].originalStart : this.OriginalSequence.getLength();\n      var modifiedStop = i < changes.length - 1 ? changes[i + 1].modifiedStart : this.ModifiedSequence.getLength();\n      var checkOriginal = change.originalLength > 0;\n      var checkModified = change.modifiedLength > 0;\n\n      while (change.originalStart + change.originalLength < originalStop && change.modifiedStart + change.modifiedLength < modifiedStop && (!checkOriginal || this.OriginalElementsAreEqual(change.originalStart, change.originalStart + change.originalLength)) && (!checkModified || this.ModifiedElementsAreEqual(change.modifiedStart, change.modifiedStart + change.modifiedLength))) {\n        change.originalStart++;\n        change.modifiedStart++;\n      }\n\n      var mergedChangeArr = [null];\n\n      if (i < changes.length - 1 && this.ChangesOverlap(changes[i], changes[i + 1], mergedChangeArr)) {\n        changes[i] = mergedChangeArr[0];\n        changes.splice(i + 1, 1);\n        i--;\n        continue;\n      }\n    } // Shift changes back up until we hit empty or whitespace-only lines\n\n\n    for (var i = changes.length - 1; i >= 0; i--) {\n      var change = changes[i];\n      var originalStop = 0;\n      var modifiedStop = 0;\n\n      if (i > 0) {\n        var prevChange = changes[i - 1];\n\n        if (prevChange.originalLength > 0) {\n          originalStop = prevChange.originalStart + prevChange.originalLength;\n        }\n\n        if (prevChange.modifiedLength > 0) {\n          modifiedStop = prevChange.modifiedStart + prevChange.modifiedLength;\n        }\n      }\n\n      var checkOriginal = change.originalLength > 0;\n      var checkModified = change.modifiedLength > 0;\n      var bestDelta = 0;\n\n      var bestScore = this._boundaryScore(change.originalStart, change.originalLength, change.modifiedStart, change.modifiedLength);\n\n      for (var delta = 1;; delta++) {\n        var originalStart = change.originalStart - delta;\n        var modifiedStart = change.modifiedStart - delta;\n\n        if (originalStart < originalStop || modifiedStart < modifiedStop) {\n          break;\n        }\n\n        if (checkOriginal && !this.OriginalElementsAreEqual(originalStart, originalStart + change.originalLength)) {\n          break;\n        }\n\n        if (checkModified && !this.ModifiedElementsAreEqual(modifiedStart, modifiedStart + change.modifiedLength)) {\n          break;\n        }\n\n        var score = this._boundaryScore(originalStart, change.originalLength, modifiedStart, change.modifiedLength);\n\n        if (score > bestScore) {\n          bestScore = score;\n          bestDelta = delta;\n        }\n      }\n\n      change.originalStart -= bestDelta;\n      change.modifiedStart -= bestDelta;\n    }\n\n    return changes;\n  };\n\n  LcsDiff.prototype._OriginalIsBoundary = function (index) {\n    if (index <= 0 || index >= this.OriginalSequence.getLength() - 1) {\n      return true;\n    }\n\n    var element = this.OriginalSequence.getElementAtIndex(index);\n    return typeof element === 'string' && /^\\s*$/.test(element);\n  };\n\n  LcsDiff.prototype._OriginalRegionIsBoundary = function (originalStart, originalLength) {\n    if (this._OriginalIsBoundary(originalStart) || this._OriginalIsBoundary(originalStart - 1)) {\n      return true;\n    }\n\n    if (originalLength > 0) {\n      var originalEnd = originalStart + originalLength;\n\n      if (this._OriginalIsBoundary(originalEnd - 1) || this._OriginalIsBoundary(originalEnd)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  LcsDiff.prototype._ModifiedIsBoundary = function (index) {\n    if (index <= 0 || index >= this.ModifiedSequence.getLength() - 1) {\n      return true;\n    }\n\n    var element = this.ModifiedSequence.getElementAtIndex(index);\n    return typeof element === 'string' && /^\\s*$/.test(element);\n  };\n\n  LcsDiff.prototype._ModifiedRegionIsBoundary = function (modifiedStart, modifiedLength) {\n    if (this._ModifiedIsBoundary(modifiedStart) || this._ModifiedIsBoundary(modifiedStart - 1)) {\n      return true;\n    }\n\n    if (modifiedLength > 0) {\n      var modifiedEnd = modifiedStart + modifiedLength;\n\n      if (this._ModifiedIsBoundary(modifiedEnd - 1) || this._ModifiedIsBoundary(modifiedEnd)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  LcsDiff.prototype._boundaryScore = function (originalStart, originalLength, modifiedStart, modifiedLength) {\n    var originalScore = this._OriginalRegionIsBoundary(originalStart, originalLength) ? 1 : 0;\n    var modifiedScore = this._ModifiedRegionIsBoundary(modifiedStart, modifiedLength) ? 1 : 0;\n    return originalScore + modifiedScore;\n  };\n  /**\r\n   * Concatenates the two input DiffChange lists and returns the resulting\r\n   * list.\r\n   * @param The left changes\r\n   * @param The right changes\r\n   * @returns The concatenated list\r\n   */\n\n\n  LcsDiff.prototype.ConcatenateChanges = function (left, right) {\n    var mergedChangeArr = [];\n\n    if (left.length === 0 || right.length === 0) {\n      return right.length > 0 ? right : left;\n    } else if (this.ChangesOverlap(left[left.length - 1], right[0], mergedChangeArr)) {\n      // Since we break the problem down recursively, it is possible that we\n      // might recurse in the middle of a change thereby splitting it into\n      // two changes. Here in the combining stage, we detect and fuse those\n      // changes back together\n      var result = new Array(left.length + right.length - 1);\n      MyArray.Copy(left, 0, result, 0, left.length - 1);\n      result[left.length - 1] = mergedChangeArr[0];\n      MyArray.Copy(right, 1, result, left.length, right.length - 1);\n      return result;\n    } else {\n      var result = new Array(left.length + right.length);\n      MyArray.Copy(left, 0, result, 0, left.length);\n      MyArray.Copy(right, 0, result, left.length, right.length);\n      return result;\n    }\n  };\n  /**\r\n   * Returns true if the two changes overlap and can be merged into a single\r\n   * change\r\n   * @param left The left change\r\n   * @param right The right change\r\n   * @param mergedChange The merged change if the two overlap, null otherwise\r\n   * @returns True if the two changes overlap\r\n   */\n\n\n  LcsDiff.prototype.ChangesOverlap = function (left, right, mergedChangeArr) {\n    Debug.Assert(left.originalStart <= right.originalStart, 'Left change is not less than or equal to right change');\n    Debug.Assert(left.modifiedStart <= right.modifiedStart, 'Left change is not less than or equal to right change');\n\n    if (left.originalStart + left.originalLength >= right.originalStart || left.modifiedStart + left.modifiedLength >= right.modifiedStart) {\n      var originalStart = left.originalStart;\n      var originalLength = left.originalLength;\n      var modifiedStart = left.modifiedStart;\n      var modifiedLength = left.modifiedLength;\n\n      if (left.originalStart + left.originalLength >= right.originalStart) {\n        originalLength = right.originalStart + right.originalLength - left.originalStart;\n      }\n\n      if (left.modifiedStart + left.modifiedLength >= right.modifiedStart) {\n        modifiedLength = right.modifiedStart + right.modifiedLength - left.modifiedStart;\n      }\n\n      mergedChangeArr[0] = new diffChange_1.DiffChange(originalStart, originalLength, modifiedStart, modifiedLength);\n      return true;\n    } else {\n      mergedChangeArr[0] = null;\n      return false;\n    }\n  };\n  /**\r\n   * Helper method used to clip a diagonal index to the range of valid\r\n   * diagonals. This also decides whether or not the diagonal index,\r\n   * if it exceeds the boundary, should be clipped to the boundary or clipped\r\n   * one inside the boundary depending on the Even/Odd status of the boundary\r\n   * and numDifferences.\r\n   * @param diagonal The index of the diagonal to clip.\r\n   * @param numDifferences The current number of differences being iterated upon.\r\n   * @param diagonalBaseIndex The base reference diagonal.\r\n   * @param numDiagonals The total number of diagonals.\r\n   * @returns The clipped diagonal index.\r\n   */\n\n\n  LcsDiff.prototype.ClipDiagonalBound = function (diagonal, numDifferences, diagonalBaseIndex, numDiagonals) {\n    if (diagonal >= 0 && diagonal < numDiagonals) {\n      // Nothing to clip, its in range\n      return diagonal;\n    } // diagonalsBelow: The number of diagonals below the reference diagonal\n    // diagonalsAbove: The number of diagonals above the reference diagonal\n\n\n    var diagonalsBelow = diagonalBaseIndex;\n    var diagonalsAbove = numDiagonals - diagonalBaseIndex - 1;\n    var diffEven = numDifferences % 2 === 0;\n\n    if (diagonal < 0) {\n      var lowerBoundEven = diagonalsBelow % 2 === 0;\n      return diffEven === lowerBoundEven ? 0 : 1;\n    } else {\n      var upperBoundEven = diagonalsAbove % 2 === 0;\n      return diffEven === upperBoundEven ? numDiagonals - 1 : numDiagonals - 2;\n    }\n  };\n\n  return LcsDiff;\n}();\n\nexports.LcsDiff = LcsDiff;","import { PaymentMethodCreateParams, SetupIntent } from '@stripe/stripe-js';\r\nimport { PaymentProviderSavedPaymentMethodClientSetupToken, PaymentProviderSavedPaymentMethodClientToken } from '../../../common/types';\r\n\r\nexport type StripeCustomerBillingDetails = PaymentMethodCreateParams.BillingDetails;\r\n\r\nexport type StripePaymentClientSetupToken = {\r\n    clientSecret: string;\r\n    customerBillingDetails: StripeCustomerBillingDetails;\r\n};\r\n\r\nexport const stripeEncodeClientSetupToken = (params: StripePaymentClientSetupToken): PaymentProviderSavedPaymentMethodClientSetupToken => {\r\n    return params as unknown as PaymentProviderSavedPaymentMethodClientSetupToken;\r\n};\r\nexport const stripeDecodeClientSetupToken = (params: PaymentProviderSavedPaymentMethodClientSetupToken): StripePaymentClientSetupToken => {\r\n    return params as unknown as StripePaymentClientSetupToken;\r\n};\r\n\r\nexport type StripePaymentClientToken = {\r\n    setupIntent: SetupIntent;\r\n};\r\n\r\nexport const stripeEncodeClientToken = (params: StripePaymentClientToken): PaymentProviderSavedPaymentMethodClientToken => {\r\n    return params as unknown as PaymentProviderSavedPaymentMethodClientToken;\r\n};\r\nexport const stripeDecodeClientToken = (params: PaymentProviderSavedPaymentMethodClientToken): StripePaymentClientToken => {\r\n    return params as unknown as StripePaymentClientToken;\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Text, TouchableOpacity, View } from 'react-native-lite';\r\nimport { LessonData, LessonExperiment, LessonProjectState, SetProjectState } from '../lesson-types';\r\nimport { lessonExperiments_createReplacementProjectState } from '../replacements';\r\nimport { LessonProjectFilesEditor } from './lesson-file-editor';\r\nimport { LessonProjectStatePreview } from './lesson-render-view';\r\n\r\nconst styles = {\r\n    sectionHeaderText: {\r\n        margin: 8,\r\n        fontSize: 18,\r\n        color: `#FFFF88`,\r\n        whiteSpace: `pre-wrap`,\r\n    },\r\n    sectionHeader2Text: {\r\n        margin: 8,\r\n        fontSize: 16,\r\n        color: `#FFFF88`,\r\n        whiteSpace: `pre-wrap`,\r\n    },\r\n    infoText: {\r\n        margin: 8,\r\n        fontSize: 12,\r\n        whiteSpace: `pre-wrap`,\r\n    },\r\n    buttonView: {\r\n        margin: 8,\r\n        padding: 4,\r\n        border: `solid 1px #888888`,\r\n    },\r\n    buttonText: {\r\n        color: `#88FF88`,\r\n    },\r\n} as const;\r\nexport const LessonView_PreviewResult = ({ data, onDone, setProjectState }: { data: LessonData, onDone?: () => void, setProjectState: SetProjectState }) => {\r\n\r\n    const [isDone, setIsDone] = useState(false);\r\n\r\n    return (\r\n        <>\r\n            <Text style={styles.sectionHeaderText}>{`${data.title} - Preview the Result ${isDone ? `` : ``}`}</Text>\r\n            <View style={{ flexDirection: `row`, alignItems: `center` }}>\r\n                <Text style={styles.infoText}>{`${``} Preview the result below`}</Text>\r\n                <View style={{ flex: 1 }} />\r\n                {onDone && (\r\n                    <TouchableOpacity onPress={() => onDone?.()}>\r\n                        <View style={styles.buttonView}>\r\n                            <Text style={styles.buttonText}>Done</Text>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                )}\r\n            </View>\r\n            <Text style={styles.sectionHeader2Text}>Preview</Text>\r\n            <LessonProjectStatePreview projectState={data.projectState} setProjectState={setProjectState} />\r\n            <Text style={styles.sectionHeader2Text}>Code</Text>\r\n            <LessonProjectFilesEditor\r\n                projectData={{\r\n                    projectState: data.projectState,\r\n                    focus: data.focus,\r\n                }}\r\n                fileEditorMode_focus='display'\r\n                fileEditorMode_noFocus='display'\r\n                projectEditorMode='display'\r\n                onTaskDone={() => { setIsDone(true); onDone?.(); }}\r\n                lessonData={data}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport const LessonView_ConstructCode = ({ data, onDone }: { data: LessonData, onDone?: () => void }) => {\r\n\r\n    const [isDone, setIsDone] = useState(false);\r\n\r\n    return (\r\n        <>\r\n            <Text style={styles.sectionHeaderText}>{`${data.title} - Construct the Code ${isDone ? `` : ``}`}</Text>\r\n            <Text style={styles.infoText}>{` ${data.objective}`}</Text>\r\n            <Text style={styles.infoText}>{` ${data.explanation}`}</Text>\r\n            <Text style={styles.infoText}>{`${isDone ? `` : ``} ${data.task}`}</Text>\r\n            <LessonProjectFilesEditor\r\n                projectData={{\r\n                    projectState: data.projectState,\r\n                    focus: data.focus,\r\n                }}\r\n                fileEditorMode_focus='construct-code'\r\n                fileEditorMode_noFocus='display'\r\n                projectEditorMode='display'\r\n                onTaskDone={() => { setIsDone(true); onDone?.(); }}\r\n                lessonData={data}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport const LessonView_UnderstandCode = ({ data, onDone }: { data: LessonData, onDone?: () => void }) => {\r\n\r\n    const [isDone, setIsDone] = useState(false);\r\n\r\n    return (\r\n        <>\r\n            <Text style={styles.sectionHeaderText}>{`${data.title} - Understand the Code ${isDone ? `` : ``}`}</Text>\r\n            <View style={{ flexDirection: `row`, alignItems: `center` }}>\r\n                <Text style={styles.infoText}>{`${``} Preview the result below`}</Text>\r\n                <View style={{ flex: 1 }} />\r\n                {isDone && (\r\n                    <TouchableOpacity onPress={() => onDone?.()}>\r\n                        <View style={styles.buttonView}>\r\n                            <Text style={styles.buttonText}>Done</Text>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                )}\r\n            </View>\r\n            <LessonProjectFilesEditor\r\n                projectData={{\r\n                    projectState: data.projectState,\r\n                    focus: data.focus,\r\n                }}\r\n                fileEditorMode_focus='understand-code'\r\n                fileEditorMode_noFocus='display'\r\n                projectEditorMode='display'\r\n                onTaskDone={() => setIsDone(true)}\r\n                lessonData={data}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nconst experimentStyles = {\r\n    instructionsText: {\r\n        marginLeft: 16,\r\n        fontSize: 16,\r\n        color: `#88FF88`,\r\n    },\r\n    experimentView: {\r\n        padding: 16,\r\n        justifyContent: `flex-start`,\r\n    },\r\n    experimentItemRow: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n    },\r\n    experimentItemView: {\r\n        padding: 4,\r\n        // border: `solid 1px #888888`,\r\n        // borderLeft: `solid 4px #EEEEEE`,\r\n    },\r\n    experimentItemView_active: {\r\n        padding: 4,\r\n        border: `solid 1px #FFFF88`,\r\n        borderLeft: `solid 4px #FFFF88`,\r\n    },\r\n    experimentItemText: {\r\n        color: `#FFFF88`,\r\n        whiteSpace: `pre-wrap`,\r\n    },\r\n} as const;\r\nexport const LessonView_ExperimentCode = ({ data, onDone, setProjectState }: { data: LessonData, onDone?: () => void, setProjectState: SetProjectState }) => {\r\n\r\n    const [modifiedProjectState, setModifiedProjectState] = useState(data.projectState);\r\n    const [activeExperiment, setActiveExperiment] = useState(null as null | LessonExperiment);\r\n    const [activeFocus, setActiveFocus] = useState(data.focus);\r\n\r\n    const changeExperiment = (value: null | LessonExperiment) => {\r\n        setActiveExperiment(value);\r\n        if (!value) {\r\n            setModifiedProjectState(data.projectState);\r\n            setActiveFocus(data.focus);\r\n            return;\r\n        }\r\n        setModifiedProjectState(s => (lessonExperiments_createReplacementProjectState(data.projectState, value.replacements)));\r\n\r\n        // Focus on change area:\r\n        const focusReplacements = value.replacements.filter(x => x.selection.filePath === data.focus.filePath);\r\n        const minIndex = Math.min(...focusReplacements.map(x => x.selection.index));\r\n        const maxEndIndex = Math.max(...focusReplacements.map(x => x.selection.index + x.selection.length));\r\n        const lengthDeltas = focusReplacements.map(x => -x.selection.length + x.content.length);\r\n        // eslint-disable-next-line unicorn/no-reduce\r\n        const lengthDelta = lengthDeltas.reduce((out, x) => { out += x; return out; }, 0);\r\n        console.log(`LessonView_ExperimentCode`, { minIndex, maxEndIndex, lengthDeltas, lengthDelta, focusReplacements });\r\n        setActiveFocus({ ...data.focus, index: minIndex, length: maxEndIndex - minIndex + lengthDelta });\r\n    };\r\n\r\n    useEffect(() => {\r\n        changeExperiment(null);\r\n    }, [data.projectState]);\r\n\r\n    return (\r\n        <>\r\n            <Text style={styles.sectionHeaderText}>{`${data.title} - Experiment with the Code`}</Text>\r\n            <Text style={experimentStyles.instructionsText}>Select an experiment below and view the result</Text>\r\n            <View style={experimentStyles.experimentView}>\r\n                <TouchableOpacity onPress={() => changeExperiment(null)}>\r\n                    <View style={experimentStyles.experimentItemRow}>\r\n                        <View style={styles.buttonView}>\r\n                            <Text style={styles.buttonText}>View</Text>\r\n                        </View>\r\n                        <View style={activeExperiment === null ? experimentStyles.experimentItemView_active : experimentStyles.experimentItemView}>\r\n                            <Text style={experimentStyles.experimentItemText}>Completed Code</Text>\r\n                        </View>\r\n                    </View>\r\n                </TouchableOpacity>\r\n                {data.experiments.map((x, i) => (\r\n                    <TouchableOpacity key={`${i}`} onPress={() => changeExperiment(x)}>\r\n                        <View style={experimentStyles.experimentItemRow}>\r\n                            <View style={styles.buttonView}>\r\n                                <Text style={styles.buttonText}>View</Text>\r\n                            </View>\r\n                            <View style={x === activeExperiment ? experimentStyles.experimentItemView_active : experimentStyles.experimentItemView}>\r\n                                <Text style={experimentStyles.experimentItemText}>{` ${x.comment ?? `Experiment ${i}`}`}</Text>\r\n                            </View>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                ))}\r\n                {onDone && (\r\n                    <TouchableOpacity onPress={() => onDone?.()}>\r\n                        <View style={experimentStyles.experimentItemRow}>\r\n                            <View style={styles.buttonView}>\r\n                                <Text style={styles.buttonText}>Done</Text>\r\n                            </View>\r\n                            <View style={experimentStyles.experimentItemView}>\r\n                                <Text style={experimentStyles.experimentItemText}> Go to next step</Text>\r\n                            </View>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                )}\r\n            </View>\r\n            <LessonProjectFilesEditor\r\n                key={modifiedProjectState.filesHashCode}\r\n                projectData={{\r\n                    projectState: modifiedProjectState,\r\n                    focus: activeFocus,\r\n                }}\r\n                fileEditorMode_focus='display'\r\n                fileEditorMode_noFocus='display'\r\n                projectEditorMode='display'\r\n                onTaskDone={() => { }}\r\n                lessonData={data}\r\n            />\r\n            {/* {activeExperiment && activeExperiment.replacements.map(x => (\r\n                <View key={x.selection.filePath + x.selection.index} >\r\n                    <View style={{ flexDirection: `row` }}>\r\n                        <Text style={{ minWidth: 80 }}>File</Text>\r\n                        <Text style={{ marginLeft: 4, background: `#111111` }}>{`${x.selection.filePath}`}</Text>\r\n                    </View>\r\n                    <View style={{ flexDirection: `row` }}>\r\n                        <Text style={{ minWidth: 80 }}>Match</Text>\r\n                        <Text style={{ marginLeft: 4, background: `#111111`, color: `#FF8888`, textDecoration: `line-through` }}>{`${data.projectState.files.find(f => f.path === x.selection.filePath)?.content.substr(x.selection.index, x.selection.length)}`}</Text>\r\n                    </View>\r\n                    <View style={{ flexDirection: `row` }}>\r\n                        <Text style={{ minWidth: 80 }}>Replace</Text>\r\n                        <Text style={{ marginLeft: 4, background: `#111111`, color: `#8888FF` }}>{`${x.content}`}</Text>\r\n                    </View>\r\n                </View>\r\n            ))} */}\r\n            <LessonProjectStatePreview projectState={modifiedProjectState} setProjectState={setProjectState} />\r\n        </>\r\n    );\r\n};\r\n","var typescript = Prism.util.clone(Prism.languages.typescript);\nPrism.languages.tsx = Prism.languages.extend('jsx', typescript);","\"use strict\"; // Updated from commit 428eac3 - vscode/src/vs/base/common/strings.ts\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\r\n * Returns first index of the string that is not whitespace.\r\n * If string is empty or contains only whitespaces, returns -1\r\n */\n\nfunction firstNonWhitespaceIndex(str) {\n  for (var i = 0, len = str.length; i < len; i++) {\n    var chCode = str.charCodeAt(i);\n\n    if (chCode !== 32\n    /* Space */\n    && chCode !== 9\n    /* Tab */\n    ) {\n        return i;\n      }\n  }\n\n  return -1;\n}\n\nexports.firstNonWhitespaceIndex = firstNonWhitespaceIndex;\n/**\r\n * Returns last index of the string that is not whitespace.\r\n * If string is empty or contains only whitespaces, returns -1\r\n */\n\nfunction lastNonWhitespaceIndex(str, startIndex) {\n  if (startIndex === void 0) {\n    startIndex = str.length - 1;\n  }\n\n  for (var i = startIndex; i >= 0; i--) {\n    var chCode = str.charCodeAt(i);\n\n    if (chCode !== 32\n    /* Space */\n    && chCode !== 9\n    /* Tab */\n    ) {\n        return i;\n      }\n  }\n\n  return -1;\n}\n\nexports.lastNonWhitespaceIndex = lastNonWhitespaceIndex;","export const doodleStoragePaths = {\r\n    doodleSummary: `doodle/summary`,\r\n    doodleDrawingsPrefix: `doodle/drawings`,\r\n    doodlePartyDrawingsPrefix: `doodle/party/drawings`,\r\n    doodleVotesPrefix: `doodle/votes`,\r\n} as const;\r\n","export var IconsManifest = [{\n  \"id\": \"fa\",\n  \"name\": \"Font Awesome\",\n  \"projectUrl\": \"https://fontawesome.com/\",\n  \"license\": \"CC BY 4.0 License\",\n  \"licenseUrl\": \"https://creativecommons.org/licenses/by/4.0/\"\n}, {\n  \"id\": \"io\",\n  \"name\": \"Ionicons\",\n  \"projectUrl\": \"https://ionicons.com/\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://github.com/ionic-team/ionicons/blob/master/LICENSE\"\n}, {\n  \"id\": \"md\",\n  \"name\": \"Material Design icons\",\n  \"projectUrl\": \"http://google.github.io/material-design-icons/\",\n  \"license\": \"Apache License Version 2.0\",\n  \"licenseUrl\": \"https://github.com/google/material-design-icons/blob/master/LICENSE\"\n}, {\n  \"id\": \"ti\",\n  \"name\": \"Typicons\",\n  \"projectUrl\": \"http://s-ings.com/typicons/\",\n  \"license\": \"CC BY-SA 3.0\",\n  \"licenseUrl\": \"https://creativecommons.org/licenses/by-sa/3.0/\"\n}, {\n  \"id\": \"go\",\n  \"name\": \"Github Octicons icons\",\n  \"projectUrl\": \"https://octicons.github.com/\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://github.com/primer/octicons/blob/master/LICENSE\"\n}, {\n  \"id\": \"fi\",\n  \"name\": \"Feather\",\n  \"projectUrl\": \"https://feathericons.com/\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://github.com/feathericons/feather/blob/master/LICENSE\"\n}, {\n  \"id\": \"gi\",\n  \"name\": \"Game Icons\",\n  \"projectUrl\": \"https://game-icons.net/\",\n  \"license\": \"CC BY 3.0\",\n  \"licenseUrl\": \"https://creativecommons.org/licenses/by/3.0/\"\n}, {\n  \"id\": \"wi\",\n  \"name\": \"Weather Icons\",\n  \"projectUrl\": \"https://erikflowers.github.io/weather-icons/\",\n  \"license\": \"SIL OFL 1.1\",\n  \"licenseUrl\": \"http://scripts.sil.org/OFL\"\n}, {\n  \"id\": \"di\",\n  \"name\": \"Devicons\",\n  \"projectUrl\": \"https://vorillaz.github.io/devicons/\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n}, {\n  \"id\": \"ai\",\n  \"name\": \"Ant Design Icons\",\n  \"projectUrl\": \"https://github.com/ant-design/ant-design-icons\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n}, {\n  \"id\": \"bs\",\n  \"name\": \"Bootstrap Icons\",\n  \"projectUrl\": \"https://github.com/twbs/icons\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n}, {\n  \"id\": \"ri\",\n  \"name\": \"Remix Icon\",\n  \"projectUrl\": \"https://github.com/Remix-Design/RemixIcon\",\n  \"license\": \"Apache License Version 2.0\",\n  \"licenseUrl\": \"http://www.apache.org/licenses/\"\n}, {\n  \"id\": \"fc\",\n  \"name\": \"Flat Color Icons\",\n  \"projectUrl\": \"https://github.com/icons8/flat-color-icons\",\n  \"license\": \"MIT\",\n  \"licenseUrl\": \"https://opensource.org/licenses/MIT\"\n}, {\n  \"id\": \"gr\",\n  \"name\": \"Grommet-Icons\",\n  \"projectUrl\": \"https://github.com/grommet/grommet-icons\",\n  \"license\": \"Apache License Version 2.0\",\n  \"licenseUrl\": \"http://www.apache.org/licenses/\"\n}];","import * as React from 'react';\nexport var DefaultContext = {\n  color: undefined,\n  size: undefined,\n  className: undefined,\n  style: undefined,\n  attr: undefined\n};\nexport var IconContext = React.createContext && React.createContext(DefaultContext);","var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport * as React from 'react';\nimport { IconContext, DefaultContext } from './iconContext';\n\nfunction Tree2Element(tree) {\n  return tree && tree.map(function (node, i) {\n    return React.createElement(node.tag, __assign({\n      key: i\n    }, node.attr), Tree2Element(node.child));\n  });\n}\n\nexport function GenIcon(data) {\n  return function (props) {\n    return React.createElement(IconBase, __assign({\n      attr: __assign({}, data.attr)\n    }, props), Tree2Element(data.child));\n  };\n}\nexport function IconBase(props) {\n  var elem = function elem(conf) {\n    var computedSize = props.size || conf.size || \"1em\";\n    var className;\n    if (conf.className) className = conf.className;\n    if (props.className) className = (className ? className + ' ' : '') + props.className;\n\n    var attr = props.attr,\n        title = props.title,\n        svgProps = __rest(props, [\"attr\", \"title\"]);\n\n    return React.createElement(\"svg\", __assign({\n      stroke: \"currentColor\",\n      fill: \"currentColor\",\n      strokeWidth: \"0\"\n    }, conf.attr, attr, svgProps, {\n      className: className,\n      style: __assign({\n        color: props.color || conf.color\n      }, conf.style, props.style),\n      height: computedSize,\n      width: computedSize,\n      xmlns: \"http://www.w3.org/2000/svg\"\n    }), title && React.createElement(\"title\", null, title), props.children);\n  };\n\n  return IconContext !== undefined ? React.createElement(IconContext.Consumer, null, function (conf) {\n    return elem(conf);\n  }) : elem(DefaultContext);\n}","import { webRequest } from 'utils/web-request';\r\nimport { UploadApi, UploadApiEndpointName, UploadApiRequestData } from './types';\r\n\r\nexport const createUploadApiWebClient = (config: { uploadApiUrl: string }): UploadApi => {\r\n\r\n    async function apiRequest<T>(endpoint: UploadApiEndpointName, data: unknown): Promise<T> {\r\n        const url = `${config.uploadApiUrl}/${endpoint}`;\r\n\r\n        const requestData: UploadApiRequestData = {\r\n            endpoint,\r\n            data,\r\n        };\r\n\r\n        const resultObj = (await webRequest(url, requestData)) as { data: T };\r\n\r\n        return resultObj.data;\r\n    };\r\n\r\n    const api: UploadApi = {\r\n        createUploadUrl: (data) => apiRequest(`createUploadUrl`, data),\r\n        renewUploadUrl: (data) => apiRequest(`renewUploadUrl`, data),\r\n    };\r\n\r\n    return api;\r\n};\r\n","import { Platform } from 'react-native-lite';\r\n\r\nexport const createSpeechService = (): {\r\n    speak: (text: string, languange?: string) => void;\r\n    getVoicesForLanguange: (languange: string) => { voice: SpeechSynthesisVoice, isSelected: boolean }[];\r\n    setVoiceForLanguange: (languange: string, voice: SpeechSynthesisVoice) => void;\r\n} => {\r\n    if (Platform.OS !== `web`) {\r\n        return {\r\n            speak: () => { },\r\n            getVoicesForLanguange: () => [],\r\n            setVoiceForLanguange: () => { },\r\n        };\r\n    }\r\n\r\n    const synth = window.speechSynthesis;\r\n\r\n    const selectedVoices = {} as { [languange: string]: SpeechSynthesisVoice };\r\n\r\n    const speak = (text: string, languange?: string) => {\r\n        const voiceLang = selectedVoices[languange ?? `en`] ?? null;\r\n\r\n        try {\r\n            const u = new SpeechSynthesisUtterance(text);\r\n            u.voice = voiceLang;\r\n            synth.speak(u);\r\n        } catch {\r\n            // Ignore\r\n        }\r\n    };\r\n\r\n    return {\r\n        speak,\r\n        getVoicesForLanguange: (languange) => {\r\n            const voices = synth.getVoices();\r\n            console.log(`voices`, { voices });\r\n            const v = voices.filter(x => x.lang.startsWith(languange)).map(x => ({\r\n                voice: x,\r\n                isSelected: selectedVoices[languange] === x,\r\n            }));\r\n            return v;\r\n        },\r\n        setVoiceForLanguange: (language, voice) => {\r\n            selectedVoices[language] = voice;\r\n        },\r\n    };\r\n};\r\n\r\nexport type SpeechService = ReturnType<typeof createSpeechService>;\r\n","import React, { } from 'react';\r\nimport { Text, TouchableOpacity } from 'react-native-lite';\r\nimport { theme, ThemeTextStyle, ThemeViewStyle, extractViewStyle, extractTextStyle } from 'themes/theme';\r\n\r\nexport const Button = (props: { style?: ThemeTextStyle & ThemeViewStyle, styleAlt?: boolean, children: string, onPress: () => void }) => {\r\n    const s = props.style ?? (props.styleAlt ? theme.button_formAction_alt : theme.button_formAction);\r\n    return (\r\n        <TouchableOpacity style={extractViewStyle(s)} onPress={props.onPress}>\r\n            <Text style={extractTextStyle(s)}>{props.children}</Text>\r\n        </TouchableOpacity>\r\n    );\r\n};\r\n","import React, { } from 'react';\r\nimport { View, Text } from 'react-native-lite';\r\nimport { theme } from 'themes/theme';\r\nimport { Loading, LoadingInline } from './loading';\r\nimport { ErrorBox, ErrorMessage } from './error-box';\r\nimport { Input_Text, Input_Username, Input_Password, Input_Phone, Input_Email, Input_Currency } from './inputs';\r\nimport { Button } from './button';\r\n\r\ntype PropsOf<T> = T extends (props: infer P) => JSX.Element ? P : never;\r\n\r\nexport const C = {\r\n    Loading,\r\n    LoadingInline,\r\n    ErrorBox,\r\n    ErrorMessage,\r\n    View_Panel: (props: PropsOf<typeof View>) => (<View style={theme.view_panel} {...props} />),\r\n    View_Form: (props: PropsOf<typeof View>) => (<View style={theme.view_form} {...props} />),\r\n    View_FormFields: (props: PropsOf<typeof View>) => (<View style={theme.view_formFields} {...props} />),\r\n    View_FieldRow: (props: PropsOf<typeof View>) => (<View style={theme.view_fieldRow} {...props} />),\r\n    View_FormActionRow: (props: PropsOf<typeof View>) => (<View style={theme.view_formActionRow} {...props} />),\r\n    Text_FormTitle: (props: PropsOf<typeof Text>) => (<Text style={theme.text_formTitle} {...props} />),\r\n    Text_FieldLabel: (props: PropsOf<typeof Text>) => (<Text style={theme.text_fieldLabel} numberOfLines={1} {...props} />),\r\n    Button_FieldInline: (props: PropsOf<typeof Button>) => (<Button style={props.styleAlt ? theme.button_fieldInline_alt : theme.button_fieldInline} {...props} />),\r\n    Button_FormAction: (props: PropsOf<typeof Button>) => (<Button style={props.styleAlt ? theme.button_formAction_alt : theme.button_formAction} {...props} />),\r\n    Input_Text,\r\n    Input_Username,\r\n    Input_Password,\r\n    Input_Phone,\r\n    Input_Email,\r\n    Input_Currency,\r\n};\r\n","import React, { useState } from 'react';\r\nimport { TextInput, View, TouchableOpacity } from 'react-native-lite';\r\nimport { theme, ThemeTextStyle } from 'themes/theme';\r\nimport { PhoneNumber, toStandardPhoneNumber, formatPhoneNumber_UsaCanada } from 'utils/phone-number';\r\nimport { EmailAddress, toEmailAddress } from 'utils/email-address';\r\nimport { Icon } from './icon';\r\nimport { IconKind } from './icon-kind';\r\n\r\nexport const Input_Text = (props: { style?: ThemeTextStyle, value: string, onChange: (value: string) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean, onFocus?: () => void, onBlur?: () => void }) => {\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='default'\r\n            autoCompleteType='off'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={`${props.value}`}\r\n            onChange={(x) => props.onChange(x)}\r\n            onSubmitEditing={props.onSubmit}\r\n            onFocus={props.onFocus}\r\n            onBlur={props.onBlur}\r\n        />\r\n    );\r\n};\r\n\r\nexport const Input_Username = (props: { style?: ThemeTextStyle, value: string, onChange: (value: string) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='default'\r\n            autoCompleteType='username'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={`${props.value}`}\r\n            onChange={(x) => props.onChange(x)}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n\r\nexport const Input_Password = (props: { style?: ThemeTextStyle, value: string, onChange: (value: string) => void, onSubmit?: () => void, onBlur?: () => void, placeholder?: string, editable?: boolean }) => {\r\n\r\n    const [showPassword, setShowPassword] = useState(false);\r\n\r\n    const inputStyle = props.style ?? theme.input_fieldEntry;\r\n    const { marginRight } = inputStyle;\r\n    return (\r\n        <View style={{ flexDirection: `row`, alignItems: `center` }}>\r\n            <TextInput style={{ ...inputStyle, marginRight: 0 }}\r\n                keyboardType='default'\r\n                autoCompleteType='password'\r\n                secureTextEntry={!showPassword}\r\n                placeholder={props.placeholder}\r\n                editable={props.editable}\r\n                value={`${props.value}`}\r\n                onChange={(x) => props.onChange(x)}\r\n                onSubmitEditing={props.onSubmit}\r\n                onBlur={props.onBlur}\r\n            />\r\n            <TouchableOpacity onPress={() => setShowPassword(s => !s)} style={{ outlineColor: theme.icon.outlineColor }}>\r\n                <View style={{ paddingLeft: 4, paddingRight: 4, marginRight }}>\r\n                    <Icon style={theme.icon} kind={showPassword ? IconKind.eye : IconKind.eyeSlash} />\r\n                </View>\r\n            </TouchableOpacity>\r\n        </View>\r\n    );\r\n};\r\n\r\nexport type Currency = number;// & { __type: 'currency' };\r\nexport const Input_Currency = (props: { style?: ThemeTextStyle, value: Currency, onChange: (value: Currency) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='numeric'\r\n            autoCompleteType='off'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={`${props.value}`}\r\n            onChange={(x) => props.onChange(Number.parseFloat(x) || 0)}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n\r\nexport const Input_Phone = (props: { style?: ThemeTextStyle, value: PhoneNumber, onChange: (value: PhoneNumber) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n\r\n    const [valueActual, setValueActual] = useState(formatPhoneNumber_UsaCanada(props.value));\r\n    const changeValueActual = (v: string) => {\r\n        setValueActual(formatPhoneNumber_UsaCanada(v));\r\n        props.onChange(toStandardPhoneNumber(v));\r\n    };\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='phone-pad'\r\n            autoCompleteType='tel'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={valueActual}\r\n            onChange={changeValueActual}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n\r\n\r\nexport const Input_Email = (props: { style?: ThemeTextStyle, value: EmailAddress, onChange: (value: EmailAddress) => void, onSubmit?: () => void, placeholder?: string, editable?: boolean }) => {\r\n\r\n    const [valueActual, setValueActual] = useState(toEmailAddress(props.value));\r\n    const changeValueActual = (v: string) => {\r\n        setValueActual(toEmailAddress(v));\r\n        props.onChange(toEmailAddress(v));\r\n    };\r\n    return (\r\n        <TextInput style={props.style ?? theme.input_fieldEntry}\r\n            keyboardType='email-address'\r\n            autoCompleteType='email'\r\n            placeholder={props.placeholder}\r\n            editable={props.editable}\r\n            value={valueActual}\r\n            onChange={changeValueActual}\r\n            onSubmitEditing={props.onSubmit}\r\n        />\r\n    );\r\n};\r\n","import dayjs from 'dayjs';\r\nimport localizedFormat from 'dayjs/plugin/localizedFormat';\r\nimport relativeTime from 'dayjs/plugin/relativeTime';\r\n\r\ndayjs.extend(localizedFormat);\r\ndayjs.extend(relativeTime);\r\n\r\nexport const formatDate = (date: Date | number | string) => {\r\n    return dayjs(date).format(`L`);\r\n};\r\n\r\nexport const formatDate_FromNow = (date: Date | number | string) => {\r\n    return dayjs(date).fromNow();\r\n};\r\n","\"use strict\"; // Updated from commit d4edb9a - vscode/src/vs/base/common/diff/diffChange.ts\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\r\n * Represents information about a specific difference between two sequences.\r\n */\n\nvar DiffChange =\n/** @class */\nfunction () {\n  /**\r\n   * Constructs a new DiffChange with the given sequence information\r\n   * and content.\r\n   */\n  function DiffChange(originalStart, originalLength, modifiedStart, modifiedLength) {\n    //Debug.Assert(originalLength > 0 || modifiedLength > 0, \"originalLength and modifiedLength cannot both be <= 0\");\n    this.originalStart = originalStart;\n    this.originalLength = originalLength;\n    this.modifiedStart = modifiedStart;\n    this.modifiedLength = modifiedLength;\n  }\n  /**\r\n   * The end point (exclusive) of the change in the original sequence.\r\n   */\n\n\n  DiffChange.prototype.getOriginalEnd = function () {\n    return this.originalStart + this.originalLength;\n  };\n  /**\r\n   * The end point (exclusive) of the change in the modified sequence.\r\n   */\n\n\n  DiffChange.prototype.getModifiedEnd = function () {\n    return this.modifiedStart + this.modifiedLength;\n  };\n\n  return DiffChange;\n}();\n\nexports.DiffChange = DiffChange;","export async function delay(timeout: number): Promise<void> {\r\n    return await new Promise((resolve) => {\r\n        setTimeout(resolve, timeout);\r\n    });\r\n}\r\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import React from 'react';\r\nimport { ThemeIconStyle, theme } from 'themes/theme';\r\nimport { MdMenu, MdArrowBack, MdCheckBoxOutlineBlank, MdErrorOutline, MdContentCopy, MdDashboard } from 'react-icons/md';\r\nimport { FiChevronRight, FiChevronDown } from 'react-icons/fi';\r\nimport { FaRedo, FaPlus, FaMinus, FaEye, FaEyeSlash, FaCheck, FaCheckSquare, FaSquare } from 'react-icons/fa';\r\nimport { View } from 'react-native-lite';\r\nimport { IconKind } from './icon-kind';\r\n\r\nfunction getIcon(kind: IconKind) {\r\n    switch (kind) {\r\n        case IconKind.menu: return { name: `menu`, component: MdMenu };\r\n        case IconKind.back: return { name: `arrow-back`, component: MdArrowBack };\r\n        case IconKind.error: return { name: `error-outline`, component: MdErrorOutline };\r\n        case IconKind.expanded: return { name: `chevron-down`, component: FiChevronDown };\r\n        case IconKind.collapsed: return { name: `chevron-right`, component: FiChevronRight };\r\n        case IconKind.copy: return { name: `content-copy`, component: MdContentCopy };\r\n        case IconKind.retry: return { name: `reload`, component: FaRedo };\r\n        case IconKind.dashboard: return { name: `dashboard`, component: MdDashboard };\r\n        case IconKind.add: return { name: `plus`, component: FaPlus };\r\n        case IconKind.remove: return { name: `minus`, component: FaMinus };\r\n        case IconKind.eye: return { name: `eye`, component: FaEye };\r\n        case IconKind.eyeSlash: return { name: `eye-slash`, component: FaEyeSlash };\r\n        case IconKind.checkChecked: return { name: `checked`, component: FaCheckSquare };\r\n        case IconKind.checkUnchecked: return { name: `unchecked`, component: FaSquare };\r\n\r\n        // case IconKind.Account: return { name: `account-circle`, component: MaterialIcons };\r\n        // case IconKind.Message: return { name: `message`, component: MaterialIcons };\r\n        // case IconKind.Subscription: return { name: `ticket-account`, component: MaterialCommunityIcons };\r\n        // case IconKind.Campaigns: return { name: `calendar-multiselect`, component: MaterialCommunityIcons };\r\n        // case IconKind.Contacts: return { name: `contacts`, component: MaterialIcons };\r\n        // case IconKind.Keywords: return { name: `key-variant`, component: MaterialCommunityIcons };\r\n        // case IconKind.Resources: return { name: `collections-bookmark`, component: MaterialIcons };\r\n        // case IconKind.Admin: return { name: `settings`, component: MaterialIcons };\r\n        // case IconKind.Solutions: return { name: '', component: FontAwesome };\r\n        // case IconKind.Texting: return { name: '', component: FontAwesome };\r\n        // case IconKind.Pricing: return { name: '', component: FontAwesome };\r\n        // case IconKind.Download: return { name: '', component: FontAwesome };\r\n\r\n        default:\r\n            return { name: `unknown`, component: MdCheckBoxOutlineBlank };\r\n    }\r\n}\r\n\r\nexport const Icon = (props: { kind: IconKind, style?: ThemeIconStyle }) => {\r\n    const icon = getIcon(props.kind);\r\n    const IconComponent = icon.component;\r\n    const size = props.style?.size ?? theme.icon.size ?? theme.sizes.fontSize;\r\n    return (\r\n        <View style={{ width: size, height: size }}>\r\n            <IconComponent name={icon.name} size={size} color={props.style?.color ?? theme.icon.color} />\r\n        </View>\r\n    );\r\n};\r\n","/* eslint-disable @typescript-eslint/no-unused-vars */\r\nexport type ThemeViewStyle = {\r\n    display?: 'flex' | 'block' | 'inline';\r\n    flexDirection?: 'row' | 'column' | 'row-reverse' | 'column-reverse';\r\n    flexWrap?: 'wrap' | 'nowrap';\r\n    flex?: number;\r\n    justifyContent?: 'flex-start' | 'center' | 'flex-end' | 'space-around' | 'space-between';\r\n    alignItems?: 'flex-start' | 'center' | 'flex-end';\r\n    alignSelf?: 'center' | 'stretch' | 'flex-start' | 'flex-end';\r\n    overflow?: 'visible' | 'hidden' | 'auto';\r\n\r\n    background?: string;\r\n\r\n    margin?: number;\r\n    marginLeft?: number;\r\n    marginRight?: number;\r\n    marginTop?: number;\r\n    marginBottom?: number;\r\n    padding?: number;\r\n    paddingRight?: number;\r\n    paddingLeft?: number;\r\n    paddingTop?: number;\r\n    paddingBottom?: number;\r\n\r\n    width?: number;\r\n    minWidth?: number;\r\n    maxWidth?: number;\r\n    height?: number;\r\n\r\n    borderWidth?: number;\r\n    borderLeftWidth?: number;\r\n    borderRightWidth?: number;\r\n    borderTopWidth?: number;\r\n    borderBottomWidth?: number;\r\n\r\n    borderColor?: string;\r\n    borderLeftColor?: string;\r\n    borderRightColor?: string;\r\n    borderTopColor?: string;\r\n    borderBottomColor?: string;\r\n\r\n\r\n    borderRadius?: number;\r\n    borderStyle?: 'solid';\r\n    outlineColor?: string;\r\n    outline?: `none`;\r\n\r\n    transform?: string;\r\n\r\n    opacity?: number;\r\n\r\n    position?: 'absolute' | 'relative' | 'fixed';\r\n    top?: number;\r\n    bottom?: number;\r\n    left?: number;\r\n    right?: number;\r\n    zIndex?: number;\r\n};\r\nexport type ThemeTextStyle = {\r\n    margin?: number;\r\n    marginLeft?: number;\r\n    marginRight?: number;\r\n    marginTop?: number;\r\n    marginBottom?: number;\r\n    padding?: number;\r\n    paddingRight?: number;\r\n    paddingLeft?: number;\r\n    paddingTop?: number;\r\n    paddingBottom?: number;\r\n\r\n    color?: string;\r\n    background?: string;\r\n\r\n    fontFamily?: string;\r\n    fontSize?: number;\r\n    fontWeight?: 'normal' | 'bold' | 'lighter';\r\n    lineHeight?: string;\r\n    whiteSpace?: 'normal' | 'nowrap' | 'pre' | 'pre-wrap';\r\n    minWidth?: number;\r\n\r\n    textDecoration?: `line-through`;\r\n\r\n    outlineColor?: string;\r\n    userSelect?: `none`;\r\n};\r\nexport type ThemeIconStyle = {\r\n    color?: string;\r\n    size?: number;\r\n    outlineColor?: string;\r\n};\r\n\r\nexport const extractViewStyle = (style: ThemeViewStyle & ThemeTextStyle): ThemeViewStyle => {\r\n    return {\r\n        display: style.display,\r\n        flexDirection: style.flexDirection,\r\n        flex: style.flex,\r\n        justifyContent: style.justifyContent,\r\n        alignItems: style.alignItems,\r\n        overflow: style.overflow,\r\n\r\n        background: style.background,\r\n\r\n        margin: style.margin,\r\n        marginLeft: style.margin ?? style.marginLeft,\r\n        marginRight: style.margin ?? style.marginRight,\r\n        marginTop: style.margin ?? style.marginTop,\r\n        marginBottom: style.margin ?? style.marginBottom,\r\n        padding: style.padding,\r\n        paddingRight: style.padding ?? style.paddingRight,\r\n        paddingLeft: style.padding ?? style.paddingLeft,\r\n        paddingTop: style.padding ?? style.paddingTop,\r\n        paddingBottom: style.padding ?? style.paddingBottom,\r\n\r\n        width: style.width,\r\n        minWidth: style.minWidth,\r\n        maxWidth: style.maxWidth,\r\n        height: style.height,\r\n\r\n        borderWidth: style.borderWidth,\r\n        borderRadius: style.borderRadius,\r\n        borderColor: style.borderColor,\r\n        borderStyle: style.borderStyle,\r\n\r\n        outlineColor: style.outlineColor,\r\n    };\r\n};\r\nexport const extractTextStyle = (style: ThemeViewStyle & ThemeTextStyle): ThemeTextStyle => {\r\n    return {\r\n        // padding: style.padding,\r\n        color: style.color,\r\n\r\n        fontFamily: style.fontFamily,\r\n        fontSize: style.fontSize,\r\n        fontWeight: style.fontWeight,\r\n        lineHeight: style.lineHeight,\r\n        // whiteSpace: style.whiteSpace,\r\n\r\n        outlineColor: style.outlineColor,\r\n    };\r\n};\r\n\r\nexport const basicThemeColors = {\r\n    text: `#333333`,\r\n    text_header: `#333333`,\r\n    text_button: `#333333`,\r\n    text_error: `#333333`,\r\n    text_errorMessage: `#ff3333`,\r\n    border: `#cccccc`,\r\n    border_minor: `#cccccc`,\r\n    border_input: `#cccccc`,\r\n    outline: `#888888`,\r\n    background: `#ffffff`,\r\n    background_field: `#dddddd`,\r\n    background_button: `#eeeeee`,\r\n    background_error: `#ffcccc`,\r\n    loader: `#3333ff`,\r\n    icon: `#3333ff`,\r\n};\r\nexport type RectSize = { all?: number, left?: number, right?: number, top?: number, bottom?: number };\r\nconst getBorderSizes = (size: RectSize) => {\r\n    return {\r\n        borderWidth: size.all,\r\n        borderLeftWidth: size.left ?? size.all,\r\n        borderRightWidth: size.right ?? size.all,\r\n        borderTopWidth: size.top ?? size.all,\r\n        borderBottomWidth: size.bottom ?? size.all,\r\n    };\r\n};\r\n\r\nexport const basicThemeSizes = {\r\n    textPadding: 4,\r\n    borderWidth: { all: 1 } as RectSize,\r\n    borderWidth_minor: { all: 1 } as RectSize,\r\n    borderWidth_input: { all: 1 } as RectSize,\r\n    borderRadius: 4,\r\n    sectionGap: 16,\r\n    elementGap: 8,\r\n    rowGap: 4,\r\n    rowPadding: 4,\r\n\r\n    fontSize: 14,\r\n    fontSize_input: 16,\r\n    fontSize_button: 14,\r\n    fontSize_header: 16,\r\n\r\n    lineHeight: `18px`,\r\n\r\n    minWidth_label: 120,\r\n    minWidth_input: 120,\r\n    minWidth_button: 120,\r\n\r\n    icon: 14,\r\n};\r\n\r\nexport const basicFont = {\r\n    fontFamily: `\"Trebuchet MS\", Helvetica, Roboto, sans-serif`,\r\n    fontWeight_normal: `normal` as 'normal' | 'bold',\r\n    fontWeight_button: `bold` as 'normal' | 'bold',\r\n    fontWeight_header: `bold` as 'normal' | 'bold',\r\n};\r\n\r\nexport type ThemeColors = typeof basicThemeColors;\r\nexport type ThemeSizes = typeof basicThemeSizes;\r\nexport type ThemeFont = typeof basicFont;\r\n\r\nconst createTheme = (colors: ThemeColors, sizes: ThemeSizes, font: ThemeFont) => {\r\n\r\n    const borderProps = {\r\n        ...getBorderSizes(sizes.borderWidth),\r\n\r\n        borderRadius: sizes.borderRadius,\r\n        borderColor: colors.border,\r\n        borderStyle: `solid`,\r\n        outlineColor: colors.outline,\r\n    } as const;\r\n\r\n    const borderProps_minor = {\r\n        ...getBorderSizes(sizes.borderWidth_minor),\r\n\r\n        borderRadius: sizes.borderRadius,\r\n        borderColor: colors.border_minor,\r\n        borderStyle: `solid`,\r\n        outlineColor: colors.outline,\r\n    } as const;\r\n\r\n    const borderProps_input = {\r\n        ...getBorderSizes(sizes.borderWidth_input),\r\n\r\n        borderRadius: sizes.borderRadius,\r\n        borderColor: colors.border_input,\r\n        borderStyle: `solid`,\r\n        outlineColor: colors.outline,\r\n    } as const;\r\n\r\n    let sView: ThemeViewStyle = {};\r\n    let sText: ThemeTextStyle = {};\r\n    let sIcon: ThemeIconStyle = {};\r\n    let sTextView: ThemeTextStyle & ThemeViewStyle = {};\r\n\r\n    const theme = {\r\n        colors,\r\n        sizes,\r\n        font,\r\n\r\n        view_panel: sView = {\r\n            background: colors.background,\r\n            padding: sizes.elementGap,\r\n        },\r\n        view_form: sView = {\r\n            ...borderProps,\r\n            marginBottom: sizes.sectionGap,\r\n            padding: sizes.elementGap,\r\n            // background: colors.background_field,\r\n        },\r\n        text_formTitle: sText = {\r\n            padding: sizes.textPadding,\r\n            color: colors.text_header,\r\n            fontSize: sizes.fontSize_header,\r\n            fontFamily: font.fontFamily,\r\n            fontWeight: font.fontWeight_header,\r\n        },\r\n        view_formFields: sView = {\r\n            // ...borderProps,\r\n            ...borderProps_minor,\r\n            // padding: sizes.elementGap,\r\n            marginBottom: sizes.rowGap,\r\n            background: colors.background_field,\r\n            // alignItems: `center`,\r\n        },\r\n        view_fieldRow: sView = {\r\n            // ...borderProps,\r\n            // ...borderProps_minor,\r\n            // marginBottom: sizes.rowGap,\r\n            // padding: sizes.rowPadding,\r\n            marginLeft: sizes.rowPadding,\r\n            // background: colors.background_field,\r\n            display: `flex`,\r\n            flexDirection: `row`,\r\n\r\n            alignItems: `center`,\r\n            flexWrap: `wrap`,\r\n        },\r\n        text_fieldLabel: sText = {\r\n            padding: sizes.textPadding,\r\n            color: colors.text,\r\n            fontSize: sizes.fontSize,\r\n            fontWeight: font.fontWeight_normal,\r\n            minWidth: sizes.minWidth_label,\r\n            //  whiteSpace: `nowrap`,\r\n        },\r\n        input_fieldEntry: sText = {\r\n            ...borderProps_input,\r\n            marginBottom: sizes.rowGap,\r\n            marginRight: sizes.rowGap,\r\n            padding: sizes.textPadding,\r\n            color: colors.text,\r\n            fontSize: sizes.fontSize_input,\r\n            fontWeight: font.fontWeight_normal,\r\n            lineHeight: sizes.lineHeight,\r\n            minWidth: sizes.minWidth_input,\r\n        },\r\n        button_fieldInline: sTextView = {\r\n            ...borderProps,\r\n            // marginLeft: sizes.elementGap,\r\n            marginBottom: sizes.rowGap,\r\n            marginRight: sizes.rowGap,\r\n            padding: sizes.textPadding,\r\n            background: colors.background_button,\r\n            color: colors.text_button,\r\n            fontSize: sizes.fontSize_button,\r\n            fontWeight: font.fontWeight_button,\r\n            lineHeight: sizes.lineHeight,\r\n            display: `flex`,\r\n            minWidth: sizes.minWidth_button,\r\n        },\r\n        button_fieldInline_alt: sTextView = {\r\n            ...sTextView,\r\n            background: colors.text_button,\r\n            color: colors.background_button,\r\n            borderColor: colors.background_button,\r\n        },\r\n        view_formActionRow: sView = {\r\n            display: `flex`,\r\n            flexDirection: `row`,\r\n            justifyContent: `flex-end`,\r\n            marginBottom: sizes.elementGap,\r\n        },\r\n        button_formAction: sTextView = {\r\n            ...borderProps,\r\n            marginLeft: sizes.elementGap,\r\n            padding: sizes.textPadding,\r\n            background: colors.background_button,\r\n            color: colors.text_button,\r\n            fontSize: sizes.fontSize_button,\r\n            fontWeight: font.fontWeight_button,\r\n            lineHeight: sizes.lineHeight,\r\n            minWidth: sizes.minWidth_button,\r\n        },\r\n        button_formAction_alt: sTextView = {\r\n            ...sTextView,\r\n            background: colors.text_button,\r\n            color: colors.background_button,\r\n            borderColor: colors.background_button,\r\n        },\r\n\r\n        view_error: sView = {\r\n            ...borderProps,\r\n            marginBottom: sizes.sectionGap,\r\n            padding: sizes.rowPadding,\r\n            background: colors.background_error,\r\n        },\r\n        text_error: sText = {\r\n            padding: sizes.textPadding,\r\n            color: colors.text_error,\r\n            fontSize: sizes.fontSize,\r\n            fontFamily: font.fontFamily,\r\n            fontWeight: font.fontWeight_button,\r\n        },\r\n        text_errorMessage: sText = {\r\n            padding: sizes.textPadding,\r\n            color: colors.text_errorMessage,\r\n            fontSize: sizes.fontSize,\r\n            fontFamily: font.fontFamily,\r\n            fontWeight: font.fontWeight_button,\r\n        },\r\n\r\n        icon: sIcon = {\r\n            size: sizes.icon,\r\n            color: colors.icon,\r\n            outlineColor: colors.outline,\r\n        },\r\n        icon_errorMessage: sIcon = {\r\n            size: sizes.icon,\r\n            color: colors.text_errorMessage,\r\n            outlineColor: colors.outline,\r\n        },\r\n    } as const;\r\n\r\n    return theme;\r\n};\r\n\r\nexport const purpleColors = {\r\n    purple: `#863d8f`,\r\n    purpleLite: `#a75da7`,\r\n    purpleBackgroundLite: `#ddbfdd`,\r\n    blue: `#3baccf`,\r\n    gray: `#656364`,\r\n    lightGray: `#f8f6f7`,\r\n    lightBackgroundGray: `#e8e6e7`,\r\n    borderGray: `#d7c7d7`,\r\n    headerWhite: `#ffffff`,\r\n    headerGray: `#cecece`,\r\n    menuWhite: `#ffffff`,\r\n    bodyWhite: `#ffffff`,\r\n    buttonGray: `#a0a1a5`,\r\n    buttonWhite: `#e2e3e9`,\r\n    headingGray: `#f8f6f7`,\r\n    cardLightGray: `#f8f8f8`,\r\n    textWhite: `#ffffff`,\r\n    textBlack: `#2b2b2b`,\r\n    textGray: `#696768`,\r\n\r\n    // New Colors\r\n    warnRed: `#C56364`,\r\n    errorRed: `#C56364`,\r\n    deleteRed: `#C56364`,\r\n    changedYellow: `#F5F5C5`,\r\n};\r\n\r\nexport const purpleThemeColors: typeof basicThemeColors = {\r\n    ...basicThemeColors,\r\n    text: `#2b2b2b`,\r\n    text_header: `#863d8f`,\r\n    text_button: `#ffffff`,\r\n    // text_error: `#ffffff`,\r\n    border: `#863d8f`,\r\n    border_minor: `#863d8f`,\r\n    // border_minor: `#aaaaaa`,\r\n    border_input: `#aaaaaa`,\r\n    background: `#ffffff`,\r\n    background_field: `#dddddd`,\r\n    background_button: `#863d8f`,\r\n    // background_error: `#C56364`,\r\n    loader: `#863d8f`,\r\n    icon: `#863d8f`,\r\n};\r\n\r\nexport const purpleSizes: typeof basicThemeSizes = {\r\n    ...basicThemeSizes,\r\n    borderWidth: { all: 1, bottom: 4 },\r\n    borderWidth_minor: { all: 0, bottom: 1 },\r\n};\r\n\r\nexport const vscodeThemeColors = {\r\n    colors: {\r\n        text: `#569CD6`,\r\n        border: `#6796E6`,\r\n        background: `#1e1e1e`,\r\n        background_field: `#2e2e2e`,\r\n    },\r\n};\r\n\r\n// eslint-disable-next-line import/no-mutable-exports\r\nexport let theme = createTheme(basicThemeColors, basicThemeSizes, basicFont);\r\n// eslint-disable-next-line import/no-mutable-exports\r\n// export let theme = createTheme(purpleThemeColors, purpleSizes, basicFont);\r\n\r\nexport const setTheme = (colors: ThemeColors, sizes: ThemeSizes, font: ThemeFont) => {\r\n    theme = createTheme(purpleThemeColors, basicThemeSizes, basicFont);\r\n};\r\n","import { getValuesAsItems } from './objects';\r\n\r\nexport const moveItem = <T>(obj: T, from: T[], to: T[]) => {\r\n    const i = from.indexOf(obj);\r\n    if (i < 0) { throw new Error(`moveItem Failed to find an item in the from array: ${JSON.stringify({ obj, from, to })}`); }\r\n    from.splice(i, 1);\r\n    to.push(obj);\r\n};\r\n\r\nexport const distinct = <T>(items: T[]): T[] => {\r\n    const set = new Set(items);\r\n    return [...set];\r\n};\r\n\r\nexport const shuffle = <T>(items: T[]): T[] => {\r\n    return items.map(x => ({ x, value: Math.random() })).sort((a, b) => a.value - b.value).map(x => x.x);\r\n};\r\n\r\nexport const distinct_key = <T>(items: T[], getKey: (item: T) => string): T[] => {\r\n    const set = {} as { [key: string]: T };\r\n    items.forEach(x => { set[getKey(x)] = x; });\r\n    return getValuesAsItems(set);\r\n};\r\n\r\nexport const groupItems = <T>(items: T[], getKey: (item: T) => string): { [key: string]: T[] } => {\r\n    const groups = {} as { [key: string]: T[] };\r\n    for (const x of items) {\r\n        const g = groups[getKey(x)] ?? (groups[getKey(x)] = []);\r\n        g.push(x);\r\n    }\r\n    return groups;\r\n};\r\n\r\nexport const mergeItems = <T>(items: T[], getKey: (item: T) => string, getMerged: (item: T[], key: string) => T): T[] => {\r\n    const groups = groupItems(items, getKey);\r\n    const merged = getValuesAsItems(groups).map(g => getMerged(g, getKey(g[0])));\r\n    return merged;\r\n};\r\n\r\nexport function sameArrayContents<T>(a: undefined | null | T[], b?: undefined | null | T[]) {\r\n    if (a === b) { return true; }\r\n    if (a == null && b == null) { return true; }\r\n    if (a == null || b == null) { return false; }\r\n    if (a.length !== b.length) { return false; }\r\n    for (const i in a) {\r\n        if (a[i] !== b[i]) { return false; }\r\n    }\r\n    return true;\r\n}\r\n","(function (Prism) {\n  Prism.languages.typescript = Prism.languages.extend('javascript', {\n    'class-name': {\n      pattern: /(\\b(?:class|extends|implements|instanceof|interface|new|type)\\s+)(?!keyof\\b)[_$a-zA-Z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*(?:\\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,\n      lookbehind: true,\n      greedy: true,\n      inside: null // see below\n\n    },\n    // From JavaScript Prism keyword list and TypeScript language spec: https://github.com/Microsoft/TypeScript/blob/master/doc/spec.md#221-reserved-words\n    'keyword': /\\b(?:abstract|as|asserts|async|await|break|case|catch|class|const|constructor|continue|debugger|declare|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|is|keyof|let|module|namespace|new|null|of|package|private|protected|public|readonly|return|require|set|static|super|switch|this|throw|try|type|typeof|undefined|var|void|while|with|yield)\\b/,\n    'builtin': /\\b(?:string|Function|any|number|boolean|Array|symbol|console|Promise|unknown|never)\\b/\n  }); // doesn't work with TS because TS is too complex\n\n  delete Prism.languages.typescript['parameter']; // a version of typescript specifically for highlighting types\n\n  var typeInside = Prism.languages.extend('typescript', {});\n  delete typeInside['class-name'];\n  Prism.languages.typescript['class-name'].inside = typeInside;\n  Prism.languages.insertBefore('typescript', 'function', {\n    'generic-function': {\n      // e.g. foo<T extends \"bar\" | \"baz\">( ...\n      pattern: /#?[_$a-zA-Z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*\\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\\s*\\()/,\n      greedy: true,\n      inside: {\n        'function': /^#?[_$a-zA-Z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*/,\n        'generic': {\n          pattern: /<[\\s\\S]+/,\n          // everything after the first <\n          alias: 'class-name',\n          inside: typeInside\n        }\n      }\n    }\n  });\n  Prism.languages.ts = Prism.languages.typescript;\n})(Prism);","'use strict';\nvar isArray = require('../internals/is-array');\nvar toLength = require('../internals/to-length');\nvar bind = require('../internals/function-bind-context');\n\n// `FlattenIntoArray` abstract operation\n// https://tc39.github.io/proposal-flatMap/#sec-FlattenIntoArray\nvar flattenIntoArray = function (target, original, source, sourceLen, start, depth, mapper, thisArg) {\n  var targetIndex = start;\n  var sourceIndex = 0;\n  var mapFn = mapper ? bind(mapper, thisArg, 3) : false;\n  var element;\n\n  while (sourceIndex < sourceLen) {\n    if (sourceIndex in source) {\n      element = mapFn ? mapFn(source[sourceIndex], sourceIndex, original) : source[sourceIndex];\n\n      if (depth > 0 && isArray(element)) {\n        targetIndex = flattenIntoArray(target, original, element, toLength(element.length), targetIndex, depth - 1) - 1;\n      } else {\n        if (targetIndex >= 0x1FFFFFFFFFFFFF) throw TypeError('Exceed the acceptable array length');\n        target[targetIndex] = element;\n      }\n\n      targetIndex++;\n    }\n    sourceIndex++;\n  }\n  return targetIndex;\n};\n\nmodule.exports = flattenIntoArray;\n","// this method was added to unscopables after implementation\n// in popular engines, so it's moved to a separate module\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\naddToUnscopables('flatMap');\n","/* **********************************************\n     Begin prism-core.js\n********************************************** */\n/// <reference lib=\"WebWorker\"/>\nvar _self = typeof window !== 'undefined' ? window // if in browser\n: typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope ? self // if in worker\n: {} // if in node js\n;\n/**\n * Prism: Lightweight, robust, elegant syntax highlighting\n *\n * @license MIT <https://opensource.org/licenses/MIT>\n * @author Lea Verou <https://lea.verou.me>\n * @namespace\n * @public\n */\n\n\nvar Prism = function (_self) {\n  // Private helper vars\n  var lang = /\\blang(?:uage)?-([\\w-]+)\\b/i;\n  var uniqueId = 0;\n  var _ = {\n    /**\n     * By default, Prism will attempt to highlight all code elements (by calling {@link Prism.highlightAll}) on the\n     * current page after the page finished loading. This might be a problem if e.g. you wanted to asynchronously load\n     * additional languages or plugins yourself.\n     *\n     * By setting this value to `true`, Prism will not automatically highlight all code elements on the page.\n     *\n     * You obviously have to change this value before the automatic highlighting started. To do this, you can add an\n     * empty Prism object into the global scope before loading the Prism script like this:\n     *\n     * ```js\n     * window.Prism = window.Prism || {};\n     * Prism.manual = true;\n     * // add a new <script> to load Prism's script\n     * ```\n     *\n     * @default false\n     * @type {boolean}\n     * @memberof Prism\n     * @public\n     */\n    manual: _self.Prism && _self.Prism.manual,\n    disableWorkerMessageHandler: _self.Prism && _self.Prism.disableWorkerMessageHandler,\n\n    /**\n     * A namespace for utility methods.\n     *\n     * All function in this namespace that are not explicitly marked as _public_ are for __internal use only__ and may\n     * change or disappear at any time.\n     *\n     * @namespace\n     * @memberof Prism\n     */\n    util: {\n      encode: function encode(tokens) {\n        if (tokens instanceof Token) {\n          return new Token(tokens.type, encode(tokens.content), tokens.alias);\n        } else if (Array.isArray(tokens)) {\n          return tokens.map(encode);\n        } else {\n          return tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\\u00a0/g, ' ');\n        }\n      },\n\n      /**\n       * Returns the name of the type of the given value.\n       *\n       * @param {any} o\n       * @returns {string}\n       * @example\n       * type(null)      === 'Null'\n       * type(undefined) === 'Undefined'\n       * type(123)       === 'Number'\n       * type('foo')     === 'String'\n       * type(true)      === 'Boolean'\n       * type([1, 2])    === 'Array'\n       * type({})        === 'Object'\n       * type(String)    === 'Function'\n       * type(/abc+/)    === 'RegExp'\n       */\n      type: function type(o) {\n        return Object.prototype.toString.call(o).slice(8, -1);\n      },\n\n      /**\n       * Returns a unique number for the given object. Later calls will still return the same number.\n       *\n       * @param {Object} obj\n       * @returns {number}\n       */\n      objId: function objId(obj) {\n        if (!obj['__id']) {\n          Object.defineProperty(obj, '__id', {\n            value: ++uniqueId\n          });\n        }\n\n        return obj['__id'];\n      },\n\n      /**\n       * Creates a deep clone of the given object.\n       *\n       * The main intended use of this function is to clone language definitions.\n       *\n       * @param {T} o\n       * @param {Record<number, any>} [visited]\n       * @returns {T}\n       * @template T\n       */\n      clone: function deepClone(o, visited) {\n        visited = visited || {};\n        var clone, id;\n\n        switch (_.util.type(o)) {\n          case 'Object':\n            id = _.util.objId(o);\n\n            if (visited[id]) {\n              return visited[id];\n            }\n\n            clone =\n            /** @type {Record<string, any>} */\n            {};\n            visited[id] = clone;\n\n            for (var key in o) {\n              if (o.hasOwnProperty(key)) {\n                clone[key] = deepClone(o[key], visited);\n              }\n            }\n\n            return (\n              /** @type {any} */\n              clone\n            );\n\n          case 'Array':\n            id = _.util.objId(o);\n\n            if (visited[id]) {\n              return visited[id];\n            }\n\n            clone = [];\n            visited[id] = clone;\n\n            /** @type {Array} */\n\n            /** @type {any} */\n            o.forEach(function (v, i) {\n              clone[i] = deepClone(v, visited);\n            });\n            return (\n              /** @type {any} */\n              clone\n            );\n\n          default:\n            return o;\n        }\n      },\n\n      /**\n       * Returns the Prism language of the given element set by a `language-xxxx` or `lang-xxxx` class.\n       *\n       * If no language is set for the element or the element is `null` or `undefined`, `none` will be returned.\n       *\n       * @param {Element} element\n       * @returns {string}\n       */\n      getLanguage: function getLanguage(element) {\n        while (element && !lang.test(element.className)) {\n          element = element.parentElement;\n        }\n\n        if (element) {\n          return (element.className.match(lang) || [, 'none'])[1].toLowerCase();\n        }\n\n        return 'none';\n      },\n\n      /**\n       * Returns the script element that is currently executing.\n       *\n       * This does __not__ work for line script element.\n       *\n       * @returns {HTMLScriptElement | null}\n       */\n      currentScript: function currentScript() {\n        if (typeof document === 'undefined') {\n          return null;\n        }\n\n        if ('currentScript' in document && 1 < 2\n        /* hack to trip TS' flow analysis */\n        ) {\n            return (\n              /** @type {any} */\n              document.currentScript\n            );\n          } // IE11 workaround\n        // we'll get the src of the current script by parsing IE11's error stack trace\n        // this will not work for inline scripts\n\n\n        try {\n          throw new Error();\n        } catch (err) {\n          // Get file src url from stack. Specifically works with the format of stack traces in IE.\n          // A stack will look like this:\n          //\n          // Error\n          //    at _.util.currentScript (http://localhost/components/prism-core.js:119:5)\n          //    at Global code (http://localhost/components/prism-core.js:606:1)\n          var src = (/at [^(\\r\\n]*\\((.*):.+:.+\\)$/i.exec(err.stack) || [])[1];\n\n          if (src) {\n            var scripts = document.getElementsByTagName('script');\n\n            for (var i in scripts) {\n              if (scripts[i].src == src) {\n                return scripts[i];\n              }\n            }\n          }\n\n          return null;\n        }\n      },\n\n      /**\n       * Returns whether a given class is active for `element`.\n       *\n       * The class can be activated if `element` or one of its ancestors has the given class and it can be deactivated\n       * if `element` or one of its ancestors has the negated version of the given class. The _negated version_ of the\n       * given class is just the given class with a `no-` prefix.\n       *\n       * Whether the class is active is determined by the closest ancestor of `element` (where `element` itself is\n       * closest ancestor) that has the given class or the negated version of it. If neither `element` nor any of its\n       * ancestors have the given class or the negated version of it, then the default activation will be returned.\n       *\n       * In the paradoxical situation where the closest ancestor contains __both__ the given class and the negated\n       * version of it, the class is considered active.\n       *\n       * @param {Element} element\n       * @param {string} className\n       * @param {boolean} [defaultActivation=false]\n       * @returns {boolean}\n       */\n      isActive: function isActive(element, className, defaultActivation) {\n        var no = 'no-' + className;\n\n        while (element) {\n          var classList = element.classList;\n\n          if (classList.contains(className)) {\n            return true;\n          }\n\n          if (classList.contains(no)) {\n            return false;\n          }\n\n          element = element.parentElement;\n        }\n\n        return !!defaultActivation;\n      }\n    },\n\n    /**\n     * This namespace contains all currently loaded languages and the some helper functions to create and modify languages.\n     *\n     * @namespace\n     * @memberof Prism\n     * @public\n     */\n    languages: {\n      /**\n       * Creates a deep copy of the language with the given id and appends the given tokens.\n       *\n       * If a token in `redef` also appears in the copied language, then the existing token in the copied language\n       * will be overwritten at its original position.\n       *\n       * ## Best practices\n       *\n       * Since the position of overwriting tokens (token in `redef` that overwrite tokens in the copied language)\n       * doesn't matter, they can technically be in any order. However, this can be confusing to others that trying to\n       * understand the language definition because, normally, the order of tokens matters in Prism grammars.\n       *\n       * Therefore, it is encouraged to order overwriting tokens according to the positions of the overwritten tokens.\n       * Furthermore, all non-overwriting tokens should be placed after the overwriting ones.\n       *\n       * @param {string} id The id of the language to extend. This has to be a key in `Prism.languages`.\n       * @param {Grammar} redef The new tokens to append.\n       * @returns {Grammar} The new language created.\n       * @public\n       * @example\n       * Prism.languages['css-with-colors'] = Prism.languages.extend('css', {\n       *     // Prism.languages.css already has a 'comment' token, so this token will overwrite CSS' 'comment' token\n       *     // at its original position\n       *     'comment': { ... },\n       *     // CSS doesn't have a 'color' token, so this token will be appended\n       *     'color': /\\b(?:red|green|blue)\\b/\n       * });\n       */\n      extend: function extend(id, redef) {\n        var lang = _.util.clone(_.languages[id]);\n\n        for (var key in redef) {\n          lang[key] = redef[key];\n        }\n\n        return lang;\n      },\n\n      /**\n       * Inserts tokens _before_ another token in a language definition or any other grammar.\n       *\n       * ## Usage\n       *\n       * This helper method makes it easy to modify existing languages. For example, the CSS language definition\n       * not only defines CSS highlighting for CSS documents, but also needs to define highlighting for CSS embedded\n       * in HTML through `<style>` elements. To do this, it needs to modify `Prism.languages.markup` and add the\n       * appropriate tokens. However, `Prism.languages.markup` is a regular JavaScript object literal, so if you do\n       * this:\n       *\n       * ```js\n       * Prism.languages.markup.style = {\n       *     // token\n       * };\n       * ```\n       *\n       * then the `style` token will be added (and processed) at the end. `insertBefore` allows you to insert tokens\n       * before existing tokens. For the CSS example above, you would use it like this:\n       *\n       * ```js\n       * Prism.languages.insertBefore('markup', 'cdata', {\n       *     'style': {\n       *         // token\n       *     }\n       * });\n       * ```\n       *\n       * ## Special cases\n       *\n       * If the grammars of `inside` and `insert` have tokens with the same name, the tokens in `inside`'s grammar\n       * will be ignored.\n       *\n       * This behavior can be used to insert tokens after `before`:\n       *\n       * ```js\n       * Prism.languages.insertBefore('markup', 'comment', {\n       *     'comment': Prism.languages.markup.comment,\n       *     // tokens after 'comment'\n       * });\n       * ```\n       *\n       * ## Limitations\n       *\n       * The main problem `insertBefore` has to solve is iteration order. Since ES2015, the iteration order for object\n       * properties is guaranteed to be the insertion order (except for integer keys) but some browsers behave\n       * differently when keys are deleted and re-inserted. So `insertBefore` can't be implemented by temporarily\n       * deleting properties which is necessary to insert at arbitrary positions.\n       *\n       * To solve this problem, `insertBefore` doesn't actually insert the given tokens into the target object.\n       * Instead, it will create a new object and replace all references to the target object with the new one. This\n       * can be done without temporarily deleting properties, so the iteration order is well-defined.\n       *\n       * However, only references that can be reached from `Prism.languages` or `insert` will be replaced. I.e. if\n       * you hold the target object in a variable, then the value of the variable will not change.\n       *\n       * ```js\n       * var oldMarkup = Prism.languages.markup;\n       * var newMarkup = Prism.languages.insertBefore('markup', 'comment', { ... });\n       *\n       * assert(oldMarkup !== Prism.languages.markup);\n       * assert(newMarkup === Prism.languages.markup);\n       * ```\n       *\n       * @param {string} inside The property of `root` (e.g. a language id in `Prism.languages`) that contains the\n       * object to be modified.\n       * @param {string} before The key to insert before.\n       * @param {Grammar} insert An object containing the key-value pairs to be inserted.\n       * @param {Object<string, any>} [root] The object containing `inside`, i.e. the object that contains the\n       * object to be modified.\n       *\n       * Defaults to `Prism.languages`.\n       * @returns {Grammar} The new grammar object.\n       * @public\n       */\n      insertBefore: function insertBefore(inside, before, insert, root) {\n        root = root ||\n        /** @type {any} */\n        _.languages;\n        var grammar = root[inside];\n        /** @type {Grammar} */\n\n        var ret = {};\n\n        for (var token in grammar) {\n          if (grammar.hasOwnProperty(token)) {\n            if (token == before) {\n              for (var newToken in insert) {\n                if (insert.hasOwnProperty(newToken)) {\n                  ret[newToken] = insert[newToken];\n                }\n              }\n            } // Do not insert token which also occur in insert. See #1525\n\n\n            if (!insert.hasOwnProperty(token)) {\n              ret[token] = grammar[token];\n            }\n          }\n        }\n\n        var old = root[inside];\n        root[inside] = ret; // Update references in other language definitions\n\n        _.languages.DFS(_.languages, function (key, value) {\n          if (value === old && key != inside) {\n            this[key] = ret;\n          }\n        });\n\n        return ret;\n      },\n      // Traverse a language definition with Depth First Search\n      DFS: function DFS(o, callback, type, visited) {\n        visited = visited || {};\n        var objId = _.util.objId;\n\n        for (var i in o) {\n          if (o.hasOwnProperty(i)) {\n            callback.call(o, i, o[i], type || i);\n\n            var property = o[i],\n                propertyType = _.util.type(property);\n\n            if (propertyType === 'Object' && !visited[objId(property)]) {\n              visited[objId(property)] = true;\n              DFS(property, callback, null, visited);\n            } else if (propertyType === 'Array' && !visited[objId(property)]) {\n              visited[objId(property)] = true;\n              DFS(property, callback, i, visited);\n            }\n          }\n        }\n      }\n    },\n    plugins: {},\n\n    /**\n     * This is the most high-level function in Prisms API.\n     * It fetches all the elements that have a `.language-xxxx` class and then calls {@link Prism.highlightElement} on\n     * each one of them.\n     *\n     * This is equivalent to `Prism.highlightAllUnder(document, async, callback)`.\n     *\n     * @param {boolean} [async=false] Same as in {@link Prism.highlightAllUnder}.\n     * @param {HighlightCallback} [callback] Same as in {@link Prism.highlightAllUnder}.\n     * @memberof Prism\n     * @public\n     */\n    highlightAll: function highlightAll(async, callback) {\n      _.highlightAllUnder(document, async, callback);\n    },\n\n    /**\n     * Fetches all the descendants of `container` that have a `.language-xxxx` class and then calls\n     * {@link Prism.highlightElement} on each one of them.\n     *\n     * The following hooks will be run:\n     * 1. `before-highlightall`\n     * 2. All hooks of {@link Prism.highlightElement} for each element.\n     *\n     * @param {ParentNode} container The root element, whose descendants that have a `.language-xxxx` class will be highlighted.\n     * @param {boolean} [async=false] Whether each element is to be highlighted asynchronously using Web Workers.\n     * @param {HighlightCallback} [callback] An optional callback to be invoked on each element after its highlighting is done.\n     * @memberof Prism\n     * @public\n     */\n    highlightAllUnder: function highlightAllUnder(container, async, callback) {\n      var env = {\n        callback: callback,\n        container: container,\n        selector: 'code[class*=\"language-\"], [class*=\"language-\"] code, code[class*=\"lang-\"], [class*=\"lang-\"] code'\n      };\n\n      _.hooks.run('before-highlightall', env);\n\n      env.elements = Array.prototype.slice.apply(env.container.querySelectorAll(env.selector));\n\n      _.hooks.run('before-all-elements-highlight', env);\n\n      for (var i = 0, element; element = env.elements[i++];) {\n        _.highlightElement(element, async === true, env.callback);\n      }\n    },\n\n    /**\n     * Highlights the code inside a single element.\n     *\n     * The following hooks will be run:\n     * 1. `before-sanity-check`\n     * 2. `before-highlight`\n     * 3. All hooks of {@link Prism.highlight}. These hooks will only be run by the current worker if `async` is `true`.\n     * 4. `before-insert`\n     * 5. `after-highlight`\n     * 6. `complete`\n     *\n     * @param {Element} element The element containing the code.\n     * It must have a class of `language-xxxx` to be processed, where `xxxx` is a valid language identifier.\n     * @param {boolean} [async=false] Whether the element is to be highlighted asynchronously using Web Workers\n     * to improve performance and avoid blocking the UI when highlighting very large chunks of code. This option is\n     * [disabled by default](https://prismjs.com/faq.html#why-is-asynchronous-highlighting-disabled-by-default).\n     *\n     * Note: All language definitions required to highlight the code must be included in the main `prism.js` file for\n     * asynchronous highlighting to work. You can build your own bundle on the\n     * [Download page](https://prismjs.com/download.html).\n     * @param {HighlightCallback} [callback] An optional callback to be invoked after the highlighting is done.\n     * Mostly useful when `async` is `true`, since in that case, the highlighting is done asynchronously.\n     * @memberof Prism\n     * @public\n     */\n    highlightElement: function highlightElement(element, async, callback) {\n      // Find language\n      var language = _.util.getLanguage(element);\n\n      var grammar = _.languages[language]; // Set language on the element, if not present\n\n      element.className = element.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language; // Set language on the parent, for styling\n\n      var parent = element.parentElement;\n\n      if (parent && parent.nodeName.toLowerCase() === 'pre') {\n        parent.className = parent.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\n      }\n\n      var code = element.textContent;\n      var env = {\n        element: element,\n        language: language,\n        grammar: grammar,\n        code: code\n      };\n\n      function insertHighlightedCode(highlightedCode) {\n        env.highlightedCode = highlightedCode;\n\n        _.hooks.run('before-insert', env);\n\n        env.element.innerHTML = env.highlightedCode;\n\n        _.hooks.run('after-highlight', env);\n\n        _.hooks.run('complete', env);\n\n        callback && callback.call(env.element);\n      }\n\n      _.hooks.run('before-sanity-check', env);\n\n      if (!env.code) {\n        _.hooks.run('complete', env);\n\n        callback && callback.call(env.element);\n        return;\n      }\n\n      _.hooks.run('before-highlight', env);\n\n      if (!env.grammar) {\n        insertHighlightedCode(_.util.encode(env.code));\n        return;\n      }\n\n      if (async && _self.Worker) {\n        var worker = new Worker(_.filename);\n\n        worker.onmessage = function (evt) {\n          insertHighlightedCode(evt.data);\n        };\n\n        worker.postMessage(JSON.stringify({\n          language: env.language,\n          code: env.code,\n          immediateClose: true\n        }));\n      } else {\n        insertHighlightedCode(_.highlight(env.code, env.grammar, env.language));\n      }\n    },\n\n    /**\n     * Low-level function, only use if you know what youre doing. It accepts a string of text as input\n     * and the language definitions to use, and returns a string with the HTML produced.\n     *\n     * The following hooks will be run:\n     * 1. `before-tokenize`\n     * 2. `after-tokenize`\n     * 3. `wrap`: On each {@link Token}.\n     *\n     * @param {string} text A string with the code to be highlighted.\n     * @param {Grammar} grammar An object containing the tokens to use.\n     *\n     * Usually a language definition like `Prism.languages.markup`.\n     * @param {string} language The name of the language definition passed to `grammar`.\n     * @returns {string} The highlighted HTML.\n     * @memberof Prism\n     * @public\n     * @example\n     * Prism.highlight('var foo = true;', Prism.languages.javascript, 'javascript');\n     */\n    highlight: function highlight(text, grammar, language) {\n      var env = {\n        code: text,\n        grammar: grammar,\n        language: language\n      };\n\n      _.hooks.run('before-tokenize', env);\n\n      env.tokens = _.tokenize(env.code, env.grammar);\n\n      _.hooks.run('after-tokenize', env);\n\n      return Token.stringify(_.util.encode(env.tokens), env.language);\n    },\n\n    /**\n     * This is the heart of Prism, and the most low-level function you can use. It accepts a string of text as input\n     * and the language definitions to use, and returns an array with the tokenized code.\n     *\n     * When the language definition includes nested tokens, the function is called recursively on each of these tokens.\n     *\n     * This method could be useful in other contexts as well, as a very crude parser.\n     *\n     * @param {string} text A string with the code to be highlighted.\n     * @param {Grammar} grammar An object containing the tokens to use.\n     *\n     * Usually a language definition like `Prism.languages.markup`.\n     * @returns {TokenStream} An array of strings and tokens, a token stream.\n     * @memberof Prism\n     * @public\n     * @example\n     * let code = `var foo = 0;`;\n     * let tokens = Prism.tokenize(code, Prism.languages.javascript);\n     * tokens.forEach(token => {\n     *     if (token instanceof Prism.Token && token.type === 'number') {\n     *         console.log(`Found numeric literal: ${token.content}`);\n     *     }\n     * });\n     */\n    tokenize: function tokenize(text, grammar) {\n      var rest = grammar.rest;\n\n      if (rest) {\n        for (var token in rest) {\n          grammar[token] = rest[token];\n        }\n\n        delete grammar.rest;\n      }\n\n      var tokenList = new LinkedList();\n      addAfter(tokenList, tokenList.head, text);\n      matchGrammar(text, tokenList, grammar, tokenList.head, 0);\n      return toArray(tokenList);\n    },\n\n    /**\n     * @namespace\n     * @memberof Prism\n     * @public\n     */\n    hooks: {\n      all: {},\n\n      /**\n       * Adds the given callback to the list of callbacks for the given hook.\n       *\n       * The callback will be invoked when the hook it is registered for is run.\n       * Hooks are usually directly run by a highlight function but you can also run hooks yourself.\n       *\n       * One callback function can be registered to multiple hooks and the same hook multiple times.\n       *\n       * @param {string} name The name of the hook.\n       * @param {HookCallback} callback The callback function which is given environment variables.\n       * @public\n       */\n      add: function add(name, callback) {\n        var hooks = _.hooks.all;\n        hooks[name] = hooks[name] || [];\n        hooks[name].push(callback);\n      },\n\n      /**\n       * Runs a hook invoking all registered callbacks with the given environment variables.\n       *\n       * Callbacks will be invoked synchronously and in the order in which they were registered.\n       *\n       * @param {string} name The name of the hook.\n       * @param {Object<string, any>} env The environment variables of the hook passed to all callbacks registered.\n       * @public\n       */\n      run: function run(name, env) {\n        var callbacks = _.hooks.all[name];\n\n        if (!callbacks || !callbacks.length) {\n          return;\n        }\n\n        for (var i = 0, callback; callback = callbacks[i++];) {\n          callback(env);\n        }\n      }\n    },\n    Token: Token\n  };\n  _self.Prism = _; // Typescript note:\n  // The following can be used to import the Token type in JSDoc:\n  //\n  //   @typedef {InstanceType<import(\"./prism-core\")[\"Token\"]>} Token\n\n  /**\n   * Creates a new token.\n   *\n   * @param {string} type See {@link Token#type type}\n   * @param {string | TokenStream} content See {@link Token#content content}\n   * @param {string|string[]} [alias] The alias(es) of the token.\n   * @param {string} [matchedStr=\"\"] A copy of the full string this token was created from.\n   * @class\n   * @global\n   * @public\n   */\n\n  function Token(type, content, alias, matchedStr) {\n    /**\n     * The type of the token.\n     *\n     * This is usually the key of a pattern in a {@link Grammar}.\n     *\n     * @type {string}\n     * @see GrammarToken\n     * @public\n     */\n    this.type = type;\n    /**\n     * The strings or tokens contained by this token.\n     *\n     * This will be a token stream if the pattern matched also defined an `inside` grammar.\n     *\n     * @type {string | TokenStream}\n     * @public\n     */\n\n    this.content = content;\n    /**\n     * The alias(es) of the token.\n     *\n     * @type {string|string[]}\n     * @see GrammarToken\n     * @public\n     */\n\n    this.alias = alias; // Copy of the full string this token was created from\n\n    this.length = (matchedStr || '').length | 0;\n  }\n  /**\n   * A token stream is an array of strings and {@link Token Token} objects.\n   *\n   * Token streams have to fulfill a few properties that are assumed by most functions (mostly internal ones) that process\n   * them.\n   *\n   * 1. No adjacent strings.\n   * 2. No empty strings.\n   *\n   *    The only exception here is the token stream that only contains the empty string and nothing else.\n   *\n   * @typedef {Array<string | Token>} TokenStream\n   * @global\n   * @public\n   */\n\n  /**\n   * Converts the given token or token stream to an HTML representation.\n   *\n   * The following hooks will be run:\n   * 1. `wrap`: On each {@link Token}.\n   *\n   * @param {string | Token | TokenStream} o The token or token stream to be converted.\n   * @param {string} language The name of current language.\n   * @returns {string} The HTML representation of the token or token stream.\n   * @memberof Token\n   * @static\n   */\n\n\n  Token.stringify = function stringify(o, language) {\n    if (typeof o == 'string') {\n      return o;\n    }\n\n    if (Array.isArray(o)) {\n      var s = '';\n      o.forEach(function (e) {\n        s += stringify(e, language);\n      });\n      return s;\n    }\n\n    var env = {\n      type: o.type,\n      content: stringify(o.content, language),\n      tag: 'span',\n      classes: ['token', o.type],\n      attributes: {},\n      language: language\n    };\n    var aliases = o.alias;\n\n    if (aliases) {\n      if (Array.isArray(aliases)) {\n        Array.prototype.push.apply(env.classes, aliases);\n      } else {\n        env.classes.push(aliases);\n      }\n    }\n\n    _.hooks.run('wrap', env);\n\n    var attributes = '';\n\n    for (var name in env.attributes) {\n      attributes += ' ' + name + '=\"' + (env.attributes[name] || '').replace(/\"/g, '&quot;') + '\"';\n    }\n\n    return '<' + env.tag + ' class=\"' + env.classes.join(' ') + '\"' + attributes + '>' + env.content + '</' + env.tag + '>';\n  };\n  /**\n   * @param {string} text\n   * @param {LinkedList<string | Token>} tokenList\n   * @param {any} grammar\n   * @param {LinkedListNode<string | Token>} startNode\n   * @param {number} startPos\n   * @param {RematchOptions} [rematch]\n   * @returns {void}\n   * @private\n   *\n   * @typedef RematchOptions\n   * @property {string} cause\n   * @property {number} reach\n   */\n\n\n  function matchGrammar(text, tokenList, grammar, startNode, startPos, rematch) {\n    for (var token in grammar) {\n      if (!grammar.hasOwnProperty(token) || !grammar[token]) {\n        continue;\n      }\n\n      var patterns = grammar[token];\n      patterns = Array.isArray(patterns) ? patterns : [patterns];\n\n      for (var j = 0; j < patterns.length; ++j) {\n        if (rematch && rematch.cause == token + ',' + j) {\n          return;\n        }\n\n        var patternObj = patterns[j],\n            inside = patternObj.inside,\n            lookbehind = !!patternObj.lookbehind,\n            greedy = !!patternObj.greedy,\n            lookbehindLength = 0,\n            alias = patternObj.alias;\n\n        if (greedy && !patternObj.pattern.global) {\n          // Without the global flag, lastIndex won't work\n          var flags = patternObj.pattern.toString().match(/[imsuy]*$/)[0];\n          patternObj.pattern = RegExp(patternObj.pattern.source, flags + 'g');\n        }\n        /** @type {RegExp} */\n\n\n        var pattern = patternObj.pattern || patternObj;\n\n        for ( // iterate the token list and keep track of the current token/string position\n        var currentNode = startNode.next, pos = startPos; currentNode !== tokenList.tail; pos += currentNode.value.length, currentNode = currentNode.next) {\n          if (rematch && pos >= rematch.reach) {\n            break;\n          }\n\n          var str = currentNode.value;\n\n          if (tokenList.length > text.length) {\n            // Something went terribly wrong, ABORT, ABORT!\n            return;\n          }\n\n          if (str instanceof Token) {\n            continue;\n          }\n\n          var removeCount = 1; // this is the to parameter of removeBetween\n\n          if (greedy && currentNode != tokenList.tail.prev) {\n            pattern.lastIndex = pos;\n            var match = pattern.exec(text);\n\n            if (!match) {\n              break;\n            }\n\n            var from = match.index + (lookbehind && match[1] ? match[1].length : 0);\n            var to = match.index + match[0].length;\n            var p = pos; // find the node that contains the match\n\n            p += currentNode.value.length;\n\n            while (from >= p) {\n              currentNode = currentNode.next;\n              p += currentNode.value.length;\n            } // adjust pos (and p)\n\n\n            p -= currentNode.value.length;\n            pos = p; // the current node is a Token, then the match starts inside another Token, which is invalid\n\n            if (currentNode.value instanceof Token) {\n              continue;\n            } // find the last node which is affected by this match\n\n\n            for (var k = currentNode; k !== tokenList.tail && (p < to || typeof k.value === 'string'); k = k.next) {\n              removeCount++;\n              p += k.value.length;\n            }\n\n            removeCount--; // replace with the new match\n\n            str = text.slice(pos, p);\n            match.index -= pos;\n          } else {\n            pattern.lastIndex = 0;\n            var match = pattern.exec(str);\n          }\n\n          if (!match) {\n            continue;\n          }\n\n          if (lookbehind) {\n            lookbehindLength = match[1] ? match[1].length : 0;\n          }\n\n          var from = match.index + lookbehindLength,\n              matchStr = match[0].slice(lookbehindLength),\n              to = from + matchStr.length,\n              before = str.slice(0, from),\n              after = str.slice(to);\n          var reach = pos + str.length;\n\n          if (rematch && reach > rematch.reach) {\n            rematch.reach = reach;\n          }\n\n          var removeFrom = currentNode.prev;\n\n          if (before) {\n            removeFrom = addAfter(tokenList, removeFrom, before);\n            pos += before.length;\n          }\n\n          removeRange(tokenList, removeFrom, removeCount);\n          var wrapped = new Token(token, inside ? _.tokenize(matchStr, inside) : matchStr, alias, matchStr);\n          currentNode = addAfter(tokenList, removeFrom, wrapped);\n\n          if (after) {\n            addAfter(tokenList, currentNode, after);\n          }\n\n          if (removeCount > 1) {\n            // at least one Token object was removed, so we have to do some rematching\n            // this can only happen if the current pattern is greedy\n            matchGrammar(text, tokenList, grammar, currentNode.prev, pos, {\n              cause: token + ',' + j,\n              reach: reach\n            });\n          }\n        }\n      }\n    }\n  }\n  /**\n   * @typedef LinkedListNode\n   * @property {T} value\n   * @property {LinkedListNode<T> | null} prev The previous node.\n   * @property {LinkedListNode<T> | null} next The next node.\n   * @template T\n   * @private\n   */\n\n  /**\n   * @template T\n   * @private\n   */\n\n\n  function LinkedList() {\n    /** @type {LinkedListNode<T>} */\n    var head = {\n      value: null,\n      prev: null,\n      next: null\n    };\n    /** @type {LinkedListNode<T>} */\n\n    var tail = {\n      value: null,\n      prev: head,\n      next: null\n    };\n    head.next = tail;\n    /** @type {LinkedListNode<T>} */\n\n    this.head = head;\n    /** @type {LinkedListNode<T>} */\n\n    this.tail = tail;\n    this.length = 0;\n  }\n  /**\n   * Adds a new node with the given value to the list.\n   * @param {LinkedList<T>} list\n   * @param {LinkedListNode<T>} node\n   * @param {T} value\n   * @returns {LinkedListNode<T>} The added node.\n   * @template T\n   */\n\n\n  function addAfter(list, node, value) {\n    // assumes that node != list.tail && values.length >= 0\n    var next = node.next;\n    var newNode = {\n      value: value,\n      prev: node,\n      next: next\n    };\n    node.next = newNode;\n    next.prev = newNode;\n    list.length++;\n    return newNode;\n  }\n  /**\n   * Removes `count` nodes after the given node. The given node will not be removed.\n   * @param {LinkedList<T>} list\n   * @param {LinkedListNode<T>} node\n   * @param {number} count\n   * @template T\n   */\n\n\n  function removeRange(list, node, count) {\n    var next = node.next;\n\n    for (var i = 0; i < count && next !== list.tail; i++) {\n      next = next.next;\n    }\n\n    node.next = next;\n    next.prev = node;\n    list.length -= i;\n  }\n  /**\n   * @param {LinkedList<T>} list\n   * @returns {T[]}\n   * @template T\n   */\n\n\n  function toArray(list) {\n    var array = [];\n    var node = list.head.next;\n\n    while (node !== list.tail) {\n      array.push(node.value);\n      node = node.next;\n    }\n\n    return array;\n  }\n\n  if (!_self.document) {\n    if (!_self.addEventListener) {\n      // in Node.js\n      return _;\n    }\n\n    if (!_.disableWorkerMessageHandler) {\n      // In worker\n      _self.addEventListener('message', function (evt) {\n        var message = JSON.parse(evt.data),\n            lang = message.language,\n            code = message.code,\n            immediateClose = message.immediateClose;\n\n        _self.postMessage(_.highlight(code, _.languages[lang], lang));\n\n        if (immediateClose) {\n          _self.close();\n        }\n      }, false);\n    }\n\n    return _;\n  } // Get current script and highlight\n\n\n  var script = _.util.currentScript();\n\n  if (script) {\n    _.filename = script.src;\n\n    if (script.hasAttribute('data-manual')) {\n      _.manual = true;\n    }\n  }\n\n  function highlightAutomaticallyCallback() {\n    if (!_.manual) {\n      _.highlightAll();\n    }\n  }\n\n  if (!_.manual) {\n    // If the document state is \"loading\", then we'll use DOMContentLoaded.\n    // If the document state is \"interactive\" and the prism.js script is deferred, then we'll also use the\n    // DOMContentLoaded event because there might be some plugins or languages which have also been deferred and they\n    // might take longer one animation frame to execute which can create a race condition where only some plugins have\n    // been loaded when Prism.highlightAll() is executed, depending on how fast resources are loaded.\n    // See https://github.com/PrismJS/prism/issues/2102\n    var readyState = document.readyState;\n\n    if (readyState === 'loading' || readyState === 'interactive' && script && script.defer) {\n      document.addEventListener('DOMContentLoaded', highlightAutomaticallyCallback);\n    } else {\n      if (window.requestAnimationFrame) {\n        window.requestAnimationFrame(highlightAutomaticallyCallback);\n      } else {\n        window.setTimeout(highlightAutomaticallyCallback, 16);\n      }\n    }\n  }\n\n  return _;\n}(_self);\n\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = Prism;\n} // hack for components to work correctly in node.js\n\n\nif (typeof global !== 'undefined') {\n  global.Prism = Prism;\n} // some additional documentation/types\n\n/**\n * The expansion of a simple `RegExp` literal to support additional properties.\n *\n * @typedef GrammarToken\n * @property {RegExp} pattern The regular expression of the token.\n * @property {boolean} [lookbehind=false] If `true`, then the first capturing group of `pattern` will (effectively)\n * behave as a lookbehind group meaning that the captured text will not be part of the matched text of the new token.\n * @property {boolean} [greedy=false] Whether the token is greedy.\n * @property {string|string[]} [alias] An optional alias or list of aliases.\n * @property {Grammar} [inside] The nested grammar of this token.\n *\n * The `inside` grammar will be used to tokenize the text value of each token of this kind.\n *\n * This can be used to make nested and even recursive language definitions.\n *\n * Note: This can cause infinite recursion. Be careful when you embed different languages or even the same language into\n * each another.\n * @global\n * @public\n*/\n\n/**\n * @typedef Grammar\n * @type {Object<string, RegExp | GrammarToken | Array<RegExp | GrammarToken>>}\n * @property {Grammar} [rest] An optional grammar object that will be appended to this grammar.\n * @global\n * @public\n */\n\n/**\n * A function which will invoked after an element was successfully highlighted.\n *\n * @callback HighlightCallback\n * @param {Element} element The element successfully highlighted.\n * @returns {void}\n * @global\n * @public\n*/\n\n/**\n * @callback HookCallback\n * @param {Object<string, any>} env The environment variables of the hook.\n * @returns {void}\n * @global\n * @public\n */\n\n/* **********************************************\n     Begin prism-markup.js\n********************************************** */\n\n\nPrism.languages.markup = {\n  'comment': /<!--[\\s\\S]*?-->/,\n  'prolog': /<\\?[\\s\\S]+?\\?>/,\n  'doctype': {\n    // https://www.w3.org/TR/xml/#NT-doctypedecl\n    pattern: /<!DOCTYPE(?:[^>\"'[\\]]|\"[^\"]*\"|'[^']*')+(?:\\[(?:[^<\"'\\]]|\"[^\"]*\"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\\]\\s*)?>/i,\n    greedy: true,\n    inside: {\n      'internal-subset': {\n        pattern: /(\\[)[\\s\\S]+(?=\\]>$)/,\n        lookbehind: true,\n        greedy: true,\n        inside: null // see below\n\n      },\n      'string': {\n        pattern: /\"[^\"]*\"|'[^']*'/,\n        greedy: true\n      },\n      'punctuation': /^<!|>$|[[\\]]/,\n      'doctype-tag': /^DOCTYPE/,\n      'name': /[^\\s<>'\"]+/\n    }\n  },\n  'cdata': /<!\\[CDATA\\[[\\s\\S]*?]]>/i,\n  'tag': {\n    pattern: /<\\/?(?!\\d)[^\\s>\\/=$<%]+(?:\\s(?:\\s*[^\\s>\\/=]+(?:\\s*=\\s*(?:\"[^\"]*\"|'[^']*'|[^\\s'\">=]+(?=[\\s>]))|(?=[\\s/>])))+)?\\s*\\/?>/,\n    greedy: true,\n    inside: {\n      'tag': {\n        pattern: /^<\\/?[^\\s>\\/]+/,\n        inside: {\n          'punctuation': /^<\\/?/,\n          'namespace': /^[^\\s>\\/:]+:/\n        }\n      },\n      'attr-value': {\n        pattern: /=\\s*(?:\"[^\"]*\"|'[^']*'|[^\\s'\">=]+)/,\n        inside: {\n          'punctuation': [{\n            pattern: /^=/,\n            alias: 'attr-equals'\n          }, /\"|'/]\n        }\n      },\n      'punctuation': /\\/?>/,\n      'attr-name': {\n        pattern: /[^\\s>\\/]+/,\n        inside: {\n          'namespace': /^[^\\s>\\/:]+:/\n        }\n      }\n    }\n  },\n  'entity': [{\n    pattern: /&[\\da-z]{1,8};/i,\n    alias: 'named-entity'\n  }, /&#x?[\\da-f]{1,8};/i]\n};\nPrism.languages.markup['tag'].inside['attr-value'].inside['entity'] = Prism.languages.markup['entity'];\nPrism.languages.markup['doctype'].inside['internal-subset'].inside = Prism.languages.markup; // Plugin to make entity title show the real entity, idea by Roman Komarov\n\nPrism.hooks.add('wrap', function (env) {\n  if (env.type === 'entity') {\n    env.attributes['title'] = env.content.replace(/&amp;/, '&');\n  }\n});\nObject.defineProperty(Prism.languages.markup.tag, 'addInlined', {\n  /**\n   * Adds an inlined language to markup.\n   *\n   * An example of an inlined language is CSS with `<style>` tags.\n   *\n   * @param {string} tagName The name of the tag that contains the inlined language. This name will be treated as\n   * case insensitive.\n   * @param {string} lang The language key.\n   * @example\n   * addInlined('style', 'css');\n   */\n  value: function addInlined(tagName, lang) {\n    var includedCdataInside = {};\n    includedCdataInside['language-' + lang] = {\n      pattern: /(^<!\\[CDATA\\[)[\\s\\S]+?(?=\\]\\]>$)/i,\n      lookbehind: true,\n      inside: Prism.languages[lang]\n    };\n    includedCdataInside['cdata'] = /^<!\\[CDATA\\[|\\]\\]>$/i;\n    var inside = {\n      'included-cdata': {\n        pattern: /<!\\[CDATA\\[[\\s\\S]*?\\]\\]>/i,\n        inside: includedCdataInside\n      }\n    };\n    inside['language-' + lang] = {\n      pattern: /[\\s\\S]+/,\n      inside: Prism.languages[lang]\n    };\n    var def = {};\n    def[tagName] = {\n      pattern: RegExp(/(<__[\\s\\S]*?>)(?:<!\\[CDATA\\[(?:[^\\]]|\\](?!\\]>))*\\]\\]>|(?!<!\\[CDATA\\[)[\\s\\S])*?(?=<\\/__>)/.source.replace(/__/g, function () {\n        return tagName;\n      }), 'i'),\n      lookbehind: true,\n      greedy: true,\n      inside: inside\n    };\n    Prism.languages.insertBefore('markup', 'cdata', def);\n  }\n});\nPrism.languages.html = Prism.languages.markup;\nPrism.languages.mathml = Prism.languages.markup;\nPrism.languages.svg = Prism.languages.markup;\nPrism.languages.xml = Prism.languages.extend('markup', {});\nPrism.languages.ssml = Prism.languages.xml;\nPrism.languages.atom = Prism.languages.xml;\nPrism.languages.rss = Prism.languages.xml;\n/* **********************************************\n     Begin prism-css.js\n********************************************** */\n\n(function (Prism) {\n  var string = /(\"|')(?:\\\\(?:\\r\\n|[\\s\\S])|(?!\\1)[^\\\\\\r\\n])*\\1/;\n  Prism.languages.css = {\n    'comment': /\\/\\*[\\s\\S]*?\\*\\//,\n    'atrule': {\n      pattern: /@[\\w-]+[\\s\\S]*?(?:;|(?=\\s*\\{))/,\n      inside: {\n        'rule': /^@[\\w-]+/,\n        'selector-function-argument': {\n          pattern: /(\\bselector\\s*\\((?!\\s*\\))\\s*)(?:[^()]|\\((?:[^()]|\\([^()]*\\))*\\))+?(?=\\s*\\))/,\n          lookbehind: true,\n          alias: 'selector'\n        },\n        'keyword': {\n          pattern: /(^|[^\\w-])(?:and|not|only|or)(?![\\w-])/,\n          lookbehind: true\n        } // See rest below\n\n      }\n    },\n    'url': {\n      // https://drafts.csswg.org/css-values-3/#urls\n      pattern: RegExp('\\\\burl\\\\((?:' + string.source + '|' + /(?:[^\\\\\\r\\n()\"']|\\\\[\\s\\S])*/.source + ')\\\\)', 'i'),\n      greedy: true,\n      inside: {\n        'function': /^url/i,\n        'punctuation': /^\\(|\\)$/,\n        'string': {\n          pattern: RegExp('^' + string.source + '$'),\n          alias: 'url'\n        }\n      }\n    },\n    'selector': RegExp('[^{}\\\\s](?:[^{};\"\\']|' + string.source + ')*?(?=\\\\s*\\\\{)'),\n    'string': {\n      pattern: string,\n      greedy: true\n    },\n    'property': /[-_a-z\\xA0-\\uFFFF][-\\w\\xA0-\\uFFFF]*(?=\\s*:)/i,\n    'important': /!important\\b/i,\n    'function': /[-a-z0-9]+(?=\\()/i,\n    'punctuation': /[(){};:,]/\n  };\n  Prism.languages.css['atrule'].inside.rest = Prism.languages.css;\n  var markup = Prism.languages.markup;\n\n  if (markup) {\n    markup.tag.addInlined('style', 'css');\n    Prism.languages.insertBefore('inside', 'attr-value', {\n      'style-attr': {\n        pattern: /\\s*style=(\"|')(?:\\\\[\\s\\S]|(?!\\1)[^\\\\])*\\1/i,\n        inside: {\n          'attr-name': {\n            pattern: /^\\s*style/i,\n            inside: markup.tag.inside\n          },\n          'punctuation': /^\\s*=\\s*['\"]|['\"]\\s*$/,\n          'attr-value': {\n            pattern: /.+/i,\n            inside: Prism.languages.css\n          }\n        },\n        alias: 'language-css'\n      }\n    }, markup.tag);\n  }\n})(Prism);\n/* **********************************************\n     Begin prism-clike.js\n********************************************** */\n\n\nPrism.languages.clike = {\n  'comment': [{\n    pattern: /(^|[^\\\\])\\/\\*[\\s\\S]*?(?:\\*\\/|$)/,\n    lookbehind: true\n  }, {\n    pattern: /(^|[^\\\\:])\\/\\/.*/,\n    lookbehind: true,\n    greedy: true\n  }],\n  'string': {\n    pattern: /([\"'])(?:\\\\(?:\\r\\n|[\\s\\S])|(?!\\1)[^\\\\\\r\\n])*\\1/,\n    greedy: true\n  },\n  'class-name': {\n    pattern: /(\\b(?:class|interface|extends|implements|trait|instanceof|new)\\s+|\\bcatch\\s+\\()[\\w.\\\\]+/i,\n    lookbehind: true,\n    inside: {\n      'punctuation': /[.\\\\]/\n    }\n  },\n  'keyword': /\\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\\b/,\n  'boolean': /\\b(?:true|false)\\b/,\n  'function': /\\w+(?=\\()/,\n  'number': /\\b0x[\\da-f]+\\b|(?:\\b\\d+\\.?\\d*|\\B\\.\\d+)(?:e[+-]?\\d+)?/i,\n  'operator': /[<>]=?|[!=]=?=?|--?|\\+\\+?|&&?|\\|\\|?|[?*/~^%]/,\n  'punctuation': /[{}[\\];(),.:]/\n};\n/* **********************************************\n     Begin prism-javascript.js\n********************************************** */\n\nPrism.languages.javascript = Prism.languages.extend('clike', {\n  'class-name': [Prism.languages.clike['class-name'], {\n    pattern: /(^|[^$\\w\\xA0-\\uFFFF])[_$A-Z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*(?=\\.(?:prototype|constructor))/,\n    lookbehind: true\n  }],\n  'keyword': [{\n    pattern: /((?:^|})\\s*)(?:catch|finally)\\b/,\n    lookbehind: true\n  }, {\n    pattern: /(^|[^.]|\\.\\.\\.\\s*)\\b(?:as|async(?=\\s*(?:function\\b|\\(|[$\\w\\xA0-\\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|for|from|function|(?:get|set)(?=\\s*[\\[$\\w\\xA0-\\uFFFF])|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\\b/,\n    lookbehind: true\n  }],\n  'number': /\\b(?:(?:0[xX](?:[\\dA-Fa-f](?:_[\\dA-Fa-f])?)+|0[bB](?:[01](?:_[01])?)+|0[oO](?:[0-7](?:_[0-7])?)+)n?|(?:\\d(?:_\\d)?)+n|NaN|Infinity)\\b|(?:\\b(?:\\d(?:_\\d)?)+\\.?(?:\\d(?:_\\d)?)*|\\B\\.(?:\\d(?:_\\d)?)+)(?:[Ee][+-]?(?:\\d(?:_\\d)?)+)?/,\n  // Allow for all non-ASCII characters (See http://stackoverflow.com/a/2008444)\n  'function': /#?[_$a-zA-Z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*(?=\\s*(?:\\.\\s*(?:apply|bind|call)\\s*)?\\()/,\n  'operator': /--|\\+\\+|\\*\\*=?|=>|&&=?|\\|\\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\\.{3}|\\?\\?=?|\\?\\.?|[~:]/\n});\nPrism.languages.javascript['class-name'][0].pattern = /(\\b(?:class|interface|extends|implements|instanceof|new)\\s+)[\\w.\\\\]+/;\nPrism.languages.insertBefore('javascript', 'keyword', {\n  'regex': {\n    pattern: /((?:^|[^$\\w\\xA0-\\uFFFF.\"'\\])\\s]|\\b(?:return|yield))\\s*)\\/(?:\\[(?:[^\\]\\\\\\r\\n]|\\\\.)*]|\\\\.|[^/\\\\\\[\\r\\n])+\\/[gimyus]{0,6}(?=(?:\\s|\\/\\*(?:[^*]|\\*(?!\\/))*\\*\\/)*(?:$|[\\r\\n,.;:})\\]]|\\/\\/))/,\n    lookbehind: true,\n    greedy: true\n  },\n  // This must be declared before keyword because we use \"function\" inside the look-forward\n  'function-variable': {\n    pattern: /#?[_$a-zA-Z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*(?=\\s*[=:]\\s*(?:async\\s*)?(?:\\bfunction\\b|(?:\\((?:[^()]|\\([^()]*\\))*\\)|[_$a-zA-Z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*)\\s*=>))/,\n    alias: 'function'\n  },\n  'parameter': [{\n    pattern: /(function(?:\\s+[_$A-Za-z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*)?\\s*\\(\\s*)(?!\\s)(?:[^()]|\\([^()]*\\))+?(?=\\s*\\))/,\n    lookbehind: true,\n    inside: Prism.languages.javascript\n  }, {\n    pattern: /[_$a-z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*(?=\\s*=>)/i,\n    inside: Prism.languages.javascript\n  }, {\n    pattern: /(\\(\\s*)(?!\\s)(?:[^()]|\\([^()]*\\))+?(?=\\s*\\)\\s*=>)/,\n    lookbehind: true,\n    inside: Prism.languages.javascript\n  }, {\n    pattern: /((?:\\b|\\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\\w\\xA0-\\uFFFF]))(?:[_$A-Za-z\\xA0-\\uFFFF][$\\w\\xA0-\\uFFFF]*\\s*)\\(\\s*|\\]\\s*\\(\\s*)(?!\\s)(?:[^()]|\\([^()]*\\))+?(?=\\s*\\)\\s*\\{)/,\n    lookbehind: true,\n    inside: Prism.languages.javascript\n  }],\n  'constant': /\\b[A-Z](?:[A-Z_]|\\dx?)*\\b/\n});\nPrism.languages.insertBefore('javascript', 'string', {\n  'template-string': {\n    pattern: /`(?:\\\\[\\s\\S]|\\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})+}|(?!\\${)[^\\\\`])*`/,\n    greedy: true,\n    inside: {\n      'template-punctuation': {\n        pattern: /^`|`$/,\n        alias: 'string'\n      },\n      'interpolation': {\n        pattern: /((?:^|[^\\\\])(?:\\\\{2})*)\\${(?:[^{}]|{(?:[^{}]|{[^}]*})*})+}/,\n        lookbehind: true,\n        inside: {\n          'interpolation-punctuation': {\n            pattern: /^\\${|}$/,\n            alias: 'punctuation'\n          },\n          rest: Prism.languages.javascript\n        }\n      },\n      'string': /[\\s\\S]+/\n    }\n  }\n});\n\nif (Prism.languages.markup) {\n  Prism.languages.markup.tag.addInlined('script', 'javascript');\n}\n\nPrism.languages.js = Prism.languages.javascript;\n/* **********************************************\n     Begin prism-file-highlight.js\n********************************************** */\n\n(function () {\n  if (typeof self === 'undefined' || !self.Prism || !self.document) {\n    return;\n  }\n\n  var Prism = window.Prism;\n  var LOADING_MESSAGE = 'Loading';\n\n  var FAILURE_MESSAGE = function FAILURE_MESSAGE(status, message) {\n    return ' Error ' + status + ' while fetching file: ' + message;\n  };\n\n  var FAILURE_EMPTY_MESSAGE = ' Error: File does not exist or is empty';\n  var EXTENSIONS = {\n    'js': 'javascript',\n    'py': 'python',\n    'rb': 'ruby',\n    'ps1': 'powershell',\n    'psm1': 'powershell',\n    'sh': 'bash',\n    'bat': 'batch',\n    'h': 'c',\n    'tex': 'latex'\n  };\n  var STATUS_ATTR = 'data-src-status';\n  var STATUS_LOADING = 'loading';\n  var STATUS_LOADED = 'loaded';\n  var STATUS_FAILED = 'failed';\n  var SELECTOR = 'pre[data-src]:not([' + STATUS_ATTR + '=\"' + STATUS_LOADED + '\"])' + ':not([' + STATUS_ATTR + '=\"' + STATUS_LOADING + '\"])';\n  var lang = /\\blang(?:uage)?-([\\w-]+)\\b/i;\n  /**\n   * Sets the Prism `language-xxxx` or `lang-xxxx` class to the given language.\n   *\n   * @param {HTMLElement} element\n   * @param {string} language\n   * @returns {void}\n   */\n\n  function setLanguageClass(element, language) {\n    var className = element.className;\n    className = className.replace(lang, ' ') + ' language-' + language;\n    element.className = className.replace(/\\s+/g, ' ').trim();\n  }\n\n  Prism.hooks.add('before-highlightall', function (env) {\n    env.selector += ', ' + SELECTOR;\n  });\n  Prism.hooks.add('before-sanity-check', function (env) {\n    var pre =\n    /** @type {HTMLPreElement} */\n    env.element;\n\n    if (pre.matches(SELECTOR)) {\n      env.code = ''; // fast-path the whole thing and go to complete\n\n      pre.setAttribute(STATUS_ATTR, STATUS_LOADING); // mark as loading\n      // add code element with loading message\n\n      var code = pre.appendChild(document.createElement('CODE'));\n      code.textContent = LOADING_MESSAGE;\n      var src = pre.getAttribute('data-src');\n      var language = env.language;\n\n      if (language === 'none') {\n        // the language might be 'none' because there is no language set;\n        // in this case, we want to use the extension as the language\n        var extension = (/\\.(\\w+)$/.exec(src) || [, 'none'])[1];\n        language = EXTENSIONS[extension] || extension;\n      } // set language classes\n\n\n      setLanguageClass(code, language);\n      setLanguageClass(pre, language); // preload the language\n\n      var autoloader = Prism.plugins.autoloader;\n\n      if (autoloader) {\n        autoloader.loadLanguages(language);\n      } // load file\n\n\n      var xhr = new XMLHttpRequest();\n      xhr.open('GET', src, true);\n\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState == 4) {\n          if (xhr.status < 400 && xhr.responseText) {\n            // mark as loaded\n            pre.setAttribute(STATUS_ATTR, STATUS_LOADED); // highlight code\n\n            code.textContent = xhr.responseText;\n            Prism.highlightElement(code);\n          } else {\n            // mark as failed\n            pre.setAttribute(STATUS_ATTR, STATUS_FAILED);\n\n            if (xhr.status >= 400) {\n              code.textContent = FAILURE_MESSAGE(xhr.status, xhr.statusText);\n            } else {\n              code.textContent = FAILURE_EMPTY_MESSAGE;\n            }\n          }\n        }\n      };\n\n      xhr.send(null);\n    }\n  });\n  Prism.plugins.fileHighlight = {\n    /**\n     * Executes the File Highlight plugin for all matching `pre` elements under the given container.\n     *\n     * Note: Elements which are already loaded or currently loading will not be touched by this method.\n     *\n     * @param {ParentNode} [container=document]\n     */\n    highlight: function highlight(container) {\n      var elements = (container || document).querySelectorAll(SELECTOR);\n\n      for (var i = 0, element; element = elements[i++];) {\n        Prism.highlightElement(element);\n      }\n    }\n  };\n  var logged = false;\n  /** @deprecated Use `Prism.plugins.fileHighlight.highlight` instead. */\n\n  Prism.fileHighlight = function () {\n    if (!logged) {\n      console.warn('Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead.');\n      logged = true;\n    }\n\n    Prism.plugins.fileHighlight.highlight.apply(this, arguments);\n  };\n})();","import { useEffect, useState, useRef } from 'react';\r\nimport { sameArrayContents } from 'utils/arrays';\r\nimport { ErrorState } from 'utils/error';\r\n\r\ntype TDoWork = (\r\n    doWorkInner: (stopIfObsolete: (() => void)) => Promise<void>,\r\n    getContext?: () => unknown[]) => void;\r\n\r\n\r\nexport function useMounted() {\r\n    const mounted = useRef(true);\r\n    useEffect(() => {\r\n        // Unmount on unsub\r\n        return () => {\r\n            mounted.current = false;\r\n        };\r\n    }, [/* Init Only */]);\r\n    return { mounted };\r\n}\r\n\r\nexport function useDebounce(timeMs = 250) {\r\n    const { mounted } = useMounted();\r\n    const debouncer = useRef({\r\n        timeoutId: setTimeout(() => { }),\r\n        debounce: (action: () => void) => {\r\n            clearTimeout(debouncer.current.timeoutId);\r\n            debouncer.current.timeoutId = setTimeout(() => {\r\n                if (!mounted.current) { return; }\r\n                action();\r\n            }, timeMs);\r\n        },\r\n    });\r\n\r\n    return debouncer.current;\r\n}\r\n\r\n/** Automatically handle loading and error objects with asyncronous calls\r\n * @return The { loading, error, doWork } values\r\n * @example\r\n *\r\n *      const { loading, error, doWork } = ChatHooks.useAutoLoadingError();\r\n *      ...\r\n *          doWork(async (stopIfObsolete) => {\r\n *              ...\r\n *              const result = async DoAsyncWork());\r\n *              stopIfObsolete(); // Stop work if component has been unmounted, or if contextValues have changed since beginning of doWork\r\n *              ...\r\n *              setResult(result);\r\n *          }, () => [ contextValueA, contextValueB ]); // Optional context values to stop work if changed\r\n *    \r\n */\r\nexport function useAutoLoadingError() {\r\n    const { mounted } = useMounted();\r\n    const [loadingError, setLoadingError] = useState({ loading: false, error: null as null | ErrorState });\r\n\r\n    const UNMOUNTED = `unmounted`;\r\n    const CHANGED_CONTEXT = `changedContext`;\r\n\r\n    const doWork: TDoWork = (\r\n        doWorkInner: (stopIfObsolete: (() => void)) => Promise<void>,\r\n        getContext?: () => unknown[]) => {\r\n\r\n        let contextInit = undefined as undefined | unknown[];\r\n\r\n        const stopIfObsolete = () => {\r\n            if (!mounted.current) {\r\n                // eslint-disable-next-line @typescript-eslint/no-throw-literal\r\n                throw UNMOUNTED;\r\n            }\r\n            const c = getContext?.();\r\n\r\n            if (!sameArrayContents(contextInit, c)) {\r\n                // eslint-disable-next-line @typescript-eslint/no-throw-literal\r\n                throw CHANGED_CONTEXT;\r\n            }\r\n        };\r\n\r\n        const doCall = async () => {\r\n            contextInit = getContext?.();\r\n            setLoadingError({ loading: true, error: null });\r\n\r\n            // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n            let hadError = false;\r\n\r\n            try {\r\n                try {\r\n                    await doWorkInner(stopIfObsolete);\r\n                    stopIfObsolete();\r\n                    setLoadingError({ loading: false, error: null });\r\n                }\r\n                catch (error) {\r\n                    // Ignore unmounted or changed context\r\n                    if (error !== UNMOUNTED && error !== CHANGED_CONTEXT) {\r\n                        throw error;\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                // console.log(`doWork catch`, { err: error });\r\n                hadError = true;\r\n\r\n                if (!mounted.current) {\r\n                    // console.warn(`doWork Error when not Mounted`, { err: error });\r\n                    return;\r\n                }\r\n\r\n                setLoadingError({ loading: false, error: { message: error.message ?? `Unknown Error in doWork`, error, retryCallback: doCall } });\r\n            }\r\n        };\r\n\r\n        // Start Async\r\n        (async () => await doCall())();\r\n    };\r\n\r\n    return { loading: loadingError.loading, error: loadingError.error, doWork };\r\n}\r\n\r\nexport function useLoadData<T>(doWork: TDoWork, getData: () => Promise<T>, getDataDeps?: () => unknown[]) {\r\n    const [data, setData] = useState(null as null | T);\r\n    useEffect(() => {\r\n        // console.log(`useLoadData.useEffect`);\r\n        doWork(async (stopIfObsolete) => {\r\n            // console.log(`useLoadData.useEffect.doWork`);\r\n            const d = await getData();\r\n            stopIfObsolete();\r\n            setData(d);\r\n        }, getDataDeps);\r\n    }, getDataDeps?.() ?? []);\r\n    return { data };\r\n}\r\n","import React, { useState, useEffect } from 'react';\r\nimport { ActivityIndicator, View } from 'react-native-lite';\r\nimport { theme } from 'themes/theme';\r\n\r\nexport const Loading = ({ loading }: { loading?: boolean }) => {\r\n\r\n    const visible = loading;\r\n\r\n    // // Show loading for a min time\r\n    // const [visible, setVisible] = useState(loading);\r\n    // const MIN_TIME_MS = 500;\r\n    // useEffect(() => {\r\n    //     if (loading) { setVisible(true); return () => { }; }\r\n    //     const timeoutId = setTimeout(() => {\r\n    //         setVisible(false);\r\n    //     }, MIN_TIME_MS);\r\n    //     return () => {\r\n    //         clearTimeout(timeoutId);\r\n    //     };\r\n    // }, [loading]);\r\n\r\n    if (!visible) { return <></>; }\r\n\r\n    return (\r\n        <View>\r\n            <ActivityIndicator size='large' color={theme.colors.loader} />\r\n        </View>\r\n    );\r\n};\r\n\r\nexport const LoadingInline = ({ loading }: { loading?: boolean }) => {\r\n\r\n    const visible = loading;\r\n\r\n    // // Show loading for a min time\r\n    // const [visible, setVisible] = useState(loading);\r\n    // const MIN_TIME_MS = 500;\r\n    // useEffect(() => {\r\n    //     if (loading) { setVisible(true); return () => { }; }\r\n    //     const timeoutId = setTimeout(() => {\r\n    //         setVisible(false);\r\n    //     }, MIN_TIME_MS);\r\n    //     return () => {\r\n    //         clearTimeout(timeoutId);\r\n    //     };\r\n    // }, [loading]);\r\n\r\n    if (!visible) { return <></>; }\r\n\r\n    return (\r\n        <>\r\n            <ActivityIndicator size='small' color={theme.colors.loader} />\r\n        </>\r\n    );\r\n};\r\n","import { distinct, shuffle } from 'utils/arrays';\r\nimport { SpeechService } from '../../utils/speech';\r\nimport { ProblemService, ProblemAnswer } from '../problems-service';\r\nimport { getSpellingEntries } from './spelling-entries';\r\n\r\nexport const createSpellingProblemService = ({ speechService, maxAnswers = 4, sectionSize = 25 }: { speechService: SpeechService, maxAnswers?: number, sectionSize?: number }): ProblemService => {\r\n    const speech = speechService;\r\n    const spellingEntries = getSpellingEntries();\r\n    const sectionCount = Math.ceil(spellingEntries.length / sectionSize);\r\n\r\n    let state = {\r\n        nextIndex: 0,\r\n        completedSectionKeys: [] as string[],\r\n    };\r\n\r\n    const getSectionKey = (sectionIndex: number) => {\r\n        return `${sectionIndex}`;\r\n    };\r\n    const getSectionName = (sectionIndex: number) => {\r\n        return `Spelling ${sectionIndex + 1}`;\r\n    };\r\n\r\n    const service: ProblemService = {\r\n        load: async (storage) => {\r\n            const loaded = await storage.load<typeof state>();\r\n            if (loaded) {\r\n                state = loaded;\r\n            }\r\n        },\r\n        save: async (storage) => {\r\n            await storage.save(state);\r\n        },\r\n        getSections: () => [...new Array(sectionCount)].map((x, i) => ({\r\n            key: getSectionKey(i),\r\n            name: getSectionName(i),\r\n            isComplete: state.completedSectionKeys.includes(getSectionKey(i)),\r\n        })),\r\n        gotoSection: ({ key }) => {\r\n            const a = Number.parseInt(key, 10);\r\n            state.nextIndex = a * sectionSize;\r\n            console.log(`createSpellingProblemService gotoSection`, { key, a, state });\r\n        },\r\n        getNextProblem: () => {\r\n            if (state.nextIndex >= spellingEntries.length) {\r\n                state.nextIndex = 0;\r\n            }\r\n\r\n            const i = state.nextIndex;\r\n            state.nextIndex++;\r\n\r\n            const p = spellingEntries[i];\r\n            const correctValue = p.word;\r\n            const wrongAnswerCount = maxAnswers - 1;\r\n            const wrongValues =\r\n                shuffle(distinct(p.mispellings)).slice(0, wrongAnswerCount);\r\n\r\n            const answers: ProblemAnswer[] = shuffle([...wrongValues.map(x => ({ value: `${x}`, isCorrect: false })), { value: `${correctValue}`, isCorrect: true }]).map(x => ({ ...x, key: x.value }));\r\n\r\n            const isLastOfSection = (i + 1) % sectionSize === 0;\r\n            const isLastOfSubject = i === spellingEntries.length - 1;\r\n            return {\r\n                key: `${i + 1}`,\r\n                question: `Word ${i + 1}`,\r\n                onQuestion: () => { speech.speak(correctValue); },\r\n                answers,\r\n                sectionKey: getSectionKey(Math.floor(i / sectionSize)),\r\n                isLastOfSection,\r\n                isLastOfSubject,\r\n            };\r\n        },\r\n        recordAnswer: (problem, answer) => {\r\n            if (answer.isCorrect && problem.isLastOfSection) {\r\n                state.completedSectionKeys.push(problem.sectionKey);\r\n            }\r\n        },\r\n    };\r\n\r\n    return service;\r\n};\r\n","import { ifError } from 'assert';\r\nimport React, { useState } from 'react';\r\nimport { View, Text, TouchableOpacity } from 'react-native-lite';\r\n\r\nconst styles = {\r\n    mainView: {\r\n        flexDirection: `row`,\r\n        flexWrap: `wrap`,\r\n        alignItems: `center`,\r\n    },\r\n    mainView_column: {\r\n        flexDirection: `column`,\r\n    },\r\n    tabView: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n        background: `#1e1e1e`,\r\n        // alignSelf: `flex-start`,\r\n        padding: 4,\r\n        marginRight: 1,\r\n    },\r\n    tabView_selected: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n        background: `#292a2d`,\r\n        // alignSelf: `flex-start`,\r\n        padding: 4,\r\n        marginRight: 1,\r\n    },\r\n    tabText: {\r\n        fontSize: 14,\r\n    },\r\n    tabText_selected: {\r\n        fontSize: 14,\r\n        color: `#FFFF88`,\r\n    },\r\n    headerTabView: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n        // background: `#1e1e1e`,\r\n        // alignSelf: `flex-start`,\r\n        padding: 4,\r\n        marginRight: 1,\r\n    },\r\n    headerTabText: {\r\n        fontSize: 14,\r\n    },\r\n    moveButtonView: {\r\n        minWidth: 24,\r\n        justifyContents: `center`,\r\n        alignItems: `center`,\r\n    },\r\n} as const;\r\n\r\nexport const TabsListEditorComponent = <T extends {}>({\r\n    items,\r\n    onChange,\r\n    getLabel,\r\n    getKey,\r\n    selected,\r\n    onSelect,\r\n    onCreateNewItem,\r\n    header,\r\n    style,\r\n}: {\r\n    items: T[];\r\n    onChange?: (items: T[]) => void;\r\n    getLabel: (item: T) => string;\r\n    getKey: (item: T, index: number) => string;\r\n    selected?: T;\r\n    onSelect: (selected: T) => void;\r\n    onCreateNewItem: () => T;\r\n    header?: string;\r\n    style?: {\r\n        selectedTabText?: { color?: string };\r\n    };\r\n}) => {\r\n\r\n    if (!onChange) {\r\n        return (\r\n            <TabsComponent\r\n                items={items}\r\n                getLabel={getLabel}\r\n                getKey={getKey}\r\n                selected={selected}\r\n                onSelect={onSelect}\r\n                header={header}\r\n                style={style}\r\n            />\r\n        );\r\n    }\r\n\r\n    const onAdd = () => {\r\n        const newItem = onCreateNewItem();\r\n        onChange([...items, newItem]);\r\n        onSelect(newItem);\r\n    };\r\n    const onDelete = () => {\r\n        const newItems = [...items.filter(x => x !== selected)];\r\n        onChange(newItems);\r\n        if (newItems.length > 0) {\r\n            onSelect(newItems[0]);\r\n        }\r\n    };\r\n    const onMove = (item: T, oldIndex: number, newIndex: number) => {\r\n        if (newIndex < 0 || newIndex > items.length - 1) { return; }\r\n        const newItems = [...items];\r\n        newItems.splice(oldIndex, 1);\r\n        newItems.splice(newIndex, 0, item);\r\n\r\n        onChange(newItems);\r\n    };\r\n\r\n    return (\r\n        <TabsComponent\r\n            items={items}\r\n            getLabel={getLabel}\r\n            getKey={getKey}\r\n            selected={selected}\r\n            onSelect={onSelect}\r\n            onMove={onMove}\r\n            onAdd={onAdd}\r\n            onDelete={onDelete}\r\n            header={header}\r\n            style={style}\r\n        />\r\n    );\r\n};\r\n\r\nexport const TabsComponent = <T extends {}>({\r\n    items,\r\n    getLabel,\r\n    getKey,\r\n    selected,\r\n    onSelect,\r\n    onMove,\r\n    onAdd,\r\n    onDelete,\r\n    header,\r\n    style,\r\n}: {\r\n    items: T[];\r\n    getLabel: (item: T) => string;\r\n    getKey: (item: T, index: number) => string;\r\n    selected?: T;\r\n    onSelect: (selected: T) => void;\r\n    onMove?: (item: T, fromIndex: number, toIndex: number) => void;\r\n    onAdd?: () => void;\r\n    onDelete?: () => void;\r\n    header?: string;\r\n    style?: {\r\n        selectedTabText?: { color?: string };\r\n    };\r\n}) => {\r\n    const [mode, setMode] = useState(`row` as 'row' | 'column');\r\n\r\n    return (\r\n        <View style={mode === `row` ? styles.mainView : styles.mainView_column}>\r\n\r\n            {!!header && (\r\n                <TouchableOpacity onPress={() => setMode(s => s === `row` ? `column` : `row`)}>\r\n                    <View style={styles.headerTabView}>\r\n                        <Text style={styles.tabText}>{`${mode === `row` ? ` ` : ` `}`}</Text>\r\n                        <Text style={styles.headerTabText}>{`${header}`}</Text>\r\n                    </View>\r\n                </TouchableOpacity>\r\n            )}\r\n\r\n            {items.map((x, i) => (\r\n                <View key={getKey(x, i)} style={x === selected ? styles.tabView_selected : styles.tabView}>\r\n                    {mode === `column` && onMove && (\r\n                        <>\r\n                            <TouchableOpacity onPress={() => onMove(x, i, i - 1)}>\r\n                                <View style={styles.moveButtonView}>\r\n                                    <Text style={styles.tabText}>{`${i <= 0 ? ` ` : ``}`}</Text>\r\n                                </View>\r\n                            </TouchableOpacity>\r\n                            <TouchableOpacity onPress={() => onMove(x, i, i + 1)}>\r\n                                <View style={styles.moveButtonView}>\r\n                                    <Text style={styles.tabText}>{`${i >= items.length - 1 ? ` ` : ``}`}</Text>\r\n                                </View>\r\n                            </TouchableOpacity>\r\n                        </>\r\n                    )}\r\n                    <TouchableOpacity style={{ flex: 1 }} onPress={() => onSelect(x)}>\r\n                        <View>\r\n                            <Text style={x === selected ? { ...styles.tabText_selected, ...style?.selectedTabText } : { ...styles.tabText }}>{`${getLabel(x)}`}</Text>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                </View>\r\n            ))}\r\n            <View style={{ flex: 1, flexDirection: `row` }}>\r\n                {onAdd && (\r\n                    <>\r\n                        <TouchableOpacity onPress={() => onAdd()}>\r\n                            <View style={styles.tabView}>\r\n                                <Text style={styles.tabText}>{`${``} Add`}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    </>\r\n                )}\r\n                <View style={{ flex: 1 }} />\r\n                {onDelete && (\r\n                    <TouchableOpacity onPress={() => onDelete()}>\r\n                        <View style={styles.tabView}>\r\n                            <Text style={styles.tabText}>{`${``} Delete`}</Text>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                )}\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n","(function (Prism) {\n  var javascript = Prism.util.clone(Prism.languages.javascript);\n  Prism.languages.jsx = Prism.languages.extend('markup', javascript);\n  Prism.languages.jsx.tag.pattern = /<\\/?(?:[\\w.:-]+\\s*(?:\\s+(?:[\\w.:$-]+(?:=(?:(\"|')(?:\\\\[\\s\\S]|(?!\\1)[^\\\\])*\\1|[^\\s{'\">=]+|\\{(?:\\{(?:\\{[^{}]*\\}|[^{}])*\\}|[^{}])+\\}))?|\\{\\s*\\.{3}\\s*[a-z_$][\\w$]*(?:\\.[a-z_$][\\w$]*)*\\s*\\}))*\\s*\\/?)?>/i;\n  Prism.languages.jsx.tag.inside['tag'].pattern = /^<\\/?[^\\s>\\/]*/i;\n  Prism.languages.jsx.tag.inside['attr-value'].pattern = /=(?!\\{)(?:(\"|')(?:\\\\[\\s\\S]|(?!\\1)[^\\\\])*\\1|[^\\s'\">]+)/i;\n  Prism.languages.jsx.tag.inside['tag'].inside['class-name'] = /^[A-Z]\\w*(?:\\.[A-Z]\\w*)*$/;\n  Prism.languages.insertBefore('inside', 'attr-name', {\n    'spread': {\n      pattern: /\\{\\s*\\.{3}\\s*[a-z_$][\\w$]*(?:\\.[a-z_$][\\w$]*)*\\s*\\}/,\n      inside: {\n        'punctuation': /\\.{3}|[{}.]/,\n        'attr-value': /\\w+/\n      }\n    }\n  }, Prism.languages.jsx.tag);\n  Prism.languages.insertBefore('inside', 'attr-value', {\n    'script': {\n      // Allow for two levels of nesting\n      pattern: /=(?:\\{(?:\\{(?:\\{[^{}]*\\}|[^{}])*\\}|[^{}])+\\})/i,\n      inside: {\n        'script-punctuation': {\n          pattern: /^=(?={)/,\n          alias: 'punctuation'\n        },\n        rest: Prism.languages.jsx\n      },\n      'alias': 'language-javascript'\n    }\n  }, Prism.languages.jsx.tag); // The following will handle plain text inside tags\n\n  var stringifyToken = function stringifyToken(token) {\n    if (!token) {\n      return '';\n    }\n\n    if (typeof token === 'string') {\n      return token;\n    }\n\n    if (typeof token.content === 'string') {\n      return token.content;\n    }\n\n    return token.content.map(stringifyToken).join('');\n  };\n\n  var walkTokens = function walkTokens(tokens) {\n    var openedTags = [];\n\n    for (var i = 0; i < tokens.length; i++) {\n      var token = tokens[i];\n      var notTagNorBrace = false;\n\n      if (typeof token !== 'string') {\n        if (token.type === 'tag' && token.content[0] && token.content[0].type === 'tag') {\n          // We found a tag, now find its kind\n          if (token.content[0].content[0].content === '</') {\n            // Closing tag\n            if (openedTags.length > 0 && openedTags[openedTags.length - 1].tagName === stringifyToken(token.content[0].content[1])) {\n              // Pop matching opening tag\n              openedTags.pop();\n            }\n          } else {\n            if (token.content[token.content.length - 1].content === '/>') {// Autoclosed tag, ignore\n            } else {\n              // Opening tag\n              openedTags.push({\n                tagName: stringifyToken(token.content[0].content[1]),\n                openedBraces: 0\n              });\n            }\n          }\n        } else if (openedTags.length > 0 && token.type === 'punctuation' && token.content === '{') {\n          // Here we might have entered a JSX context inside a tag\n          openedTags[openedTags.length - 1].openedBraces++;\n        } else if (openedTags.length > 0 && openedTags[openedTags.length - 1].openedBraces > 0 && token.type === 'punctuation' && token.content === '}') {\n          // Here we might have left a JSX context inside a tag\n          openedTags[openedTags.length - 1].openedBraces--;\n        } else {\n          notTagNorBrace = true;\n        }\n      }\n\n      if (notTagNorBrace || typeof token === 'string') {\n        if (openedTags.length > 0 && openedTags[openedTags.length - 1].openedBraces === 0) {\n          // Here we are inside a tag, and not inside a JSX context.\n          // That's plain text: drop any tokens matched.\n          var plainText = stringifyToken(token); // And merge text with adjacent text\n\n          if (i < tokens.length - 1 && (typeof tokens[i + 1] === 'string' || tokens[i + 1].type === 'plain-text')) {\n            plainText += stringifyToken(tokens[i + 1]);\n            tokens.splice(i + 1, 1);\n          }\n\n          if (i > 0 && (typeof tokens[i - 1] === 'string' || tokens[i - 1].type === 'plain-text')) {\n            plainText = stringifyToken(tokens[i - 1]) + plainText;\n            tokens.splice(i - 1, 1);\n            i--;\n          }\n\n          tokens[i] = new Prism.Token('plain-text', plainText, null, plainText);\n        }\n      }\n\n      if (token.content && typeof token.content !== 'string') {\n        walkTokens(token.content);\n      }\n    }\n  };\n\n  Prism.hooks.add('after-tokenize', function (env) {\n    if (env.language !== 'jsx' && env.language !== 'tsx') {\n      return;\n    }\n\n    walkTokens(env.tokens);\n  });\n})(Prism);","import React, { useState, useRef, useEffect } from 'react';\r\nimport { View, Text, Pressable, Platform } from 'react-native-lite';\r\n\r\nexport type GamepadPressState = { moveDirection: { x: number, y: number }, buttons: { key: string, text: string, isDown: boolean }[] };\r\nexport const GamepadAnalogStateful = (props: {\r\n    style: { backgroundColor: string, borderColor: string };\r\n    onPressStateChange: (value: GamepadPressState) => void;\r\n    buttons: { text: string, key: string }[];\r\n}) => {\r\n\r\n    const state = useRef({\r\n        moveDirection: { x: 0, y: 0 },\r\n        buttons: props.buttons.map((x, i) => ({\r\n            isDown: false,\r\n            key: x.key,\r\n            text: x.text,\r\n            onPressIn: () => {\r\n                state.current.buttons[i].isDown = true;\r\n                props.onPressStateChange(state.current);\r\n            },\r\n            onPressOut: () => {\r\n                state.current.buttons[i].isDown = false;\r\n                props.onPressStateChange(state.current);\r\n            },\r\n        })),\r\n    });\r\n\r\n    const onMovePressIn = (dir: { x: number, y: number }) => {\r\n        const s = state.current;\r\n\r\n        state.current.moveDirection = {\r\n            x: dir.x ? dir.x : s.moveDirection.x,\r\n            y: dir.y ? dir.y : s.moveDirection.y,\r\n        };\r\n\r\n        console.log(`onMovePressIn`, { dir, s, moveDirection: state.current.moveDirection });\r\n\r\n        props.onPressStateChange(state.current);\r\n    };\r\n\r\n    const onMovePressOut = (dir: { x: number, y: number }) => {\r\n        const s = state.current;\r\n        state.current.moveDirection = {\r\n            x: dir.x ? 0 : s.moveDirection.x,\r\n            y: dir.y ? 0 : s.moveDirection.y,\r\n        };\r\n        props.onPressStateChange(state.current);\r\n    };\r\n\r\n    return (\r\n        <GamepadAnalog {...props} onMovePressIn={onMovePressIn} onMovePressOut={onMovePressOut} buttons={state.current.buttons} />\r\n    );\r\n};\r\n\r\nconst inputStyles = {\r\n    container: { flex: 1, alignSelf: `stretch`, flexDirection: `row`, justifyContent: `space-between`, alignItems: `center`, padding: 4 },\r\n    section: { justifyContent: `center`, alignItems: `center`, padding: 4 },\r\n    moveSectionWrapper: { overflow: `hidden` },\r\n    moveSectionRotation: { transform: `rotate(0.125turn)`, margin: 0 },\r\n    row: { flexDirection: `row` },\r\n    cellTouch: { outline: `none` },\r\n    cellView: { pointerEvents: `none`, position: `relative`, margin: 4, width: 56, height: 56, justifyContent: `center`, alignItems: `center`, borderWidth: 0, borderStyle: `solid`, outline: `none` },\r\n    cellText: { userSelect: `none`, pointerEvents: `none` },\r\n    moveCellText: { userSelect: `none`, pointerEvents: `none`, transform: `rotate(-0.125turn)` },\r\n    cellEmptyView: { margin: 2, width: 56, height: 56 },\r\n    cellTextOcclusionView: { position: `absolute`, top: 0, bottom: 0, left: 0, right: 0, backgroundColor: `red`, opacity: 0 },\r\n} as const;\r\n\r\nexport const GamepadAnalog = (props: {\r\n    style: { backgroundColor: string, borderColor: string };\r\n    onMovePressIn: (direction: { x: number, y: number }) => void;\r\n    onMovePressOut: (direction: { x: number, y: number }) => void;\r\n    buttons: { text: string, onPressIn: () => void, onPressOut: () => void }[];\r\n}) => {\r\n    const { onMovePressIn, onMovePressOut } = props;\r\n\r\n    const cellViewStyle = { ...inputStyles.cellView, ...props.style };\r\n\r\n    // Keyboard\r\n    useEffect(() => {\r\n        const onIgnore = (e: KeyboardEvent) => {\r\n            e.preventDefault();\r\n            e.stopPropagation?.();\r\n            return false;\r\n        };\r\n        if (Platform.OS === `web`) {\r\n            const onKeyDown = (e: KeyboardEvent) => {\r\n                if (e.key === `ArrowUp`) { onMovePressIn({ x: 0, y: +1 }); return onIgnore(e); }\r\n                if (e.key === `ArrowDown`) { onMovePressIn({ x: 0, y: -1 }); return onIgnore(e); }\r\n                if (e.key === `ArrowLeft`) { onMovePressIn({ x: -1, y: 0 }); return onIgnore(e); }\r\n                if (e.key === `ArrowRight`) { onMovePressIn({ x: +1, y: 0 }); return onIgnore(e); }\r\n                if (e.key === ` `) { props.buttons[0]?.onPressIn(); return onIgnore(e); }\r\n                // console.log(`onKeyDown`, { key: e.key });\r\n                return true;\r\n            };\r\n            const onKeyUp = (e: KeyboardEvent) => {\r\n                if (e.key === `ArrowUp`) { onMovePressOut({ x: 0, y: +1 }); return onIgnore(e); }\r\n                if (e.key === `ArrowDown`) { onMovePressOut({ x: 0, y: -1 }); return onIgnore(e); }\r\n                if (e.key === `ArrowLeft`) { onMovePressOut({ x: -1, y: 0 }); return onIgnore(e); }\r\n                if (e.key === `ArrowRight`) { onMovePressOut({ x: +1, y: 0 }); return onIgnore(e); }\r\n                if (e.key === ` `) { props.buttons[0]?.onPressOut(); return onIgnore(e); }\r\n                return true;\r\n            };\r\n            window.addEventListener(`keydown`, onKeyDown);\r\n            window.addEventListener(`keyup`, onKeyUp);\r\n            return () => {\r\n                window.removeEventListener(`keydown`, onKeyDown);\r\n                window.removeEventListener(`keyup`, onKeyUp);\r\n            };\r\n        }\r\n\r\n        return () => { };\r\n    });\r\n\r\n    const DirectionButton = ({ text, direction }: { text: string, direction: { x: number, y: number } }) => {\r\n        return (\r\n            <Pressable style={inputStyles.cellTouch} onPressIn={() => onMovePressIn(direction)} onPressOut={() => onMovePressOut(direction)}>\r\n                <View style={cellViewStyle}>\r\n                    <Text style={inputStyles.moveCellText}>{text}</Text>\r\n                    <View style={inputStyles.cellTextOcclusionView} />\r\n                </View>\r\n            </Pressable>\r\n        );\r\n    };\r\n\r\n    const ActionButton = ({ text, onPressIn, onPressOut }: { text: string, onPressIn: () => void, onPressOut: () => void }) => {\r\n        return (\r\n            <Pressable style={inputStyles.cellTouch} onPressIn={onPressIn} onPressOut={onPressOut}>\r\n                <View style={cellViewStyle}>\r\n                    <Text style={inputStyles.cellText}>{text}</Text>\r\n                    <View style={inputStyles.cellTextOcclusionView} />\r\n                </View>\r\n            </Pressable>\r\n        );\r\n    };\r\n\r\n    return (\r\n        <View style={inputStyles.container}>\r\n            <View style={inputStyles.moveSectionWrapper}>\r\n                <View style={inputStyles.moveSectionRotation}>\r\n                    <View style={inputStyles.section}>\r\n                        <View style={inputStyles.row} >\r\n                            <DirectionButton direction={{ x: 0, y: +1 }} text='' />\r\n                            <DirectionButton direction={{ x: +1, y: 0 }} text='' />\r\n                        </View>\r\n                        <View style={inputStyles.row} >\r\n                            <DirectionButton direction={{ x: -1, y: 0 }} text='' />\r\n                            <DirectionButton direction={{ x: 0, y: -1 }} text='' />\r\n                        </View>\r\n                    </View>\r\n                </View>\r\n            </View>\r\n            <View style={inputStyles.section} >\r\n                <View style={inputStyles.row} >\r\n                    {props.buttons.map(x => (\r\n                        <React.Fragment key={`${x.text}`}>\r\n                            <View style={inputStyles.cellEmptyView} />\r\n                            <ActionButton {...x} />\r\n                        </React.Fragment>\r\n                    ))}\r\n                </View>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n","export type Vector2 = { x: number, y: number };\r\nexport const getDistanceSq = (a: Vector2, b: Vector2) => {\r\n    const x = a.x - b.x;\r\n    const y = a.y - b.y;\r\n    return x * x + y * y;\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\n/* eslint-disable jsx-a11y/accessible-emoji */\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { View, Text, Pressable, TouchableOpacity, Platform } from 'react-native-lite';\r\nimport { createMultiplesProblemService } from './problems/multiples';\r\nimport { ProblemService, Problem } from './problems/problems-service';\r\nimport { GamepadAnalogStateful, GamepadPressState } from './components/game-pad-analog';\r\nimport { getDistanceSq, Vector2 } from './utils/vectors';\r\nimport { createReviewProblemService } from './problems/problems-reviewer';\r\nimport { createProgressGameProblemService } from './progress-games/progress-game';\r\nimport { createAutoSavedProblemService } from './problems/problem-state-storage';\r\nimport { SubjectNavigator } from './utils/subject-navigator';\r\n\r\nexport const EducationalGame_StarBlastSideways_Multiples = (props: {}) => {\r\n    return <EducationalGame_StarBlastSideways problemService={createAutoSavedProblemService(createReviewProblemService(createMultiplesProblemService({ min: 1, max: 12 }), {}), `ProblemsMultiples`)} />;\r\n};\r\n\r\nexport const EducationalGame_StarBlastSideways = (props: { problemService: ProblemService }) => {\r\n    // Add Pet Feeder\r\n    return <EducationalGame_StarBlastSideways_Inner problemService={createProgressGameProblemService(props.problemService)} />;\r\n};\r\n\r\nconst EducationalGame_StarBlastSideways_Inner = (props: { problemService: ProblemService }) => {\r\n    const [pauseState, setPauseState] = useState({ paused: false } as { paused: boolean });\r\n    const [pressState, setPressState] = useState({ moveDirection: { x: 0, y: 0 }, buttons: [] } as GamepadPressState);\r\n    const onPressStateChange = (value: GamepadPressState) => {\r\n        // console.log(`onPressStateChange`, { ...x, dir: { ...x.moveDirection }, buttons: x.buttons.map(b => ({ ...b })) });\r\n        setPressState(value);\r\n    };\r\n\r\n    const [problemSourceKey, setProblemSourceKey] = useState(0);\r\n\r\n    return (\r\n        <>\r\n            <View>\r\n                <View style={{ alignItems: `center`, alignSelf: `stretch` }} >\r\n                    <View style={{ overflow: `hidden`, padding: 10, paddingTop: 4, paddingBottom: 64 }}>\r\n                        <View style={{ position: `relative` }}>\r\n                            <GameView pressState={pressState} pauseState={pauseState} problemService={props.problemService} problemSourceKey={`${problemSourceKey}`} />\r\n                            {/* <Pressable style={{ position: `absolute`, top: 0, bottom: 0, left: 0, right: 0, opacity: 0 }} onPressIn={() => { }} onPressOut={() => { }} /> */}\r\n                            <View style={{ zIndex: 10, flex: 1, alignSelf: `stretch` }}>\r\n                                <GamepadAnalogStateful style={colors.gamepad} onPressStateChange={onPressStateChange} buttons={[{ key: `A`, text: `` }]} />\r\n                            </View>\r\n                        </View>\r\n                    </View>\r\n                </View>\r\n                <SubjectNavigator problemService={props.problemService}\r\n                    onOpen={() => setPauseState({ paused: true })}\r\n                    onClose={() => setPauseState({ paused: false })}\r\n                    onSubjectNavigation={() => { setPauseState({ paused: false }); setProblemSourceKey(s => s + 1); }}\r\n                />\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n\r\n\r\nconst colors = {\r\n    gamepad: {\r\n        backgroundColor: `#333333`,\r\n        borderColor: `#000033`,\r\n    },\r\n    viewscreen: {\r\n        borderColor: `#000033`,\r\n        backgroundColor: `#000000`,\r\n    },\r\n};\r\n\r\nconst gameStyles = {\r\n    directAnswerButtonContainer: { alignSelf: `flex-end`, justifyContent: `space-around`, height: 250, padding: 4 },\r\n    directAnswerButton: { width: 40, height: 40, backgroundColor: `#FFFFFF`, opacity: 0.1 },\r\n    directAnswerButton_hidden: { width: 40, height: 40 },\r\n    viewscreenView: {\r\n        height: 300,\r\n        width: 300,\r\n        backgroundColor: colors.viewscreen.backgroundColor,\r\n        borderColor: colors.viewscreen.borderColor,\r\n        borderWidth: 1,\r\n        borderStyle: `solid`,\r\n    },\r\n    sprite: {\r\n        viewSize: { width: 32, height: 32 },\r\n        text: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 32,\r\n            textAlign: `center`,\r\n        },\r\n    },\r\n    answer: {\r\n        text: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 24,\r\n            fontSize_small: 14,\r\n            textAlign: `center`,\r\n            whiteSpace: `pre-wrap`,\r\n        },\r\n    },\r\n    question: {\r\n        view: { flex: 1, justifyContent: `center`, padding: 4 },\r\n        text: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 24,\r\n            fontSize_small: 14,\r\n            whiteSpace: `pre-wrap`,\r\n        },\r\n    },\r\n    gameOver: {\r\n        view: { flex: 1, justifyContent: `center`, padding: 4 },\r\n        text: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 24,\r\n            textAlign: `center`,\r\n        },\r\n    },\r\n} as const;\r\n\r\ntype GamePosition = {\r\n    x: number;\r\n    y: number;\r\n    rotation: number;\r\n};\r\n\r\ntype GameState = {\r\n    lastActualTimeMs: number;\r\n    lastGameTime: number;\r\n    gameSpeed: number;\r\n\r\n    lives: number;\r\n    deadTime?: number;\r\n    gameOverTime?: number;\r\n    score: number;\r\n\r\n    weaponsLock?: {\r\n        lockedAtPlayerPosition: GamePosition;\r\n        lockedEnemy: { pos: GamePosition };\r\n    };\r\n    playerTargetPosition?: { x: number, y: number };\r\n};\r\n\r\n\r\ntype AnswerState = { key: string, value: string, isCorrect: boolean, isAnsweredWrong: boolean };\r\nconst GameView = (props: { pressState: GamepadPressState, pauseState: { paused: boolean }, problemService: ProblemService, problemSourceKey: string }) => {\r\n\r\n    const pressState = useRef(props.pressState);\r\n    pressState.current = props.pressState;\r\n\r\n    const pauseState = useRef(props.pauseState);\r\n    pauseState.current = props.pauseState;\r\n\r\n    const gameAcceleration = 0.1;\r\n    const gameDeceleration = 0.2;\r\n    const maxGameSpeed = 5;\r\n    const minGameSpeed = 0.5;\r\n\r\n    const getDefaultGameState = (): GameState => ({\r\n        lastActualTimeMs: Date.now(),\r\n        lastGameTime: 0,\r\n        gameSpeed: 1,\r\n        lives: 3,\r\n        score: 0,\r\n    });\r\n    const gameState = useRef(getDefaultGameState());\r\n    const getGameTime = () => {\r\n        const now = Date.now();\r\n        let actualTimePassed = (now - gameState.current.lastActualTimeMs) / 1000;\r\n        gameState.current.lastActualTimeMs = now;\r\n\r\n        if (actualTimePassed === 0) {\r\n            return { gameTime: gameState.current.lastGameTime };\r\n        }\r\n\r\n        // Left App, frozen, etc?\r\n        if (actualTimePassed > 0.1) {\r\n            actualTimePassed = 0.1;\r\n        }\r\n\r\n        const gameTimePassed = actualTimePassed * gameState.current.gameSpeed;\r\n        const gameTime = gameState.current.lastGameTime + gameTimePassed;\r\n        gameState.current.lastGameTime = gameTime;\r\n\r\n        return {\r\n            gameTime,\r\n        };\r\n    };\r\n\r\n    const playerPositionState = useRef({\r\n        y: gameStyles.viewscreenView.height * 0.5, x: gameStyles.viewscreenView.width * 0.15, rotation: 0,\r\n    } as GamePosition);\r\n    const projectilesState = useRef({ lastShotActualTime: 0, shots: [], debris: [] } as ProjectilesState);\r\n    const enemiesState = useRef({ enemies: [] } as EnemiesState);\r\n\r\n    const problemsState = useRef(null as null | { problemTime: number, question: string, answers: (Problem['answers'][0] & { key: string, pos: GamePosition, isAnsweredWrong: boolean })[] });\r\n    const [renderId, setRenderId] = useState(0);\r\n\r\n    const restartGame = () => {\r\n        // Move enemies back\r\n        enemiesState.current.enemies.forEach(e2 => { e2.pos.x += gameStyles.viewscreenView.width * 0.5; });\r\n\r\n        // Reset Player\r\n        playerPositionState.current.y = gameStyles.viewscreenView.height * 0.5;\r\n        playerPositionState.current.x = gameStyles.viewscreenView.width * 0.15;\r\n\r\n        gameState.current = { ...getDefaultGameState(), lastGameTime: gameState.current.lastGameTime };\r\n    };\r\n\r\n    const gameOver = () => {\r\n        gameState.current = {\r\n            ...gameState.current,\r\n            lives: 0,\r\n            gameOverTime: getGameTime().gameTime,\r\n        };\r\n    };\r\n\r\n    const gotoNextProblem = () => {\r\n        const p = props.problemService.getNextProblem();\r\n\r\n        console.log(`gotoNextProblem`, { p });\r\n\r\n        if (!p.question) {\r\n            // Game over - problems done\r\n            return;\r\n        }\r\n\r\n        const pSize = gameStyles.viewscreenView.width / (p.answers.length + 1);\r\n        const newProblemState = {\r\n            problemTime: getGameTime().gameTime,\r\n            question: p.question,\r\n            answers: p.answers.map((x, i) => ({ ...x, key: `${p.question} ${x.value}`, pos: { y: pSize * (0.5 + i), x: gameStyles.viewscreenView.width - gameStyles.sprite.viewSize.width * 0.5, rotation: 0 }, isAnsweredWrong: false })),\r\n        };\r\n        const newEnemyState = {\r\n            enemies: newProblemState.answers.map((ans, i) => {\r\n                const enemy = {\r\n                    key: `${p.question} ${ans.value}`,\r\n                    answer: ans,\r\n                    pos: { y: pSize * (0.5 + i), x: gameStyles.viewscreenView.width - gameStyles.sprite.viewSize.width * 1.5, rotation: 0 },\r\n                    vel: { x: -5, y: 0 },\r\n                    onHit: () => {\r\n                        setTimeout(() => {\r\n                            console.log(`onHit`, { ans });\r\n                            props.problemService.recordAnswer(p, ans);\r\n                            if (ans.isCorrect) {\r\n                                // TODO: Update score, etc.\r\n                                // Let bullets clear\r\n                                projectilesState.current.shots.forEach(x => { x.ignore = true; });\r\n                                gotoNextProblem();\r\n\r\n                                gameState.current = {\r\n                                    ...gameState.current,\r\n                                    score: gameState.current.score += Math.floor(enemy.pos.x) * 1000,\r\n                                    gameSpeed: Math.min(maxGameSpeed, gameState.current.gameSpeed * 1 + gameAcceleration),\r\n                                };\r\n                            } else {\r\n                                ans.isAnsweredWrong = true;\r\n\r\n                                gameState.current = {\r\n                                    ...gameState.current,\r\n                                    score: gameState.current.score -= Math.floor(enemy.pos.x) * 1500,\r\n                                    gameSpeed: Math.max(minGameSpeed, gameState.current.gameSpeed * 1 - gameDeceleration),\r\n                                };\r\n                            }\r\n                        });\r\n                    },\r\n                    destroyed: false,\r\n                };\r\n\r\n                return enemy;\r\n            }),\r\n        };\r\n\r\n        problemsState.current = newProblemState;\r\n        enemiesState.current = newEnemyState;\r\n        setRenderId(s => s + 1);\r\n\r\n        setTimeout(() => {\r\n            p.onQuestion?.();\r\n        }, 250);\r\n    };\r\n\r\n    useEffect(() => {\r\n        gotoNextProblem();\r\n    }, [props.problemSourceKey]);\r\n\r\n    useEffect(() => {\r\n        // Game Loop\r\n        let gameLastTime = getGameTime().gameTime;\r\n        const gameLoop = () => {\r\n            const { gameTime } = getGameTime();\r\n            const gameDeltaTime = gameTime - gameLastTime;\r\n            gameLastTime = gameTime;\r\n\r\n            if (pauseState.current.paused || gameDeltaTime <= 0) {\r\n                requestAnimationFrame(gameLoop);\r\n                return;\r\n            }\r\n\r\n            // if (!pressState.current.moveDirection.x\r\n            //     && !pressState.current.moveDirection.y) {\r\n            //     // No change\r\n            //     requestAnimationFrame(gameLoop);\r\n            //     return;\r\n            // }\r\n\r\n            // console.log(`gameLoop Update`);\r\n\r\n            // Update\r\n\r\n            const getCommonState = (): CommonGameState => {\r\n                return {\r\n                    gameTime,\r\n                    gameDeltaTime,\r\n                    gameState: gameState.current,\r\n                    pressState: pressState.current,\r\n                    playerPosition: playerPositionState.current,\r\n                    projectilesState: projectilesState.current,\r\n                    enemiesState: enemiesState.current,\r\n                    onLoseLife: () => {\r\n                        if (gameState.current.deadTime || gameState.current.gameOverTime) { return; }\r\n\r\n                        projectilesState.current.debris.push({ key: `player${gameTime}`, kind: `player-character`, pos: { ...playerPositionState.current }, vel: { x: 0, y: 0 } });\r\n\r\n\r\n                        if (gameState.current.lives <= 1) {\r\n                            // Game over\r\n                            gameOver();\r\n                            return;\r\n                        }\r\n\r\n                        // Move enemies back\r\n                        // enemiesState.current.enemies.forEach(e2 => { e2.pos.x += gameStyles.viewscreenView.width * 0.5; });\r\n\r\n                        gameState.current = {\r\n                            ...gameState.current,\r\n                            lives: gameState.current.lives - 1,\r\n                            deadTime: gameTime,\r\n                        };\r\n                    },\r\n                };\r\n            };\r\n\r\n\r\n            // Game\r\n            const gameResult = updateGame(getCommonState());\r\n            gameState.current = gameResult;\r\n\r\n            if (!gameState.current.gameOverTime) {\r\n                // Player\r\n                const playerResult = updatePlayer(getCommonState());\r\n                playerPositionState.current = playerResult.playerPosition;\r\n            } else if (getGameTime().gameTime > 1 + gameState.current.gameOverTime\r\n                && pressState.current.buttons[0]?.isDown) {\r\n                setTimeout(() => {\r\n                    restartGame();\r\n                }, 250);\r\n            }\r\n\r\n            // Projectiles\r\n            const projectilesResult = updateProjectiles(getCommonState());\r\n            projectilesState.current = projectilesResult;\r\n\r\n            // Enemies\r\n            const enemiesResult = updateEnemies(getCommonState());\r\n            enemiesState.current = enemiesResult;\r\n\r\n\r\n            // Game Loop\r\n            requestAnimationFrame(gameLoop);\r\n            setRenderId(s => s + 1);\r\n        };\r\n\r\n        requestAnimationFrame(gameLoop);\r\n    }, []);\r\n\r\n\r\n    // console.log(`GameView render`, { playerStylePosition });\r\n\r\n    const timeSinceProblem = getGameTime().gameTime - (problemsState.current?.problemTime ?? 0);\r\n\r\n    const directAnswer = (enemy: EnemiesState['enemies'][0]) => {\r\n        if (gameState.current.gameOverTime) { restartGame(); return; }\r\n        if (gameState.current.deadTime) { return; }\r\n        if (enemy.destroyed || enemy.explodeTime) { return; }\r\n        gameState.current.weaponsLock = { lockedEnemy: enemy, lockedAtPlayerPosition: playerPositionState.current };\r\n        const { shots } = projectilesState.current;\r\n        shots.push({ key: `${getGameTime()}${shots.length}`, pos: { ...playerPositionState.current }, lockedEnemy: enemy });\r\n        gameState.current.playerTargetPosition = { x: playerPositionState.current.x, y: enemy.pos.y };\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <View style={gameStyles.viewscreenView} >\r\n                {/* <TextPositioned text={`${gameState.current.score.toLocaleString()}`} position={{ x: 0, y: -0.8 * gameStyles.sprite.viewSize.height, rotation: 0 }} /> */}\r\n                {[... new Array(gameState.current.lives)].map((x, i) => (\r\n                    <Sprite key={`life${i}`} kind='life' position={{ x: gameStyles.viewscreenView.width - (gameStyles.sprite.viewSize.width * (1 + i)), y: gameStyles.viewscreenView.height - 0.5 * gameStyles.sprite.viewSize.height, rotation: 0 }} />\r\n                ))}\r\n                {projectilesState.current.debris.map(x => (\r\n                    <Sprite key={x.key} kind={x.hasHitGround ? `${x.kind}-splat` as SpriteKind : x.kind} position={x.pos} />\r\n                ))}\r\n                {enemiesState.current?.enemies.filter(e => !e.destroyed).map(e => (\r\n                    <React.Fragment key={e.key}>\r\n                        {!e.answer.isAnsweredWrong && (<TextPositioned position={{ y: e.pos.y, x: e.pos.x + gameStyles.sprite.viewSize.width, rotation: 0 }} text={e.answer.value} />)}\r\n                        {e.answer.isAnsweredWrong && (<Sprite kind='answer-wrong' position={{ y: e.pos.y, x: e.pos.x + gameStyles.sprite.viewSize.width, rotation: 0 }} />)}\r\n                    </React.Fragment>\r\n                ))}\r\n                {enemiesState.current?.enemies.filter(x => !x.destroyed).map(x => (\r\n                    <React.Fragment key={x.key}>\r\n                        <Sprite kind={x.explodeTime ? `enemy-explode` : `enemy`} position={x.pos} />\r\n                        {x === gameState.current.weaponsLock?.lockedEnemy && (\r\n                            <Sprite kind='lock' position={x.pos} />\r\n                        )}\r\n                    </React.Fragment>\r\n                ))}\r\n                {!gameState.current.gameOverTime && !gameState.current.deadTime && (\r\n                    <Sprite kind='player' position={playerPositionState.current} />\r\n                )}\r\n                {projectilesState.current.shots.map(x => (\r\n                    <Sprite key={x.key} kind={x.explodeTime ? `shot-explode` : `shot`} position={x.pos} />\r\n                ))}\r\n                {gameState.current.gameOverTime && (\r\n                    <View>\r\n                        <View style={{ position: `absolute`, top: gameStyles.viewscreenView.height * 0.5, width: gameStyles.viewscreenView.width }}>\r\n                            <Text style={gameStyles.gameOver.text}>Game Over</Text>\r\n                            {getGameTime().gameTime > 1 + gameState.current.gameOverTime && (<Text style={gameStyles.gameOver.text}>Continue?</Text>)}\r\n                        </View>\r\n                    </View>\r\n                )}\r\n\r\n                <View style={gameStyles.directAnswerButtonContainer}>\r\n                    {enemiesState.current?.enemies.map(e => (\r\n                        <TouchableOpacity key={e.key} onPress={() => directAnswer(e)} >\r\n                            <View style={!e.destroyed && !e.explodeTime ? gameStyles.directAnswerButton : gameStyles.directAnswerButton_hidden} />\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </View>\r\n            </View>\r\n            <View style={{ position: `relative`, height: gameStyles.question.text.fontSize * 3, alignSelf: `stretch` }}>\r\n                <TextPositioned text={problemsState.current?.question ?? ``} position={{ x: gameStyles.viewscreenView.width * 0.25, y: gameStyles.question.text.fontSize * 1 - Math.max(0, gameStyles.viewscreenView.height * 0.5 - 125 * timeSinceProblem), rotation: 0 }} />\r\n            </View>\r\n            {/* <View>\r\n                <Text>{`${renderId}`}</Text>\r\n            </View> */}\r\n            {/* <View style={[gameStyles.question.view, { transform: `translate(0px,${-Math.max(0, gameStyles.viewscreenView.height * 0.5 - 125 * timeSinceProblem)}px)` }]}>\r\n                <Text style={{...gameStyles.question.text, text.length > 10 ? s.fontSize_small * 0.5 : s.fontSize}} >{problemsState.current?.question}</Text>\r\n            </View> */}\r\n\r\n        </>\r\n    );\r\n};\r\n\r\ntype CommonGameState = { gameTime: number, gameDeltaTime: number, gameState: GameState, pressState: GamepadPressState, playerPosition: GamePosition, projectilesState: ProjectilesState, enemiesState: EnemiesState, onLoseLife: () => void };\r\n\r\nconst updateGame = ({ gameTime, gameDeltaTime, pressState, playerPosition, gameState, enemiesState }: CommonGameState): GameState => {\r\n\r\n    // Respawn Player\r\n    if (gameState.deadTime && gameTime > 3 + gameState.deadTime) {\r\n        playerPosition.y = gameStyles.viewscreenView.height * 0.5;\r\n        playerPosition.x = gameStyles.viewscreenView.width * 0.15;\r\n\r\n        enemiesState.enemies.forEach(e2 => { e2.pos.x += gameStyles.viewscreenView.width * 0.5; });\r\n\r\n        return { ...gameState, deadTime: undefined };\r\n    }\r\n\r\n    return gameState;\r\n};\r\n\r\nconst updatePlayer = ({ gameTime, gameDeltaTime, pressState, playerPosition, gameState }: CommonGameState): { playerPosition: GamePosition } => {\r\n    if (gameState.deadTime) { return { playerPosition }; }\r\n\r\n    const dirPress = pressState.moveDirection;\r\n    const targetPos = gameState.playerTargetPosition;\r\n    const dir = dirPress.x || dirPress.y ? { x: dirPress.x, y: -dirPress.y }\r\n        : targetPos ? { x: targetPos.x - playerPosition.x, y: targetPos.y - playerPosition.y }\r\n            : { x: 0, y: 0 };\r\n    dir.x = dir.x === 0 ? 0 : Math.sign(dir.x);\r\n    dir.y = dir.y === 0 ? 0 : Math.sign(dir.y);\r\n\r\n    if (gameState.playerTargetPosition) {\r\n        console.log(`updatePlayer`, { dirPress, dir, targetPos, playerPosition });\r\n    }\r\n\r\n    if (dirPress.x || dirPress.y) {\r\n        gameState.playerTargetPosition = undefined;\r\n    }\r\n    if (gameState.playerTargetPosition && getDistanceSq(playerPosition, gameState.playerTargetPosition) < 5 * 5) {\r\n        gameState.playerTargetPosition = undefined;\r\n    }\r\n\r\n    const targetRotation = dir.y * 0.05;\r\n\r\n    const pos = {\r\n        x: playerPosition.x + dir.x * gameDeltaTime * 250,\r\n        y: playerPosition.y + dir.y * gameDeltaTime * 250,\r\n        rotation: playerPosition.rotation * 0.9 + targetRotation * 0.1,\r\n    };\r\n\r\n    const w = gameStyles.viewscreenView.width;\r\n    const gw = gameStyles.sprite.viewSize.width * 0.5;\r\n    const h = gameStyles.viewscreenView.height;\r\n    const gh = gameStyles.sprite.viewSize.height * 0.5;\r\n    pos.x = pos.x < gw ? gw : pos.x > w - gw ? w - gw : pos.x;\r\n    pos.y = pos.y < gh ? gh : pos.y > h - gh ? h - gh : pos.y;\r\n\r\n    return { playerPosition: pos };\r\n};\r\n\r\ntype ProjectilesState = {\r\n    lastShotActualTime: number;\r\n    shots: { key: string, pos: GamePosition, explodeTime?: number, ignore?: boolean, lockedEnemy?: { pos: GamePosition, explodeTime?: number, destoyed?: boolean } }[];\r\n    debris: { key: string, vel: Vector2, pos: GamePosition, kind: SpriteKind, hasHitGround?: boolean }[];\r\n};\r\nconst updateProjectiles = ({ gameTime, gameDeltaTime, pressState, playerPosition: playerPos, enemiesState, projectilesState, gameState, onLoseLife }: CommonGameState): ProjectilesState => {\r\n    const { shots, debris, lastShotActualTime } = projectilesState;\r\n\r\n    const canShoot = !gameState.deadTime && !gameState.gameOverTime && (Date.now() / 1000) > 0.25 + lastShotActualTime;\r\n\r\n    // console.log(`updateProjectiles`, { canShoot, gameTime, lastShotTime });\r\n\r\n    const didShoot = canShoot && pressState.buttons.find(x => x.key === `A`)?.isDown;\r\n    if (didShoot) {\r\n        const lockedEnemy = gameState.weaponsLock?.lockedEnemy;\r\n        shots.push({ key: `${gameTime}${shots.length}`, pos: { ...playerPos }, lockedEnemy });\r\n    }\r\n\r\n    // Move shots\r\n    shots.forEach(x => {\r\n        if (x.explodeTime) { return; }\r\n\r\n        if (x.lockedEnemy && !x.lockedEnemy.explodeTime && !x.lockedEnemy.destoyed) {\r\n            x.pos.y += (x.lockedEnemy.pos.y - x.pos.y) * 0.25;\r\n            x.pos.x += Math.min(250 * gameDeltaTime, (x.lockedEnemy.pos.x - x.pos.x) * 0.5);\r\n        } else {\r\n            x.pos.x += 250 * gameDeltaTime;\r\n        }\r\n    });\r\n\r\n    // Move debris\r\n    debris.forEach(d => {\r\n        if (d.hasHitGround) { return; }\r\n\r\n        // Gravity\r\n        d.vel.y += 100 * gameDeltaTime;\r\n\r\n        d.pos.y += d.vel.y * gameDeltaTime;\r\n        d.pos.x += d.vel.x * gameDeltaTime;\r\n\r\n        const pad = gameStyles.sprite.viewSize.width * 0.5;\r\n        const w = gameStyles.viewscreenView.width;\r\n        if (d.pos.x < pad) { d.pos.x = pad; d.vel.x = -d.vel.x; }\r\n        if (d.pos.x > w - pad) { d.pos.x = w - pad; d.vel.x = -d.vel.x; }\r\n\r\n        const hPad = gameStyles.sprite.viewSize.width * 0.8;\r\n        const h = gameStyles.viewscreenView.height;\r\n        if (d.pos.y > h - hPad + Math.random() * 10) {\r\n            d.hasHitGround = true;\r\n\r\n            if (d.kind === `kitten`) {\r\n                onLoseLife();\r\n            }\r\n        }\r\n\r\n    });\r\n\r\n    // Clean up too much debris\r\n    if (debris.length > 25) {\r\n        debris.shift();\r\n    }\r\n\r\n    const newShots = shots\r\n        // Remove shots offscreen\r\n        .filter(x => x.pos.x < gameStyles.viewscreenView.width)\r\n        // Remove exploded\r\n        .filter(x => !x.explodeTime || gameTime < 1 + x.explodeTime)\r\n        ;\r\n\r\n    return {\r\n        ...projectilesState,\r\n        lastShotActualTime: didShoot ? (Date.now() / 1000) : lastShotActualTime,\r\n        shots: newShots,\r\n    };\r\n};\r\n\r\ntype EnemiesState = {\r\n    enemies: {\r\n        key: string;\r\n        pos: GamePosition;\r\n        vel: Vector2;\r\n        explodeTime?: number;\r\n        answer: AnswerState;\r\n        onHit: () => void;\r\n        destroyed?: boolean;\r\n    }[];\r\n};\r\nconst updateEnemies = ({ gameTime, gameDeltaTime, projectilesState, enemiesState, gameState, playerPosition, onLoseLife }: CommonGameState): EnemiesState => {\r\n    const { enemies } = enemiesState;\r\n    const { shots } = projectilesState;\r\n\r\n    // Detect Collisions\r\n\r\n    // Enemies - Bullets\r\n    const radius = gameStyles.sprite.viewSize.width * 0.75;\r\n    const radiusSq = radius * radius;\r\n\r\n    enemies.forEach(e => shots.forEach(s => {\r\n        // console.log(`Checking!`, { e, s });\r\n\r\n        if (e.explodeTime) { return; }\r\n        if (s.explodeTime || s.ignore) { return; }\r\n\r\n        // Only shoot locked enemy\r\n        if (s.lockedEnemy && s.lockedEnemy !== e) { return; }\r\n\r\n        if (getDistanceSq(e.pos, s.pos) < radiusSq) {\r\n            console.log(`Exploded!`, { e, s });\r\n\r\n            e.explodeTime = gameTime;\r\n            s.explodeTime = gameTime;\r\n\r\n            e.onHit();\r\n\r\n            if (e.answer.isCorrect) {\r\n                projectilesState.debris.push({ key: `${e.key} ${gameTime}`, kind: `alien`, pos: { ...e.pos }, vel: { ...e.vel } });\r\n            } else {\r\n                projectilesState.debris.push({ key: `${e.key} ${gameTime}`, kind: `kitten`, pos: { ...e.pos }, vel: { ...e.vel } });\r\n            }\r\n        }\r\n    }));\r\n\r\n    // Enemies - Enemies (bounce)\r\n    const radiusSq_enemies = radius * radius * 1.5 * 1.5;\r\n    enemies.forEach((e, i) => enemies.forEach((e2, i2) => {\r\n\r\n        if (i >= i2) { return; }\r\n        if (e.explodeTime) { return; }\r\n        if (e2.explodeTime) { return; }\r\n\r\n        if (getDistanceSq(e.pos, e2.pos) < radiusSq_enemies) {\r\n\r\n            // Transfer momentum\r\n            const frictionRatio = 0.95;\r\n            const swap = e.vel.y;\r\n            e.vel.y = e2.vel.y * frictionRatio;\r\n            e2.vel.y = swap * frictionRatio;\r\n            // }\r\n\r\n            // if (getDistanceSq(e.pos, e2.pos) < radiusSq_enemies * 0.8 * 0.8) {\r\n            // Move apart\r\n            const a = e.pos.y < e2.pos.y ? e : e2;\r\n            const b = e.pos.y < e2.pos.y ? e2 : e;\r\n\r\n            a.pos.y -= 10 * gameDeltaTime;\r\n            b.pos.y += 10 * gameDeltaTime;\r\n            a.vel.y -= 10 * gameDeltaTime;\r\n            b.vel.y += 10 * gameDeltaTime;\r\n        }\r\n    }));\r\n\r\n    // Enemies - Player\r\n    const radiusSq_player = radius * radius * 0.8 * 0.8;\r\n    enemies.forEach((e, i) => {\r\n        if (e.explodeTime) { return; }\r\n        if (gameState.deadTime || gameState.gameOverTime) { return; }\r\n\r\n        if (getDistanceSq(e.pos, playerPosition) < radiusSq_player) {\r\n            onLoseLife();\r\n\r\n            // e.explodeTime = gameTime;\r\n            // e.onHit();\r\n\r\n            return;\r\n        }\r\n    });\r\n\r\n    // Enemies move\r\n    enemies.forEach(e => {\r\n        if (e.explodeTime) { return; }\r\n\r\n        e.vel.y += (-1 + 2 * Math.random()) * 250 * gameDeltaTime;\r\n        // e.vel.x += -3 * gameDeltaTime;\r\n\r\n        if (!gameState.deadTime && !gameState.gameOverTime) {\r\n            e.vel.x = -25;\r\n        } else {\r\n            e.vel.x = 0;\r\n        }\r\n\r\n        // Move away from ground\r\n        if (e.pos.y > gameStyles.viewscreenView.height * 0.7) {\r\n            // e.vel.y += -100 * gameDeltaTime;\r\n            e.vel.y = -5;\r\n        }\r\n\r\n        // Keep on screen\r\n        if (e.pos.x > gameStyles.viewscreenView.width - gameStyles.sprite.viewSize.width * 2) {\r\n            e.pos.x = gameStyles.viewscreenView.width - gameStyles.sprite.viewSize.width * 2;\r\n        }\r\n\r\n        e.pos.x += e.vel.x * gameDeltaTime;\r\n        e.pos.y += e.vel.y * gameDeltaTime;\r\n\r\n        const pad = gameStyles.sprite.viewSize.height * 0.5;\r\n        const h = gameStyles.viewscreenView.height;\r\n        if (e.pos.y < pad) { e.pos.y = pad; e.vel.y = 5; }\r\n        if (e.pos.y > h - pad) { e.pos.y = h - pad; e.vel.y = -e.vel.y; }\r\n\r\n        const wPad = gameStyles.sprite.viewSize.width * 0.5;\r\n        if (e.pos.x < wPad) {\r\n            e.pos.x = wPad;\r\n        }\r\n\r\n        // // Attack player\r\n        // if (e.pos.x < playerPosition.x) {\r\n        //     e.pos.y = playerPosition.y;\r\n        //     // e.vel.y = (playerPosition.y - e.pos.y) * 5;\r\n        // }\r\n    });\r\n\r\n    // Closest Enemy\r\n    const closestEnemyToPlayer = enemiesState.enemies.filter(x => !x.explodeTime && !x.destroyed)\r\n        .sort((a, b) => Math.abs(a.pos.y - playerPosition.y) < Math.abs(b.pos.y - playerPosition.y) ? -1 : 1)[0];\r\n\r\n    const updateWeaponsLock = (enemy: typeof enemiesState.enemies[0]) => {\r\n        // Only update on player movement\r\n        if (gameState.weaponsLock?.lockedAtPlayerPosition.y === playerPosition.y) {\r\n            return;\r\n        }\r\n\r\n        gameState.weaponsLock = {\r\n            lockedAtPlayerPosition: playerPosition,\r\n            lockedEnemy: enemy,\r\n        };\r\n    };\r\n\r\n    // Attack Player\r\n    if (closestEnemyToPlayer?.pos.x < playerPosition.x + gameStyles.sprite.viewSize.width * 0.5) {\r\n        closestEnemyToPlayer.pos.y = playerPosition.y;\r\n    } else {\r\n        // Lock on Enemy\r\n        updateWeaponsLock(closestEnemyToPlayer);\r\n    }\r\n\r\n    // Cleanup\r\n    const newEnemies = enemies;\r\n    newEnemies.filter(x => x.explodeTime && gameTime > 1 + x.explodeTime).forEach(x => {\r\n        x.destroyed = true;\r\n\r\n    });\r\n    // // Remove exploded\r\n    // .filter(x => !x.explodeTime || gameTime < 1 + x.explodeTime)\r\n    // ;\r\n\r\n    return {\r\n        enemies: newEnemies,\r\n    };\r\n};\r\n\r\ntype SpriteKind = 'text' | 'player' | 'player-character' | 'player-character-splat' | 'shot' | 'shot-explode' | 'lock' | 'enemy' | 'enemy-explode' | 'answer-wrong' | 'alien' | 'kitten' | 'alien-splat' | 'kitten-splat' | 'super-kitten' | 'life';\r\nconst getSpriteEmoji = (kind: SpriteKind) => {\r\n    // \r\n    // \r\n    // \r\n    // \r\n    // \r\n    switch (kind) {\r\n        case `player`: return { text: ``, rotation: +0.125, offsetX: 0, offsetY: -0.25 };\r\n        case `player-character`: return { text: `` };\r\n        case `player-character-splat`: return { text: ``, rotation: 0.15 };\r\n        case `shot`: return { text: ``, rotation: -0.25 };\r\n        case `shot-explode`: return { text: ``, rotation: 0, scale: 0.5 };\r\n        case `lock`: return { text: ``, offsetX: -0.25, offsetY: -0.125, scale: 1.5 };\r\n        case `enemy`: return { text: ``, offsetX: -0.125, offsetY: -0.125 };\r\n        case `enemy-explode`: return { text: ``, offsetX: -0.125, offsetY: -0.125 };\r\n        case `answer-wrong`: return { text: ``, offsetX: -0.125, offsetY: -0.125 };\r\n        case `alien`: return { text: ``, offsetX: 0, offsetY: 0 };\r\n        // case `kitten`: return { text: ``, offsetX: 0, offsetY: 0 };\r\n        case `kitten`: return { text: ``, offsetX: 0, offsetY: 0 };\r\n        case `alien-splat`: return { text: ``, offsetX: 0, offsetY: 0 };\r\n        case `kitten-splat`: return { text: ``, offsetX: 0, offsetY: 0 };\r\n        case `super-kitten`: return { text: ``, offsetX: 0, offsetY: 0 };\r\n        // case `kitten-splat`: return { text: ``, offsetX: 0, offsetY: 0 };\r\n        case `life`: return { text: ``, scale: 0.5 };\r\n        case `text`: return { text: ``, offsetX: 0, offsetY: -0.125 };\r\n        default: return { text: `` };\r\n    }\r\n};\r\n\r\nconst Sprite = ({ kind, position, text }: { kind: SpriteKind, position: { x: number, y: number, rotation: number }, text?: string }) => {\r\n    const s = getSpriteEmoji(kind);\r\n    const size = gameStyles.sprite.viewSize;\r\n    const { fontSize } = gameStyles.sprite.text;\r\n\r\n    const stylePosition = {\r\n        position: `absolute`,\r\n        ...size,\r\n        transform: `translate(${position.x}px, ${position.y}px) rotate(${position.rotation ?? 0}turn)`,\r\n        // backgroundColor: `red`,\r\n        pointerEvents: `none`,\r\n    } as const;\r\n    const styleRotation = {\r\n        ...size,\r\n        transform: `translate( ${size.width * -0.5 + Math.floor((s.offsetX ?? 0) * fontSize)}px, ${size.height * -0.5 + Math.floor((s.offsetY ?? 0) * fontSize)}px) rotate(${s.rotation ?? 0}turn) scale(${s.scale ?? 1})`,\r\n    };\r\n    return (\r\n        <View style={stylePosition}>\r\n            <View style={styleRotation}>\r\n                <Text style={gameStyles.sprite.text}>{text ?? s.text}</Text>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n\r\nconst TextPositioned = ({ text, position }: { text: string, position: { x: number, y: number, rotation: number } }) => {\r\n    const s = gameStyles.answer.text;\r\n    const fontSize = text.length > 10 ? s.fontSize_small : s.fontSize;\r\n\r\n    const offsetY = -fontSize * 0.5 - 4;\r\n\r\n    const stylePosition = {\r\n        position: `absolute`,\r\n        transform: `translate(${position.x}px, ${position.y + offsetY}px) rotate(${position.rotation ?? 0}turn)`,\r\n        pointerEvents: `none`,\r\n        maxWidth: gameStyles.viewscreenView.width * 0.5,\r\n        // backgroundColor: `red`,\r\n    } as const;\r\n\r\n    return (\r\n        <View style={stylePosition}>\r\n            <Text style={{ ...gameStyles.answer.text, fontSize }}>{text}</Text>\r\n        </View>\r\n    );\r\n};\r\n","import { shuffle, distinct } from 'utils/arrays';\r\nimport { ProblemService, ProblemResult, ProblemAnswer } from './problems-service';\r\n\r\nexport const createMultiplesProblemService = ({\r\n    min = 1,\r\n    max = 12,\r\n    maxAnswers = 4,\r\n}: {\r\n    min?: number;\r\n    max?: number;\r\n    maxAnswers?: number;\r\n}): ProblemService => {\r\n\r\n    let state = {\r\n        n: min - 1,\r\n        m: min,\r\n        completedSectionKeys: [] as string[],\r\n    };\r\n    const getSectionKey = (m: number) => {\r\n        return `${m}`;\r\n    };\r\n    const getSectionName = (m: number) => {\r\n        return `Multiples of ${m}`;\r\n    };\r\n\r\n    const problemService: ProblemService = {\r\n        load: async (storage) => {\r\n            const loaded = await storage.load<typeof state>();\r\n            if (loaded) {\r\n                state = loaded;\r\n            }\r\n        },\r\n        save: async (storage) => {\r\n            await storage.save(state);\r\n        },\r\n        getSections: () => [...new Array(max - min + 1)].map((x, i) => ({\r\n            key: getSectionKey(i + min),\r\n            name: getSectionName(i + min),\r\n            isComplete: state.completedSectionKeys.includes(getSectionKey(i + min)),\r\n        })),\r\n        gotoSection: ({ key }) => {\r\n            const bVal = Number.parseInt(key, 10);\r\n            state.m = bVal;\r\n            state.n = min - 1;\r\n        },\r\n        getNextProblem: (): ProblemResult => {\r\n            state.n++;\r\n            if (state.n > max) {\r\n                state.n = min;\r\n                state.m++;\r\n                if (state.m > max) {\r\n                    // Loop\r\n                    state.n = min;\r\n                    state.m = min;\r\n                    // return { done: true, key: `done` };\r\n                }\r\n            }\r\n\r\n            const { n, m } = state;\r\n            const correctValue = n * m;\r\n            const wrongAnswerCount = maxAnswers - 1;\r\n            const wrongValues =\r\n                distinct(\r\n                    [...new Array(100)].map(() =>\r\n                        Math.round(n + 1 - 2 * Math.random())\r\n                        * Math.round(m + 1 - 2 * Math.random())\r\n                        + Math.round(2 - 4 * Math.random()))\r\n                        .filter(x => x !== correctValue)\r\n                        .filter(x => x > 0),\r\n                ).slice(0, wrongAnswerCount);\r\n\r\n            const answers: ProblemAnswer[] = shuffle([...wrongValues.map(x => ({ value: `${x}`, isCorrect: false })), { value: `${correctValue}`, isCorrect: true }]).map(x => ({ ...x, key: x.value }));\r\n\r\n            return {\r\n                key: `${m} x ${n}`,\r\n                question: `${m} x ${n}`,\r\n                answers,\r\n                sectionKey: getSectionKey(m),\r\n                isLastOfSection: n === max,\r\n                isLastOfSubject: n === max && m === max,\r\n            };\r\n        },\r\n        recordAnswer: (problem, answer) => {\r\n            if (answer.isCorrect && problem.isLastOfSection) {\r\n                state.completedSectionKeys.push(problem.sectionKey);\r\n            }\r\n        },\r\n    };\r\n\r\n    return problemService;\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\nimport React, { useEffect, useState } from 'react';\r\nimport { View, Text, TouchableOpacity } from 'react-native-lite';\r\nimport { shuffle } from 'utils/arrays';\r\n\r\nconst englishKeyboard = {\r\n    rows: [\r\n        { keys: `qwertyuiop`.split(``) },\r\n        { keys: ` asdfghjkl`.split(``) },\r\n        { keys: `  zxcvbnm `.split(``) },\r\n    ],\r\n};\r\n\r\nconst styles = {\r\n    container: {},\r\n    rowView: { flex: 1, flexDirection: `row` },\r\n    keyView: {\r\n        margin: 2,\r\n        padding: 2,\r\n        // width: 20,\r\n        flex: 1,\r\n        height: 20,\r\n        backgroundColor: `#111111`,\r\n        justifyContent: `center`,\r\n        alignItems: `center`,\r\n    },\r\n    keyView_disabled: { opacity: 0.5 },\r\n    keyText: {\r\n        fontSize: 16,\r\n    },\r\n    keyText_wrong: {\r\n        fontSize: 16,\r\n        color: `#FF0000`,\r\n    },\r\n} as const;\r\n\r\nexport const KeyboardSimplified = ({ expectedCharacter, showHints, onExpectedKeyPress }: { expectedCharacter: string, showHints: boolean, onExpectedKeyPress: () => void }) => {\r\n    const keyboard = englishKeyboard;\r\n\r\n    const [hintKeys, setHintKeys] = useState(null as null | string[]);\r\n    const [wrongKeys, setWrongKeys] = useState([] as string[]);\r\n    useEffect(() => {\r\n        if (!showHints) { setHintKeys(null); }\r\n\r\n        const hints = [expectedCharacter, ...shuffle(keyboard.rows.flatMap(x => x.keys).map(x => x.trim()).filter(x => x)).slice(0, 3)];\r\n        setHintKeys(hints);\r\n        setWrongKeys([]);\r\n    }, [expectedCharacter, showHints]);\r\n\r\n    const onKeyPress = (key: string) => {\r\n        if (key === expectedCharacter) {\r\n            onExpectedKeyPress();\r\n            return;\r\n        }\r\n        // Remove from choices\r\n        if (showHints) {\r\n            setHintKeys(s => (s ?? []).filter(x => x !== key));\r\n            setWrongKeys(s => [...s, key]);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <View style={styles.container}>\r\n                {keyboard.rows.map((row, iRow) => (\r\n                    <View style={styles.rowView} key={`${iRow}`} >\r\n                        {row.keys.map((k, i) => (\r\n                            <TouchableOpacity key={`${k}${i}`} style={{ outline: `none` }} onPress={() => onKeyPress(k)}>\r\n                                <View style={!hintKeys || hintKeys.includes(k) ? {} : styles.keyView_disabled} >\r\n                                    <View style={styles.keyView}>\r\n                                        <Text style={wrongKeys.includes(k) ? styles.keyText_wrong : styles.keyText}>{k}</Text>\r\n                                    </View>\r\n                                </View>\r\n                            </TouchableOpacity>\r\n                        ))}\r\n                    </View>\r\n                ))}\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { View, Text, TouchableOpacity } from 'react-native-lite';\r\nimport { DoodleDrawing, defaultDoodleDrawing, DoodleData } from './doodle';\r\nimport { DoodleDrawerView, DoodleDisplayView } from './doodle-view';\r\nimport { KeyboardSimplified } from './keyboard-simplified';\r\n\r\nexport const styles = {\r\n    container: {\r\n        alignItems: `center`,\r\n    },\r\n    drawing: {\r\n        width: 312,\r\n        height: 312,\r\n        color: `#FFFFFF`,\r\n        backgroundColor: `#000000`,\r\n    },\r\n    drawingChoicesView: {\r\n        maxWidth: 312 + 4 * 4 + 4,\r\n        flexDirection: `row`,\r\n        flexWrap: `wrap`,\r\n    },\r\n    drawingChoiceWrapper: {\r\n        padding: 4,\r\n    },\r\n    drawingChoice: {\r\n        width: 78,\r\n        height: 78,\r\n        color: `#FFFFFF`,\r\n        backgroundColor: `#000000`,\r\n    },\r\n    titleView: {\r\n        justifyContent: `center`,\r\n        alignItems: `center`,\r\n    },\r\n    titleText: {\r\n        fontSize: 20,\r\n        color: `#FFFFFF`,\r\n    },\r\n    promptView: {\r\n        justifyContent: `center`,\r\n        alignItems: `center`,\r\n    },\r\n    promptText: {\r\n        fontSize: 20,\r\n        color: `#FFFF00`,\r\n    },\r\n    hintText: {\r\n        fontSize: 14,\r\n        color: `#FFFF00`,\r\n    },\r\n    buttonRowView: {\r\n        flexDirection: `row`,\r\n    },\r\n    buttonView: {\r\n        margin: 4,\r\n        padding: 8,\r\n        backgroundColor: `#111111`,\r\n    },\r\n    buttonText: {\r\n        fontSize: 20,\r\n        color: `#FFFF00`,\r\n    },\r\n} as const;\r\n\r\nexport const DoodleGameView_DrawWord = (props: { prompt: string, hint?: string, onDone: (drawing: DoodleDrawing) => void, onSkip?: () => void }) => {\r\n    const [drawing, setDrawing] = useState(defaultDoodleDrawing());\r\n    const changeDoodle = (value: DoodleDrawing) => {\r\n        setDrawing(value);\r\n    };\r\n\r\n    const done = () => {\r\n        props.onDone(drawing);\r\n    };\r\n    const skip = () => {\r\n        props.onSkip?.();\r\n    };\r\n\r\n    useEffect(() => {\r\n        // Reset problem when prompt changes\r\n        setDrawing(defaultDoodleDrawing());\r\n    }, [props.prompt]);\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            <View style={styles.titleView}>\r\n                <Text style={styles.titleText}>Draw</Text>\r\n            </View>\r\n            <DoodleDrawerView style={styles.drawing} drawing={drawing} onChange={changeDoodle} />\r\n            <View style={styles.promptView}>\r\n                <Text style={styles.promptText}>{props.prompt}</Text>\r\n                {!!props.hint && (<Text style={styles.hintText}>{props.hint}</Text>)}\r\n            </View>\r\n            <View style={styles.buttonRowView}>\r\n                {!!props.onSkip && (\r\n                    <TouchableOpacity onPress={skip}>\r\n                        <View style={styles.buttonView}>\r\n                            <Text style={styles.buttonText}>Skip</Text>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                )}\r\n                <TouchableOpacity onPress={done}>\r\n                    <View style={styles.buttonView}>\r\n                        <Text style={styles.buttonText}>Done</Text>\r\n                    </View>\r\n                </TouchableOpacity>\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n\r\nexport const DoodleGameView_ChooseBest = (props: { prompt: string, drawings: DoodleData[], onChooseBest: (drawing: DoodleData) => void }) => {\r\n    return (\r\n        <View style={styles.container}>\r\n            <View style={styles.titleView}>\r\n                <Text style={styles.titleText}>Choose Best</Text>\r\n            </View>\r\n            <View style={styles.promptView}>\r\n                <Text style={styles.promptText}>{props.prompt}</Text>\r\n            </View>\r\n            <View style={styles.drawingChoicesView} >\r\n                {props.drawings.map(x => (\r\n                    <TouchableOpacity key={x.key} onPress={() => props.onChooseBest(x)}>\r\n                        <View style={styles.drawingChoiceWrapper} >\r\n                            <DoodleDisplayView style={styles.drawingChoice} drawing={x.drawing} />\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                ))}\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n\r\nconst typeStyles = {\r\n    completedText: {\r\n        fontSize: 16,\r\n        color: `#FFFF00`,\r\n    },\r\n} as const;\r\nexport const DoodleGameView_TypeExpected = (props: { prompt: string, drawings: DoodleData[], onDone: () => void, sayAgain: () => void }) => {\r\n\r\n    const [status, setStatus] = useState({ completed: ``, remaining: props.prompt });\r\n    useEffect(() => {\r\n        setStatus({ completed: ``, remaining: props.prompt });\r\n    }, [props.prompt, props.drawings]);\r\n\r\n    const onExpectedKeyPress = () => {\r\n        setStatus(s => {\r\n            if (s.remaining.length <= 1) {\r\n                props.onDone();\r\n            }\r\n            const nextChar = s.remaining[0];\r\n            return {\r\n                completed: s.completed + nextChar,\r\n                remaining: s.remaining.substr(1),\r\n            };\r\n        });\r\n    };\r\n\r\n    return (\r\n        <View style={styles.container}>\r\n            <View style={styles.titleView}>\r\n                <Text style={styles.titleText}>Type Word</Text>\r\n            </View>\r\n            <View style={styles.drawingChoicesView} >\r\n                {props.drawings.map(x => (\r\n                    <View key={x.key} style={styles.drawingChoiceWrapper} >\r\n                        <DoodleDisplayView style={styles.drawingChoice} drawing={x.drawing} />\r\n                    </View>\r\n                ))}\r\n            </View>\r\n            <TouchableOpacity onPress={props.sayAgain}>\r\n                <View style={styles.buttonView}>\r\n                    <Text style={styles.buttonText}>Say Again</Text>\r\n                </View>\r\n            </TouchableOpacity>\r\n            <View>\r\n                <Text style={typeStyles.completedText}>{`${status.completed}${status.remaining.length > 0 ? `_` : ``}`}</Text>\r\n            </View>\r\n            <KeyboardSimplified expectedCharacter={status.remaining[0] ?? ` `} showHints onExpectedKeyPress={onExpectedKeyPress} />\r\n        </View>\r\n    );\r\n};\r\n","import React, { useState } from 'react';\r\nimport { View, Text, TouchableOpacity, TextInput } from 'react-native-lite';\r\n\r\n\r\nexport const createLeaderboard = <TScoreState extends {}>(args: {\r\n    storageKey: string;\r\n    sortKey: (item: TScoreState) => string | number;\r\n    sortDescending?: boolean;\r\n    scoreColumns: { name: string, getValue: (item: TScoreState) => string }[];\r\n}) => {\r\n\r\n    type LeaderboardScore = { name: string, score: TScoreState };\r\n    const leaderboard = {\r\n        saveScore: (name: string, score: TScoreState) => {\r\n            const data = leaderboard.loadScore();\r\n\r\n            data.push({ name, score });\r\n            data.sort((a, b) => args.sortKey(a.score) < args.sortKey(b.score) ? -1 : 1);\r\n\r\n            localStorage.setItem(args.storageKey, JSON.stringify(data));\r\n        },\r\n        loadScore: () => {\r\n            const json = localStorage.getItem(args.storageKey);\r\n            if (!json) { return []; }\r\n\r\n            const data = JSON.parse(json) as LeaderboardScore[];\r\n            data.sort((a, b) => (args.sortKey(a.score) > args.sortKey(b.score) ? -1 : 1) * (args.sortDescending ? -1 : 1));\r\n            return data;\r\n        },\r\n    };\r\n\r\n    const leaderboardInputStyles = {\r\n        container: {\r\n            flex: 1,\r\n            alignItems: `center`,\r\n            margin: 16,\r\n        },\r\n        textInput: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 16,\r\n            color: `#0000FF`,\r\n        },\r\n        buttonView: {\r\n            margin: 4,\r\n            padding: 4,\r\n            borderColor: `#FFFF00`,\r\n            borderStyle: `solid`,\r\n            borderWidth: 1,\r\n            borderRadius: 4,\r\n        },\r\n        buttonText: {\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 16,\r\n            color: `#FFFF00`,\r\n        },\r\n    } as const;\r\n\r\n    const LeaderboardNameInput = (props: { onSubmit: (value: string) => void }) => {\r\n        const [name, setName] = useState(``);\r\n        return (\r\n            <View style={leaderboardInputStyles.container}>\r\n                <TextInput style={leaderboardInputStyles.textInput} value={name} onChange={setName} placeholder='Name' keyboardType='default' autoCompleteType='off' />\r\n                <TouchableOpacity onPress={() => !!name && props.onSubmit(name)} style={!name ? { opacity: 0.5 } : {}}>\r\n                    <View style={leaderboardInputStyles.buttonView}>\r\n                        <Text style={leaderboardInputStyles.buttonText}>Save Score</Text>\r\n                    </View>\r\n                </TouchableOpacity>\r\n            </View >\r\n        );\r\n    };\r\n\r\n    const leaderboardStyles = {\r\n        container: {\r\n            marginTop: 16,\r\n            borderColor: `#FFFFFF`,\r\n            borderStyle: `solid`,\r\n            borderWidth: 1,\r\n            borderRadius: 0,\r\n        },\r\n        scoreView: {\r\n            flexDirection: `row`,\r\n            justifyContent: `space-around`,\r\n            padding: 4,\r\n            borderColor: `#FFFFFF`,\r\n            borderStyle: `solid`,\r\n            borderWidth: 1,\r\n            borderRadius: 0,\r\n        },\r\n        nameText: {\r\n            flex: 2,\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 12,\r\n            color: `#FFFFFF`,\r\n            overflow: `hidden`,\r\n        },\r\n        scoreText: {\r\n            flex: 1,\r\n            textAlign: `right`,\r\n            fontFamily: `\"Lucida Console\", Monaco, monospace`,\r\n            fontSize: 12,\r\n            color: `#FFFF00`,\r\n        },\r\n    } as const;\r\n\r\n    const LeaderboardViewInner = (props: { scores: LeaderboardScore[] }) => {\r\n\r\n        return (\r\n            <View style={leaderboardStyles.container}>\r\n                <View style={leaderboardStyles.scoreView}>\r\n                    <Text style={leaderboardStyles.nameText}>Leaderboard</Text>\r\n                    {args.scoreColumns.map(x => (\r\n                        <Text key={x.name} style={leaderboardStyles.scoreText} />\r\n                    ))}\r\n                </View>\r\n                <View style={leaderboardStyles.scoreView}>\r\n                    <Text style={leaderboardStyles.nameText}>Name</Text>\r\n                    {args.scoreColumns.map(x => (\r\n                        <Text key={x.name} style={leaderboardStyles.scoreText} >{x.name}</Text>\r\n                    ))}\r\n                </View>\r\n                {props.scores.map(x => (\r\n                    <View style={leaderboardStyles.scoreView}>\r\n                        <Text style={leaderboardStyles.nameText}>{x.name}</Text>\r\n                        {args.scoreColumns.map(c => (\r\n                            <Text key={x.name} style={leaderboardStyles.scoreText} >{c.getValue(x.score)}</Text>\r\n                        ))}\r\n                    </View>\r\n                ))}\r\n            </View>\r\n        );\r\n    };\r\n\r\n    const useLeaderboard = ({\r\n        getScore,\r\n    }: {\r\n        getScore: () => TScoreState;\r\n    }) => {\r\n\r\n        const [leaderboardScores, setLeaderboardScores] = useState({ scores: leaderboard.loadScore() } as { scores: LeaderboardScore[] });\r\n\r\n        const LeaderboardArea = (props: { gameOver: boolean, onScoreSaved: () => void }) => {\r\n\r\n            const onSaveScore = (name: string) => {\r\n                leaderboard.saveScore(name, getScore());\r\n                setLeaderboardScores({ scores: leaderboard.loadScore() });\r\n                props.onScoreSaved();\r\n            };\r\n\r\n            return (\r\n                <>\r\n                    {!!props.gameOver && (<LeaderboardNameInput onSubmit={onSaveScore} />)}\r\n                    <LeaderboardViewInner scores={leaderboardScores.scores} />\r\n                </>\r\n            );\r\n        };\r\n\r\n        return {\r\n            LeaderboardArea,\r\n        };\r\n    };\r\n\r\n\r\n    return {\r\n        useLeaderboard,\r\n    };\r\n};\r\n","export const userProfileChracters = `\r\n                       \r\n`.split(` `).map(x => x.trim()).filter(x => x);\r\n","import React, { useRef, useState, useEffect } from 'react';\r\nimport { View, Text, TouchableOpacity } from 'react-native-lite';\r\nimport { useAutoLoadingError } from 'utils-react/hooks';\r\nimport { C } from 'controls-react';\r\nimport { Icon } from 'controls-react/icon';\r\nimport { IconKind } from 'controls-react/icon-kind';\r\nimport { UserDataService, UserProfileInfo } from './user-data-service';\r\nimport { userProfileChracters } from './user-profile-emojis';\r\n\r\n\r\nexport const UserProfileManagerView = (props: { onClose?: () => void }) => {\r\n\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const [userProfiles, setUserProfiles] = useState(null as null | UserProfileInfo[]);\r\n\r\n    const reload = () => doWork(async (stopIfObsolete) => {\r\n        await UserDataService.get().setup();\r\n        stopIfObsolete();\r\n\r\n        const profiles = await UserDataService.get().getUserProfiles();\r\n        setUserProfiles(profiles);\r\n    });\r\n\r\n    useEffect(() => {\r\n        reload();\r\n    }, []);\r\n\r\n    return (\r\n        <C.View_Panel>\r\n            <C.Text_FormTitle >Users</C.Text_FormTitle>\r\n            <C.LoadingInline loading={loading} />\r\n            <C.ErrorBox error={error} />\r\n            {userProfiles?.map(x => (\r\n                <UserProfileView key={x.key} userProfile={x} onActiveUserChange={reload} onUserProfileChange={reload} />\r\n            ))}\r\n            <C.Text_FormTitle >Add User</C.Text_FormTitle>\r\n            <AddUserProfileView onUserAdded={reload} />\r\n            {!!props.onClose && (\r\n                <C.View_FormActionRow>\r\n                    <C.Button_FormAction onPress={() => props.onClose?.()}>Done</C.Button_FormAction>\r\n                </C.View_FormActionRow>\r\n            )}\r\n        </C.View_Panel>\r\n    );\r\n};\r\n\r\nconst AddUserProfileView = (props: { onUserAdded: () => void }) => {\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const [shareCode, setShareCode] = useState(null as null | string);\r\n    const addShareCode = () => {\r\n        if (!shareCode) { return; }\r\n\r\n        doWork(async (stopIfObsolete) => {\r\n            await UserDataService.get().addUserFromShareCode(shareCode);\r\n            stopIfObsolete();\r\n            props.onUserAdded();\r\n            setShareCode(null);\r\n        });\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <C.View_Form>\r\n                <C.View_FieldRow>\r\n                    <C.LoadingInline loading={loading} />\r\n                    <C.Input_Text value={shareCode ?? ``} onChange={setShareCode} placeholder='Enter Share Code' />\r\n                    <C.Button_FieldInline onPress={addShareCode}>Add User</C.Button_FieldInline>\r\n                </C.View_FieldRow>\r\n                <C.ErrorBox error={error} />\r\n            </C.View_Form>\r\n        </>\r\n    );\r\n};\r\n\r\n\r\nconst UserProfileView = ({ userProfile, onActiveUserChange, onUserProfileChange }: { userProfile: UserProfileInfo, onActiveUserChange: () => void, onUserProfileChange: () => void }) => {\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const [shareCode, setShareCode] = useState(null as null | string);\r\n    const [characters, setCharacters] = useState(null as null | string[]);\r\n\r\n    const createShareCode = () => doWork(async (stopIfObsolete) => {\r\n        const result = await UserDataService.get().createShareCode(userProfile.key);\r\n        stopIfObsolete();\r\n        setShareCode(result.shareCode);\r\n    });\r\n    const makeActive = () => doWork(async (stopIfObsolete) => {\r\n        await UserDataService.get().setActiveUser(userProfile.key);\r\n        stopIfObsolete();\r\n        onActiveUserChange();\r\n    });\r\n\r\n    const showCharacterSelection = () => {\r\n        setCharacters(userProfileChracters);\r\n    };\r\n    const selectCharacter = (character: string) => doWork(async (stopIfObsolete) => {\r\n        await UserDataService.get().setUserProfileInfo(userProfile.key, { emoji: character });\r\n\r\n        setCharacters(null);\r\n        onUserProfileChange();\r\n    });\r\n\r\n    if (characters) {\r\n        return (\r\n            <>\r\n                <C.View_Form>\r\n                    <View style={{ flexDirection: `row`, flexWrap: `wrap` }}>\r\n                        {characters.map(x => (\r\n                            <TouchableOpacity key={x} onPress={() => selectCharacter(x)} >\r\n                                <View>\r\n                                    <Text style={{ fontSize: 32 }} >{x}</Text>\r\n                                </View>\r\n                            </TouchableOpacity>\r\n                        ))}\r\n                    </View>\r\n                </C.View_Form>\r\n            </>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <C.View_Form>\r\n                <C.View_FieldRow>\r\n                    <C.LoadingInline loading={loading} />\r\n                    <TouchableOpacity onPress={makeActive}>\r\n                        <Icon style={{ size: 32 }} kind={userProfile.isActive ? IconKind.checkChecked : IconKind.checkUnchecked} />\r\n                    </TouchableOpacity>\r\n                    <TouchableOpacity onPress={showCharacterSelection} >\r\n                        <View>\r\n                            <Text style={{ fontSize: 32 }} >{userProfile.emoji}</Text>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                    <UserProfileName userProfile={userProfile} onNameChange={onUserProfileChange} />\r\n                    {!!shareCode && (\r\n                        <C.Text_FieldLabel>{shareCode}</C.Text_FieldLabel>\r\n                    )}\r\n                    {!shareCode && (\r\n                        <C.Button_FieldInline onPress={createShareCode}>Create Share Code</C.Button_FieldInline>\r\n                    )}\r\n                </C.View_FieldRow>\r\n                <C.ErrorBox error={error} />\r\n            </C.View_Form>\r\n        </>\r\n    );\r\n};\r\n\r\n\r\nexport const UserProfileName = ({ userProfile, onNameChange }: { userProfile: UserProfileInfo, onNameChange: () => void }) => {\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const [name, setName] = useState(userProfile.name);\r\n    const [isEditingName, setIsEditingName] = useState(false);\r\n\r\n    const changeName = () => doWork(async (stopIfObsolete) => {\r\n        console.log(`UserProfileName changeName`, { name });\r\n\r\n        await UserDataService.get().setUserProfileInfo(userProfile.key, { name });\r\n\r\n        setIsEditingName(false);\r\n        onNameChange();\r\n    });\r\n\r\n    return (\r\n        <>\r\n            {!isEditingName && (\r\n                <TouchableOpacity onPress={() => setIsEditingName(true)} >\r\n                    <C.Text_FieldLabel>{userProfile.name}</C.Text_FieldLabel>\r\n                </TouchableOpacity>\r\n            )}\r\n            {isEditingName && (\r\n                <>\r\n                    <C.Input_Text value={name} onChange={setName} onSubmit={changeName} />\r\n                    <C.Button_FieldInline onPress={changeName}>Change</C.Button_FieldInline>\r\n                </>\r\n            )}\r\n        </>\r\n    );\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\nimport React, { ReactNode, useEffect, useRef, useState } from 'react';\r\nimport { View, Text, TouchableOpacity } from 'react-native-lite';\r\nimport { Utterances } from 'comments/utterances';\r\nimport { LessonModule, SetProjectState } from '../common/lesson-types';\r\nimport { LessonView_ConstructCode, LessonView_ExperimentCode, LessonView_PreviewResult, LessonView_UnderstandCode } from '../common/components/lesson-view';\r\n\r\nconst styles = {\r\n    container: {\r\n        background: `#111111`,\r\n    },\r\n    containerPanel: {\r\n        background: `#292a2d`,\r\n    },\r\n    editorModeTabRowView: {\r\n        flexDirection: `row`,\r\n        paddingLeft: 16,\r\n    },\r\n    editorModeTabView: {\r\n        background: `#1e1e1e`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        marginRight: 1,\r\n    },\r\n    editorModeTabView_selected: {\r\n        background: `#292a2d`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        marginRight: 1,\r\n    },\r\n    editorModeTabText: {\r\n        fontSize: 14,\r\n        color: `#FFFFFFF`,\r\n    },\r\n    editorModeTabText_selected: {\r\n        fontSize: 14,\r\n        color: `#FFFF88`,\r\n    },\r\n    buttonView: {\r\n        background: `#1e1e1e`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        margin: 1,\r\n    },\r\n    buttonText: {\r\n        fontSize: 14,\r\n        color: `#FFFFFFF`,\r\n    },\r\n    sectionHeaderText: {\r\n        margin: 8,\r\n        fontSize: 18,\r\n        color: `#FFFF88`,\r\n    },\r\n    infoView: {\r\n    },\r\n    infoText: {\r\n        margin: 8,\r\n        fontSize: 12,\r\n        wrap: `wrap`,\r\n    },\r\n    lessonFieldView: {\r\n        flexDirection: `row`,\r\n    },\r\n    lessonFieldLabelText: {\r\n        minWidth: 80,\r\n        padding: 4,\r\n        fontSize: 12,\r\n    },\r\n    lessonFieldText: {\r\n        flex: 1,\r\n        padding: 4,\r\n        fontSize: 12,\r\n        wrap: `wrap`,\r\n    },\r\n    jsonText: {\r\n        padding: 4,\r\n        fontSize: 12,\r\n        color: `#FFFFFF`,\r\n        background: `#000000`,\r\n    },\r\n} as const;\r\n\r\n\r\nconst getLessonNavigatorItems = (module: LessonModule) => {\r\n    const items = module.lessons.flatMap((x, i) => [\r\n        { kind: `lesson` as const, lesson: x, label: `${i + 1}. ${x.title}` },\r\n        { kind: `preview` as const, lesson: x, label: `   Preview the Result` },\r\n        { kind: `construct` as const, lesson: x, label: `   Construct the Code` },\r\n        { kind: `understand` as const, lesson: x, label: `   Understand the Code` },\r\n        { kind: `experiment` as const, lesson: x, label: `   Experiment with the Code` },\r\n    ]);\r\n\r\n    // Add Intro Preview\r\n    const lastLesson = module.lessons[module.lessons.length - 1];\r\n    if (lastLesson) {\r\n        const lastLessonMainFile = lastLesson.projectState.files.find(x => x.path === lastLesson.focus.filePath);\r\n        items.unshift({\r\n            kind: `preview` as const,\r\n            lesson: {\r\n                ...lastLesson,\r\n                key: `lesson-`,\r\n                focus: { ...lastLesson.focus, index: 0, length: lastLessonMainFile?.content.length ?? 0 },\r\n            },\r\n            label: ` Lesson Objective`,\r\n        });\r\n    }\r\n\r\n    return items.map(x => ({ ...x, key: x.lesson.key + x.kind }));\r\n};\r\ntype NavigatorItem = ReturnType<typeof getLessonNavigatorItems>[0];\r\n\r\nexport const LessonModulePlayer = (props: { module: LessonModule, setProjectState: SetProjectState }) => {\r\n    const [items, setItems] = useState(getLessonNavigatorItems(props.module));\r\n    const [activeItem, setActiveItem] = useState(null as null | NavigatorItem);\r\n\r\n    useEffect(() => {\r\n        const newItems = getLessonNavigatorItems(props.module);\r\n        setItems(newItems);\r\n        nextStep({ items: newItems, useTimeout: false });\r\n    }, [props.module]);\r\n\r\n    const navigate = (targetItem: NavigatorItem) => {\r\n        if (targetItem.kind !== `lesson`) {\r\n            setActiveItem(targetItem);\r\n            return;\r\n        }\r\n\r\n        nextStep({ items, activeItem: targetItem, useTimeout: false });\r\n    };\r\n\r\n    const nextStep = (options?: { items?: NavigatorItem[], activeItem?: NavigatorItem, useTimeout: boolean }) => {\r\n        // console.log(`LessonModulePlayer nextStep`, { activeItem, options });\r\n        const itemsToUse = options?.items ?? items;\r\n        const activeItemToUse = options?.activeItem ?? activeItem;\r\n        if (!itemsToUse) { return; }\r\n\r\n        const itemSteps = itemsToUse.filter(x => x.kind !== `lesson`);\r\n        const activeItemStepIndex = itemSteps.findIndex(x => x.key === activeItemToUse?.key);\r\n        const activeItemIndex = itemsToUse.findIndex(x => x.key === activeItemToUse?.key);\r\n        const nextItem = (activeItemStepIndex >= 0 ? itemSteps[activeItemStepIndex + 1] : null)\r\n            ?? (activeItemIndex >= 0 ? itemsToUse[activeItemIndex + 1] : null)\r\n            ?? itemsToUse[0];\r\n\r\n        if (options?.useTimeout) {\r\n            setTimeout(() => {\r\n                setActiveItem(nextItem);\r\n            }, 1000);\r\n        } else {\r\n            setActiveItem(nextItem);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <View style={styles.container}>\r\n                {items && (\r\n                    <LessonModuleNavigator items={items} activeItem={activeItem ?? undefined} onChange={navigate}>\r\n                        <View key={activeItem?.key}>\r\n                            {activeItem?.kind === `preview` && (\r\n                                <LessonView_PreviewResult data={activeItem.lesson} setProjectState={props.setProjectState} onDone={nextStep} />\r\n                            )}\r\n                            {activeItem?.kind === `construct` && (\r\n                                <LessonView_ConstructCode data={activeItem.lesson} onDone={nextStep} />\r\n                            )}\r\n                            {activeItem?.kind === `understand` && (\r\n                                <LessonView_UnderstandCode data={activeItem.lesson} onDone={nextStep} />\r\n                            )}\r\n                            {activeItem?.kind === `experiment` && (\r\n                                <LessonView_ExperimentCode data={activeItem.lesson} setProjectState={props.setProjectState} onDone={nextStep} />\r\n                            )}\r\n                        </View>\r\n\r\n                        <div>\r\n                            <h3 style={{ borderTop: `solid 1px #3ca4ff`, padding: 8, margin: 0, marginTop: 16, textAlign: `center` }}>Community Comments - {props.module.title}</h3>\r\n                            <Utterances repo='ricklove/ricklove-code-lesson-comments' />\r\n                        </div>\r\n                    </LessonModuleNavigator>\r\n                )}\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n\r\n\r\nconst navigatorStyles = {\r\n    outerContainer: {\r\n        flexDirection: `row`,\r\n    },\r\n    contentContainer: {\r\n        flex: 1,\r\n        overflow: `auto`,\r\n    },\r\n    container: {\r\n        flexDirection: `column`,\r\n    },\r\n    itemsContainer: {\r\n        // paddingLeft: 24,\r\n        background: `#333333`,\r\n    },\r\n    itemView_header: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n        background: `#333333`,\r\n        // alignSelf: `flex-start`,\r\n        padding: 4,\r\n        marginRight: 1,\r\n    },\r\n    itemView: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n        background: `#1e1e1e`,\r\n        // alignSelf: `flex-start`,\r\n        padding: 4,\r\n        marginRight: 1,\r\n    },\r\n    itemView_selected: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n        background: `#292a2d`,\r\n        // alignSelf: `flex-start`,\r\n        padding: 4,\r\n        marginRight: 1,\r\n    },\r\n    itemText: {\r\n        fontSize: 14,\r\n    },\r\n    itemText_selected: {\r\n        fontSize: 14,\r\n        color: `#FFFF88`,\r\n    },\r\n    // headerTabView: {\r\n    //     flexDirection: `row`,\r\n    //     alignItems: `center`,\r\n    //     // background: `#1e1e1e`,\r\n    //     // alignSelf: `flex-start`,\r\n    //     padding: 4,\r\n    //     marginRight: 1,\r\n    // },\r\n    // headerTabText: {\r\n    //     fontSize: 14,\r\n    // },\r\n    // moveButtonView: {\r\n    //     minWidth: 24,\r\n    //     justifyContents: `center`,\r\n    //     alignItems: `center`,\r\n    // },\r\n} as const;\r\n\r\nexport const LessonModuleNavigator = (props: { children: ReactNode, items: NavigatorItem[], activeItem?: NavigatorItem, onChange: (value: NavigatorItem) => void }) => {\r\n    const { items, activeItem } = props;\r\n\r\n    const hasLoadedHash = useRef(false);\r\n    const [isExpanded, setIsExpanded] = useState(true);\r\n    const [isNarrowScreen, setIsNarrowScreen] = useState(false);\r\n\r\n    const onLoad = (width: number) => {\r\n        const isNarrow = width < 600;\r\n        setIsNarrowScreen(isNarrow);\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (isNarrowScreen) {\r\n            setIsExpanded(false);\r\n        }\r\n    }, [isNarrowScreen]);\r\n\r\n    useEffect(() => {\r\n        if (!activeItem?.key) { return; }\r\n\r\n        if (!hasLoadedHash.current) {\r\n            hasLoadedHash.current = true;\r\n            // First Load\r\n            const hash = window.location.hash.substr(1);\r\n            const matchItem = props.items.find(x => x.key === hash);\r\n\r\n            console.log(`LessonModuleNavigator load`, { hash, matchItem });\r\n            if (matchItem) {\r\n                props.onChange(matchItem);\r\n                return;\r\n            }\r\n        }\r\n\r\n        window.history.replaceState(null, activeItem?.label ?? ``, `#${activeItem?.key ?? ``}`);\r\n    }, [activeItem]);\r\n\r\n    const changeItem = (item: typeof items[0]) => {\r\n        props.onChange(item);\r\n    };\r\n\r\n    if (!isExpanded && activeItem) {\r\n        return (\r\n            <>\r\n                <TouchableOpacity onPress={() => setIsExpanded(() => true)}>\r\n                    <View style={navigatorStyles.itemView_header}>\r\n                        <Text style={navigatorStyles.itemText_selected}>{`${` `}Lesson Navigation`}</Text>\r\n                    </View>\r\n                    <View style={navigatorStyles.itemsContainer}>\r\n                        <View style={navigatorStyles.itemView_selected}>\r\n                            <Text style={navigatorStyles.itemText_selected}>{`${` `}${activeItem.label}`}</Text>\r\n                        </View>\r\n                    </View>\r\n                </TouchableOpacity>\r\n                {props.children}\r\n            </>\r\n        );\r\n    }\r\n\r\n\r\n    return (\r\n        <>\r\n            <div onLoad={(e) => { onLoad((e.target as HTMLDivElement).clientWidth); }}>\r\n                <View style={navigatorStyles.outerContainer}>\r\n                    <View style={navigatorStyles.container}>\r\n                        <TouchableOpacity onPress={() => setIsExpanded(() => false)}>\r\n                            <View style={navigatorStyles.itemView_header}>\r\n                                <Text style={navigatorStyles.itemText_selected}>{`${` `}Lesson Navigation`}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                        <View style={navigatorStyles.itemsContainer}>\r\n                            {items.map(x => (\r\n                                <TouchableOpacity key={x.key} onPress={() => { if (isNarrowScreen) { setIsExpanded(() => false); } if (x.key === activeItem?.key) { return; } changeItem(x); }}>\r\n                                    <View style={x.key === activeItem?.key ? navigatorStyles.itemView_selected : navigatorStyles.itemView}>\r\n                                        <Text style={x.key === activeItem?.key ? navigatorStyles.itemText_selected : navigatorStyles.itemText}>{`${x.key === activeItem?.key ? ` ` : ``}${x.label}`}</Text>\r\n                                    </View>\r\n                                </TouchableOpacity>\r\n                            ))}\r\n                        </View>\r\n                    </View>\r\n                    <View style={navigatorStyles.contentContainer}>\r\n                        {props.children}\r\n                    </View>\r\n                </View>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import setPrototypeOf from \"./setPrototypeOf\";\nimport isNativeReflectConstruct from \"./isNativeReflectConstruct\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","import getPrototypeOf from \"./getPrototypeOf\";\nimport setPrototypeOf from \"./setPrototypeOf\";\nimport isNativeFunction from \"./isNativeFunction\";\nimport construct from \"./construct\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","import { ApiError } from './error';\r\n\r\nexport function fetchWithTimeout(url: string, options: RequestInit, timeoutMs = 10000): Promise<Response> {\r\n    return Promise.race([\r\n        fetch(url, options),\r\n        new Promise((resolve, reject) =>\r\n            setTimeout(() => reject(new ApiError(`Fetch Timeout`)), timeoutMs),\r\n        ) as Promise<Response>,\r\n    ]);\r\n}\r\n\r\nexport async function webRequest(url: string, data: unknown, options?: { method?: 'POST' | 'PUT', timeoutMs?: number }) {\r\n\r\n    const body = JSON.stringify(data);\r\n    const reqData: RequestInit = {\r\n        method: options?.method ?? `POST`,\r\n        headers: {\r\n            'Accept': `application/json`,\r\n            'Content-Type': `application/json`,\r\n            'Content-Length': `${body.length}`,\r\n        },\r\n        body,\r\n    };\r\n    const result = await fetchWithTimeout(url, reqData, options?.timeoutMs).catch((error) => { throw new ApiError(`Request Failure`, { url, data, error }); });\r\n    if (!result.ok) {\r\n        throw new ApiError(`Api Error`, { data: (await result.json().catch(error => {/* Ignore Parse Error */ })) ?? {}, responseStatus: result.status, request: { url, data } });\r\n    }\r\n    const resultObj = await result.json().catch((error) => { throw new ApiError(`Request Parse Failure`, { url, data, error }); });\r\n    return resultObj;\r\n}\r\n","\"use strict\"; // Updated from commit 46d1426 - vscode/src/vs/editor/common/diff/diffComputer.ts\n\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar diff_1 = require(\"./diff\");\n\nvar strings = require(\"./strings\");\n\nvar MAXIMUM_RUN_TIME = 5000; // 5 seconds\n\nvar MINIMUM_MATCHING_CHARACTER_LENGTH = 3;\n\nfunction computeDiff(originalSequence, modifiedSequence, continueProcessingPredicate, pretty) {\n  var diffAlgo = new diff_1.LcsDiff(originalSequence, modifiedSequence, continueProcessingPredicate);\n  return diffAlgo.ComputeDiff(pretty);\n}\n\nvar LineMarkerSequence =\n/** @class */\nfunction () {\n  function LineMarkerSequence(lines) {\n    var startColumns = [];\n    var endColumns = [];\n\n    for (var i = 0, length_1 = lines.length; i < length_1; i++) {\n      startColumns[i] = LineMarkerSequence._getFirstNonBlankColumn(lines[i], 1);\n      endColumns[i] = LineMarkerSequence._getLastNonBlankColumn(lines[i], 1);\n    }\n\n    this._lines = lines;\n    this._startColumns = startColumns;\n    this._endColumns = endColumns;\n  }\n\n  LineMarkerSequence.prototype.getLength = function () {\n    return this._lines.length;\n  };\n\n  LineMarkerSequence.prototype.getElementAtIndex = function (i) {\n    return this._lines[i].substring(this._startColumns[i] - 1, this._endColumns[i] - 1);\n  };\n\n  LineMarkerSequence.prototype.getStartLineNumber = function (i) {\n    return i + 1;\n  };\n\n  LineMarkerSequence.prototype.getStartColumn = function (i) {\n    return this._startColumns[i];\n  };\n\n  LineMarkerSequence.prototype.getEndLineNumber = function (i) {\n    return i + 1;\n  };\n\n  LineMarkerSequence.prototype.getEndColumn = function (i) {\n    return this._endColumns[i];\n  };\n\n  LineMarkerSequence._getFirstNonBlankColumn = function (txt, defaultValue) {\n    var r = strings.firstNonWhitespaceIndex(txt);\n\n    if (r === -1) {\n      return defaultValue;\n    }\n\n    return r + 1;\n  };\n\n  LineMarkerSequence._getLastNonBlankColumn = function (txt, defaultValue) {\n    var r = strings.lastNonWhitespaceIndex(txt);\n\n    if (r === -1) {\n      return defaultValue;\n    }\n\n    return r + 2;\n  };\n\n  LineMarkerSequence.prototype.getCharSequence = function (shouldIgnoreTrimWhitespace, startIndex, endIndex) {\n    var charCodes = [];\n    var lineNumbers = [];\n    var columns = [];\n    var len = 0;\n\n    for (var index = startIndex; index <= endIndex; index++) {\n      var lineContent = this._lines[index];\n      var startColumn = shouldIgnoreTrimWhitespace ? this._startColumns[index] : 1;\n      var endColumn = shouldIgnoreTrimWhitespace ? this._endColumns[index] : lineContent.length + 1;\n\n      for (var col = startColumn; col < endColumn; col++) {\n        charCodes[len] = lineContent.charCodeAt(col - 1);\n        lineNumbers[len] = index + 1;\n        columns[len] = col;\n        len++;\n      }\n    }\n\n    return new CharSequence(charCodes, lineNumbers, columns);\n  };\n\n  return LineMarkerSequence;\n}();\n\nvar CharSequence =\n/** @class */\nfunction () {\n  function CharSequence(charCodes, lineNumbers, columns) {\n    this._charCodes = charCodes;\n    this._lineNumbers = lineNumbers;\n    this._columns = columns;\n  }\n\n  CharSequence.prototype.getLength = function () {\n    return this._charCodes.length;\n  };\n\n  CharSequence.prototype.getElementAtIndex = function (i) {\n    return this._charCodes[i];\n  };\n\n  CharSequence.prototype.getStartLineNumber = function (i) {\n    return this._lineNumbers[i];\n  };\n\n  CharSequence.prototype.getStartColumn = function (i) {\n    return this._columns[i];\n  };\n\n  CharSequence.prototype.getEndLineNumber = function (i) {\n    return this._lineNumbers[i];\n  };\n\n  CharSequence.prototype.getEndColumn = function (i) {\n    return this._columns[i] + 1;\n  };\n\n  return CharSequence;\n}();\n\nvar CharChange =\n/** @class */\nfunction () {\n  function CharChange(originalStartLineNumber, originalStartColumn, originalEndLineNumber, originalEndColumn, modifiedStartLineNumber, modifiedStartColumn, modifiedEndLineNumber, modifiedEndColumn) {\n    this.originalStartLineNumber = originalStartLineNumber;\n    this.originalStartColumn = originalStartColumn;\n    this.originalEndLineNumber = originalEndLineNumber;\n    this.originalEndColumn = originalEndColumn;\n    this.modifiedStartLineNumber = modifiedStartLineNumber;\n    this.modifiedStartColumn = modifiedStartColumn;\n    this.modifiedEndLineNumber = modifiedEndLineNumber;\n    this.modifiedEndColumn = modifiedEndColumn;\n  }\n\n  CharChange.createFromDiffChange = function (diffChange, originalCharSequence, modifiedCharSequence) {\n    var originalStartLineNumber;\n    var originalStartColumn;\n    var originalEndLineNumber;\n    var originalEndColumn;\n    var modifiedStartLineNumber;\n    var modifiedStartColumn;\n    var modifiedEndLineNumber;\n    var modifiedEndColumn;\n\n    if (diffChange.originalLength === 0) {\n      originalStartLineNumber = 0;\n      originalStartColumn = 0;\n      originalEndLineNumber = 0;\n      originalEndColumn = 0;\n    } else {\n      originalStartLineNumber = originalCharSequence.getStartLineNumber(diffChange.originalStart);\n      originalStartColumn = originalCharSequence.getStartColumn(diffChange.originalStart);\n      originalEndLineNumber = originalCharSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\n      originalEndColumn = originalCharSequence.getEndColumn(diffChange.originalStart + diffChange.originalLength - 1);\n    }\n\n    if (diffChange.modifiedLength === 0) {\n      modifiedStartLineNumber = 0;\n      modifiedStartColumn = 0;\n      modifiedEndLineNumber = 0;\n      modifiedEndColumn = 0;\n    } else {\n      modifiedStartLineNumber = modifiedCharSequence.getStartLineNumber(diffChange.modifiedStart);\n      modifiedStartColumn = modifiedCharSequence.getStartColumn(diffChange.modifiedStart);\n      modifiedEndLineNumber = modifiedCharSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n      modifiedEndColumn = modifiedCharSequence.getEndColumn(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n    }\n\n    return new CharChange(originalStartLineNumber, originalStartColumn, originalEndLineNumber, originalEndColumn, modifiedStartLineNumber, modifiedStartColumn, modifiedEndLineNumber, modifiedEndColumn);\n  };\n\n  return CharChange;\n}();\n\nfunction postProcessCharChanges(rawChanges) {\n  if (rawChanges.length <= 1) {\n    return rawChanges;\n  }\n\n  var result = [rawChanges[0]];\n  var prevChange = result[0];\n\n  for (var i = 1, len = rawChanges.length; i < len; i++) {\n    var currChange = rawChanges[i];\n    var originalMatchingLength = currChange.originalStart - (prevChange.originalStart + prevChange.originalLength);\n    var modifiedMatchingLength = currChange.modifiedStart - (prevChange.modifiedStart + prevChange.modifiedLength); // Both of the above should be equal, but the continueProcessingPredicate may prevent this from being true\n\n    var matchingLength = Math.min(originalMatchingLength, modifiedMatchingLength);\n\n    if (matchingLength < MINIMUM_MATCHING_CHARACTER_LENGTH) {\n      // Merge the current change into the previous one\n      prevChange.originalLength = currChange.originalStart + currChange.originalLength - prevChange.originalStart;\n      prevChange.modifiedLength = currChange.modifiedStart + currChange.modifiedLength - prevChange.modifiedStart;\n    } else {\n      // Add the current change\n      result.push(currChange);\n      prevChange = currChange;\n    }\n  }\n\n  return result;\n}\n\nvar LineChange =\n/** @class */\nfunction () {\n  function LineChange(originalStartLineNumber, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber, charChanges) {\n    this.originalStartLineNumber = originalStartLineNumber;\n    this.originalEndLineNumber = originalEndLineNumber;\n    this.modifiedStartLineNumber = modifiedStartLineNumber;\n    this.modifiedEndLineNumber = modifiedEndLineNumber;\n    this.charChanges = charChanges;\n  }\n\n  LineChange.createFromDiffResult = function (shouldIgnoreTrimWhitespace, diffChange, originalLineSequence, modifiedLineSequence, continueProcessingPredicate, shouldComputeCharChanges, shouldPostProcessCharChanges) {\n    var originalStartLineNumber;\n    var originalEndLineNumber;\n    var modifiedStartLineNumber;\n    var modifiedEndLineNumber;\n    var charChanges = undefined;\n\n    if (diffChange.originalLength === 0) {\n      originalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart) - 1;\n      originalEndLineNumber = 0;\n    } else {\n      originalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart);\n      originalEndLineNumber = originalLineSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\n    }\n\n    if (diffChange.modifiedLength === 0) {\n      modifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart) - 1;\n      modifiedEndLineNumber = 0;\n    } else {\n      modifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart);\n      modifiedEndLineNumber = modifiedLineSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\n    }\n\n    if (shouldComputeCharChanges && diffChange.originalLength !== 0 && diffChange.modifiedLength !== 0 && continueProcessingPredicate()) {\n      var originalCharSequence = originalLineSequence.getCharSequence(shouldIgnoreTrimWhitespace, diffChange.originalStart, diffChange.originalStart + diffChange.originalLength - 1);\n      var modifiedCharSequence = modifiedLineSequence.getCharSequence(shouldIgnoreTrimWhitespace, diffChange.modifiedStart, diffChange.modifiedStart + diffChange.modifiedLength - 1);\n      var rawChanges = computeDiff(originalCharSequence, modifiedCharSequence, continueProcessingPredicate, true);\n\n      if (shouldPostProcessCharChanges) {\n        rawChanges = postProcessCharChanges(rawChanges);\n      }\n\n      charChanges = [];\n\n      for (var i = 0, length_2 = rawChanges.length; i < length_2; i++) {\n        charChanges.push(CharChange.createFromDiffChange(rawChanges[i], originalCharSequence, modifiedCharSequence));\n      }\n    }\n\n    return new LineChange(originalStartLineNumber, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber, charChanges);\n  };\n\n  return LineChange;\n}();\n\nvar DiffComputer =\n/** @class */\nfunction () {\n  function DiffComputer(originalLines, modifiedLines, opts) {\n    this.shouldComputeCharChanges = opts.shouldComputeCharChanges;\n    this.shouldPostProcessCharChanges = opts.shouldPostProcessCharChanges;\n    this.shouldIgnoreTrimWhitespace = opts.shouldIgnoreTrimWhitespace;\n    this.shouldMakePrettyDiff = opts.shouldMakePrettyDiff;\n    this.maximumRunTimeMs = MAXIMUM_RUN_TIME;\n    this.originalLines = originalLines;\n    this.modifiedLines = modifiedLines;\n    this.original = new LineMarkerSequence(originalLines);\n    this.modified = new LineMarkerSequence(modifiedLines);\n  }\n\n  DiffComputer.prototype.computeDiff = function () {\n    if (this.original.getLength() === 1 && this.original.getElementAtIndex(0).length === 0) {\n      // empty original => fast path\n      return [{\n        originalStartLineNumber: 1,\n        originalEndLineNumber: 1,\n        modifiedStartLineNumber: 1,\n        modifiedEndLineNumber: this.modified.getLength(),\n        charChanges: [{\n          modifiedEndColumn: 0,\n          modifiedEndLineNumber: 0,\n          modifiedStartColumn: 0,\n          modifiedStartLineNumber: 0,\n          originalEndColumn: 0,\n          originalEndLineNumber: 0,\n          originalStartColumn: 0,\n          originalStartLineNumber: 0\n        }]\n      }];\n    }\n\n    if (this.modified.getLength() === 1 && this.modified.getElementAtIndex(0).length === 0) {\n      // empty modified => fast path\n      return [{\n        originalStartLineNumber: 1,\n        originalEndLineNumber: this.original.getLength(),\n        modifiedStartLineNumber: 1,\n        modifiedEndLineNumber: 1,\n        charChanges: [{\n          modifiedEndColumn: 0,\n          modifiedEndLineNumber: 0,\n          modifiedStartColumn: 0,\n          modifiedStartLineNumber: 0,\n          originalEndColumn: 0,\n          originalEndLineNumber: 0,\n          originalStartColumn: 0,\n          originalStartLineNumber: 0\n        }]\n      }];\n    }\n\n    this.computationStartTime = new Date().getTime();\n    var rawChanges = computeDiff(this.original, this.modified, this._continueProcessingPredicate.bind(this), this.shouldMakePrettyDiff); // The diff is always computed with ignoring trim whitespace\n    // This ensures we get the prettiest diff\n\n    if (this.shouldIgnoreTrimWhitespace) {\n      var lineChanges = [];\n\n      for (var i = 0, length_3 = rawChanges.length; i < length_3; i++) {\n        lineChanges.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, rawChanges[i], this.original, this.modified, this._continueProcessingPredicate.bind(this), this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\n      }\n\n      return lineChanges;\n    } // Need to post-process and introduce changes where the trim whitespace is different\n    // Note that we are looping starting at -1 to also cover the lines before the first change\n\n\n    var result = [];\n    var originalLineIndex = 0;\n    var modifiedLineIndex = 0;\n\n    for (var i = -1\n    /* !!!! */\n    , len = rawChanges.length; i < len; i++) {\n      var nextChange = i + 1 < len ? rawChanges[i + 1] : null;\n      var originalStop = nextChange ? nextChange.originalStart : this.originalLines.length;\n      var modifiedStop = nextChange ? nextChange.modifiedStart : this.modifiedLines.length;\n\n      while (originalLineIndex < originalStop && modifiedLineIndex < modifiedStop) {\n        var originalLine = this.originalLines[originalLineIndex];\n        var modifiedLine = this.modifiedLines[modifiedLineIndex];\n\n        if (originalLine !== modifiedLine) {\n          // These lines differ only in trim whitespace\n          // Check the leading whitespace\n          {\n            var originalStartColumn = LineMarkerSequence._getFirstNonBlankColumn(originalLine, 1);\n\n            var modifiedStartColumn = LineMarkerSequence._getFirstNonBlankColumn(modifiedLine, 1);\n\n            while (originalStartColumn > 1 && modifiedStartColumn > 1) {\n              var originalChar = originalLine.charCodeAt(originalStartColumn - 2);\n              var modifiedChar = modifiedLine.charCodeAt(modifiedStartColumn - 2);\n\n              if (originalChar !== modifiedChar) {\n                break;\n              }\n\n              originalStartColumn--;\n              modifiedStartColumn--;\n            }\n\n            if (originalStartColumn > 1 || modifiedStartColumn > 1) {\n              this._pushTrimWhitespaceCharChange(result, originalLineIndex + 1, 1, originalStartColumn, modifiedLineIndex + 1, 1, modifiedStartColumn);\n            }\n          } // Check the trailing whitespace\n\n          {\n            var originalEndColumn = LineMarkerSequence._getLastNonBlankColumn(originalLine, 1);\n\n            var modifiedEndColumn = LineMarkerSequence._getLastNonBlankColumn(modifiedLine, 1);\n\n            var originalMaxColumn = originalLine.length + 1;\n            var modifiedMaxColumn = modifiedLine.length + 1;\n\n            while (originalEndColumn < originalMaxColumn && modifiedEndColumn < modifiedMaxColumn) {\n              var originalChar = originalLine.charCodeAt(originalEndColumn - 1);\n              var modifiedChar = originalLine.charCodeAt(modifiedEndColumn - 1);\n\n              if (originalChar !== modifiedChar) {\n                break;\n              }\n\n              originalEndColumn++;\n              modifiedEndColumn++;\n            }\n\n            if (originalEndColumn < originalMaxColumn || modifiedEndColumn < modifiedMaxColumn) {\n              this._pushTrimWhitespaceCharChange(result, originalLineIndex + 1, originalEndColumn, originalMaxColumn, modifiedLineIndex + 1, modifiedEndColumn, modifiedMaxColumn);\n            }\n          }\n        }\n\n        originalLineIndex++;\n        modifiedLineIndex++;\n      }\n\n      if (nextChange) {\n        // Emit the actual change\n        result.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, nextChange, this.original, this.modified, this._continueProcessingPredicate.bind(this), this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\n        originalLineIndex += nextChange.originalLength;\n        modifiedLineIndex += nextChange.modifiedLength;\n      }\n    }\n\n    return result;\n  };\n\n  DiffComputer.prototype._pushTrimWhitespaceCharChange = function (result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn) {\n    if (this._mergeTrimWhitespaceCharChange(result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn)) {\n      // Merged into previous\n      return;\n    }\n\n    var charChanges = undefined;\n\n    if (this.shouldComputeCharChanges) {\n      charChanges = [new CharChange(originalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn)];\n    }\n\n    result.push(new LineChange(originalLineNumber, originalLineNumber, modifiedLineNumber, modifiedLineNumber, charChanges));\n  };\n\n  DiffComputer.prototype._mergeTrimWhitespaceCharChange = function (result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn) {\n    var len = result.length;\n\n    if (len === 0) {\n      return false;\n    }\n\n    var prevChange = result[len - 1];\n\n    if (prevChange.originalEndLineNumber === 0 || prevChange.modifiedEndLineNumber === 0) {\n      // Don't merge with inserts/deletes\n      return false;\n    }\n\n    if (prevChange.originalEndLineNumber + 1 === originalLineNumber && prevChange.modifiedEndLineNumber + 1 === modifiedLineNumber) {\n      prevChange.originalEndLineNumber = originalLineNumber;\n      prevChange.modifiedEndLineNumber = modifiedLineNumber;\n\n      if (this.shouldComputeCharChanges) {\n        prevChange.charChanges.push(new CharChange(originalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn));\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  DiffComputer.prototype._continueProcessingPredicate = function () {\n    if (this.maximumRunTimeMs === 0) {\n      return true;\n    }\n\n    var now = new Date().getTime();\n    return now - this.computationStartTime < this.maximumRunTimeMs;\n  };\n\n  return DiffComputer;\n}();\n\nexports.DiffComputer = DiffComputer;","import { distinct_key } from 'utils/arrays';\r\nimport { StringSpan } from 'utils/string-span';\r\nimport { IDiffComputerOpts, DiffComputer, ILineChange } from 'vscode-diff';\r\n\r\nconst getSpanRange = (v: { span: StringSpan, lineSpans: StringSpan[], startLine: number, endLine: number, startColumn?: number, endColumn?: number, otherAtStart: boolean, otherAtEnd: boolean }) => {\r\n    const afterLine = v.endLine === 0; // || v.endColumn === 0;\r\n    if (afterLine) {\r\n        const atStart = v.startLine === 0 && v.otherAtStart;\r\n        if (atStart) {\r\n            const cStart = 0;\r\n            const cAfterEnd = 0;\r\n            const cChange = v.span.newRange(cStart, cAfterEnd - cStart);\r\n            return {\r\n                start: cStart,\r\n                afterEnd: cAfterEnd,\r\n                change: cChange,\r\n                span: v.span,\r\n                lineSpans: v.lineSpans,\r\n            };\r\n        }\r\n\r\n        const atEnd = v.startLine === 0 && v.otherAtEnd;\r\n        if (atEnd) {\r\n            const cStart = v.span.length;\r\n            const cAfterEnd = cStart;\r\n            const cChange = v.span.newRange(cStart, cAfterEnd - cStart);\r\n            return {\r\n                start: cStart,\r\n                afterEnd: cAfterEnd,\r\n                change: cChange,\r\n                span: v.span,\r\n                lineSpans: v.lineSpans,\r\n            };\r\n        }\r\n\r\n        // After line\r\n        const cStart = v.startLine >= v.lineSpans.length ? v.span.length : v.lineSpans[v.startLine].start;\r\n        const cAfterEnd = cStart;\r\n        const cChange = v.span.newRange(cStart, cAfterEnd - cStart);\r\n        return {\r\n            start: cStart,\r\n            afterEnd: cAfterEnd,\r\n            change: cChange,\r\n            span: v.span,\r\n            lineSpans: v.lineSpans,\r\n        };\r\n    }\r\n\r\n    // Whole lines\r\n    if (!v.startColumn || !v.endColumn) {\r\n        const cStart = v.startLine <= 1 ? 0\r\n            // Start of this line\r\n            : v.lineSpans[v.startLine - 1].start;\r\n\r\n        const cAfterEnd = v.endLine > v.lineSpans.length ? v.span.length\r\n            // End of this line\r\n            : v.lineSpans[v.endLine - 1].start + v.lineSpans[v.endLine - 1].length;\r\n\r\n        const cChange = v.span.newRange(cStart, cAfterEnd - cStart);\r\n        return {\r\n            start: cStart,\r\n            afterEnd: cAfterEnd,\r\n            change: cChange,\r\n            span: v.span,\r\n            lineSpans: v.lineSpans,\r\n        };\r\n    }\r\n\r\n    // Char Range\r\n    const start = v.lineSpans[v.startLine - 1].start + v.startColumn - 1;\r\n    const afterEnd = v.lineSpans[v.endLine - 1].start + v.endColumn - 1;\r\n    const change = v.span.newRange(start, afterEnd - start);\r\n\r\n    return {\r\n        start,\r\n        afterEnd,\r\n        change,\r\n        span: v.span,\r\n        lineSpans: v.lineSpans,\r\n    };\r\n};\r\n\r\nexport const diff = (a: string, b: string) => {\r\n    const aSpan = new StringSpan(a);\r\n    const bSpan = new StringSpan(b);\r\n    const aLineSpans = aSpan.splitOnRegExp(/\\n/g).map((x, i) => i === 0 ? x.transform(0, 1) : x.transform(1, 1));\r\n    const bLineSpans = bSpan.splitOnRegExp(/\\n/g).map((x, i) => i === 0 ? x.transform(0, 1) : x.transform(1, 1));\r\n    const options: IDiffComputerOpts = {\r\n        shouldPostProcessCharChanges: true,\r\n        shouldIgnoreTrimWhitespace: false,\r\n        shouldMakePrettyDiff: true,\r\n        shouldComputeCharChanges: true,\r\n\r\n        // maxComputationTime: 0, // time in milliseconds, 0 => no computation limit.\r\n    };\r\n    const diffComputer = new DiffComputer(aLineSpans.map(x => x.toText()), bLineSpans.map(x => x.toText()), options);\r\n    const lineChanges: ILineChange[] = diffComputer.computeDiff();\r\n\r\n    type LineCharChange = {\r\n        line: {\r\n            readonly originalStartLineNumber: number;\r\n            readonly originalEndLineNumber: number;\r\n            readonly modifiedStartLineNumber: number;\r\n            readonly modifiedEndLineNumber: number;\r\n        };\r\n        readonly originalStartLineNumber: number;\r\n        readonly originalEndLineNumber: number;\r\n        readonly modifiedStartLineNumber: number;\r\n        readonly modifiedEndLineNumber: number;\r\n        readonly originalStartColumn?: number;\r\n        readonly originalEndColumn?: number;\r\n        readonly modifiedStartColumn?: number;\r\n        readonly modifiedEndColumn?: number;\r\n    };\r\n    const charChanges = lineChanges\r\n        .flatMap(x => x.charChanges?.map(c => ({\r\n            line: x,\r\n            ...c,\r\n            // ...x,\r\n        })) as LineCharChange[] ?? [{\r\n            line: x,\r\n            ...x,\r\n            originalStartColumn: undefined,\r\n            originalEndColumn: undefined,\r\n            modifiedStartColumn: undefined,\r\n            modifiedEndColumn: undefined,\r\n        }]);\r\n\r\n    console.log(`diff`, { charChanges, lineChanges, aSpan, bSpan });\r\n\r\n    const changes = charChanges\r\n        .map(x => {\r\n            if (x.originalStartColumn === 0 && x.originalEndColumn === 0\r\n                || x.modifiedStartColumn === 0 && x.modifiedEndColumn === 0) {\r\n                // Whole Line\r\n                return {\r\n                    ...x,\r\n                    a: getSpanRange({\r\n                        span: aSpan,\r\n                        lineSpans: aLineSpans,\r\n                        startLine: x.line.originalStartLineNumber,\r\n                        endLine: x.line.originalEndLineNumber,\r\n                        startColumn: undefined,\r\n                        endColumn: undefined,\r\n                        otherAtStart: x.modifiedStartLineNumber <= 1 && (x.modifiedStartColumn ?? 1) === 1,\r\n                        otherAtEnd: x.modifiedStartLineNumber >= bLineSpans.length,\r\n                    }),\r\n                    b: getSpanRange({\r\n                        span: bSpan,\r\n                        lineSpans: bLineSpans,\r\n                        startLine: x.line.modifiedStartLineNumber,\r\n                        endLine: x.line.modifiedEndLineNumber,\r\n                        startColumn: undefined,\r\n                        endColumn: undefined,\r\n                        otherAtStart: x.originalStartLineNumber <= 1 && (x.originalStartColumn ?? 1) === 1,\r\n                        otherAtEnd: x.originalStartLineNumber >= aLineSpans.length,\r\n                    }),\r\n                };\r\n            }\r\n\r\n            const aSpanRange = getSpanRange({\r\n                span: aSpan,\r\n                lineSpans: aLineSpans,\r\n                startLine: x.originalStartLineNumber,\r\n                endLine: x.originalEndLineNumber,\r\n                startColumn: x.originalStartColumn,\r\n                endColumn: x.originalEndColumn,\r\n                otherAtStart: x.modifiedStartLineNumber <= 1 && (x.modifiedStartColumn ?? 1) === 1,\r\n                otherAtEnd: x.modifiedStartLineNumber >= bLineSpans.length,\r\n            });\r\n            const bSpanRange = getSpanRange({\r\n                span: bSpan,\r\n                lineSpans: bLineSpans,\r\n                startLine: x.modifiedStartLineNumber,\r\n                endLine: x.modifiedEndLineNumber,\r\n                startColumn: x.modifiedStartColumn,\r\n                endColumn: x.modifiedEndColumn,\r\n                otherAtStart: x.originalStartLineNumber <= 1 && (x.originalStartColumn ?? 1) === 1,\r\n                otherAtEnd: x.originalStartLineNumber >= aLineSpans.length,\r\n            });\r\n\r\n            return {\r\n                ...x,\r\n                a: aSpanRange,\r\n                b: bSpanRange,\r\n            };\r\n        });\r\n\r\n    return {\r\n        changes: distinct_key(changes, x => `${x.a.change.start}:${x.a.change.length}=>${x.b.change.start}:${x.b.change.length}`),\r\n    };\r\n};\r\n","import { diff } from './diff';\r\nimport { calculateFilesHashCode } from './lesson-hash';\r\nimport { LessonProjectState, LessonExperimentReplacement } from './lesson-types';\r\n\r\nexport const lessonExperiments_createReplacementProjectState = (projectState: LessonProjectState, replacements: LessonExperimentReplacement[]): LessonProjectState => {\r\n    const files = projectState.files.map(x => {\r\n        const file = { ...x };\r\n        replacements\r\n            .filter(r => r.selection.filePath === x.path)\r\n            // Apply replacements from end so the index will be valid\r\n            .sort((a, b) => - (a.selection.index - b.selection.index))\r\n            .forEach(r => { file.content = `${file.content.substr(0, r.selection.index)}${r.content}${file.content.substr(r.selection.index + r.selection.length)}`; });\r\n        return file;\r\n    });\r\n\r\n    const finalProjectState: LessonProjectState = {\r\n        files,\r\n        filesHashCode: calculateFilesHashCode(files),\r\n    };\r\n\r\n    console.log(`lessonExperiments_createReplacementProjectState`, finalProjectState, projectState, replacements);\r\n    return finalProjectState;\r\n};\r\nexport const lessonExperiments_calculateProjectStateReplacements = (projectState: LessonProjectState, newProjectState: LessonProjectState): { replacements: LessonExperimentReplacement[] } => {\r\n\r\n    const replacements = projectState.files.map(x => ({\r\n        oldFile: x,\r\n        newFile: newProjectState.files.find(f => f.path === x.path),\r\n    }))\r\n        .filter(x => x.newFile)\r\n        .map(x => ({\r\n            filePath: x.oldFile.path,\r\n            changes: diff(x.oldFile.content, x.newFile?.content ?? ``).changes,\r\n        }))\r\n        .flatMap(x => x.changes.map(c => ({\r\n            filePath: x.filePath,\r\n            change: c,\r\n        })))\r\n        .map(x => ({\r\n            // _change: x.change,\r\n            selection: { filePath: x.filePath, index: x.change.a.change.start, length: x.change.a.change.length },\r\n            content: (x.change.b?.change.length ?? 0) === 0 ? `` : x.change.b?.change.toText() ?? ``,\r\n        }));\r\n\r\n    console.log(`lessonExperiments_calculateProjectStateReplacements`, replacements, projectState, newProjectState);\r\n    return { replacements };\r\n};\r\n\r\n\r\n// const runTests = () => {\r\n//     const testRoundTrip = (fileStart: string, fileEnd: string) => {\r\n//         console.log(`testRoundTrip`, { fileStart, fileEnd });\r\n\r\n//         const projectStart: LessonProjectState = {\r\n//             files: [{ content: fileStart, language: `tsx`, path: `./test.tsx` }],\r\n//         };\r\n//         const projectEnd: LessonProjectState = {\r\n//             files: [{ content: fileEnd, language: `tsx`, path: `./test.tsx` }],\r\n//         };\r\n//         const { replacements } = lessonExperiments_calculateProjectStateReplacements(projectStart, projectEnd);\r\n//         const actualProjectEnd = lessonExperiments_createReplacementProjectState(projectStart, replacements);\r\n\r\n//         if (fileEnd === actualProjectEnd.files[0].content) {\r\n//             console.log(`PASS`, { expected: fileEnd, actual: actualProjectEnd.files[0].content });\r\n//             return true;\r\n//         }\r\n\r\n//         console.error(`FAIL`, { expected: fileEnd, actual: actualProjectEnd.files[0].content });\r\n//         return false;\r\n//     };\r\n\r\n//     let failCount = 0;\r\n//     failCount += !testRoundTrip(`Test`, `Test`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test\\r\\n`, `Test\\r\\n`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test`, `123`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test\\r\\n`, `Test`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test`, `Test\\r\\n`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`A\\r\\nTest\\r\\n123\\r\\nB`, `A\\r\\n123\\r\\nTest\\r\\nB`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test`, `123\\r\\nTest`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test`, `Test\\r\\n123`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`123\\r\\nTest`, `Test`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test\\r\\n123`, `Test`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test\\n123`, `123\\nTest`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test`, `123\\nTest`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test`, `Test\\n123`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`123\\nTest`, `Test`) ? 1 : 0;\r\n//     failCount += !testRoundTrip(`Test\\n123`, `Test`) ? 1 : 0;\r\n\r\n//     console.log(`FailCount`, { failCount });\r\n//     const breakdance = true;\r\n// };\r\n// runTests();\r\n","!function (r, t) {\n  \"object\" == typeof exports && \"undefined\" != typeof module ? module.exports = t() : \"function\" == typeof define && define.amd ? define(t) : r.dayjs_plugin_relativeTime = t();\n}(this, function () {\n  \"use strict\";\n\n  return function (r, t, e) {\n    r = r || {};\n    var n = t.prototype,\n        o = {\n      future: \"in %s\",\n      past: \"%s ago\",\n      s: \"a few seconds\",\n      m: \"a minute\",\n      mm: \"%d minutes\",\n      h: \"an hour\",\n      hh: \"%d hours\",\n      d: \"a day\",\n      dd: \"%d days\",\n      M: \"a month\",\n      MM: \"%d months\",\n      y: \"a year\",\n      yy: \"%d years\"\n    };\n    e.en.relativeTime = o;\n\n    var d = function d(t, n, _d, i) {\n      for (var u, a, s, f = _d.$locale().relativeTime || o, l = r.thresholds || [{\n        l: \"s\",\n        r: 44,\n        d: \"second\"\n      }, {\n        l: \"m\",\n        r: 89\n      }, {\n        l: \"mm\",\n        r: 44,\n        d: \"minute\"\n      }, {\n        l: \"h\",\n        r: 89\n      }, {\n        l: \"hh\",\n        r: 21,\n        d: \"hour\"\n      }, {\n        l: \"d\",\n        r: 35\n      }, {\n        l: \"dd\",\n        r: 25,\n        d: \"day\"\n      }, {\n        l: \"M\",\n        r: 45\n      }, {\n        l: \"MM\",\n        r: 10,\n        d: \"month\"\n      }, {\n        l: \"y\",\n        r: 17\n      }, {\n        l: \"yy\",\n        d: \"year\"\n      }], h = l.length, m = 0; m < h; m += 1) {\n        var c = l[m];\n        c.d && (u = i ? e(t).diff(_d, c.d, !0) : _d.diff(t, c.d, !0));\n        var y = (r.rounding || Math.round)(Math.abs(u));\n\n        if (s = u > 0, y <= c.r || !c.r) {\n          y <= 1 && m > 0 && (c = l[m - 1]);\n          var p = f[c.l];\n          a = \"string\" == typeof p ? p.replace(\"%d\", y) : p(y, n, c.l, s);\n          break;\n        }\n      }\n\n      return n ? a : (s ? f.future : f.past).replace(\"%s\", a);\n    };\n\n    n.to = function (r, t) {\n      return d(r, t, this, !0);\n    }, n.from = function (r, t) {\n      return d(r, t, this);\n    };\n\n    var i = function i(r) {\n      return r.$u ? e.utc() : e();\n    };\n\n    n.toNow = function (r) {\n      return this.to(i(this), r);\n    }, n.fromNow = function (r) {\n      return this.from(i(this), r);\n    };\n  };\n});","var fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n","export const websocketsApiConfig = {\r\n    websocketsApiUrl: `wss://p4w1a7ysk8.execute-api.us-east-1.amazonaws.com/prod`,\r\n};\r\n","'use strict';\nvar $ = require('../internals/export');\nvar flattenIntoArray = require('../internals/flatten-into-array');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar aFunction = require('../internals/a-function');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\n// `Array.prototype.flatMap` method\n// https://github.com/tc39/proposal-flatMap\n$({ target: 'Array', proto: true }, {\n  flatMap: function flatMap(callbackfn /* , thisArg */) {\n    var O = toObject(this);\n    var sourceLen = toLength(O.length);\n    var A;\n    aFunction(callbackfn);\n    A = arraySpeciesCreate(O, 0);\n    A.length = flattenIntoArray(A, O, O, sourceLen, 0, 1, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n    return A;\n  }\n});\n","import React, { useState } from 'react';\r\nimport { View, Text, TouchableOpacity, Platform } from 'react-native-lite';\r\nimport { ProblemService } from '../problems/problems-service';\r\n\r\n\r\nconst subjectStyles = {\r\n    container: {\r\n        margin: 16,\r\n    },\r\n    header: {\r\n        view: {\r\n            margin: 4,\r\n        },\r\n        text: {\r\n            fontSize: 16,\r\n        },\r\n    },\r\n    section: {\r\n        view: {\r\n            margin: 4,\r\n            flexDirection: `row`,\r\n        },\r\n        text: {\r\n            fontSize: 16,\r\n        },\r\n    },\r\n} as const;\r\n\r\nexport type SubjectProblemService = {\r\n    getSections: () => { key: string, name: string, isComplete: boolean }[];\r\n    gotoSection: (section: { key: string }) => void;\r\n};\r\nexport const SubjectNavigator = (props: { problemService: SubjectProblemService, onOpen: () => void, onClose: () => void, onSubjectNavigation: () => void }) => {\r\n\r\n    const [isExpanded, setIsExpanded] = useState(false);\r\n    const toggle = () => {\r\n        if (!isExpanded) {\r\n            props.onOpen();\r\n        }\r\n        if (isExpanded) {\r\n            props.onClose();\r\n        }\r\n        setIsExpanded(s => !s);\r\n    };\r\n\r\n    return (\r\n        <View style={subjectStyles.container}>\r\n            <TouchableOpacity onPress={toggle}>\r\n                <View style={subjectStyles.header.view}>\r\n                    <Text style={subjectStyles.header.text}>Sections</Text>\r\n                </View>\r\n            </TouchableOpacity>\r\n            {isExpanded && (\r\n                <View>\r\n                    {props.problemService.getSections().map(s => (\r\n                        <TouchableOpacity key={s.key} onPress={() => {\r\n                            console.log(`SubjectNavigator onSection`, { s });\r\n                            props.problemService.gotoSection(s);\r\n                            props.onSubjectNavigation();\r\n                            props.onClose();\r\n                            setIsExpanded(false);\r\n                            if (Platform.OS === `web`) {\r\n                                window.scrollTo(0, 0);\r\n                            }\r\n                        }}>\r\n                            <View style={subjectStyles.section.view}>\r\n                                <Text style={subjectStyles.section.text}>{s.isComplete ? `` : ``}</Text>\r\n                                <Text style={subjectStyles.section.text}>{s.name}</Text>\r\n                            </View>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </View>\r\n            )}\r\n\r\n        </View>\r\n    );\r\n};\r\n","import { ProblemStateStorage, ProblemService } from './problems-service';\r\n\r\nexport const createProblemStateStorage = (storageKey: string): ProblemStateStorage => {\r\n    const storage: ProblemStateStorage = {\r\n        load: async <T>() => {\r\n            try {\r\n                return JSON.parse(localStorage.getItem(storageKey) ?? `error - NOT FOUND`) as T;\r\n            }\r\n            catch{\r\n                return null;\r\n            }\r\n        },\r\n        save: async (value) => {\r\n            localStorage.setItem(storageKey, JSON.stringify(value));\r\n        },\r\n    };\r\n    return storage;\r\n};\r\n\r\nexport const createAutoSavedProblemService = (problemSource: ProblemService, storageKey: string): ProblemService => {\r\n    const storage = createProblemStateStorage(storageKey);\r\n\r\n    // Load \r\n    (async () => await problemSource.load(storage))();\r\n\r\n    return {\r\n        ...problemSource,\r\n        recordAnswer: (problem, answer) => {\r\n            problemSource.recordAnswer(problem, answer);\r\n\r\n            if (problem.isLastOfSection) {\r\n                (async () => await problemSource.save(storage))();\r\n            }\r\n        },\r\n    };\r\n};\r\n","import { createUploadApiWebClient } from 'upload-api/client/web-client';\r\nimport { uploadApiConfig } from 'upload-api/client/config';\r\nimport { UploadUrl } from 'upload-api/client/types';\r\nimport { createUploader, downloadData } from 'upload-api/client/uploader';\r\nimport { AppError } from 'utils/error';\r\nimport { delay } from 'utils/delay';\r\nimport { error } from 'console';\r\n\r\nconst USER_DATA_SERVICE_STATE_KEY = `_USER_DATA_SERVICE_STATE`;\r\nexport type UserProfileInfo = {\r\n    key: string;\r\n    name: string;\r\n    emoji: string;\r\n    isActive: boolean;\r\n};\r\ntype UserProfileMetadata = {\r\n    name?: string;\r\n    emoji?: string;\r\n};\r\ntype UserProfileData = {\r\n    key: string;\r\n    name: string;\r\n    emoji?: string;\r\n    uploadUrl: UploadUrl;\r\n    lastUploadTimestamp?: number;\r\n};\r\ntype UserServiceState = {\r\n    userProfiles: UserProfileData[];\r\n    activeUserProfileKey: string;\r\n    changeTimestamp: number;\r\n};\r\ntype UserData = {\r\n    data: { [key: string]: null | string };\r\n    metadata?: UserProfileMetadata;\r\n    timestamp: number;\r\n};\r\n\r\nconst createUserDataService = () => {\r\n    const uploadApi = createUploadApiWebClient(uploadApiConfig);\r\n\r\n    const storage = {\r\n        getUserDataServiceState: (): null | UserServiceState => {\r\n            try {\r\n                return JSON.parse(localStorage.getItem(USER_DATA_SERVICE_STATE_KEY) ?? `NULL !{}`);\r\n            } catch{\r\n                return null;\r\n            }\r\n        },\r\n        setUserDataServiceState: (state: UserServiceState) => {\r\n            localStorage.setItem(USER_DATA_SERVICE_STATE_KEY, JSON.stringify(state));\r\n        },\r\n        getUserData: (): UserData => {\r\n            const state = storage.getUserDataServiceState();\r\n            const userState = state && state.userProfiles.find(x => x.key === state.activeUserProfileKey);\r\n            const data = {\r\n                data: {},\r\n                metadata: { name: userState?.name, emoji: userState?.emoji },\r\n                timestamp: Date.now(),\r\n            } as UserData;\r\n            const keys = Object.keys(localStorage).filter(x => !x.startsWith(`_`));\r\n            for (const k of keys) {\r\n                data.data[k] = localStorage.getItem(k);\r\n            }\r\n            return data;\r\n        },\r\n        clearUserData: () => {\r\n            // Remove all old data\r\n            const keys = Object.keys(localStorage).filter(x => !x.startsWith(`_`));\r\n            for (const k of keys) {\r\n                localStorage.removeItem(k);\r\n            }\r\n\r\n            // Load metadata\r\n            const state = storage.getUserDataServiceState();\r\n            if (!state) { return; }\r\n            state.userProfiles.forEach(x => { x.lastUploadTimestamp = undefined; });\r\n            storage.setUserDataServiceState(state);\r\n        },\r\n        setUserData: (userData: UserData) => {\r\n            storage.clearUserData();\r\n\r\n            // Set New data\r\n            for (const k of Object.keys(userData.data)) {\r\n                const val = userData.data[k];\r\n                if (!val) {\r\n                    localStorage.removeItem(k);\r\n                    return;\r\n                }\r\n                localStorage.setItem(k, val);\r\n            }\r\n\r\n            // Load metadata\r\n            const state = storage.getUserDataServiceState();\r\n            const userState = state && state.userProfiles.find(x => x.key === state.activeUserProfileKey);\r\n            if (!state || !userState) { return; }\r\n            userState.emoji = userData.metadata?.emoji ?? userState.emoji;\r\n            userState.name = userData.metadata?.name ?? userState.name;\r\n            userState.lastUploadTimestamp = userData.timestamp;\r\n            storage.setUserDataServiceState(state);\r\n        },\r\n    };\r\n\r\n    const getUserProfile = (userProfileKey: string) => {\r\n        const state = storage.getUserDataServiceState();\r\n        if (!state) { return null; }\r\n        return state.userProfiles.find(x => x.key === userProfileKey);\r\n    };\r\n    const getActiveUserProfile = () => {\r\n        const state = storage.getUserDataServiceState();\r\n        if (!state?.activeUserProfileKey) { return null; }\r\n        return state.userProfiles.find(x => x.key === state.activeUserProfileKey);\r\n    };\r\n\r\n    const uploadBackup = async (userState: UserProfileData, userData: UserData) => {\r\n        const uploadUrl = await uploadApi.createUploadUrl({ prefix: `backup/users/${userState.name}/${userState.uploadUrl.relativePath}/${Date.now()}` });\r\n        const uploader = createUploader(uploadUrl.uploadUrl);\r\n        await uploader.uploadData(userData);\r\n    };\r\n\r\n    const uploadWithAutoRenew = async (userProfileKey: string, userData: UserData) => {\r\n        const state = storage.getUserDataServiceState();\r\n        const userState = state && state.userProfiles.find(x => x.key === userProfileKey);\r\n        if (!state || !userState) { return; }\r\n\r\n        // Upload backup\r\n        await uploadBackup(userState, userData);\r\n\r\n        const upload = async () => {\r\n            const uploader = createUploader(userState.uploadUrl);\r\n            await uploader.uploadData(userData);\r\n        };\r\n\r\n        try {\r\n            // Try to upload\r\n            console.log(`uploadWithAutoRenew - Attempt 1`);\r\n            await upload();\r\n            console.log(`uploadWithAutoRenew - UPLOADED`);\r\n        } catch{\r\n            // Rewew and try again\r\n            console.log(`uploadWithAutoRenew - Attempt 2`);\r\n\r\n            const newUploarUrl = await uploadApi.renewUploadUrl({ uploadUrl: userState.uploadUrl });\r\n            userState.uploadUrl = newUploarUrl.uploadUrl;\r\n            storage.setUserDataServiceState(state);\r\n\r\n            await upload();\r\n\r\n            console.log(`uploadWithAutoRenew - UPLOADED AFTER RENEW`);\r\n        }\r\n    };\r\n\r\n    const updateUserProfileFromServer = async (userProfileKey: string) => {\r\n        console.log(`updateUserProfile`, { userProfileKey });\r\n        const state = storage.getUserDataServiceState();\r\n        const userState = state && state.userProfiles.find(x => x.key === userProfileKey);\r\n        if (!state || !userState) {\r\n            console.log(`updateUserProfile - NO USER STATE`, { userProfileKey });\r\n            return;\r\n        }\r\n\r\n        const userData = await downloadData(userState.uploadUrl.getUrl) as UserData;\r\n        if (!userData.timestamp || userData.timestamp <= (userState.lastUploadTimestamp ?? 0)) {\r\n            // Skip if not new\r\n            console.log(`updateUserProfile - NOT NEW`, { name: userState.name });\r\n            return;\r\n        }\r\n\r\n        console.log(`updateUserProfile - UPDATED USER PROFILE`, { name: userState.name });\r\n        userState.emoji = userData.metadata?.emoji ?? userState.emoji;\r\n        userState.name = userData.metadata?.name ?? userState.name;\r\n        userState.lastUploadTimestamp = userData.timestamp;\r\n        storage.setUserDataServiceState(state);\r\n\r\n        if (userState.key === state.activeUserProfileKey) {\r\n            console.log(`updateUserProfile - UPDATED ACTIVE USER DATA`, { name: userState.name });\r\n            storage.setUserData(userData);\r\n        }\r\n    };\r\n    const updateAllProfilesFromServer = async () => {\r\n        const state = storage.getUserDataServiceState();\r\n        if (!state) { return; }\r\n\r\n        for (const userState of state.userProfiles) {\r\n            try {\r\n                // eslint-disable-next-line no-await-in-loop\r\n                await updateUserProfileFromServer(userState.key);\r\n            } catch (error_) {\r\n                console.log(`updateAllProfiles - ERROR Updating user profile`, { error: error_ });\r\n            }\r\n        }\r\n    };\r\n\r\n    let isSetupStarted = false;\r\n    let isSetupDone = false;\r\n\r\n    const service = {\r\n        setup: async () => {\r\n            if (isSetupStarted) {\r\n                while (!isSetupDone) {\r\n                    // eslint-disable-next-line no-await-in-loop\r\n                    await delay(10);\r\n                }\r\n                return;\r\n            }\r\n            isSetupStarted = true;\r\n            const doSetup = async () => {\r\n                console.log(`UserDataService:setup`);\r\n\r\n                const a = getActiveUserProfile();\r\n                if (a) {\r\n                    await updateAllProfilesFromServer();\r\n                    return;\r\n                }\r\n\r\n                const state = storage.getUserDataServiceState();\r\n                if (state && state.userProfiles.length > 0) {\r\n                    state.activeUserProfileKey = state.userProfiles[0].key;\r\n                    storage.setUserDataServiceState(state);\r\n                    await updateAllProfilesFromServer();\r\n                    return;\r\n                }\r\n\r\n                const newUploadUrlResult = await uploadApi.createUploadUrl({ prefix: `users` });\r\n                const newState: UserServiceState = state ?? {\r\n                    userProfiles: [{\r\n                        key: newUploadUrlResult.uploadUrl.relativePath,\r\n                        name: `${`Player 1`}`,\r\n                        uploadUrl: newUploadUrlResult.uploadUrl,\r\n                    }],\r\n                    activeUserProfileKey: newUploadUrlResult.uploadUrl.relativePath,\r\n                    changeTimestamp: 0,\r\n                };\r\n                storage.setUserDataServiceState(newState);\r\n\r\n                // Upload initial data\r\n                await service.uploadUserData();\r\n            };\r\n\r\n            try {\r\n                await doSetup();\r\n                isSetupDone = true;\r\n            } catch (error_) {\r\n                // Setup Failed\r\n                isSetupDone = true;\r\n                throw error_;\r\n            }\r\n        },\r\n        getActiveUser: (): null | UserProfileInfo => {\r\n            const user = getActiveUserProfile();\r\n            if (!user) { return null; }\r\n            return {\r\n                key: user.key,\r\n                name: user.name,\r\n                emoji: user.emoji ?? ``,\r\n                isActive: true,\r\n            };\r\n        },\r\n        setActiveUser: async (userProfileKey: string) => {\r\n            console.log(`setActiveUser`, { userProfileKey });\r\n            const state = storage.getUserDataServiceState();\r\n            if (!state) { return; }\r\n\r\n            if (!state.userProfiles.find(x => x.key === userProfileKey)) {\r\n                console.log(`setActiveUser - User Profile Not Found`, { userProfileKey });\r\n                throw new AppError(`User Profile not found`);\r\n            }\r\n\r\n            // Don't upload old user data - the chance of this being out of date is high\r\n            // // Upload old user data\r\n            // await service.uploadUserData();\r\n\r\n            if (state.activeUserProfileKey !== userProfileKey) {\r\n                console.log(`setActiveUser - user changed - clearing state`);\r\n\r\n                state.activeUserProfileKey = userProfileKey;\r\n                state.changeTimestamp = 0;\r\n                storage.setUserDataServiceState(state);\r\n                storage.clearUserData();\r\n            }\r\n\r\n            console.log(`setActiveUser - before download`, { stateJson: JSON.stringify(storage.getUserDataServiceState()) });\r\n\r\n            // Download new user data\r\n            await service.downloadUserDataIfNewer();\r\n        },\r\n        getUserProfiles: async (): Promise<UserProfileInfo[]> => {\r\n            const state = storage.getUserDataServiceState();\r\n            if (!state?.activeUserProfileKey) { return []; }\r\n            return state.userProfiles.map(x => ({\r\n                key: x.key,\r\n                name: x.name,\r\n                emoji: x.emoji ?? ``,\r\n                isActive: state.activeUserProfileKey === x.key,\r\n            }));\r\n        },\r\n        setUserProfileInfo: async (userProfileKey: string, info: { emoji?: string, name?: string }) => {\r\n            const state = storage.getUserDataServiceState();\r\n            if (!state) {\r\n                console.log(`uploadUserData - NO STATE`);\r\n                return;\r\n            }\r\n\r\n            const userState = state.userProfiles.find(x => x.key === userProfileKey);\r\n            if (!userState) {\r\n                console.log(`uploadUserData - NO USER STATE`);\r\n                return;\r\n            }\r\n\r\n            userState.emoji = info.emoji ?? userState.emoji;\r\n            userState.name = info.name ?? userState.name;\r\n            storage.setUserDataServiceState(state);\r\n\r\n            // Save to remote data\r\n            const uploader = createUploader(userState.uploadUrl);\r\n            const uData = await uploader.downloadData() as UserData;\r\n            if (!uData) { return; }\r\n            uData.metadata = {\r\n                name: userState.name,\r\n                emoji: userState.emoji,\r\n            };\r\n            uData.timestamp = Date.now();\r\n            await uploadWithAutoRenew(userProfileKey, uData);\r\n        },\r\n        uploadUserData: async () => {\r\n            console.log(`uploadUserData`);\r\n\r\n            const state = storage.getUserDataServiceState();\r\n            if (!state) {\r\n                console.log(`uploadUserData - NO STATE`);\r\n                return;\r\n            }\r\n\r\n            const userState = state.userProfiles.find(x => x.key === state.activeUserProfileKey);\r\n            if (!userState) {\r\n                console.log(`uploadUserData - NO user State`, { state });\r\n                return;\r\n            }\r\n\r\n            userState.lastUploadTimestamp = Date.now();\r\n            storage.setUserDataServiceState(state);\r\n\r\n            const userData = storage.getUserData();\r\n            await uploadWithAutoRenew(userState.key, userData);\r\n\r\n            console.log(`uploadUserData - UPLOADED`, { userData });\r\n        },\r\n        downloadUserDataIfNewer: async () => {\r\n            const state = storage.getUserDataServiceState();\r\n            if (!state) { return; }\r\n\r\n            const userState = state.userProfiles.find(x => x.key === state.activeUserProfileKey);\r\n            if (!userState) { return; }\r\n\r\n            console.log(`downloadUserDataIfNewer`);\r\n\r\n            const uploader = createUploader(userState.uploadUrl);\r\n            const userData = await uploader.downloadData() as UserData;\r\n\r\n            // Don't update if not newer\r\n            if (!userData.timestamp || userData.timestamp <= (userState.lastUploadTimestamp ?? 0)) {\r\n                console.log(`downloadUserDataIfNewer - Local data is up to date`, { state, userData });\r\n                return;\r\n            }\r\n\r\n            console.log(`downloadUserDataIfNewer - UPDATING`, { state, userData });\r\n            storage.clearUserData();\r\n            storage.setUserData(userData);\r\n        },\r\n        createShareCode: async (userProfileKey: string) => {\r\n            await service.setup();\r\n            const user = getUserProfile(userProfileKey);\r\n            if (!user) {\r\n                throw new AppError(`user should not be null`);\r\n            }\r\n\r\n            const shareUrlResult = await uploadApi.createUploadUrl({ shareablePath: true });\r\n\r\n            // Save user uploadUrl to shared path\r\n            const uploader = createUploader(shareUrlResult.uploadUrl);\r\n            await uploader.uploadData(user.uploadUrl);\r\n\r\n            return {\r\n                shareCode: shareUrlResult.uploadUrl.relativePath,\r\n            };\r\n        },\r\n        addUserFromShareCode: async (shareCode: string) => {\r\n            console.log(`addUserFromShareCode`, { shareCode });\r\n\r\n            // Don't have a clean way to get the path, but can generate a new path from the server and use it as a template\r\n            const shareUrlResult = await uploadApi.createUploadUrl({ shareablePath: true });\r\n            const shareGetUrl = shareUrlResult.uploadUrl.getUrl.replace(shareUrlResult.uploadUrl.relativePath, shareCode.toUpperCase());\r\n            const sharedUploadUrl = await downloadData(shareGetUrl) as UploadUrl;\r\n            if (!sharedUploadUrl.putUrl) {\r\n                console.log(`addUserFromShareCode - FAILED TO GET PROFILE`);\r\n                throw new AppError(`Failed to get user profile`);\r\n            }\r\n\r\n            const state = storage.getUserDataServiceState();\r\n            if (!state) {\r\n                console.log(`addUserFromShareCode - NO STATE`);\r\n                throw new AppError(`UserDataService is not setup`);\r\n            }\r\n\r\n            // Already has that user profile\r\n            if (state.userProfiles.find(x => x.key === sharedUploadUrl.relativePath)) {\r\n                console.log(`addUserFromShareCode - ALREADY HAS USER`, { userKey: sharedUploadUrl.relativePath });\r\n                return;\r\n            }\r\n\r\n            state.userProfiles.push({\r\n                key: sharedUploadUrl.relativePath,\r\n                name: `Player ${state.userProfiles.length + 1}`,\r\n                uploadUrl: sharedUploadUrl,\r\n            });\r\n            storage.setUserDataServiceState(state);\r\n\r\n            console.log(`addUserFromShareCode - ADDED`, { userKey: sharedUploadUrl.relativePath });\r\n\r\n            // Reload profile\r\n            await updateUserProfileFromServer(sharedUploadUrl.relativePath);\r\n        },\r\n    };\r\n    return service;\r\n};\r\n\r\nexport type UserDataService = ReturnType<typeof createUserDataService>;\r\nconst serviceState = {\r\n    instance: null as null | UserDataService,\r\n};\r\nexport const UserDataService = {\r\n    get: (): UserDataService => {\r\n        if (!serviceState.instance) {\r\n            serviceState.instance = createUserDataService();\r\n        };\r\n        return serviceState.instance;\r\n    },\r\n};\r\n","export { delay } from 'utils/delay';\r\nexport { randomIndex, randomItem } from 'utils/random';\r\nexport { getValuesAsItems } from 'utils/objects';\r\nexport { moveItem } from 'utils/arrays';\r\nexport const randomBinary = (length: number) => String.fromCharCode(...[...new Array(length)].map(x => Math.random() * (126 - 32) + 32));\r\n","import { distinct, shuffle } from 'utils/arrays';\r\nimport { StringSpan } from 'utils/string-span';\r\nimport { highlight, languages } from 'prismjs';\r\nimport { LessonProjectFileSelection } from '../lesson-types';\r\nimport 'prismjs/components/prism-typescript';\r\nimport 'prismjs/components/prism-jsx';\r\nimport 'prismjs/components/prism-tsx';\r\nimport 'prism-themes/themes/prism-vsc-dark-plus.css';\r\n\r\nexport const isSimilarCodeToken = (a: string, b: string) => {\r\n    if (/^\\d+$/g.test(a) &&\r\n        /^\\d+$/g.test(b)) { return true; }\r\n    if (/^\\w+$/g.test(a) &&\r\n        /^\\w+$/g.test(b)) { return true; }\r\n    if (/^\\W+$/g.test(a) &&\r\n        /^\\W+$/g.test(b)) { return true; }\r\n\r\n    return false;\r\n};\r\n\r\n\r\ntype CodeWithClasses = { code: string, classes: string[] };\r\nconst parseHighlightedSpans = (html: string): CodeWithClasses[] => {\r\n    const h = new StringSpan(html, 0, html.length);\r\n    const tagsWithCode = h.splitOnRegExp(/<[^>]*>/g).filter(x => x.length > 0).map(t => {\r\n\r\n        const iTagLast = t.indexOf(`>`);\r\n        if (iTagLast < 0) {\r\n            return {\r\n                raw: t,\r\n                tag: t,\r\n                code: t,\r\n            };\r\n        }\r\n\r\n        const iTagLength = iTagLast - t.start + 1;\r\n        return {\r\n            raw: t,\r\n            tag: t.newRange(t.start, iTagLength),\r\n            code: t.newRange(iTagLast + 1, t.length - iTagLength),\r\n        };\r\n    });\r\n\r\n    const tagContext = [] as StringSpan[];\r\n    const tagsWithContext = tagsWithCode.map(t => {\r\n        if (t.tag.startsWith(`</`)) {\r\n            tagContext.pop();\r\n        } else if (t.tag.startsWith(`<`)) {\r\n            tagContext.push(t.tag);\r\n        }\r\n        return {\r\n            ...t,\r\n            context: [...tagContext],\r\n        };\r\n    });\r\n    const tagsWithClasses = tagsWithContext.map(t => {\r\n        const classInfos = t.context.map(c => {\r\n            const cParts = c.splitOnRegExp(/class=('|\")/g);\r\n            if (cParts.length <= 1) { return { raw: c, cParts }; }\r\n\r\n            const classPart = cParts[1];\r\n            const classContentParts = classPart.splitOnRegExp(/('|\")/g);\r\n\r\n            const classContent = classContentParts[1].trimStart([`\"`, `'`]);\r\n            if (!classContent) { return { raw: c, cParts, classContentParts }; }\r\n\r\n            return {\r\n                raw: c,\r\n                cParts,\r\n                classContentParts,\r\n                classContent: classContent.toText(),\r\n                classes: classContent.toText().split(` `).filter(x => x).map(x => x as string),\r\n            };\r\n        });\r\n        return {\r\n            ...t,\r\n            classInfos,\r\n            classes: distinct(classInfos.flatMap(x => x.classes ?? [])),\r\n        };\r\n    });\r\n\r\n    const codeWithClasses = tagsWithClasses.map(x => ({\r\n        code: x.code.toText()\r\n            .replace(/&lt;/g, `<`)\r\n            .replace(/&gt;/g, `>`)\r\n            .replace(/&amp;/g, `&`)\r\n        ,\r\n        classes: x.classes,\r\n    }))\r\n        .filter(x => x.code);\r\n\r\n    console.log(`parseHighlightedSpans`, { codeWithClasses, tagsWithClasses, summary: codeWithClasses.map(x => `<span class='${x.classes.join(` `)}'>${x.code}</span>`).join(``) });\r\n    // const iFocus = h.lastIndexOf(`<span`, lengthSameStart);\r\n    return codeWithClasses;\r\n};\r\n\r\nexport type CodePart = {\r\n    code: string;\r\n    classes: string[];\r\n    index: number;\r\n    length: number;\r\n    indexAfterEnd: number;\r\n    isInSelection: boolean;\r\n    onPress?: (value: CodePart) => void;\r\n};\r\nexport type CodePartsData = {\r\n    // codeBefore: string;\r\n    codeFocus: string;\r\n    // codeAfter: string;\r\n    codeParts: CodePart[];\r\n    selection?: LessonProjectFileSelection;\r\n};\r\nexport const getCodeParts = (code: string, language: 'tsx', selection?: LessonProjectFileSelection): CodePartsData => {\r\n\r\n    const html = highlight(code, languages[language], language);\r\n    const codeWithClasses = parseHighlightedSpans(html);\r\n    let index = 0;\r\n    const codeParts = codeWithClasses.map(x => {\r\n        const r = {\r\n            code: x.code,\r\n            classes: x.classes,\r\n            index,\r\n            length: x.code.length,\r\n            indexAfterEnd: index + x.code.length,\r\n            _rawCode: code.substr(index, x.code.length),\r\n        };\r\n        index += x.code.length;\r\n        return r;\r\n    });\r\n\r\n    if (codeParts.some(x => x.code !== x._rawCode)) {\r\n        console.error(`getCodeParts FAILED`, { codeParts: codeWithClasses, codePartsFailed: codeParts.filter(x => x.code !== x._rawCode) });\r\n    }\r\n\r\n    const s = selection ?? {\r\n        index: 0,\r\n        length: code.length,\r\n    };\r\n\r\n    const codePartsAll = modifyCodeParts(codeParts.map(x => ({ ...x, isInSelection: true, indexAfterEnd: x.index + x.length })), s, (x, inRange) => ({ ...x, isInSelection: inRange }));\r\n\r\n    console.log(`getCodeParts`, {\r\n        codePartsAll,\r\n        code,\r\n        selection,\r\n    });\r\n\r\n    if (codePartsAll.some(x => x.code !== code.substr(x.index, x.length))) {\r\n        console.error(`getCodeParts FAILED`, { codeParts: codeWithClasses, codePartsFailed: codeParts.filter(x => x.code !== x._rawCode) });\r\n    }\r\n\r\n    const codeFocus = code.substr(s.index, s.length);\r\n    return {\r\n        codeFocus,\r\n        codeParts: codePartsAll,\r\n        selection,\r\n    };\r\n};\r\nconst modifyCodeParts = <T extends CodePart>(codeParts: CodePart[], range: { index: number, length: number }, getCodePart: (codePart: CodePart, inRange: boolean) => T): T[] => {\r\n    const s = {\r\n        ...range,\r\n        indexAfterEnd: range.index + range.length,\r\n    };\r\n\r\n    const codePartsAll: T[] = [];\r\n    for (const c of codeParts) {\r\n        // Before\r\n        if (c.indexAfterEnd < s.index) {\r\n            codePartsAll.push(getCodePart(c, false));\r\n            continue;\r\n        }\r\n        // After\r\n        if (c.index > s.indexAfterEnd) {\r\n            codePartsAll.push(getCodePart(c, false));\r\n            continue;\r\n        }\r\n        // Within\r\n        if (c.index >= s.index && c.indexAfterEnd <= s.indexAfterEnd) {\r\n            codePartsAll.push(getCodePart(c, true));\r\n            continue;\r\n        }\r\n\r\n        // Overlap\r\n        const shouldSplitStart = c.index < s.index;\r\n        const shouldSplitEnd = c.indexAfterEnd > s.indexAfterEnd;\r\n        const iCodeStart = shouldSplitStart ? s.index - c.index : 0;\r\n        const iCodeAfterEnd = shouldSplitEnd ? s.indexAfterEnd - c.index : c.length;\r\n        const before = c.code.substr(0, iCodeStart);\r\n        const within = c.code.substr(iCodeStart, iCodeAfterEnd - iCodeStart);\r\n        const after = c.code.substr(iCodeAfterEnd, c.length - iCodeAfterEnd);\r\n        codePartsAll.push(...[\r\n            getCodePart({ ...c, code: before, index: c.index, length: iCodeStart }, false),\r\n            getCodePart({ ...c, code: within, index: c.index + iCodeStart, length: iCodeAfterEnd - iCodeStart }, true),\r\n            getCodePart({ ...c, code: after, index: c.index + iCodeAfterEnd, length: c.length - iCodeAfterEnd }, false),\r\n        ].filter(x => x.length > 0));\r\n    }\r\n\r\n    return codePartsAll;\r\n};\r\n\r\nexport const getCodePartsCompleted = (codeParts: CodePart[], incomplete: { index: number, length: number }, options?: { showBlank?: boolean }): CodePart[] => {\r\n    const codePartsCompleted = modifyCodeParts(codeParts, incomplete, (x, inRange) => ({ ...x, isIncomplete: inRange }));\r\n    if (options?.showBlank) {\r\n        return codePartsCompleted.map(x => ({ ...x, code: x.isIncomplete ? x.code.replace(/./g, ` `) : x.code }));\r\n    }\r\n    return codePartsCompleted.filter(x => !x.isIncomplete);\r\n};\r\n\r\nexport const getAutoComplete = ({ codeParts, selection }: { codeParts: CodePart[], selection?: { index: number, length: number } }, codeFocusCompleted?: string) => {\r\n    if (!selection\r\n        || codeFocusCompleted == null\r\n        || selection.length === codeFocusCompleted.length\r\n    ) {\r\n        return null;\r\n    }\r\n\r\n    // const remaining = code_focus.substr(completed.length);\r\n\r\n    const nextPartIndexRaw = codeParts.findIndex(x => x.index > selection.index + codeFocusCompleted.length);\r\n    const nextPartIndex = nextPartIndexRaw < 0 ? codeParts.length : nextPartIndexRaw;\r\n    const activePartText = codeParts[nextPartIndex - 1]?.code;\r\n    const iDone = codeParts[nextPartIndex - 1]?.index;\r\n    // console.log(`updateAutoComplete`, { iNext, iDone, activePart: activePartText, codeParts, codeFocusCompleted });\r\n\r\n    if (!activePartText?.trim()) {\r\n        return null;\r\n    }\r\n\r\n    const lengthCompleted = codeFocusCompleted.length + selection.index - iDone;\r\n    const activePartTextCompleted = activePartText.substr(0, lengthCompleted);\r\n    const matchWords = distinct(codeParts\r\n        .filter(x =>\r\n            (!!activePartTextCompleted && x.code.startsWith(activePartTextCompleted))\r\n            || (!activePartTextCompleted && isSimilarCodeToken(x.code, activePartText)))\r\n        .map(x => x.code)\r\n        .filter(x => x !== activePartText)\r\n        .filter(x => !!x.trim()),\r\n    );\r\n    const choices = [activePartText, ...shuffle(matchWords).slice(0, 3)].map(x => ({\r\n        textCompleted: x.substr(0, lengthCompleted),\r\n        text: x.substr(lengthCompleted),\r\n    }));\r\n\r\n    console.log(`updateAutoComplete`, { iDone, activePartText, codeFocusCompleted, codeParts, activePartTextCompleted, matchWords, choices });\r\n\r\n    return {\r\n        choices: shuffle(choices).map((x, i) => ({ ...x, isSelected: i === 0, isWrong: false })),\r\n        activeIndex: iDone,\r\n    };\r\n};\r\n","import { isAbsolute } from 'path';\r\nimport React, { useEffect, useMemo, useRef, useState } from 'react';\r\nimport { TouchableOpacity, View } from 'react-native-lite';\r\nimport { CodePart } from './code-editor-helpers';\r\n\r\nexport type CodeDisplayPart = CodePart;\r\nexport type CodeDisplayInputOptions = {\r\n    isActive?: boolean;\r\n    cursorIndex?: number;\r\n    activeIndex?: number;\r\n    promptIndex?: number;\r\n    prompt?: CodeDisplayPrompt;\r\n    feedback?: CodeDisplayFeedback;\r\n    autoComplete?: { textCompleted: string, text: string, isSelected: boolean, isWrong: boolean }[];\r\n    onAutocomplete?: (value: string) => void;\r\n};\r\nexport const CodeDisplay = ({ codeParts, language, inputOptions }: {\r\n    codeParts: CodeDisplayPart[];\r\n    language: string;\r\n    inputOptions?: CodeDisplayInputOptions;\r\n}) => {\r\n\r\n    const Cursor = useMemo(() => <CursorComponent isActive={inputOptions?.isActive ?? false} />, [inputOptions?.isActive]);\r\n\r\n    console.log(`CodeDisplay`, { inputOptions, codeParts });\r\n    return (\r\n        <View>\r\n            <pre style={{ margin: 0, paddingBottom: inputOptions ? 100 : 0 }} className={`language-${language}`}>\r\n                <code className={`language-${language}`}>\r\n                    <CodeSpan key='-1' code={{ code: `\\n`, index: -1, indexAfterEnd: 0, length: 1, classes: [], isInSelection: false }} Cursor={Cursor} inputOptions={inputOptions ?? {}} />\r\n                    {codeParts.map(x => (\r\n                        <CodeSpan key={`${x.code}:${x.index}:${x.code.length}`} code={x} Cursor={Cursor} inputOptions={inputOptions ?? {}} />\r\n                    ))}\r\n                </code>\r\n            </pre>\r\n        </View>\r\n    );\r\n};\r\n\r\nconst CodeSpan = ({ code, Cursor, inputOptions }: { code: CodeDisplayPart, Cursor: JSX.Element, inputOptions: CodeDisplayInputOptions }) => {\r\n    const { cursorIndex, activeIndex = inputOptions.cursorIndex, promptIndex } = inputOptions;\r\n\r\n    const hasCursor = !!(cursorIndex != null\r\n        && cursorIndex >= code.index\r\n        && cursorIndex < code.index + code.code.length\r\n    );\r\n    const hasActive = !!(activeIndex != null\r\n        && activeIndex >= code.index\r\n        && activeIndex < code.index + code.code.length\r\n    );\r\n    const hasPrompt = !!(promptIndex != null\r\n        && promptIndex >= code.index\r\n        && promptIndex < code.index + code.code.length\r\n    );\r\n    return (\r\n        <>\r\n            {hasCursor && Cursor}\r\n            {hasActive && (\r\n                <>\r\n                    <AutoCompleteComponent inputOptions={inputOptions} />\r\n                </>\r\n            )}\r\n            {hasPrompt && (\r\n                <>\r\n                    <PromptComponent inputOptions={inputOptions} />\r\n                </>\r\n            )}\r\n            {!code.onPress && (\r\n                <span className={code.classes.join(` `)} style={!code.isInSelection ? { opacity: 0.5 } : {}} >{`${code.code}`}</span>\r\n            )}\r\n            {code.onPress && (\r\n                <TouchableOpacity style={{ display: `inline` }} onPress={() => code.onPress?.(code)}>\r\n                    <span className={code.classes.join(` `)} style={!code.isInSelection ? { opacity: 0.5 } : {}} >{`${code.code}`}</span>\r\n                </TouchableOpacity>\r\n            )}\r\n\r\n        </>\r\n    );\r\n};\r\n\r\n\r\nconst CursorComponent = ({ isActive }: { isActive: boolean }) => {\r\n    const [cursorBlinkState, setCursorBlinkState] = useState(true);\r\n    useEffect(() => {\r\n        const intervalId = setInterval(() => {\r\n            setCursorBlinkState(s => !s);\r\n        }, 500);\r\n        return () => {\r\n            clearInterval(intervalId);\r\n        };\r\n    }, []);\r\n    return (\r\n        <span style={{ display: `inline-block`, width: 0, margin: 0, position: `relative`, left: -4, opacity: isActive ? 1 : 0.5 }}>{cursorBlinkState ? ` ` : `|`}</span>\r\n    );\r\n};\r\n\r\nconst autoCompleteStyles = {\r\n    wrapper: { display: `inline-block`, position: `relative`, top: 4, width: 0 },\r\n    inner: { display: `block`, position: `absolute`, zIndex: 100, background: `#000000`, border: `solid 1 #CCCCFF` },\r\n    item: { display: `block`, padding: 4, color: `#FFFFFF` },\r\n    item_selected: { display: `block`, padding: 4, color: `#CCCCFF`, background: `#111133`, minWidth: 60 },\r\n    textCompleted: { color: `#CCCCFF`, opacity: 0.5 },\r\n    textNew: { color: `#CCCCFF` },\r\n} as const;\r\n\r\nconst AutoCompleteComponent = ({ inputOptions }: { inputOptions: CodeDisplayInputOptions }) => {\r\n    const { autoComplete } = inputOptions;\r\n    if (!autoComplete) { return (<></>); }\r\n\r\n    const s = autoCompleteStyles;\r\n    console.log(`AutoCompleteComponent`, { autoComplete });\r\n    return (\r\n        <>\r\n            <span style={s.wrapper}>\r\n                <span style={s.inner}>\r\n                    {autoComplete.map(x => (\r\n                        <TouchableOpacity key={x.text} onPress={() => { inputOptions.onAutocomplete?.(x.text); }}>\r\n                            <span style={x.isSelected ? s.item_selected : s.item}>\r\n                                <span style={s.textCompleted}>{x.isWrong ? ` ` : ``}{x.textCompleted}</span>\r\n                                <span style={s.textNew}>{x.text}</span>\r\n                            </span>\r\n                        </TouchableOpacity>\r\n                    ))}\r\n                </span>\r\n            </span>\r\n        </>\r\n    );\r\n};\r\n\r\nconst promptStyles = {\r\n    wrapper: {\r\n        position: `relative`,\r\n        background: `#111111`,\r\n        margin: 4,\r\n        padding: 4,\r\n        marginLeft: 20,\r\n        borderRadius: 4,\r\n        border: `1px solid #555555`,\r\n        // Remove extra line\r\n        marginBottom: -16,\r\n    },\r\n    text: { whiteSpace: `pre-wrap` },\r\n    text_positive: { whiteSpace: `pre-wrap`, color: `#88FF88` },\r\n    text_negative: { whiteSpace: `pre-wrap`, color: `#FF8888` },\r\n    emoji: { position: `absolute`, fontSize: 20, left: -24, top: 0 },\r\n} as const;\r\n\r\nexport type CodeDisplayFeedback = {\r\n    message: string;\r\n    emoji: string;\r\n    timestamp: number;\r\n    isNegative?: boolean;\r\n    timeoutMs?: number;\r\n};\r\nexport type CodeDisplayPrompt = {\r\n    message: string;\r\n    emoji: string;\r\n    timestamp: number;\r\n    timeout?: number;\r\n};\r\nconst PromptComponent = ({ inputOptions }: { inputOptions: CodeDisplayInputOptions }) => {\r\n    const { prompt: promptRaw, feedback } = inputOptions;\r\n\r\n    // Feedback\r\n    const [hideFeedback, setHideFeedback] = useState(true);\r\n    useEffect(() => {\r\n        setHideFeedback(false);\r\n\r\n        const id = setTimeout(() => {\r\n            setHideFeedback(true);\r\n        }, feedback?.timeoutMs ?? 3000);\r\n\r\n        return () => {\r\n            clearTimeout(id);\r\n        };\r\n    }, [feedback]);\r\n\r\n    const showFeedback = feedback && !hideFeedback;\r\n    const s = promptStyles;\r\n    const textStyle = showFeedback && feedback ? (feedback.isNegative ? s.text_negative : s.text_positive) : s.text;\r\n    const prompt = showFeedback ? feedback : promptRaw;\r\n    if (!prompt) { return <></>; }\r\n    return (\r\n        <>\r\n            <div style={s.wrapper} >\r\n                <div style={s.emoji}>{prompt.emoji}</div>\r\n                <span style={textStyle}>{prompt.message}</span>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n","export const goodEmojis = `       `.split(` `);\r\nexport const badEmojis = `       `.split(` `);\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport { TouchableOpacity, View } from 'react-native-lite';\r\nimport { randomItem } from 'utils/random';\r\nimport { LessonData, LessonProjectFileSelection } from '../lesson-types';\r\nimport { CodePartsData, getAutoComplete, getCodeParts, getCodePartsCompleted } from './code-editor-helpers';\r\nimport { CodeDisplay, CodeDisplayFeedback, CodeDisplayPrompt } from './code-display';\r\nimport { badEmojis, goodEmojis } from './emojis';\r\n\r\nexport const LessonFileContentEditor_ConstructCode = ({ code, language, selection, onDone, lessonData }: {\r\n    code: string; language: 'tsx';\r\n    selection?: LessonProjectFileSelection;\r\n    onDone: () => void;\r\n    lessonData: LessonData;\r\n}) => {\r\n    const [codeParts, setCodeParts] = useState(null as null | CodePartsData);\r\n    const inputRef = useRef(null as null | HTMLTextAreaElement);\r\n\r\n    useEffect(() => {\r\n        const parts = getCodeParts(code, language, selection);\r\n        setCodeParts(parts);\r\n        setAutoComplete(null);\r\n\r\n        const timeoutId = setTimeout(() => {\r\n            inputRef.current?.focus();\r\n        }, 250);\r\n        return () => {\r\n            clearTimeout(timeoutId);\r\n        };\r\n    }, [code]);\r\n\r\n    const [inputText, setInputText] = useState(``);\r\n    const [isActive, setIsActive] = useState(false);\r\n    const [feedback, setFeedback] = useState(null as null | CodeDisplayFeedback);\r\n    const [autoComplete, setAutoComplete] = useState(null as null | { choices: { textCompleted: string, text: string, isSelected: boolean, isWrong: boolean }[], activeIndex: number });\r\n\r\n    useEffect(() => {\r\n        const timeoutId = setTimeout(() => {\r\n            const nextLetter = codeParts?.codeFocus.substr(inputText.length).trim()[0];\r\n            if (!nextLetter) { return; }\r\n\r\n            setFeedback(s => ({\r\n                message: ` Type: ${nextLetter}`,\r\n                emoji: ``,\r\n                timestamp: Date.now(),\r\n                timeoutMs: 5 * 1000,\r\n            }));\r\n        }, 5000);\r\n\r\n        return () => {\r\n            clearTimeout(timeoutId);\r\n        };\r\n    }, [codeParts, inputText]);\r\n\r\n    const onKeyDown = (e: React.KeyboardEvent<HTMLInputElement | HTMLTextAreaElement>) => {\r\n        const TABKEY = 9;\r\n        const RETURNKEY = 13;\r\n        const UPKEY = 38;\r\n        const DOWNKEY = 40;\r\n        // console.log(`CodeEditor onKeyPress`, { keyCode: e.keyCode });\r\n\r\n        if (e.keyCode === TABKEY) {\r\n            // console.log(`CodeEditor onKeyPress onTabKey`);\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            changeInputText(`${inputText}\\t`);\r\n            return false;\r\n        }\r\n        if (e.keyCode === RETURNKEY) {\r\n            // console.log(`CodeEditor onKeyPress onTabKey`);\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n\r\n            changeInputText(`${inputText}\\n`);\r\n            return false;\r\n        }\r\n        if (e.keyCode === UPKEY) {\r\n            setAutoComplete(s => {\r\n                if (!s) { return null; }\r\n                const iSelected = s.choices.findIndex(x => x.isSelected);\r\n                const iSelectedNew = Math.max(0, iSelected - 1);\r\n                return { ...s, choices: [...s.choices.map((x, i) => ({ ...x, isSelected: iSelectedNew === i }))] };\r\n            });\r\n        }\r\n        if (e.keyCode === DOWNKEY) {\r\n            setAutoComplete(s => {\r\n                if (!s) { return null; }\r\n                const iSelected = s.choices.findIndex(x => x.isSelected);\r\n                const iSelectedNew = Math.min(s.choices.length - 1, iSelected + 1);\r\n                return { ...s, choices: [...s.choices.map((x, i) => ({ ...x, isSelected: iSelectedNew === i }))] };\r\n            });\r\n        }\r\n        return true;\r\n    };\r\n\r\n    const changeInputText = (valueRaw: string) => {\r\n        if (!codeParts) { return; }\r\n        const {\r\n            codeFocus,\r\n        } = codeParts;\r\n\r\n        const newInput = valueRaw.substr(inputText.length);\r\n        const wasBackspace = valueRaw.length < inputText.length;\r\n        const wasTab = valueRaw.endsWith(`\\t`);\r\n        const wasReturn = valueRaw.endsWith(`\\n`);\r\n        const wasPeriod = valueRaw.endsWith(`.`);\r\n        const wasSpace = valueRaw.endsWith(` `);\r\n\r\n        const remaining = codeFocus.substr(inputText.length);\r\n        const isWhitespace = remaining.trimStart() !== remaining;\r\n        const wasCorrectRaw = codeFocus.startsWith(valueRaw);\r\n        const wasAutoComplete = autoComplete && !wasCorrectRaw && (wasTab || wasReturn || wasPeriod || wasSpace);\r\n        const activeAutoComplete = autoComplete?.choices.find(x => x.isSelected);\r\n\r\n        const value2 = wasCorrectRaw ? valueRaw\r\n            : wasAutoComplete ? inputText + (activeAutoComplete?.text ?? ``)\r\n                : (wasReturn || wasTab || wasSpace) && isWhitespace ? codeFocus.substr(0, codeFocus.length - remaining.trimStart().length)\r\n                    : valueRaw\r\n            ;\r\n\r\n        const wasCorrect_ignoreWhitespace = remaining.trimStart().startsWith(newInput);\r\n        const value = wasCorrect_ignoreWhitespace ? codeFocus.substr(0, codeFocus.length - remaining.trimStart().length + newInput.length) : value2;\r\n\r\n        const wasCorrect = codeFocus.startsWith(value);\r\n\r\n        console.log(`changeInputText`, {\r\n            wasBackspace,\r\n            wasTab,\r\n            wasReturn,\r\n            wasPeriod,\r\n            wasSpace,\r\n            wasCorrectRaw,\r\n            wasAutoComplete,\r\n            activeAutoComplete,\r\n            value,\r\n            value2,\r\n            valueRaw,\r\n            codeFocus,\r\n            remaining,\r\n            isWhitespace,\r\n            wasCorrect,\r\n            wasCorrect_ignoreWhitespace,\r\n        });\r\n\r\n        if (codeFocus === inputText) {\r\n            setFeedback({ emoji: randomItem(goodEmojis), message: ` You're already done.`, timestamp: Date.now() });\r\n            return;\r\n        }\r\n        if (wasBackspace) {\r\n            setFeedback({ isNegative: true, emoji: randomItem(badEmojis), message: ` You're right so far, no need to backspace.`, timestamp: Date.now() });\r\n            return;\r\n        }\r\n        if (!wasCorrect) {\r\n            if (wasAutoComplete && activeAutoComplete) {\r\n                activeAutoComplete.isWrong = true;\r\n            }\r\n            if (!activeAutoComplete) {\r\n                const a = getAutoComplete(codeParts, inputText);\r\n                setAutoComplete(a);\r\n            }\r\n            setFeedback({ isNegative: true, emoji: randomItem(badEmojis), message: ` ${randomItem([`Wrong`, `Incorrect`, `No`, `Try Again`])}`, timestamp: Date.now() });\r\n            return;\r\n        }\r\n\r\n        const isDone = codeFocus === value;\r\n        if (isDone) {\r\n            onDone();\r\n        }\r\n\r\n        setIsActive(true);\r\n        setInputText(value);\r\n        setFeedback(!isDone ? null : { emoji: randomItem(goodEmojis), message: ``, timestamp: Date.now() });\r\n        const a = getAutoComplete(codeParts, value);\r\n        setAutoComplete(a);\r\n\r\n        inputRef.current?.focus();\r\n    };\r\n\r\n    const onAutocomplete = (text: string) => {\r\n        if (!autoComplete) { return; }\r\n\r\n        autoComplete.choices.forEach(x => { x.isSelected = false; });\r\n        const choice = autoComplete.choices.find(x => x.text === text);\r\n        if (!choice) { return; }\r\n\r\n        choice.isSelected = true;\r\n        changeInputText(inputText + text);\r\n    };\r\n\r\n\r\n    if (!codeParts || !code) {\r\n        return <></>;\r\n    }\r\n\r\n    const s = selection ?? { index: 0, length: code.length };\r\n    const cursorIndex = s.index + inputText.length;\r\n    const activeIndex = autoComplete?.activeIndex ?? cursorIndex;\r\n    const promptIndex = code.lastIndexOf(`\\n`, code.lastIndexOf(`\\n`, s.index) - 1);\r\n    const activeCodeParts = getCodePartsCompleted(codeParts.codeParts, { index: cursorIndex, length: codeParts.codeFocus.length - inputText.length }, { showBlank: true });\r\n    const nextChar = code.substr(cursorIndex, 1);\r\n    const prompt: CodeDisplayPrompt = {\r\n        emoji: ``,\r\n        message: lessonData.task,\r\n        timestamp: Date.now(),\r\n    };\r\n    console.log(`CodeEditor_TypeSelection`, { nextChar, inputText, codeParts, activeCodeParts, isActive, cursorIndex, activeIndex, feedback, autoComplete: autoComplete?.choices });\r\n\r\n    return (\r\n        <>\r\n            <TouchableOpacity onPress={() => inputRef.current?.focus()}>\r\n                <View style={{ position: `relative` }}>\r\n                    <View>\r\n                        <CodeDisplay codeParts={activeCodeParts} language={language} inputOptions={{\r\n                            isActive, cursorIndex, activeIndex, promptIndex,\r\n                            feedback: feedback ?? undefined,\r\n                            prompt: prompt ?? undefined,\r\n                            autoComplete: autoComplete?.choices,\r\n                            onAutocomplete,\r\n                        }} />\r\n                    </View>\r\n                    <View style={{ position: `absolute`, top: 0, left: 0, right: 0, bottom: 0, opacity: 0 }}>\r\n                        <textarea style={{ width: `100%`, height: `100%`, background: `#FF0000` }}\r\n                            value={inputText}\r\n                            onChange={(e) => changeInputText(e.target.value)}\r\n                            onFocus={() => setIsActive(true)}\r\n                            onBlur={() => setIsActive(false)}\r\n                            onKeyDown={(e) => onKeyDown(e)}\r\n                            ref={inputRef}\r\n                        />\r\n                    </View>\r\n                </View>\r\n                {/* <Text>{inputText}</Text> */}\r\n            </TouchableOpacity>\r\n        </>\r\n    );\r\n};\r\n","import React, { useEffect, useState } from 'react';\r\nimport { View } from 'react-native-lite';\r\nimport { randomItem } from 'utils/random';\r\nimport { LessonData, LessonProjectFileSelection } from '../lesson-types';\r\nimport { CodePart, CodePartsData, getCodeParts } from './code-editor-helpers';\r\nimport { CodeDisplay, CodeDisplayFeedback, CodeDisplayPrompt } from './code-display';\r\nimport { badEmojis, goodEmojis } from './emojis';\r\n\r\nexport const LessonFileContentEditor_UnderstandCode = ({ code, language, selection, onDone, lessonData }: {\r\n    code: string;\r\n    language: 'tsx';\r\n    selection?: LessonProjectFileSelection;\r\n    onDone: () => void;\r\n    lessonData: LessonData;\r\n}) => {\r\n    const [codeParts, setCodeParts] = useState(null as null | CodePartsData);\r\n    type FillInBlankProblem = { textWithBlanks: string, textWithoutBlanks: string };\r\n    const [fillInBlanks, setFillInBlanks] = useState(null as null | FillInBlankProblem[]);\r\n    const [fillInBlank, setFillInBlank] = useState(null as null | FillInBlankProblem);\r\n    const [feedback, setFeedback] = useState(null as null | CodeDisplayFeedback);\r\n\r\n    useEffect(() => {\r\n        const parts = getCodeParts(code, language, selection);\r\n        setCodeParts(parts);\r\n\r\n        // Create fill in blank description\r\n        const descriptionsWithBlanks = lessonData.descriptions.map(x => {\r\n            let d = x;\r\n            parts.codeParts\r\n                .filter(c => c.isInSelection)\r\n                .map(c => c.code.trim())\r\n                .filter(c => !!c)\r\n                // Require a space around it\r\n                .forEach(c => { d = d.replace(` ${c} `, ` ___ `); });\r\n\r\n            console.log(`LessonFileContentEditor_UnderstandCode - create fill in blank`, { parts, d, x });\r\n            return {\r\n                textWithBlanks: d,\r\n                textWithoutBlanks: x,\r\n            };\r\n        });\r\n        setFillInBlanks(descriptionsWithBlanks);\r\n        setFillInBlank(descriptionsWithBlanks[0] ?? null);\r\n\r\n    }, [code]);\r\n\r\n    const onPressCodePart = (part: CodePart) => {\r\n        if (!fillInBlank || !fillInBlanks) { return; }\r\n\r\n        const iBlank = fillInBlank.textWithBlanks.indexOf(`___`);\r\n        const nextWithBlanks = fillInBlank.textWithBlanks.replace(`___`, part.code.trim());\r\n        const isCorrect = nextWithBlanks.startsWith(fillInBlank.textWithoutBlanks.substr(0, iBlank + part.length));\r\n\r\n        console.log(`onPressCodePart`, { part, iBlank, withoutBlank: nextWithBlanks, isCorrect, fillInBlank });\r\n\r\n        if (!isCorrect) {\r\n            setFeedback({ isNegative: true, emoji: randomItem(badEmojis), message: ` ${randomItem([`Wrong`, `Incorrect`, `No`, `Try Again`])}`, timestamp: Date.now() });\r\n            return;\r\n        }\r\n\r\n        setFeedback({ emoji: randomItem(goodEmojis), message: ``, timestamp: Date.now(), timeoutMs: 1000 });\r\n\r\n        if (!nextWithBlanks.includes(`___`)) {\r\n            // Done\r\n            const remaining = fillInBlanks.filter(x => x.textWithoutBlanks !== fillInBlank.textWithoutBlanks);\r\n            setFillInBlanks(remaining);\r\n            setFillInBlank(remaining[0] ?? null);\r\n\r\n            if (remaining.length <= 0) {\r\n                onDone();\r\n            }\r\n\r\n            return;\r\n        }\r\n\r\n        setFillInBlank({\r\n            textWithoutBlanks: fillInBlank.textWithoutBlanks,\r\n            textWithBlanks: nextWithBlanks,\r\n        });\r\n    };\r\n\r\n    if (!codeParts) { return <></>; }\r\n\r\n    const s = selection ?? { index: 0, length: code.length };\r\n    const promptIndex = code.lastIndexOf(`\\n`, code.lastIndexOf(`\\n`, s.index) - 1);\r\n    const activeCodeParts = codeParts.codeParts.map(x => ({ ...x, onPress: onPressCodePart }));\r\n    const activePrompt: CodeDisplayPrompt = {\r\n        emoji: fillInBlank ? `` : randomItem(goodEmojis),\r\n        message: fillInBlank ? `${fillInBlank.textWithBlanks}\\r\\n\\r\\n Select the correct word below` : `${lessonData.descriptions.map(x => ` ${x}`).join(`\\r\\n`)}`,\r\n        timestamp: Date.now(),\r\n    };\r\n    console.log(`LessonFileContentEditor_UnderstandCode render`, { fillInBlank, activePrompt });\r\n    return (\r\n        <>\r\n            <View style={{ position: `relative` }}>\r\n                <View>\r\n                    <CodeDisplay codeParts={activeCodeParts} language={language} inputOptions={{\r\n                        prompt: activePrompt,\r\n                        promptIndex,\r\n                        feedback: feedback ?? undefined,\r\n                    }} />\r\n                </View>\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n","/* eslint-disable unicorn/no-for-loop */\r\n/* eslint-disable react/no-danger */\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { View, Text, TextInput } from 'react-native-lite';\r\nimport { randomItem } from 'utils/random';\r\nimport { LessonData, LessonProjectFile, LessonProjectFileSelection, LessonProjectState } from '../lesson-types';\r\nimport { CodePartsData, getAutoComplete, getCodeParts, getCodePartsCompleted } from './code-editor-helpers';\r\nimport { CodeDisplay, CodeDisplayPrompt } from './code-display';\r\nimport { TabsListEditorComponent } from './tabs';\r\nimport { LessonFileContentEditor_ConstructCode } from './lesson-file-editor-construct-code';\r\nimport { LessonFileContentEditor_UnderstandCode } from './lesson-file-editor-understand-code';\r\nimport { calculateFilesHashCode } from '../lesson-hash';\r\n\r\nexport type LessonProjectEditorMode = 'display' | 'edit';\r\nexport const LessonProjectFilesEditor = ({\r\n    projectData,\r\n    projectEditorMode,\r\n    fileEditorMode_focus,\r\n    fileEditorMode_noFocus,\r\n    onProjectDataChange = () => { },\r\n    onTaskDone = () => { },\r\n    lessonData,\r\n}: {\r\n    projectData: {\r\n        projectState: LessonProjectState;\r\n        focus: LessonProjectFileSelection;\r\n    };\r\n    projectEditorMode: LessonProjectEditorMode;\r\n    fileEditorMode_focus: LessonFileEditorMode;\r\n    fileEditorMode_noFocus: LessonFileEditorMode;\r\n    onProjectDataChange?: (value: {\r\n        projectState?: LessonProjectState;\r\n        focus?: LessonProjectFileSelection;\r\n    }) => void;\r\n    onTaskDone?: () => void;\r\n    lessonData: LessonData;\r\n}) => {\r\n    const {\r\n        projectState,\r\n        focus,\r\n    } = projectData;\r\n    const [activeFilePath, setActiveFilePath] = useState(focus.filePath);\r\n    const lastFocusSet = useRef(null as null | LessonProjectFileSelection);\r\n\r\n    useEffect(() => {\r\n        const focusFile = projectState.files.find(x => x.path === focus.filePath);\r\n        if (projectState.files.length > 0\r\n            && (!focusFile\r\n                || focus.length <= 0\r\n                || focus.index >= (focusFile?.content.length ?? 0))\r\n            && lastFocusSet.current !== focus\r\n        ) {\r\n            const f = projectState.files.find(x => x.path === focus.filePath) ?? projectState.files[0];\r\n            const newFocus = {\r\n                filePath: f.path,\r\n                index: 0,\r\n                length: f.content.length,\r\n            };\r\n            lastFocusSet.current = newFocus;\r\n\r\n            onProjectDataChange({\r\n                focus: newFocus,\r\n            });\r\n            return;\r\n        }\r\n\r\n        const p = focusFile?.path ?? projectState.files[0]?.path ?? undefined;\r\n\r\n        setActiveFilePath(p);\r\n    }, [projectState, focus]);\r\n\r\n    const createNewFile = () => {\r\n        let path = `new.ts`;\r\n        let attempt = 1;\r\n        // eslint-disable-next-line no-loop-func\r\n        while (projectState.files.some(x => x.path === path)) {\r\n            path = `new${attempt}.ts`;\r\n            attempt++;\r\n        }\r\n        const newFile: LessonProjectFile = {\r\n            path,\r\n            content: ``,\r\n            language: `tsx`,\r\n        };\r\n        return newFile;\r\n    };\r\n\r\n    const changeFile = (file: LessonProjectFile) => {\r\n        const files = projectState.files.map(x => {\r\n            if (x.path === file.path) { return file; }\r\n            return x;\r\n        });\r\n        onProjectDataChange({\r\n            projectState: {\r\n                files,\r\n                filesHashCode: calculateFilesHashCode(files),\r\n            },\r\n        });\r\n    };\r\n    const changeSelection = (value: { index: number, length: number }) => {\r\n        const file = projectState.files.find(x => x.path === activeFilePath);\r\n        if (!file) { return; }\r\n\r\n        console.log(`changeSelection`, { ...value });\r\n        const f = file;\r\n        onProjectDataChange({\r\n            focus: {\r\n                filePath: f.path,\r\n                ...value,\r\n            },\r\n        });\r\n    };\r\n\r\n    console.log(`ProjectCodeEditor`, { activeFilePath, focus, projectState });\r\n    const activeFile = projectState.files.find(x => x.path === activeFilePath) ?? projectState.files[0] ?? undefined;\r\n    return (\r\n        <>\r\n            <TabsListEditorComponent\r\n                header='Files'\r\n                items={projectState.files}\r\n                onChange={projectEditorMode !== `edit` ? undefined : (x => onProjectDataChange({ projectState: { files: x, filesHashCode: calculateFilesHashCode(x) } }))}\r\n                getKey={x => x.path}\r\n                getLabel={x => focus.filePath === x.path ? ` ${x.path}` : x.path}\r\n                selected={activeFile}\r\n                onSelect={x => setActiveFilePath(x.path)}\r\n                onCreateNewItem={createNewFile}\r\n            />\r\n            {activeFile && (\r\n                <LessonFileEditor\r\n                    key={activeFile.path}\r\n                    projectEditorMode={projectEditorMode}\r\n                    file={activeFile} selection={focus.filePath === activeFile.path ? focus : undefined}\r\n                    fileEditorMode={focus.filePath === activeFile.path ? fileEditorMode_focus : fileEditorMode_noFocus}\r\n                    onChange={changeFile} onSelectionChange={changeSelection}\r\n                    onTaskDone={onTaskDone}\r\n                    lessonData={lessonData}\r\n                />\r\n            )}\r\n        </>\r\n    );\r\n};\r\n\r\nexport const LessonFileEditor = ({\r\n    projectEditorMode,\r\n    fileEditorMode,\r\n    file,\r\n    onChange,\r\n    selection,\r\n    onSelectionChange,\r\n    onTaskDone,\r\n    lessonData,\r\n}: {\r\n    projectEditorMode: LessonProjectEditorMode;\r\n    fileEditorMode: LessonFileEditorMode;\r\n    file: LessonProjectFile;\r\n    onChange: (value: LessonProjectFile) => void;\r\n    selection?: LessonProjectFileSelection;\r\n    onSelectionChange: (value: { index: number, length: number }) => void;\r\n    onTaskDone: () => void;\r\n    lessonData: LessonData;\r\n}) => {\r\n\r\n    const [filePathEdit, setFilePathEdit] = useState(file.path);\r\n    const changeFileName = () => {\r\n        file.path = filePathEdit;\r\n        onChange({ ...file, path: filePathEdit });\r\n    };\r\n\r\n    return (\r\n        <>\r\n            {projectEditorMode === `edit` && (\r\n                <View style={{ flexDirection: `row` }}>\r\n                    <TextInput\r\n                        style={{\r\n                            padding: 4,\r\n                            fontSize: 12,\r\n                            color: `#FFFFFF`,\r\n                            background: `#000000`,\r\n                        }}\r\n                        value={filePathEdit}\r\n                        onChange={setFilePathEdit}\r\n                        onBlur={changeFileName}\r\n                        autoCompleteType='off'\r\n                        keyboardType='default'\r\n                    />\r\n                </View>\r\n            )}\r\n            <LessonFileContentEditor\r\n                file={file}\r\n                onCodeChange={x => onChange({ ...file, content: x })}\r\n                mode={fileEditorMode}\r\n                selection={selection}\r\n                onSelectionChange={onSelectionChange}\r\n                onTaskDone={onTaskDone}\r\n                lessonData={lessonData}\r\n            />\r\n        </>\r\n    );\r\n};\r\n\r\nexport type LessonFileEditorMode = 'display' | 'edit' | 'construct-code' | 'understand-code';\r\nexport const LessonFileContentEditor = ({\r\n    file,\r\n    selection,\r\n    mode,\r\n    onCodeChange,\r\n    onSelectionChange,\r\n    onTaskDone,\r\n    lessonData,\r\n}: {\r\n    file: LessonProjectFile;\r\n    selection?: LessonProjectFileSelection;\r\n    mode: LessonFileEditorMode;\r\n    onCodeChange: (code: string) => void;\r\n    onSelectionChange: (value: { index: number, length: number }) => void;\r\n    onTaskDone: () => void;\r\n    lessonData: LessonData;\r\n}) => {\r\n    return (\r\n        <View style={{}}>\r\n            {/* <View style={{ background: `#1e1e1e`, alignSelf: `flex-start`, padding: 4 }}>\r\n                <Text>{` ${file.path}`}</Text>\r\n            </View> */}\r\n            <View style={{ padding: 0 }}>\r\n                {mode === `display` && (\r\n                    <LessonFileContentEditor_Display code={file.content} language={file.language} selection={selection} />\r\n                )}\r\n                {mode === `edit` && (\r\n                    <LessonFileContentEditor_Edit code={file.content} language={file.language} selection={selection} onCodeChange={onCodeChange} onSelectionChange={onSelectionChange} />\r\n                )}\r\n                {mode === `construct-code` && (\r\n                    <LessonFileContentEditor_ConstructCode code={file.content} language={file.language} selection={selection} onDone={onTaskDone} lessonData={lessonData} />\r\n                )}\r\n                {mode === `understand-code` && (\r\n                    <LessonFileContentEditor_UnderstandCode code={file.content} language={file.language} selection={selection} onDone={onTaskDone} lessonData={lessonData} />\r\n                )}\r\n            </View>\r\n        </View >\r\n    );\r\n};\r\n\r\nconst LessonFileContentEditor_Display = ({ code, language, selection }: { code: string, language: 'tsx', selection?: LessonProjectFileSelection }) => {\r\n    const codeParts = getCodeParts(code, language, selection);\r\n    return (\r\n        <CodeDisplay codeParts={codeParts.codeParts} language={language} />\r\n    );\r\n};\r\n\r\nconst LessonFileContentEditor_Edit = ({ code, language, selection, onCodeChange, onSelectionChange,\r\n}: {\r\n    code: string;\r\n    language: 'tsx';\r\n    selection?: LessonProjectFileSelection;\r\n    onCodeChange: (code: string) => void;\r\n    onSelectionChange: (value: { index: number, length: number }) => void;\r\n}) => {\r\n\r\n    const [inputText, setInputText] = useState(code);\r\n    const [codeParts, setCodeParts] = useState(null as null | CodePartsData);\r\n    const changeInputText = (value: string) => {\r\n        setInputText(value);\r\n        const parts = getCodeParts(code, language, selection);\r\n        setCodeParts(parts);\r\n    };\r\n    const onBlur = () => {\r\n        setInputText(inputText);\r\n        const parts = getCodeParts(code, language, selection);\r\n        setCodeParts(parts);\r\n        onCodeChange(inputText);\r\n    };\r\n    useEffect(() => {\r\n        const parts = getCodeParts(code, language, selection);\r\n        setCodeParts(parts);\r\n    }, [code, selection]);\r\n\r\n    return (\r\n        <View >\r\n            <View style={{}}>\r\n                <TextInput\r\n                    style={{\r\n                        padding: 4,\r\n                        fontSize: 12,\r\n                        color: `#FFFFFF`,\r\n                        background: `#000000`,\r\n                    }}\r\n                    value={inputText}\r\n                    onChange={changeInputText}\r\n                    onBlur={onBlur}\r\n                    autoCompleteType='off'\r\n                    keyboardType='default'\r\n                    multiline\r\n                    numberOfLines={16}\r\n                    onSelectionChange={x => onSelectionChange({ index: x.start, length: x.end - x.start })}\r\n                />\r\n            </View>\r\n            <View>\r\n                {codeParts && (<CodeDisplay codeParts={codeParts.codeParts} language={language} />)}\r\n            </View>\r\n        </View>\r\n    );\r\n};\r\n"],"sourceRoot":""}