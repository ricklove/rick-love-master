(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[32],{XFco:function(e,t,n){"use strict";n.r(t),n.d(t,"WebsocketClientTestView",(function(){return f}));var a=n("t8gp"),s=n("ERkP"),r=n.n(s),c=n("DTYs"),i=n("EsTT"),o=n("9DGK"),u="wss://p4w1a7ysk8.execute-api.us-east-1.amazonaws.com/prod",l=""+Date.now()+Math.random(),f=function(e){var t=Object(s.useState)([]),n=t[0],f=t[1],p=Object(s.useState)([]),d=p[0],m=p[1],b=Object(s.useRef)(null);Object(s.useEffect)((function(){var e,t=(e={websocketsApiUrl:u},{connect:function(t){var n=t.key,a=Object(i.a)(),s=Object(i.a)(),r=function(){var t=new WebSocket(""+e.websocketsApiUrl);return t.addEventListener("open",(function(e){if(t===c){s.onStateChange({connectionStatus:"opened"});var a={message:null,key:n};t.send(JSON.stringify(a))}else t.close()})),t.addEventListener("close",(function(e){t===c?(s.onStateChange({connectionStatus:"closed"}),u()):t.close()})),t.addEventListener("error",(function(e){t===c?(s.onStateChange({connectionStatus:"error",error:{message:"Websocket Error",error:e}}),u()):t.close()})),t.addEventListener("message",(function(e){if(t===c){var s=JSON.parse(e.data);s.key===n&&s.message&&a.onStateChange(s.message)}else t.close()})),t},c=r(),u=function(){setTimeout((function(){c=r()}),50)};return{send:function(e){if(c.readyState!==WebSocket.OPEN)throw new o.b("Websocket is not open");var t={message:e,key:n};c.send(JSON.stringify(t))},subscribeMessages:a.subscribe,subscribeConnectionEvents:s.subscribe}}}).connect({key:"test"});b.current=t.send;var n=t.subscribeMessages((function(e){f((function(t){return[].concat(Object(a.a)(t),[Object.assign({},e,{receivedAtTimestamp:Date.now()})])}))})),s=t.subscribeConnectionEvents((function(e){m((function(t){return[].concat(Object(a.a)(t),[e])}))}));return function(){b.current=null,n.unsubscribe(),s.unsubscribe()}}),[]);var S=Object(s.useState)(""),E=S[0],g=S[1],y=function(){var e;b.current&&(null===(e=b.current)||void 0===e||e.call(b,{text:E,timestamp:Date.now(),senderKey:l}),g(""))};return r.a.createElement(c.h,{style:{padding:4}},r.a.createElement(c.h,{style:{padding:4}},r.a.createElement(c.e,{style:{whiteSpace:"pre-wrap",fontSize:18}},"Events"),d.map((function(e,t){return r.a.createElement(c.e,{key:t,style:{whiteSpace:"pre-wrap",fontSize:14}},JSON.stringify(e))}))),r.a.createElement(c.h,{style:{padding:4}},r.a.createElement(c.e,{style:{whiteSpace:"pre-wrap",fontSize:18}},"Messages"),n.map((function(e,t){var n;return r.a.createElement(c.e,{key:t,style:{whiteSpace:"pre-wrap",fontSize:14}},e.timestamp+" "+(e.receivedAtTimestamp-e.timestamp)+": "+(null!==(n=e.text)&&void 0!==n?n:JSON.stringify(e)))}))),r.a.createElement(c.h,{style:{padding:4}},r.a.createElement(c.e,{style:{whiteSpace:"pre-wrap",fontSize:18}},"Send Message"),r.a.createElement(c.h,{style:{flexDirection:"row",alignItems:"center"}},r.a.createElement(c.h,{style:{flex:1,paddingRight:4}},r.a.createElement(c.f,{style:{fontSize:16},value:E,onChange:g,keyboardType:"default",autoCompleteType:"off",onBlur:y,onSubmitEditing:y})),r.a.createElement(c.g,{onPress:y},r.a.createElement(c.e,{style:{whiteSpace:"pre-wrap",fontSize:18}},"Send")))))}}}]);
//# sourceMappingURL=32-b7a7feba2cc842e16a95.js.map