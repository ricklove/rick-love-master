{"version":3,"sources":["webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/browser/getCreateFFmpegCore.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/core-js/modules/es.promise.finally.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/browser/fetchFile.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/index.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/browser/defaultOptions.js","webpack:///D:/Projects/rick-love-master/code/art/rando.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/circles.tsx","webpack:///D:/Projects/rick-love-master/code/art/artwork/layers-of-the-onions-soul.tsx","webpack:///D:/Projects/rick-love-master/code/art/artwork/art-121-helpers.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/art-121.tsx","webpack:///D:/Projects/rick-love-master/code/art/div-host.tsx","webpack:///D:/Projects/rick-love-master/code/art/artwork/puzzle/art-puzzle-01.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/gears.tsx","webpack:///D:/Projects/rick-love-master/code/art/artwork/gpu-01/gpu-01.tsx","webpack:///D:/Projects/rick-love-master/code/art/artwork/flying-colors/flying-colors.tsx","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/systems/webgl.ts","webpack:///D:/Projects/rick-love-master/node_modules/dat.gui/build/dat.gui.module.js","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/utils.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/systems/texture.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/systems/shader.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/run.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/systems/frame-buffer.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/config.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/gui.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/shaders.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/example-fluid-simulator.tsx","webpack:///D:/Projects/rick-love-master/code/art/artwork/games/flappy-dodge.ts","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/fluid-simulator-game.tsx","webpack:///D:/Projects/rick-love-master/code/utils/clamp.ts","webpack:///D:/Projects/rick-love-master/code/art/canvas-video-recording/canvas-video-recorder.tsx","webpack:///D:/Projects/rick-love-master/code/art/art-gallery.tsx","webpack:///D:/Projects/rick-love-master/code/art/artwork/example-PavelDoGreat-fluid-simulation/src/ga.ts","webpack:///D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/utils/log.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/browser/index.js","webpack:///D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack:///D:/Projects/rick-love-master/node_modules/resolve-url/resolve-url.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/createFFmpeg.js","webpack:///D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/objectWithoutProperties.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/utils/parseArgs.js","webpack:///D:/Projects/rick-love-master/node_modules/gatsby/node_modules/core-js/modules/es.math.hypot.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/config.js","webpack:///D:/Projects/rick-love-master/node_modules/@ffmpeg/ffmpeg/src/utils/parseProgress.js"],"names":["_regeneratorRuntime","_asyncToGenerator","resolveURL","log","toBlobURL","_ref","mark","_callee","url","mimeType","buf","blob","blobURL","wrap","_context","prev","next","concat","fetch","sent","arrayBuffer","byteLength","Blob","type","URL","createObjectURL","abrupt","stop","_x","_x2","apply","this","arguments","module","exports","_ref3","_callee2","_ref2","_corePath","coreRemotePath","corePath","wasmPath","workerPath","_context2","Error","replace","createFFmpegCore","Promise","resolve","script","document","createElement","src","addEventListener","eventHandler","removeEventListener","getElementsByTagName","appendChild","_x3","$","IS_PURE","NativePromise","fails","getBuiltIn","speciesConstructor","promiseResolve","redefine","target","proto","real","forced","prototype","call","then","onFinally","C","isFunction","x","e","readFromBlobOrFile","reject","fileReader","FileReader","onload","result","onerror","code","error","readAsArrayBuffer","_data","data","res","Uint8Array","test","atob","split","map","c","charCodeAt","File","createFFmpeg","fetchFile","devDependencies","process","FFMPEG_ENV","substring","createRandomGenerator","hash","a","seed","str","h","length","i","Math","imul","xmur3","random","t","art_circles","key","title","description","artist","getTokenDescription","tokenId","renderArt","hostElement","floor","b","cr","cg","cb","ca","tick","p5","s","setup","createCanvas","draw","background","scale","size","color","noFill","stroke","j","circle","translate","rotate","art_layersOfTheOnionsSoul","d","fill","sin","parseTokenId_art121","tokenTimestampValue","Number","parseInt","substr","tokenCounterValue","console","isFinite","tokenCounter","timestampSecs","targetSecs","Date","getTime","timeDeltaSecs","abs","art_121","tokenData","drawClock","index","clockRadius","units","value","perUnit","iHalf","PI","isFront","xZeroValue","correctRatioRaw","zRotation","cos","angleOffset","y","isFrontValue","sign","colorKey","alphaShift","lowAlpha","ceil","strokeWeight","line","defaultDelta","now","tokenTimeDeltaSecs","delta","year","month","day","hour","minute","second","iTick","DivHost","props","hostElementRef","useRef","HostElement","Component","style","width","height","ref","useEffect","current","innerHTML","remove","art_puzzle01","oppositeDirection","dir","state","board","boardVisits","moveSequence","player","moveIndex","calculateNextPos","posRaw","pos","exit","renderSeed","item","renderPos","push","randomMove","direction","r","distance","gridSize","wallColorCount","wallColors","Array","getNextWallRandomSeed","lastReverseMove","calculatePlayerReverseMove","reverseMove","lastPos","nextPos","itemAtPos","find","itemAtNextPos","m","endPosition","actualDistance","startPosition","actualMove","unshift","p","actualReverseMove","isVisited","getRenderPosition","forEach","drawPuzzleItem","gameWon","targetRenderPos","aOffset","tOffset","angle","trans","rect","itemSize","spiralRadius","iOffset","mod","filter","activeMove","pPos","tPos","undefined","wallPos","wall","slice","keyPressed","keyCode","UP_ARROW","LEFT_ARROW","DOWN_ARROW","RIGHT_ARROW","getKeyDirection","nextMove","drawGear","g","options","colorMode","position","radiusInner","radiusOuter","radiusAxis","teeth","rotationAngle","randomSeed","randomConstant","round","randomSym","toothAngle","TWO_PI","radI","radO","jitterSize","angle0","angle1","noStroke","curveTightness","beginShape","curveVertex","endShape","drawFace","faceType","radSmile","ex","ey","art_gears","randomMain","brightness","speed","gearCount","lastGear","radius","canvasSize","gears","targetRadius","targetDistance","angleQuandrant","targetAngle","xDelta","yDelta","actualRadius","sqrt","noise","noiseDebounceTime","toggleNoise","disconnect","Noise","amp","start","mousePressed","mouseX","mouseY","touchStarted","touches","faceCount","faceCreepyCount","entries","gear","teethPassed","pow","path","art_gpu_01","shaderInstance","preload","loadShader","WEBGL","setUniform","millis","shader","art_flyingColors","lastTimeMs","getSupportedFormat","gl","internalFormat","format","texture","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texImage2D","fbo","createFramebuffer","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","supportRenderTextureFormat","gl2","R16F","RG16F","RG","RGBA16F","RGBA","colorToString","forceCSSHex","colorFormat","__state","conversionName","toString","toFixed","v","hex","ARR_EACH","ARR_SLICE","Common","BREAK","extend","each","obj","isObject","Object","keys","isUndefined","bind","defaults","compose","toCall","args","itr","scope","l","_key","defer","fnc","setTimeout","debounce","func","threshold","callImmediately","timeout","delayed","callNow","clearTimeout","toArray","isNull","isNaN","_isNaN","isArray","constructor","isNumber","isString","isBoolean","Function","INTERPRETATIONS","litmus","conversions","THREE_CHAR_HEX","read","original","match","space","write","SIX_CHAR_HEX","CSS_RGB","parseFloat","CSS_RGBA","HEX","RGB_ARRAY","RGBA_ARRAY","RGBA_OBJ","RGB_OBJ","HSVA_OBJ","HSV_OBJ","toReturn","interpret","family","conversion","tmpComponent","ColorMath","hsv_to_rgb","hi","f","q","rgb_to_hsv","min","max","NaN","rgb_to_hex","hex_with_component","component_from_hex","componentIndex","_typeof","Symbol","iterator","classCallCheck","instance","Constructor","TypeError","createClass","defineProperties","descriptor","enumerable","configurable","writable","defineProperty","protoProps","staticProps","get","object","property","receiver","desc","getOwnPropertyDescriptor","parent","getPrototypeOf","getter","inherits","subClass","superClass","create","setPrototypeOf","__proto__","possibleConstructorReturn","self","ReferenceError","Color","defineRGBComponent","component","componentHexIndex","recalculateRGB","set","defineHSVComponent","recalculateHSV","COMPONENTS","Controller","initialValue","domElement","__onChange","__onFinishChange","newValue","updateDisplay","getValue","EVENT_MAP_INV","HTMLEvents","MouseEvents","KeyboardEvents","k","CSS_VALUE_PIXELS","cssValueToPixels","val","dom","makeSelectable","elem","selectable","onselectstart","MozUserSelect","KhtmlUserSelect","unselectable","makeFullscreen","hor","vert","vertical","horizontal","left","right","top","bottom","fakeEvent","eventType","pars","aux","params","className","evt","createEvent","clientX","clientY","initMouseEvent","bubbles","cancelable","window","clickCount","init","initKeyboardEvent","initKeyEvent","ctrlKey","altKey","shiftKey","metaKey","charCode","initEvent","dispatchEvent","event","newBool","bool","attachEvent","unbind","detachEvent","addClass","classes","indexOf","join","removeClass","removeAttribute","splice","hasClass","RegExp","getWidth","getComputedStyle","getHeight","getOffset","el","offset","offsetParent","offsetLeft","offsetTop","isActive","activeElement","href","BooleanController","_Controller","_this2","_this","__prev","__checkbox","setAttribute","setValue","checked","OptionController","opts","__select","element","opt","desiredValue","selectedIndex","StringController","onChange","__input","blur","numDecimals","NumberController","_params","__min","__max","__step","step","__impliedStep","LN10","__precision","_v","minValue","maxValue","stepValue","NumberControllerBox","_NumberController","__truncationSuspended","prevY","onFinish","onMouseDrag","diff","onMouseUp","attempted","decimals","tenTo","i1","i2","o1","o2","NumberControllerSlider","preventDefault","bgRect","__background","getBoundingClientRect","onTouchMove","onTouchEnd","__foreground","pct","FunctionController","text","__button","fire","ColorController","__color","__temp","__selector","__saturation_field","__field_knob","__field_knob_border","__hue_knob","__hue_field","__input_textShadow","onBlur","valueField","fieldDown","setSV","fieldUpSV","fieldDownH","setH","fieldUpH","toOriginal","fieldRect","padding","backgroundColor","boxShadow","border","borderRadius","zIndex","borderRight","marginRight","display","cursor","linearGradient","cssText","outline","textAlign","fontWeight","textShadow","mismatch","flip","_flip","marginLeft","marginTop","toHexString","vendors","vendor","css","cssContent","indoc","doc","injected","head","saveDialogContents","ControllerFactory","requestAnimationFrame$1","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","CenteredDiv","backgroundElement","opacity","WebkitTransition","transition","body","hide","webkitTransform","layout","innerWidth","innerHeight","___$insertStyle","SUPPORTS_LOCAL_STORAGE","localStorage","SAVE_DIALOGUE","autoPlaceVirgin","autoPlaceContainer","hideableGuis","GUI","__ul","__folders","__controllers","__rememberedObjects","__rememberedObjectIndecesToControllers","__listening","closeOnTop","autoPlace","DEFAULT_WIDTH","resizable","hideable","load","preset","scrollable","root","useLocalStorage","getItem","getLocalStorageHash","saveToLocalStorage","titleRow","getRoot","gui","__preset_select","setPresetSelectIndex","revert","setWidth","name","closed","CLASS_CLOSED","onResize","__closeButton","TEXT_OPEN","TEXT_CLOSED","setItem","CLASS_MAIN","savedGui","JSON","parse","CLASS_CLOSE_BUTTON","CLASS_CLOSE_TOP","insertBefore","childNodes","CLASS_CLOSE_BOTTOM","titleRowName","createTextNode","addRow","CLASS_AUTO_PLACE_CONTAINER","CLASS_AUTO_PLACE","__resizeHandler","onResizeDebounced","addResizeHandle","stringify","getSaveObject","saveToLocalStorageIfPossible","newDom","liBefore","li","removeListeners","markPresetModified","modified","recallSavedValue","controller","matchedIndex","controllerMap","remembered","presetMap","_add","factoryArgs","before","__li","container","CLASS_CONTROLLER_ROW","__gui","_options","nextSibling","nextElementSibling","_nextSibling","_name","firstElementChild","listen","box","method","pc","pb","returned","oldName","wasListening","newController","stopPropagation","borderLeftColor","isModified","augmentController","location","addPresetOption","setSelected","showHideExplain","explain","addSaveMenu","div","__save_row","firstChild","button","button2","button3","select","getElementById","localStorageCheckBox","newConstructorTextArea","which","show","focus","save","presetName","prompt","saveAs","pmouseX","drag","dragStop","CLASS_DRAG","dragStart","__resize_handle","w","getCurrentPreset","useInitialValues","savedValues","toggleHide","CLASS_TOO_TALL","_keydownHandler","add","addColor","removeChild","destroy","subfolder","removeFolder","addFolder","newGuiParams","folders","folder","parentElement","open","close","node","offsetHeight","remember","updateDisplays","controllerArray","GUI$1","clamp01","input","correctDeltaX","canvas","aspectRatio","correctDeltaY","generateColor","HSVtoRGB","scaleByPixelRatio","pixelRatio","devicePixelRatio","hashCode","randomIntRange","minInclusive","maxInclusive","createTextureUtils","ext","createFrameBufferObject","getResolution","resolution","drawingBufferWidth","drawingBufferHeight","captureScreenshot","render","formatRGBA","halfFloatTexType","filename","uri","link","datauri","captureCanvas","ctx","getContext","imageData","createImageData","putImageData","textureToCanvas","id","nid","normalizeTexture","frameBuffer","Float32Array","readPixels","FLOAT","framebufferToTexture","toDataURL","download","append","click","revokeObjectURL","ShaderMaterial","factory","vertexShader","fragmentShaderSource","programs","activeProgram","uniforms","setKeywords","keywords","program","fragmentShader","compileShader","FRAGMENT_SHADER","createProgram","getUniforms","useProgram","ShaderProgram","runFluidSimulator","host","contentPath","timeProvider","isPaused","resizeCanvas","PointerEntity","texcoordX","texcoordY","prevTexcoordX","prevTexcoordY","deltaX","deltaY","down","moved","pointers","splatStack","webGlSystem","alpha","depth","stencil","antialias","preserveDrawingBuffer","getExtension","supportLinearFiltering","HALF_FLOAT","clearColor","formatRG","formatR","RED","gl1","halfFloat","HALF_FLOAT_OES","getWebGLSystem","frameBufferFactory","param","activeTexture","TEXTURE0","viewport","clear","COLOR_BUFFER_BIT","texelSizeX","texelSizeY","attach","createDoubleFrameBufferObject","fbo1","fbo2","swap","temp","createFrameBufferFactory","shaderFactory","source","keywordsString","keyword","addKeywords","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","trace","getShaderInfoLog","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","uniformCount","ACTIVE_UNIFORMS","uniformName","getActiveUniform","getUniformLocation","createShaderFactory","config","SIM_RESOLUTION","DYE_RESOLUTION","CAPTURE_RESOLUTION","DENSITY_DISSIPATION","VELOCITY_DISSIPATION","PRESSURE","PRESSURE_ITERATIONS","CURL","SPLAT_RADIUS","SPLAT_FORCE","SHADING","COLORFUL","COLOR_UPDATE_SPEED","PAUSED","BACK_COLOR","TRANSPARENT","BLOOM","BLOOM_ITERATIONS","BLOOM_RESOLUTION","BLOOM_INTENSITY","BLOOM_THRESHOLD","BLOOM_SOFT_KNEE","SUNRAYS","SUNRAYS_RESOLUTION","SUNRAYS_WEIGHT","MOTION_X","MOTION_Y","navigator","userAgent","disableGui","initFramebuffers","updateKeywords","dat","onFinishChange","fun","bloomFolder","sunraysFolder","captureFolder","github","ga","githubIcon","startGUI","ditheringTexture","LINEAR","REPEAT","RGB","UNSIGNED_BYTE","image","Image","createTextureAsync","dye","velocity","divergence","curl","pressure","bloom","sunrays","sunraysTemp","shaders","baseVertexShader","VERTEX_SHADER","blurVertexShader","blurShader","copyShader","clearShader","colorShader","checkerboardShader","displayShaderSource","bloomPrefilterShader","bloomBlurShader","bloomFinalShader","sunraysMaskShader","sunraysShader","splatShader","advectionShader","divergenceShader","curlShader","vorticityShader","pressureShader","gradientSubtractShader","createShaders","blurProgram","copyProgram","clearProgram","colorProgram","checkerboardProgram","bloomPrefilterProgram","bloomBlurProgram","bloomFinalProgram","sunraysMaskProgram","sunraysProgram","splatProgram","advectionProgram","divergenceProgram","curlProgram","vorticityProgram","pressureProgram","gradientSubtractProgram","displayMaterial","blit","bindBuffer","ARRAY_BUFFER","createBuffer","bufferData","STATIC_DRAW","ELEMENT_ARRAY_BUFFER","Uint16Array","vertexAttribPointer","enableVertexAttribArray","drawElements","TRIANGLES","UNSIGNED_SHORT","createFrameBufferUtils","bloomFramebuffers","resizeDoubleFBO","newFBO","uniform1i","uTexture","resizeFBO","simRes","dyeRes","texType","rgba","rg","filtering","disable","BLEND","initBloomFramebuffers","initSunraysFramebuffers","displayKeywords","disableStartupSplats","multipleSplats","lastUpdateTime","clientWidth","clientHeight","colorUpdateTimer","mask","destination","last","knee","curve0","curve1","curve2","uniform3f","curve","uniform1f","dest","uniform2f","texelSize","blendFunc","ONE","enable","baseTex","intensity","applyBloom","weight","iterations","ONE_MINUS_SRC_ALPHA","uniform4f","drawColor","drawCheckerboard","uBloom","uDithering","getTextureScale","ditherScale","uSunrays","drawDisplay","amount","splat","dx","dy","uTarget","point","correctRadius","windowSubs","windowAddEventListener","handler","disableInput","canvasSubs","canvasAddEventListener","updatePointerDownData","pointer","posX","posY","updatePointerMoveData","updatePointerUpData","offsetX","offsetY","targetTouches","touch","pageX","pageY","identifier","changedTouches","update","dt","dtActual","calcDeltaTime","range","updateColors","lastSplat","pop","applyInputs","uVelocity","uCurl","uDivergence","uPressure","dyeTexelSize","velocityId","uSource","dissipation","motion","pointerMap","Map","getSize","updateConfig","active","art_exampleFluidSimulator","flappyDodgeGame","environmentProvider","destroyed","environment","time","timeLast","timeMsStart","timeDelta","u","color1","color2","color2Stength","obstacles","obstaclesState","timeNextObstacle","getDisplaySize","minTickTimeMs","ratio","speedY","updatePlayer","onPlayerHit","freeObstacle","isStill","motionSignX","entity","updateObstacles","setBackgroundVelocity","renderEntity","kind","removeEntity","art_fluidSimulatorGame","recorder","sim","game","resetBloomAtTimeMs","isWaitingForFrame","getRecorder","addFrame","CanvasVideoRecorderControl","useState","mode","setMode","useAutoLoadingError","loading","doWork","onClick","stopIfObsolete","prepareTarget","framesPerSecond","quality","onPrepareTarget","completeToDownloadFile","ArtGallery","_settings","timeMsLost","timeMs","isRecording","workingCanvas","workingContext","blobs","requestPrepareTarget","beginIncreasingTime","completeToBlob","completeToDataUrl","artItems","art","recorderRef","settings","timeMsPerFrame","ffmpeg","buffer","FS","padStart","run","videoBlob","err","dataUrl","cvs","drawImage","toBlob","getSettings","getMode","targetReady","iscompletingVideo","setRenderId","showNavigation","setShowNavigation","setTokenId","isFullScreen","setIsFullScreen","customSize","setCustomSize","tokenDescription","setTokenDescription","useDebounce","queryParts","search","artKey","startsWith","artworkItem","newTokenId","changeTokenId","ArtComponent","cacheRenderArtwork","openSea","ArtworkComponentRef","artRenderer","fontFamily","fontSize","lineHeight","View_Panel","View_Form","Fragment","paddingBottom","Button_FormAction","onPress","View_FieldRow","Text_FormTitle","Input_Text","theme","text_formTitle","whiteSpace","maxWidth","maxHeight","logging","customLogger","setLogging","_logging","setCustomLogger","logger","message","defaultOptions","getCreateFFmpegCore","asyncGeneratorStep","gen","_next","_throw","arg","info","done","fn","numUrls","base","resolved","_toConsumableArray","_defineProperty","_objectWithoutProperties","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","sym","_objectSpread","getOwnPropertyDescriptors","_require","defaultArgs","baseOptions","_require2","parseProgress","parseArgs","_require3","version","NO_LOAD","_baseOptions$defaultO","optProgress","progress","Core","runResolve","running","detectCompletion","parseMessage","_yield$getCreateFFmpe","mainScriptUrlOrBlob","printErr","print","locateFile","prefix","endsWith","cwrap","isLoaded","_len","_args","_len2","_key2","ret","_Core$FS","setProgress","_progress","setLogger","_logger","objectWithoutPropertiesLoose","excluded","sourceSymbolKeys","propertyIsEnumerable","argsPtr","_malloc","Uint32Array","BYTES_PER_ELEMENT","idx","writeAsciiToMemory","$hypot","hypot","stat","Infinity","value1","value2","sum","aLen","larg","_slicedToArray","duration","ts2sec","ts","_ts$split","_ts$split2","_ts"],"mappings":"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","file":"8-f357678467f4d1a08c11.js","sourcesContent":["var _regeneratorRuntime = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime.js\");\n\nvar _asyncToGenerator = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\n/* eslint-disable no-undef */\nvar resolveURL = require('resolve-url');\n\nvar _require = require('../utils/log'),\n    log = _require.log;\n/*\n * Fetch data from remote URL and convert to blob URL\n * to avoid CORS issue\n */\n\n\nvar toBlobURL = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(url, mimeType) {\n    var buf, blob, blobURL;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            log('info', \"fetch \".concat(url));\n            _context.next = 3;\n            return fetch(url);\n\n          case 3:\n            _context.next = 5;\n            return _context.sent.arrayBuffer();\n\n          case 5:\n            buf = _context.sent;\n            log('info', \"\".concat(url, \" file size = \").concat(buf.byteLength, \" bytes\"));\n            blob = new Blob([buf], {\n              type: mimeType\n            });\n            blobURL = URL.createObjectURL(blob);\n            log('info', \"\".concat(url, \" blob URL = \").concat(blobURL));\n            return _context.abrupt(\"return\", blobURL);\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function toBlobURL(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nmodule.exports = /*#__PURE__*/function () {\n  var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(_ref2) {\n    var _corePath, coreRemotePath, corePath, wasmPath, workerPath;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _corePath = _ref2.corePath;\n\n            if (!(typeof _corePath !== 'string')) {\n              _context2.next = 3;\n              break;\n            }\n\n            throw Error('corePath should be a string!');\n\n          case 3:\n            coreRemotePath = resolveURL(_corePath);\n            _context2.next = 6;\n            return toBlobURL(coreRemotePath, 'application/javascript');\n\n          case 6:\n            corePath = _context2.sent;\n            _context2.next = 9;\n            return toBlobURL(coreRemotePath.replace('ffmpeg-core.js', 'ffmpeg-core.wasm'), 'application/wasm');\n\n          case 9:\n            wasmPath = _context2.sent;\n            _context2.next = 12;\n            return toBlobURL(coreRemotePath.replace('ffmpeg-core.js', 'ffmpeg-core.worker.js'), 'application/javascript');\n\n          case 12:\n            workerPath = _context2.sent;\n\n            if (!(typeof createFFmpegCore === 'undefined')) {\n              _context2.next = 15;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", new Promise(function (resolve) {\n              var script = document.createElement('script');\n\n              var eventHandler = function eventHandler() {\n                script.removeEventListener('load', eventHandler);\n                log('info', 'ffmpeg-core.js script loaded');\n                resolve({\n                  createFFmpegCore: createFFmpegCore,\n                  corePath: corePath,\n                  wasmPath: wasmPath,\n                  workerPath: workerPath\n                });\n              };\n\n              script.src = corePath;\n              script.type = 'text/javascript';\n              script.addEventListener('load', eventHandler);\n              document.getElementsByTagName('head')[0].appendChild(script);\n            }));\n\n          case 15:\n            log('info', 'ffmpeg-core.js script is loaded already');\n            return _context2.abrupt(\"return\", Promise.resolve({\n              createFFmpegCore: createFFmpegCore,\n              corePath: corePath,\n              wasmPath: wasmPath,\n              workerPath: workerPath\n            }));\n\n          case 17:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n\n  return function (_x3) {\n    return _ref3.apply(this, arguments);\n  };\n}();","'use strict';\nvar $ = require('../internals/export');\nvar IS_PURE = require('../internals/is-pure');\nvar NativePromise = require('../internals/native-promise-constructor');\nvar fails = require('../internals/fails');\nvar getBuiltIn = require('../internals/get-built-in');\nvar speciesConstructor = require('../internals/species-constructor');\nvar promiseResolve = require('../internals/promise-resolve');\nvar redefine = require('../internals/redefine');\n\n// Safari bug https://bugs.webkit.org/show_bug.cgi?id=200829\nvar NON_GENERIC = !!NativePromise && fails(function () {\n  NativePromise.prototype['finally'].call({ then: function () { /* empty */ } }, function () { /* empty */ });\n});\n\n// `Promise.prototype.finally` method\n// https://tc39.es/ecma262/#sec-promise.prototype.finally\n$({ target: 'Promise', proto: true, real: true, forced: NON_GENERIC }, {\n  'finally': function (onFinally) {\n    var C = speciesConstructor(this, getBuiltIn('Promise'));\n    var isFunction = typeof onFinally == 'function';\n    return this.then(\n      isFunction ? function (x) {\n        return promiseResolve(C, onFinally()).then(function () { return x; });\n      } : onFinally,\n      isFunction ? function (e) {\n        return promiseResolve(C, onFinally()).then(function () { throw e; });\n      } : onFinally\n    );\n  }\n});\n\n// patch native Promise.prototype for native async functions\nif (!IS_PURE && typeof NativePromise == 'function' && !NativePromise.prototype['finally']) {\n  redefine(NativePromise.prototype, 'finally', getBuiltIn('Promise').prototype['finally']);\n}\n","var _regeneratorRuntime = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime.js\");\n\nvar _asyncToGenerator = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar resolveURL = require('resolve-url');\n\nvar readFromBlobOrFile = function readFromBlobOrFile(blob) {\n  return new Promise(function (resolve, reject) {\n    var fileReader = new FileReader();\n\n    fileReader.onload = function () {\n      resolve(fileReader.result);\n    };\n\n    fileReader.onerror = function (_ref) {\n      var code = _ref.target.error.code;\n      reject(Error(\"File could not be read! Code=\".concat(code)));\n    };\n\n    fileReader.readAsArrayBuffer(blob);\n  });\n};\n\nmodule.exports = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_data) {\n    var data, res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            data = _data;\n\n            if (!(typeof _data === 'undefined')) {\n              _context.next = 3;\n              break;\n            }\n\n            return _context.abrupt(\"return\", new Uint8Array());\n\n          case 3:\n            if (!(typeof _data === 'string')) {\n              _context.next = 16;\n              break;\n            }\n\n            if (!/data:_data\\/([a-zA-Z]*);base64,([^\"]*)/.test(_data)) {\n              _context.next = 8;\n              break;\n            }\n\n            data = atob(_data.split(',')[1]).split('').map(function (c) {\n              return c.charCodeAt(0);\n            });\n            /* From remote server/URL */\n\n            _context.next = 14;\n            break;\n\n          case 8:\n            _context.next = 10;\n            return fetch(resolveURL(_data));\n\n          case 10:\n            res = _context.sent;\n            _context.next = 13;\n            return res.arrayBuffer();\n\n          case 13:\n            data = _context.sent;\n\n          case 14:\n            _context.next = 20;\n            break;\n\n          case 16:\n            if (!(_data instanceof File || _data instanceof Blob)) {\n              _context.next = 20;\n              break;\n            }\n\n            _context.next = 19;\n            return readFromBlobOrFile(_data);\n\n          case 19:\n            data = _context.sent;\n\n          case 20:\n            return _context.abrupt(\"return\", new Uint8Array(data));\n\n          case 21:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function (_x) {\n    return _ref2.apply(this, arguments);\n  };\n}();","require('regenerator-runtime/runtime');\n\nvar createFFmpeg = require('./createFFmpeg');\n\nvar _require = require('./node'),\n    fetchFile = _require.fetchFile;\n\nmodule.exports = {\n  /*\n   * Create ffmpeg instance.\n   * Each ffmpeg instance owns an isolated MEMFS and works\n   * independently.\n   *\n   * For example:\n   *\n   * ```\n   * const ffmpeg = createFFmpeg({\n   *  log: true,\n   *  logger: () => {},\n   *  progress: () => {},\n   *  corePath: '',\n   * })\n   * ```\n   *\n   * For the usage of these four arguments, check config.js\n   *\n   */\n  createFFmpeg: createFFmpeg,\n\n  /*\n   * Helper function for fetching files from various resource.\n   * Sometimes the video/audio file you want to process may located\n   * in a remote URL and somewhere in your local file system.\n   *\n   * This helper function helps you to fetch to file and return an\n   * Uint8Array variable for ffmpeg.wasm to consume.\n   *\n   */\n  fetchFile: fetchFile\n};","var resolveURL = require('resolve-url');\n\nvar _require = require('../../package.json'),\n    devDependencies = _require.devDependencies;\n/*\n * Default options for browser environment\n */\n\n\nmodule.exports = {\n  corePath: typeof process !== 'undefined' && process.env.FFMPEG_ENV === 'development' ? resolveURL('/node_modules/@ffmpeg/core/dist/ffmpeg-core.js') : \"https://unpkg.com/@ffmpeg/core@\".concat(devDependencies['@ffmpeg/core'].substring(1), \"/dist/ffmpeg-core.js\")\n};","/* eslint-disable no-return-assign */\r\n/* eslint-disable no-multi-assign */\r\n/* eslint-disable @typescript-eslint/no-unused-expressions */\r\n/* eslint-disable no-bitwise */\r\n\r\n// FROM: https://stackoverflow.com/a/47593316/567524\r\n\r\nfunction xmur3(str: string) {\r\n    let h = 1779033703 ^ str.length;\r\n    for (let i = 0; i < str.length; i++) {\r\n        h = Math.imul(h ^ str.charCodeAt(i), 3432918353);\r\n        h = h << 13 | h >>> 19;\r\n    }\r\n\r\n    return () => {\r\n        h = Math.imul(h ^ h >>> 16, 2246822507);\r\n        h = Math.imul(h ^ h >>> 13, 3266489909);\r\n        return (h ^= h >>> 16) >>> 0;\r\n    };\r\n}\r\n\r\nfunction mulberry32(a: number) {\r\n    return () => {\r\n        let t = a += 0x6D2B79F5;\r\n        t = Math.imul(t ^ t >>> 15, t | 1);\r\n        t ^= t + Math.imul(t ^ t >>> 7, t | 61);\r\n        return ((t ^ t >>> 14) >>> 0) / 4294967296;\r\n    };\r\n}\r\n\r\nexport const createRandomGenerator = (hash: string) => {\r\n    const seed = xmur3(hash)();\r\n    return {\r\n        random: mulberry32(seed),\r\n    };\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport p5 from 'p5';\r\nimport { createRandomGenerator } from '../rando';\r\nimport { ArtWork } from '../artwork-type';\r\n\r\nexport const art_circles: ArtWork = {\r\n    key: `art-circles`,\r\n    title: `Circles`,\r\n    description: `The circles we travel in life always bring us back home.`,\r\n    artist: `Rick Love`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        return null;\r\n    },\r\n    // openSea: {\r\n    //     tokenAddress: `0x495f947276749ce646f68ac8c248420045cb7b5e`,\r\n    //     tokenId: `91242641486941084018191434774360347389366801368112854311223385694785434025985`,\r\n    // },\r\n    renderArt: (hostElement: HTMLElement, hash = `This is my hash!`) => {\r\n        // const { a, b, c } = { a: 57, b: 23, c: 15 };\r\n\r\n\r\n        const { random } = createRandomGenerator(hash);\r\n\r\n        const { a, b, c } = { a: 1 + Math.floor(57 * random()), b: 1 + Math.floor(213 * random()), c: 1 + Math.floor(115 * random()) };\r\n        const { cr, cg, cb, ca } = { cr: Math.floor(25 + 230 * random()), cg: Math.floor(25 + 230 * random()), cb: Math.floor(25 + 230 * random()), ca: Math.floor(25 + 25 * random()) };\r\n\r\n        const size = 600;\r\n        const h = 200;\r\n        const scale = size / 400;\r\n        const speed = 0.5;\r\n\r\n        let tick = 0;\r\n        return new p5((s: p5) => {\r\n            s.setup = () => {\r\n                s.createCanvas(size, size);\r\n            };\r\n            s.draw = () => {\r\n                s.background(0);\r\n                s.scale(scale);\r\n\r\n                for (let i = 0; i < 10; i++) {\r\n                    const color = s.color((cr * i) % 255, (cg * i) % 255, (cb * i) % 255, ca);\r\n                    s.noFill();\r\n                    s.stroke(color);\r\n                    for (let j = 0; j < 36; j++) {\r\n                        s.circle(h - a / 2 + j % a, h - b / 2 + j % b, (h * 1.35) - (i * 5) % c);\r\n                    }\r\n                    s.translate(h, h);\r\n                    // s.rotate((a + b + c + tick * 0.001) % 2);\r\n                    s.rotate((a + b + c + tick * 0.001));\r\n                    s.translate(-h, -h);\r\n                    tick += speed;\r\n                }\r\n\r\n                tick++;\r\n            };\r\n        }, hostElement);\r\n    },\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport p5 from 'p5';\r\nimport { createRandomGenerator } from '../rando';\r\nimport { ArtWork } from '../artwork-type';\r\n\r\nexport const art_layersOfTheOnionsSoul: ArtWork = {\r\n    key: `art-onions`,\r\n    title: `Layers of the Onion's Soul`,\r\n    description: `This represents the complexity of an onion's soul - which has many layers, like a human.`,\r\n    artist: `Rick Love & Lydia Love - who called me weirdo as inspiration, and mentioned a circle, some squares, a tetrahedron, Minecraft blocks, and then said she meant cubes and spheres.`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        return null;\r\n    },\r\n    renderArt: (hostElement: HTMLElement, hash = `This is my hash!`) => {\r\n        // const { a, b, c } = { a: 3, b: 7, c: 15 };\r\n\r\n        const { random } = createRandomGenerator(hash);\r\n        const { a, b, c, d, e } = { a: 1 + Math.floor(17 * random()), b: 1 + Math.floor(57 * random()), c: 1 + Math.floor(35 * random()), d: 0 + Math.floor(5 * random()), e: 20 + Math.floor(255 * random()) };\r\n        // const { cr, cg, cb } = { cr: 207, cg: 175, cb: 65 };\r\n        const { cr, cg, cb } = { cr: Math.floor(25 + 230 * random()), cg: Math.floor(25 + 230 * random()), cb: Math.floor(25 + 230 * random()) };\r\n\r\n        let tick = 0;\r\n\r\n        return new p5((s: p5) => {\r\n            s.setup = () => {\r\n                s.createCanvas(400, 400);\r\n            };\r\n            s.draw = () => {\r\n                s.background(0);\r\n                for (let i = 0; i < 35; i++) {\r\n                    const color = s.color((cr + b * i) % 255, cg * (1 + i * a) % 255, (cb + i * d) % 255);\r\n                    s.fill(color);\r\n                    s.circle(150 + (i * 7) % b - a + 32 * Math.sin(tick * 0.001), 250 + i - c % 35 + b, (270 - i) % e);\r\n                    s.translate(100, 100);\r\n                    s.rotate(d + tick * 0.000007);\r\n                    s.translate(-120, -150);\r\n                    tick++;\r\n                }\r\n            };\r\n        }, hostElement);\r\n    },\r\n};\r\n","export const parseTokenId_art121 = (tokenId: string) => {\r\n    const tokenTimestampValue = Number.parseInt(tokenId.substr(0, tokenId.length - 6), 10);\r\n    const tokenCounterValue = Number.parseInt(tokenId.substr(tokenId.length - 6), 10);\r\n    console.log(`parseTokenId_art121`, { tokenId, tokenTimestampValue, tokenCounterValue });\r\n\r\n    if (!Number.isFinite(tokenTimestampValue)) { return null; }\r\n    if (!Number.isFinite(tokenCounterValue)) { return null; }\r\n\r\n    const tokenCounter = tokenCounterValue;\r\n    const timestampSecs = tokenTimestampValue;\r\n    const targetSecs = Math.floor(new Date(`2021-01-21 21:21:21Z`).getTime()) / 1000;\r\n    const timeDeltaSecs = Math.abs(targetSecs - timestampSecs);\r\n    return {\r\n        tokenId,\r\n        tokenCounter,\r\n        timestampSecs,\r\n        targetSecs,\r\n        timeDeltaSecs,\r\n    };\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport p5 from 'p5';\r\nimport { createRandomGenerator } from '../rando';\r\nimport { parseTokenId_art121 } from './art-121-helpers';\r\nimport { ArtWork } from '../artwork-type';\r\n\r\nexport const art_121: ArtWork = {\r\n    key: `art-121`,\r\n    title: `1/21/21 21:21:21`,\r\n    description: `This exact time pattern will occur only once in our human timeline. This NFT crypto art will attempt to capture that time to the precise second and embed it in the distributed blockchain forever. \r\n    \r\nHowever the exact outcome cannot be controlled: \r\n\r\nThe color scheme is generated from the token hash.\r\n\r\nEven more difficult to predict - the block mining timestamp since 1/21/21 21:21:21 UTC controls the behavior of the clocks:\r\n\r\nYear\r\nMonth\r\nDay\r\nHour\r\nMinute\r\nSecond\r\n\r\nIf this is mined at the exact second, perfect stability will be achieved.\r\n\r\nThis is all up to whatever timing occurs on the blockchain when these NFTs are mined by the collectors.\r\n\r\nCan we obtain the exact precision?\r\n`,\r\n    artist: `Rick Love`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        const tokenData = parseTokenId_art121(tokenId);\r\n        if (!tokenData) { return null; }\r\n\r\n        return `${tokenData.timeDeltaSecs} Seconds from 1/21/21 21:21:21 (#${tokenData.tokenCounter})`;\r\n    },\r\n    renderArt: (hostElement: HTMLElement, tokenId: string) => {\r\n        // const { a, b, c } = { a: 57, b: 23, c: 15 };\r\n\r\n\r\n        const { random } = createRandomGenerator(tokenId);\r\n        const { a, b, c } = { a: 1 + Math.floor(57 * random()), b: 1 + Math.floor(213 * random()), c: 1 + Math.floor(115 * random()) };\r\n        const { cr, cg, cb, ca } = { cr: Math.floor(25 + 230 * random()), cg: Math.floor(25 + 230 * random()), cb: Math.floor(25 + 230 * random()), ca: Math.floor(25 + 25 * random()) };\r\n\r\n        let tick = 0;\r\n\r\n        const tokenData = parseTokenId_art121(tokenId);\r\n\r\n        return new p5((s: p5) => {\r\n            s.setup = () => {\r\n                s.createCanvas(350, 350);\r\n            };\r\n            s.draw = () => {\r\n                s.background(0);\r\n\r\n                const drawClock = (index: number, clockRadius: number, units: number, value: number) => {\r\n\r\n                    const perUnit = 1 / units;\r\n                    const d = 0.8 * clockRadius * Math.sin(Math.PI * 2 * perUnit);\r\n\r\n                    for (let iHalf = 0; iHalf <= 1; iHalf++) {\r\n                        const isFront = iHalf === 1;\r\n                        let xZeroValue = 0;\r\n                        for (let i = 0; i < units; i++) {\r\n\r\n\r\n                            const errorRatio = (0.5 - Math.abs((value * perUnit) - 0.5)) * 2;\r\n                            const correctRatioRaw = 1 - errorRatio;\r\n                            // const correctRatio = correctRatioRaw * ((tick * 0.121 * correctRatioRaw) % 2 - 1);\r\n                            const zRotation = Math.cos((tick * 0.0121 * correctRatioRaw + index * 0.25));\r\n                            const angleOffset = -0.25 + value * perUnit;\r\n\r\n                            const x = zRotation * clockRadius * Math.cos(Math.PI * 2 * (angleOffset - i * perUnit));\r\n                            const y = clockRadius * Math.sin(Math.PI * 2 * (angleOffset - i * perUnit));\r\n\r\n                            if (i === 0) {\r\n                                xZeroValue = x;\r\n                            }\r\n\r\n                            const isFrontValue = (value === 0 && index % 2 === 0 ? -1 : 1) * Math.sign(xZeroValue) === Math.sign(x);\r\n                            // const isFrontValue = Math.sign(xZeroValue) === Math.sign(x);\r\n                            // const isFrontValue = Math.sign(xZeroValue) === Math.sign(x);\r\n\r\n                            if (isFront && !isFrontValue) { continue; }\r\n                            if (!isFront && isFrontValue) { continue; }\r\n\r\n                            // if (isFront && isFrontX) { continue; }\r\n                            // if (!isFront && (isFrontOnLeft && x > 0 || !isFrontOnLeft && x < 0)) { continue; }\r\n                            // if (!isFront && value !== 0) { continue; }\r\n\r\n                            const colorKey = index + 1;\r\n\r\n                            // const alphaShift = 0.5 + 0.5 * (x / clockRadius) * (isFrontOnLeft ? -1 : 1);\r\n                            // const alphaShift = 1;\r\n                            const alphaShift = isFront ? 1 : 0.25;\r\n                            const lowAlpha = Math.ceil(units < 100 ? 100 : 25);\r\n\r\n                            s.noFill();\r\n                            s.stroke(s.color((cr * colorKey) % 255, (cg * colorKey) % 255, (cb * colorKey) % 255, Math.ceil((value === 0 ? 255 : lowAlpha) * alphaShift)));\r\n                            s.strokeWeight(2);\r\n                            s.line(x * (1 - 0.05 * Math.abs(zRotation)), y * 0.95, x, y);\r\n\r\n                            if (i === 0) {\r\n                                s.stroke(s.color((cr * colorKey) % 255, (cg * colorKey) % 255, (cb * colorKey) % 255, value === 0 ? 255 : 50));\r\n                                s.line(0, 0, x, y);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                };\r\n\r\n                s.translate(175, 175);\r\n\r\n                const defaultDelta = ((new Date(`2021-01-21 21:21:21.212Z`)).getTime() - Date.now());\r\n                // const defaultDelta = ((new Date(`2022-01-21 21:21:21.212Z`)).getTime() - Date.now());\r\n                // const defaultDelta = ((new Date(`2000-01-01 00:00:00.000Z`)).getTime() - Date.now());\r\n                // const defaultDelta = 0;\r\n\r\n                const tokenTimeDeltaSecs = tokenData?.timeDeltaSecs;\r\n                const delta = tokenTimeDeltaSecs != null ? tokenTimeDeltaSecs * 1000 : defaultDelta;\r\n                // console.log(`delta`, { delta, defaultDelta, tokenId });\r\n\r\n                const e = {\r\n                    year: Math.floor(delta / (1000 * 60 * 60 * 24 * 365)),\r\n                    month: Math.floor(delta / (1000 * 60 * 60 * 24 * 31) % 12),\r\n                    day: Math.floor(delta / (1000 * 60 * 60 * 24) % 31),\r\n                    hour: Math.floor(delta / (1000 * 60 * 60) % 24),\r\n                    minute: Math.floor(delta / (1000 * 60) % 60),\r\n                    second: Math.floor(delta / (1000) % 60),\r\n                    // ms: delta % 1000,\r\n                };\r\n                const isBefore = true;\r\n\r\n                // tick = 0;\r\n                for (let iTick = 0; iTick < 10; iTick++) {\r\n                    drawClock(0, 140, 100, e.year);\r\n                    drawClock(1, 120, 12, e.month);\r\n                    drawClock(2, 100, 31, e.day);\r\n                    drawClock(3, 80, 60, e.hour);\r\n                    drawClock(4, 60, 60, e.minute);\r\n                    drawClock(5, 40, 60, e.second);\r\n                    // drawClock(6, 20, 1000, e.ms);\r\n\r\n                    s.background(s.color(0, 0, 0, 5));\r\n                    tick++;\r\n                }\r\n\r\n                s.translate(-175, -175);\r\n\r\n\r\n                const drawText = () => {\r\n                    s.textSize(20);\r\n                    s.noStroke();\r\n                    s.textFont(`monospace`);\r\n\r\n                    const pad = (value: number, digits: number) => (`${value}`).padStart(digits, `0`);\r\n\r\n                    s.fill(s.color(255, 255, 255));\r\n                    s.text(`1/21/21 21:21:21 GST`, 60, 20);\r\n\r\n                    s.fill(!isBefore ? s.color(0, 255, 0) : s.color(255, 0, 0));\r\n                    s.text(`${isBefore ? `-` : `+`} ${pad(e.year, 2)}y ${pad(e.month, 2)}m ${pad(e.day, 2)}d ${pad(e.hour, 2)}:${pad(e.minute, 2)}:${pad(e.second, 2)}`, 50, 340);\r\n                };\r\n\r\n                // drawText();\r\n\r\n                tick++;\r\n            };\r\n        }, hostElement);\r\n    },\r\n};\r\n","/* eslint-disable react/require-default-props */\r\nimport React, { useEffect, useRef } from 'react';\r\n\r\n\r\n// const hasLoadedScript = false;\r\n\r\nexport const DivHost = (props: {\r\n    renderArt: (hostElement: HTMLDivElement) => { remove: () => void };\r\n    // eslint-disable-next-line react/no-unused-prop-types\r\n    openSea?: {\r\n        tokenAddress: string;\r\n        tokenId: string;\r\n    };\r\n}) => {\r\n\r\n    const hostElementRef = useRef(null as null | HTMLDivElement);\r\n    const HostElement = useRef({ Component: () => <div style={{ width: `100%`, height: `100%` }} ref={hostElementRef} /> });\r\n\r\n    useEffect(() => {\r\n        // if (!hasLoadedScript) {\r\n        //     hasLoadedScript = true;\r\n        //     const scriptElement = document.createElement(`script`);\r\n        //     scriptElement.src = `https://unpkg.com/embeddable-nfts/dist/nft-card.min.js`;\r\n        //     document.head.append(scriptElement);\r\n        // }\r\n\r\n        if (!hostElementRef.current) { return () => { }; }\r\n\r\n        console.log(`DivHost - renderArt`, { hostElementRef: hostElementRef.current, renderArt: props.renderArt });\r\n        hostElementRef.current.innerHTML = ``;\r\n        const { remove } = props.renderArt(hostElementRef.current);\r\n        return () => {\r\n            remove();\r\n        };\r\n    }, [hostElementRef.current, props.renderArt]);\r\n\r\n\r\n    return (\r\n        <>\r\n            <HostElement.current.Component />\r\n            {/* {props.openSea && (\r\n                <>\r\n                    <div>Open Sea</div>\r\n                    <nft-card\r\n                        tokenAddress={props.openSea.tokenAddress}\r\n                        tokenId={props.openSea.tokenId}\r\n                        network='mainnet'\r\n                    />\r\n                </>\r\n            )} */}\r\n        </>\r\n    );\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport p5 from 'p5';\r\nimport { ArtWork } from '../../artwork-type';\r\nimport { createRandomGenerator } from '../../rando';\r\n\r\n\r\nconst parseTokenId_puzzle01 = (tokenId: string) => { return tokenId; };\r\n\r\nexport const art_puzzle01: ArtWork = {\r\n    key: `art-puzzle-01`,\r\n    title: `Puzzle 01`,\r\n    description: `Try to puzzle it out and unlock the answer.`,\r\n    artist: `Rick Love`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        const tokenData = parseTokenId_puzzle01(tokenId);\r\n        if (!tokenData) { return null; }\r\n\r\n        return `TokenId: ${tokenData}`;\r\n    },\r\n    renderArt: (hostElement: HTMLElement, tokenId: string) => {\r\n        // const { a, b, c } = { a: 57, b: 23, c: 15 };\r\n\r\n\r\n        const tokenData = parseTokenId_puzzle01(tokenId);\r\n\r\n        type Vector2 = { x: number, y: number };\r\n\r\n        type BoardItem = {\r\n            /** Seed for the render math */\r\n            renderSeed: string;\r\n            item: 'player' | 'exit' | 'entrance' | 'wall' | 'wall-broken';\r\n            pos: Vector2;\r\n\r\n            renderPos?: Vector2;\r\n            targetRenderPos?: Vector2;\r\n            activeMove?: ActualMove;\r\n        }\r\n        type MoveDirection = 'up' | 'down' | 'left' | 'right';\r\n        const oppositeDirection = (dir: MoveDirection): MoveDirection => {\r\n            switch (dir) {\r\n                case `up`: return `down`;\r\n                case `down`: return `up`;\r\n                case `left`: return `right`;\r\n                case `right`: return `left`;\r\n                default: return `up`;\r\n            }\r\n        };\r\n        type Move = {\r\n            direction: MoveDirection;\r\n            distance: number;\r\n        };\r\n        type ActualMove = {\r\n            direction: MoveDirection;\r\n            distance: number;\r\n            startPosition: Vector2;\r\n            endPosition: Vector2;\r\n        };\r\n        const state = {\r\n            board: [] as BoardItem[],\r\n            boardVisits: [] as { pos: Vector2 }[],\r\n            moveSequence: [] as ActualMove[],\r\n            player: {} as BoardItem,\r\n            moveIndex: 0,\r\n        };\r\n\r\n        const canvasSize = 350;\r\n        const gridSize = 16;\r\n        const itemSize = 20;\r\n        const gridAreaOffset = 15;\r\n        const maxMoveCount = 20;\r\n\r\n        const calculateNextPos = (posRaw: Vector2, dir: MoveDirection): Vector2 => {\r\n            const pos = { ...posRaw };\r\n            if (dir === `up`) { pos.y--; }\r\n            if (dir === `down`) { pos.y++; }\r\n            if (dir === `left`) { pos.x--; }\r\n            if (dir === `right`) { pos.x++; }\r\n            return pos;\r\n        };\r\n\r\n        return new p5((s: p5) => {\r\n            s.setup = () => {\r\n                s.createCanvas(canvasSize, canvasSize);\r\n                s.background(0);\r\n                // s.colorMode(s.HSB);\r\n\r\n                // Create board out of backwards generation of correct moves\r\n                const { random } = createRandomGenerator(tokenId);\r\n\r\n                const { board, boardVisits } = state;\r\n                const exit: BoardItem = {\r\n                    renderSeed: `${random()}`,\r\n                    item: `exit`,\r\n                    pos: {\r\n                        x: Math.floor(1 + (gridSize - 2) * random()),\r\n                        y: Math.floor(1 + (gridSize - 2) * random()),\r\n                    },\r\n                };\r\n\r\n                state.player = {\r\n                    renderSeed: `${random()}`,\r\n                    item: `player`,\r\n                    pos: { ...exit.pos },\r\n                    renderPos: { x: 0, y: 0 },\r\n                };\r\n                const { player } = state;\r\n\r\n                board.push(exit);\r\n                // board.push(player);\r\n\r\n                // // Crete outer wall\r\n                // for (let i = 0; i < gridSize; i++) {\r\n                //     board.push({ renderSeed: `${random()}`, item: `wall`, pos: { x: i, y: 0 } });\r\n                //     board.push({ renderSeed: `${random()}`, item: `wall`, pos: { x: i, y: gridSize - 1 } });\r\n                //     board.push({ renderSeed: `${random()}`, item: `wall`, pos: { x: 0, y: i } });\r\n                //     board.push({ renderSeed: `${random()}`, item: `wall`, pos: { x: gridSize - 1, y: i } });\r\n                // }\r\n\r\n                const randomMoveDirection = (): MoveDirection => {\r\n                    const r = random();\r\n                    if (r > 0.75) { return `up`; }\r\n                    if (r > 0.5) { return `down`; }\r\n                    if (r > 0.25) { return `left`; }\r\n                    return `right`;\r\n                };\r\n                const randomMove = (): Move => {\r\n                    return {\r\n                        direction: randomMoveDirection(),\r\n                        distance: Math.floor(0 + gridSize * 0.75 * random()),\r\n                    };\r\n                };\r\n\r\n                const wallColorMaxCount = 16;\r\n                const wallColorCount = 4 + Math.floor(random() * (wallColorMaxCount - 4));\r\n                const wallColors = [...new Array(wallColorCount)].map(x => `${random()}`);\r\n                const getNextWallRandomSeed = () => {\r\n                    return wallColors[Math.floor(random() * wallColorCount)];\r\n                };\r\n\r\n                // Reversed moves to generate board\r\n                let lastReverseMove = {\r\n                    distance: 0,\r\n                    direction: `unknown`,\r\n                } as unknown as Move;\r\n\r\n                const calculatePlayerReverseMove = (reverseMove: Move): null | ActualMove => {\r\n                    let d = reverseMove.distance;\r\n                    let lastPos = { ...player.pos };\r\n\r\n                    const dir = reverseMove.direction;\r\n                    while (d > 0) {\r\n                        const pos = calculateNextPos(lastPos, dir);\r\n                        const nextPos = calculateNextPos(lastPos, dir);\r\n\r\n                        // Past edge - fail\r\n                        if (pos.x <= 0 || pos.x >= gridSize - 1\r\n                            || pos.y <= 0 || pos.y >= gridSize - 1) { return null; }\r\n\r\n                        // Hit existing wall - fail\r\n                        const itemAtPos = board.find(x => x.item !== `player` && x.pos.x === pos.x && x.pos.y === pos.y);\r\n                        if (itemAtPos?.item === `wall`) { return null; }\r\n\r\n                        // Already next wall - fail\r\n                        const itemAtNextPos = board.find(x => x.item !== `player` && x.pos.x === nextPos.x && x.pos.y === nextPos.y);\r\n                        if (itemAtNextPos?.item === `wall`) { return null; }\r\n\r\n                        d--;\r\n                        lastPos = { ...pos };\r\n                    }\r\n\r\n                    // If in line with any existing endmove, reject\r\n                    const inLineWithLastPos = state.moveSequence.find(m => m.endPosition.x === lastPos.x || m.endPosition.y === lastPos.y);\r\n                    if (inLineWithLastPos) { return null; }\r\n\r\n                    const actualDistance = reverseMove.distance - d;\r\n                    return {\r\n                        direction: oppositeDirection(reverseMove.direction),\r\n                        distance: actualDistance,\r\n                        endPosition: { ...player.pos },\r\n                        startPosition: lastPos,\r\n                    };\r\n                };\r\n\r\n                // Add outer wall\r\n                for (let i = 0; i < gridSize; i++) {\r\n                    board.push({ renderSeed: getNextWallRandomSeed(), item: `wall`, pos: { x: i, y: 0 } });\r\n                    board.push({ renderSeed: getNextWallRandomSeed(), item: `wall`, pos: { x: i, y: gridSize - 1 } });\r\n                    board.push({ renderSeed: getNextWallRandomSeed(), item: `wall`, pos: { x: 0, y: i } });\r\n                    board.push({ renderSeed: getNextWallRandomSeed(), item: `wall`, pos: { x: gridSize - 1, y: i } });\r\n                }\r\n\r\n                // Add game walls\r\n                for (let i = 0; i < maxMoveCount; i++) {\r\n\r\n                    // Reverse Move player\r\n                    let reverseMove = randomMove();\r\n                    while (reverseMove.direction === lastReverseMove.direction\r\n                        || reverseMove.direction === oppositeDirection(lastReverseMove.direction)) {\r\n                        reverseMove = randomMove();\r\n                    }\r\n\r\n                    // Calculate reverse move\r\n                    const actualMove = calculatePlayerReverseMove(reverseMove);\r\n                    if (!actualMove || actualMove.distance <= 0) {\r\n                        continue;\r\n                    }\r\n\r\n                    // Add wall which would have stopped the player (having made this move forward)\r\n                    if (state.moveSequence.length > 0) {\r\n                        const nextPos = calculateNextPos(player.pos, oppositeDirection(reverseMove.direction));\r\n                        board.push({\r\n                            item: `wall`,\r\n                            pos: nextPos,\r\n                            renderSeed: getNextWallRandomSeed(),\r\n                        });\r\n                    }\r\n\r\n                    // Move player\r\n                    player.pos = actualMove.startPosition;\r\n                    state.moveSequence.unshift(actualMove);\r\n                    lastReverseMove = actualMove;\r\n\r\n                    // Add board visits\r\n                    let p = actualMove.startPosition;\r\n                    state.boardVisits.push({ pos: { ...p } });\r\n                    while (p.x !== actualMove.endPosition.x\r\n                        || p.y !== actualMove.endPosition.y) {\r\n                        p = calculateNextPos(p, actualMove.direction);\r\n                        state.boardVisits.push({ pos: { ...p } });\r\n                    }\r\n\r\n                    console.log(`boardVisits`, { actualReverseMove: actualMove, boardVisits: [...state.boardVisits] });\r\n                }\r\n\r\n                // Add random walls\r\n                for (let x = 0; x < gridSize; x++) {\r\n                    for (let y = 0; y < gridSize; y++) {\r\n                        const isVisited = !!boardVisits.find(b => b.pos.x === x && b.pos.y === y);\r\n                        const item = !!board.find(b => b.pos.x === x && b.pos.y === y);\r\n\r\n                        if (isVisited || item) { continue; }\r\n\r\n                        if (random() > 0.75) {\r\n                            board.push({\r\n                                item: `wall`,\r\n                                pos: { x, y },\r\n                                renderSeed: getNextWallRandomSeed(),\r\n                            });\r\n                        }\r\n                    }\r\n                }\r\n\r\n\r\n                player.renderPos = getRenderPosition(player.pos);\r\n                state.board.forEach(x => drawPuzzleItem(x));\r\n            };\r\n\r\n            const getRenderPosition = (p: Vector2) => {\r\n                const x = gridAreaOffset + p.x * itemSize;\r\n                const y = gridAreaOffset + p.y * itemSize;\r\n                return { x, y };\r\n            };\r\n\r\n            const drawPuzzleItem = (item: typeof state.board[0]) => {\r\n                const { random } = createRandomGenerator(item.renderSeed);\r\n                const { a, b, c } = { a: 1 + Math.floor(57 * random()), b: 1 + Math.floor(213 * random()), c: 1 + Math.floor(115 * random()) };\r\n                const { cr, cg, cb, ca } = { cr: Math.floor(25 + 230 * random()), cg: Math.floor(25 + 230 * random()), cb: Math.floor(25 + 230 * random()), ca: Math.floor(25 + 125 * random()) };\r\n\r\n                const { x, y } = item.renderPos ?? getRenderPosition(item.pos);\r\n                s.fill(cr, cg, cb, ca);\r\n                s.stroke(cr, cg, cb, 255);\r\n                s.strokeWeight(1);\r\n\r\n                const gameWon = state.moveIndex >= state.moveSequence.length && !state.player.targetRenderPos;\r\n\r\n                const aOffset = tick / 100;\r\n                const tOffset = Math.abs(Math.floor(Math.sin((tick + a * c) / 1000) * canvasSize));\r\n                const alphaCycle = 100;\r\n\r\n                if (item.item === `player`) {\r\n                    if (gameWon) {\r\n                        s.stroke(0, 0, 0, 10);\r\n\r\n                        let mod = tick;\r\n                        for (let i = 0; i < 16; i++) {\r\n                            s.fill(cr, cg, (cb + i * c) % 255, Math.floor(Math.sin((tick + a * c) / alphaCycle) * 25 + 35));\r\n\r\n                            const j = 0;\r\n                            s.circle(200 - a / 2 + j % a, 200 - b / 2 + j % b, 270 - (i * 5) % c);\r\n                            s.translate(tOffset, tOffset);\r\n                            // s.rotate((a + b + c + tick * 0.001) % 2);\r\n                            s.rotate(((a + b + c + mod) * 0.001));\r\n                            s.translate(-tOffset, -tOffset);\r\n                            mod++;\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    s.fill(cr, cg, cb, 30);\r\n                    const circleCount = 4;\r\n                    const spiralRadius = 0.01 * (4 + state.moveSequence.length - state.moveIndex);\r\n                    // const spiralRadius = 0.1;\r\n                    for (let i = 0; i < circleCount; i++) {\r\n                        s.stroke(cr, cg, cb, Math.floor(255 * (i + 1) / (circleCount + 1)));\r\n\r\n                        s.circle(x + itemSize * (0.5 + spiralRadius * Math.cos(2 * Math.PI * (i / circleCount + tick / 100))), y + itemSize * (0.5 + spiralRadius * Math.sin(2 * Math.PI * (i / circleCount + tick / 100))), itemSize);\r\n                    }\r\n\r\n                    // s.circle(x + 0.5 * itemSize, y + 0.5 * itemSize, itemSize);\r\n                    return;\r\n                }\r\n\r\n                if (item.item === `exit`) {\r\n                    if (gameWon) {\r\n                        s.fill(cr, cg, cb, Math.floor(Math.sin((tick + a * c) / alphaCycle) * 25 + 35));\r\n                        s.stroke(0, 0, 0, 10);\r\n\r\n                        let angle = a;\r\n                        let trans = c;\r\n                        for (let i = 0; i < 32; i++) {\r\n\r\n                            // s.rect(x + itemSize * 0.25, y + itemSize * 0.25, itemSize * 0.5, itemSize * 0.5);\r\n                            s.translate(trans, trans);\r\n                            s.rotate(angle + aOffset);\r\n                            s.rect(x + itemSize * 0.25, y + itemSize * 0.25, c * x, c * y);\r\n                            s.rotate(-angle - aOffset);\r\n                            s.translate(-trans, -trans);\r\n                            angle += b;\r\n                            trans += c;\r\n                            trans %= 125;\r\n                        }\r\n                        return;\r\n                    }\r\n\r\n                    // s.fill(cr, cg, cb, 200);\r\n                    s.fill(255, 255, 255);\r\n                    s.rect(x, y, itemSize, itemSize);\r\n                    s.fill(0, 0, 0);\r\n                    s.rect(x + itemSize * 0.25, y + itemSize * 0.25, itemSize * 0.5, itemSize * 0.5);\r\n                    return;\r\n                }\r\n\r\n                if (item.item === `wall-broken`) {\r\n                    if (!gameWon) { return; }\r\n\r\n                    s.fill(cr, cg, cb, Math.floor(Math.sin((tick + a * c) / alphaCycle) * 25 + 25));\r\n                    s.stroke(0, 0, 0, 10);\r\n\r\n                    let angle = a;\r\n                    const trans = c % (canvasSize * 0.5);\r\n                    for (let i = 0; i < 8; i++) {\r\n\r\n                        s.translate(-trans, -trans);\r\n                        s.rotate(angle + aOffset);\r\n                        s.rect(x, y, itemSize * x, itemSize * y);\r\n                        s.rotate(-angle - aOffset);\r\n                        s.translate(trans, trans);\r\n                        angle += b;\r\n                        // trans += c;\r\n                        // trans %= 3;\r\n                    }\r\n                    return;\r\n\r\n                    // s.rect(x + itemSize * 0.25, y + itemSize * 0.25, itemSize * 0.5, itemSize * 0.5);\r\n                    // s.rect(x, y, itemSize * x, itemSize * y);\r\n                    // return;\r\n                }\r\n\r\n                if (gameWon) {\r\n                    return;\r\n                    // s.fill(cr, cg, cb, Math.floor(Math.sin((tick + a * c) / alphaCycle) * 25 + 25));\r\n                    // s.rect(x, y, itemSize, itemSize);\r\n                    // return;\r\n                }\r\n                // s.rect(x, y, itemSize, itemSize);\r\n\r\n                s.fill(cr, cg, cb, 5);\r\n                const circleCount = 4;\r\n                const spiralRadius = 0.015 * (4 + state.moveSequence.length - state.moveIndex);\r\n                const iOffset = random();\r\n                for (let i = 0; i < circleCount; i++) {\r\n                    s.stroke(cr, cg, cb, Math.floor(255 * (i + 1) / (circleCount + 1)));\r\n                    s.rect(x + itemSize * (0 + spiralRadius * Math.cos(2 * Math.PI * ((iOffset + i) / circleCount + tick / 100))), y + itemSize * (0 + spiralRadius * Math.sin(2 * Math.PI * ((iOffset + i) / circleCount + tick / 100))), itemSize, itemSize);\r\n                }\r\n            };\r\n\r\n            let tick = 0;\r\n            s.draw = () => {\r\n                s.background(0);\r\n                // s.background(0, 0, 0, 5);\r\n\r\n                const drawMoveHistory = (m: typeof state.moveSequence[0]) => {\r\n                    s.noFill();\r\n                    s.stroke(255, 255, 255, 100);\r\n\r\n                    const x1 = gridAreaOffset + m.startPosition.x * itemSize + itemSize * 0.5;\r\n                    const y1 = gridAreaOffset + m.startPosition.y * itemSize + itemSize * 0.5;\r\n                    const x2 = gridAreaOffset + m.endPosition.x * itemSize + itemSize * 0.5;\r\n                    const y2 = gridAreaOffset + m.endPosition.y * itemSize + itemSize * 0.5;\r\n                    s.line(x1, y1, x2, y2);\r\n                    s.line(x1 + itemSize * 0.25, y1 + itemSize * 0.25, x2, y2);\r\n\r\n                    // s.text(`${i}`, x1,y1);\r\n                };\r\n\r\n                // state.board.forEach(x => drawPuzzleItem(x));\r\n                state.board.filter(x => x.item === `wall-broken`).forEach(x => drawPuzzleItem(x));\r\n                state.board.filter(x => x.item !== `wall-broken`).forEach(x => drawPuzzleItem(x));\r\n\r\n                drawPuzzleItem(state.player);\r\n\r\n                // Animate\r\n                if (state.player.activeMove && state.player.renderPos && state.player.targetRenderPos) {\r\n                    // state.player.renderPos = {\r\n                    //     x: 0.9 * state.player.renderPos.x + 0.1 * state.player.targetRenderPos.x,\r\n                    //     y: 0.9 * state.player.renderPos.y + 0.1 * state.player.targetRenderPos.y,\r\n                    // };\r\n\r\n                    const speed = 3;\r\n                    for (let i = 0; i < speed; i++) {\r\n                        state.player.renderPos = calculateNextPos(state.player.renderPos, state.player.activeMove.direction);\r\n\r\n                        const dist = Math.abs(state.player.renderPos.x - state.player.targetRenderPos.x)\r\n                            + Math.abs(state.player.renderPos.y - state.player.targetRenderPos.y);\r\n                        if (dist < 1) {\r\n                            state.player.renderPos = state.player.targetRenderPos;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // If player is done animating destroy wall\r\n                const { activeMove } = state.player;\r\n\r\n                const pPos = state.player.renderPos;\r\n                const tPos = state.player.targetRenderPos;\r\n                if (activeMove && pPos && tPos && pPos.x === tPos.x && pPos.y === tPos.y) {\r\n                    console.log(`Reached`, { activeMove, pPos, tPos });\r\n                    state.player.targetRenderPos = undefined;\r\n\r\n                    // Break any walls that have been reached\r\n                    for (const m of state.moveSequence.slice(0, state.moveIndex)) {\r\n                        const wallPos = calculateNextPos(m.endPosition, m.direction);\r\n                        const wall = state.board.find(x => x.pos.x === wallPos.x && x.pos.y === wallPos.y);\r\n                        if (!wall) { continue; }\r\n\r\n                        wall.item = `wall-broken`;\r\n                    }\r\n                }\r\n\r\n\r\n                // Debug\r\n                //  state.moveSequence.forEach(x => drawMoveHistory(x));\r\n                tick++;\r\n            };\r\n\r\n            s.keyPressed = () => {\r\n                const { key, keyCode } = s;\r\n\r\n                const getKeyDirection = (): null | MoveDirection => {\r\n                    switch (key) {\r\n                        case `w`: return `up`;\r\n                        case `a`: return `left`;\r\n                        case `s`: return `down`;\r\n                        case `d`: return `right`;\r\n                        default: break;\r\n                    }\r\n                    switch (keyCode) {\r\n                        case s.UP_ARROW: return `up`;\r\n                        case s.LEFT_ARROW: return `left`;\r\n                        case s.DOWN_ARROW: return `down`;\r\n                        case s.RIGHT_ARROW: return `right`;\r\n                        default: return null;\r\n                    }\r\n                };\r\n\r\n                const d = getKeyDirection();\r\n                if (!d) { return; }\r\n\r\n                // Move the player\r\n                const nextMove = state.moveSequence[state.moveIndex];\r\n                if (!nextMove) { return; }\r\n\r\n                if (nextMove.direction !== d) {\r\n                    state.moveIndex = 0;\r\n                    state.player.activeMove = undefined;\r\n                    state.player.renderPos = undefined;\r\n                    state.player.targetRenderPos = undefined;\r\n                    state.board.filter(x => x.item === `wall-broken`).forEach(x => { x.item = `wall`; });\r\n                    return;\r\n                }\r\n\r\n                state.player.activeMove = nextMove;\r\n                state.player.renderPos = getRenderPosition(nextMove.startPosition);\r\n                state.player.targetRenderPos = getRenderPosition(nextMove.endPosition);\r\n                state.moveIndex++;\r\n            };\r\n        }, hostElement);\r\n    },\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport p5 from 'p5';\r\nimport { createRandomGenerator } from '../rando';\r\nimport { ArtWork } from '../artwork-type';\r\n\r\ntype Vector2 = { x: number, y: number };\r\ntype ColorHsb = {\r\n    /** 0-360 */\r\n    h: number;\r\n    /** 0-100 */\r\n    s: number;\r\n    /** 0-100 */\r\n    b: number;\r\n    /** 0-1 */\r\n    a: number;\r\n};\r\nconst drawGear = (g: p5,\r\n    options: {\r\n        position: Vector2;\r\n        radiusInner: number;\r\n        radiusOuter: number;\r\n        radiusAxis: number;\r\n        teeth: number;\r\n        rotationAngle: number;\r\n        color: ColorHsb;\r\n        randomSeed: string;\r\n    }) => {\r\n    g.colorMode(`hsl`);\r\n\r\n    const { position: { x, y }, radiusInner, radiusOuter, radiusAxis, teeth, rotationAngle, color, randomSeed } = options;\r\n\r\n    const angleRandomKs = 16;\r\n    // const angleRandomKs = 8;\r\n    const { random: randomConstant } = createRandomGenerator(`${randomSeed}`);\r\n    const { random } = createRandomGenerator(`${randomSeed}${Math.round(rotationAngle * angleRandomKs)}`);\r\n    const randomSym = () => 1 - 2 * random();\r\n\r\n    // g.fill(color.h, color.s, color.b, color.a);\r\n    // g.stroke(0, 0, 0, 1);\r\n    // g.stroke(0, 0, 0, color.a);\r\n    // g.stroke(0, 0, 0, 0);\r\n    // g.circle(x, y, radiusOuter * 2);\r\n    // g.circle(x, y, radius * 2);\r\n\r\n    g.stroke(color.h, color.s, color.b, color.a);\r\n    g.noFill();\r\n\r\n    // g.circle(x, y, radiusOuter * 2);\r\n\r\n    const toothAngle = g.TWO_PI / teeth;\r\n    const radI = radiusInner;\r\n    const radO = radiusOuter;\r\n    let jitterSize = 2.5;\r\n    const angle0 = rotationAngle;\r\n    const angle1 = angle0 + Math.PI * 2 * randomConstant();\r\n\r\n    jitterSize = radiusOuter * 0.5;\r\n    for (let j = 0; j < 4; j++) {\r\n\r\n        g.noStroke();\r\n        g.fill(color.h, color.s, color.b * 0.25, 0.4);\r\n        // g.fill(color.h, color.s, color.b, 0.25);\r\n        // g.fill(0, 0, 0);\r\n        g.curveTightness(0.9);\r\n        g.beginShape();\r\n        for (let i = 0; i <= teeth; i++) {\r\n            // g.curveVertex(x + diaI * g.cos((i + 0) * toothAngle), y + diaI * g.sin((i + 0) * toothAngle));\r\n            if (i !== 0) {\r\n                g.curveVertex(x + (radI - jitterSize * random()) * g.cos((i + 0.2) * toothAngle + angle0), y + (radI - jitterSize * random()) * g.sin((i + 0.2) * toothAngle + angle0));\r\n            }\r\n\r\n            g.curveVertex(x + (radO - jitterSize * random()) * g.cos((i + 0.3) * toothAngle + angle0), y + (radO - jitterSize * random()) * g.sin((i + 0.3) * toothAngle + angle0));\r\n            g.curveVertex(x + (radO - jitterSize * random()) * g.cos((i + 0.7) * toothAngle + angle0), y + (radO - jitterSize * random()) * g.sin((i + 0.7) * toothAngle + angle0));\r\n            g.curveVertex(x + (radI - jitterSize * random()) * g.cos((i + 0.8) * toothAngle + angle0), y + (radI - jitterSize * random()) * g.sin((i + 0.8) * toothAngle + angle0));\r\n            // g.curveVertex(x + diaI * g.cos((i + 1) * toothAngle), y + diaI * g.sin((i + 1) * toothAngle));\r\n            // g.arc(x, y, diaI, diaI, (i + 0) * toothAngle, (i + 0.5) * toothAngle);\r\n            // g.arc(x, y, diaO, diaO, (i + 0.5) * toothAngle, (i + 1) * toothAngle);\r\n        }\r\n        g.endShape();\r\n    }\r\n\r\n    jitterSize = 2.5;\r\n    g.noFill();\r\n    g.stroke(color.h, color.s, color.b, color.a);\r\n\r\n    // Draw face\r\n    const drawFace = randomConstant() > 0.5;\r\n    const faceType = random() > 0.5 ? `happy` as const : `creepy` as const;\r\n    if (drawFace) {\r\n        const radSmile = 0.5 * radI;\r\n        for (let j = 0; j < 4; j++) {\r\n\r\n            // Smile\r\n            if (faceType === `creepy`) {\r\n                jitterSize = 12;\r\n            }\r\n            g.noFill();\r\n            g.curveTightness(0.9);\r\n            g.beginShape();\r\n            for (let i = 0; i <= teeth / 3; i++) {\r\n                g.curveVertex(x + radSmile * g.cos((i + 0.2) * toothAngle + angle1) + jitterSize * randomSym(), y + radSmile * g.sin((i + 0.2) * toothAngle + angle1) + jitterSize * randomSym());\r\n            }\r\n            g.endShape();\r\n\r\n            // jitterSize = 2.5;\r\n\r\n            // Left Eye\r\n            for (let e = 0; e <= 1; e++) {\r\n                const r = e === 0 ? 1.1 : 1.6;\r\n                const ex = radSmile * Math.cos(r * Math.PI + angle1);\r\n                const ey = radSmile * Math.sin(r * Math.PI + angle1);\r\n                g.fill(0, 0, 0);\r\n                g.beginShape();\r\n                for (let i = 0; i <= teeth + 2; i++) {\r\n                    g.curveVertex(ex + x + radiusAxis * g.cos((i + 0.3) * toothAngle + angle1) + jitterSize * randomSym(), ey + y + radiusAxis * g.sin((i + 0.3) * toothAngle + angle1) + jitterSize * randomSym());\r\n                }\r\n                g.endShape();\r\n            }\r\n        }\r\n    }\r\n\r\n    if (drawFace && faceType === `creepy`) {\r\n        jitterSize = 5;\r\n    }\r\n\r\n    // jitterSize = 2.5;\r\n    for (let j = 0; j < 4; j++) {\r\n\r\n        g.noFill();\r\n        // g.fill(0, 0, 0, 0.1);\r\n        // g.fill(color.h, color.s, color.b, 0.05);\r\n        g.curveTightness(0.9);\r\n        g.beginShape();\r\n        for (let i = 0; i <= teeth; i++) {\r\n            // g.curveVertex(x + diaI * g.cos((i + 0) * toothAngle), y + diaI * g.sin((i + 0) * toothAngle));\r\n            if (i !== 0) {\r\n                g.curveVertex(x + radI * g.cos((i + 0.2) * toothAngle + angle0) + jitterSize * randomSym(), y + radI * g.sin((i + 0.2) * toothAngle + angle0) + jitterSize * randomSym());\r\n            }\r\n\r\n            g.curveVertex(x + radO * g.cos((i + 0.3) * toothAngle + angle0) + jitterSize * randomSym(), y + radO * g.sin((i + 0.3) * toothAngle + angle0) + jitterSize * randomSym());\r\n            g.curveVertex(x + radO * g.cos((i + 0.7) * toothAngle + angle0) + jitterSize * randomSym(), y + radO * g.sin((i + 0.7) * toothAngle + angle0) + jitterSize * randomSym());\r\n            g.curveVertex(x + radI * g.cos((i + 0.8) * toothAngle + angle0) + jitterSize * randomSym(), y + radI * g.sin((i + 0.8) * toothAngle + angle0) + jitterSize * randomSym());\r\n            // g.curveVertex(x + diaI * g.cos((i + 1) * toothAngle), y + diaI * g.sin((i + 1) * toothAngle));\r\n            // g.arc(x, y, diaI, diaI, (i + 0) * toothAngle, (i + 0.5) * toothAngle);\r\n            // g.arc(x, y, diaO, diaO, (i + 0.5) * toothAngle, (i + 1) * toothAngle);\r\n        }\r\n        g.endShape();\r\n\r\n        // Inner circle\r\n        g.fill(0, 0, 0);\r\n        g.beginShape();\r\n        for (let i = 0; i <= teeth + 2; i++) {\r\n            g.curveVertex(x + radiusAxis * g.cos((i + 0.3) * toothAngle + angle0) + jitterSize * randomSym(), y + radiusAxis * g.sin((i + 0.3) * toothAngle + angle0) + jitterSize * randomSym());\r\n        }\r\n        g.endShape();\r\n    }\r\n\r\n    return {\r\n        faceType: drawFace ? faceType : null,\r\n    };\r\n};\r\n\r\nexport const art_gears: ArtWork = {\r\n    key: `art-gears`,\r\n    title: `Gears`,\r\n    description: `Are the gears of conflict twisting our perceptions of others? (Press image to toggle sound)`,\r\n    artist: `Rick Love`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        return null;\r\n    },\r\n    renderArt: (hostElement: HTMLElement, hash = `This is my hash!`) => {\r\n        (async () => await import(`p5/lib/addons/p5.sound`))();\r\n\r\n        const { random: randomMain } = createRandomGenerator(hash);\r\n\r\n        let tick = 0;\r\n\r\n        // const sat = 65 - 10 * Math.random();\r\n        const sat = 100;\r\n        const brightness = 60 - 20 * Math.random();\r\n\r\n        // const canvasSize = 300; const speed = 1 / (200 - 100 * randomMain());\r\n        const canvasSize = 600; const speed = 1 / (100 - 70 * randomMain());\r\n\r\n\r\n        const halfSize = canvasSize * 0.5;\r\n        const minGearRadius = canvasSize / 16;\r\n        const maxGearRadius = canvasSize / 3;\r\n        const minGearCount = 3;\r\n        const maxGearCount = 8;\r\n        const gearCount = Math.floor(minGearCount + (maxGearCount - minGearCount) * randomMain());\r\n\r\n        let lastGear = {\r\n            position: { x: canvasSize * randomMain(), y: canvasSize * randomMain() },\r\n            radius: minGearRadius,\r\n            // position: { x: canvasSize * randomMain(), y: canvasSize * randomMain() },\r\n            // size: minGearSize + (maxGearSize - minGearSize) * randomMain(),\r\n            randomSeed: `${randomMain()}`,\r\n            color: { h: 360 * randomMain(), s: 50, b: 50, a: 0.5 },\r\n        };\r\n        const gears = [...new Array(gearCount)].map(() => {\r\n\r\n            const targetRadius = minGearRadius + (maxGearRadius - minGearRadius) * randomMain();\r\n            const targetDistance = lastGear.radius + targetRadius;\r\n            const lastPos = lastGear.position;\r\n\r\n            // Try to bring back to center\r\n            const angleQuandrant = (lastPos.x > halfSize && lastPos.y > halfSize) ? (Math.PI * 1)\r\n                : (lastPos.x < halfSize && lastPos.y > halfSize) ? (Math.PI * 1.5)\r\n                    : (lastPos.x > halfSize && lastPos.y < halfSize) ? (Math.PI * 0.5)\r\n                        : 0;\r\n            // console.log(`angleQuandrant`, { angleQuandrant, lastPos, halfSize });\r\n            const targetAngle = Math.PI / 2 * randomMain() + angleQuandrant;\r\n\r\n            const posRaw = {\r\n                x: lastPos.x + targetDistance * Math.cos(targetAngle),\r\n                y: lastPos.y + targetDistance * Math.sin(targetAngle),\r\n            };\r\n            const pos = posRaw;\r\n            // const pos = {\r\n            //     x: 0.8 * posRaw.x + 0.2 * halfSize,\r\n            //     y: 0.8 * posRaw.y + 0.2 * halfSize,\r\n            // };\r\n\r\n            const xDelta = pos.x - lastPos.x;\r\n            const yDelta = pos.y - lastPos.y;\r\n            const actualRadius = Math.sqrt(xDelta * xDelta + yDelta * yDelta) - lastGear.radius;\r\n\r\n            // eslint-disable-next-line no-return-assign\r\n            return lastGear = {\r\n                position: pos,\r\n                radius: actualRadius,\r\n                randomSeed: `${randomMain()}`,\r\n                color: { h: 360 * randomMain(), s: sat, b: brightness, a: 0.5 },\r\n            };\r\n        });\r\n\r\n        let noise = null as null | p5.Noise;\r\n        let noiseDebounceTime = Date.now();\r\n\r\n        const toggleNoise = () => {\r\n            if (Date.now() < noiseDebounceTime + 500) { return; }\r\n            noiseDebounceTime = Date.now();\r\n\r\n            if (noise) {\r\n                noise.disconnect();\r\n                noise = null;\r\n                return;\r\n            }\r\n            noise = new p5.Noise(`white`);\r\n            noise.amp(0);\r\n            noise.start();\r\n        };\r\n\r\n        return new p5((s: p5) => {\r\n            s.setup = () => {\r\n                s.createCanvas(canvasSize, canvasSize);\r\n            };\r\n            s.mousePressed = () => { if (s.mouseX < 0 || s.mouseX > canvasSize || s.mouseY < 0 || s.mouseY > canvasSize) { return; } toggleNoise(); };\r\n            s.touchStarted = () => { const t = s.touches[0] as Vector2; if (t.x < 0 || t.x > canvasSize || t.y < 0 || t.y > canvasSize) { return; } toggleNoise(); };\r\n            // s.keyPressed = () => { toggleNoise(); };\r\n            s.draw = () => {\r\n                s.background(0);\r\n                // noise?.amp(0);\r\n\r\n                // s.background(10, 10, 10);\r\n                const g = s;\r\n                // const g = s.createGraphics(canvasSize * 2, canvasSize * 2);\r\n                // g.translate(canvasSize, canvasSize);\r\n                // g.scale(0.25);\r\n\r\n                let faceCount = 0;\r\n                let faceCreepyCount = 0;\r\n                for (const [i, gear] of gears.entries()) {\r\n                    const direction = i % 2 === 0 ? 1 : -1;\r\n                    const teethDepth = 5;\r\n                    const teeth = Math.ceil(gear.radius * Math.PI * 2 / (4 * teethDepth));\r\n                    const teethPassed = tick * speed * Math.pow(1.25, i + 1);\r\n                    const rotationAngle = s.TWO_PI * teethPassed / teeth;\r\n\r\n                    const result = drawGear(g, {\r\n                        position: gear.position,\r\n                        // radiusInner: gear.size * 0.93,\r\n                        // radiusOuter: gear.size * 1.07,\r\n                        radiusInner: gear.radius - teethDepth,\r\n                        radiusOuter: gear.radius + teethDepth,\r\n                        // radiusAxis: gear.radius * 0.15,\r\n                        radiusAxis: gear.radius * 0.1,\r\n                        // radiusAxis: teethDepth,\r\n                        teeth,\r\n                        color: gear.color,\r\n                        rotationAngle: direction * rotationAngle,\r\n                        randomSeed: gear.randomSeed,\r\n                    });\r\n\r\n                    if (result.faceType) {\r\n                        faceCount++;\r\n                    }\r\n                    if (result.faceType === `creepy`) {\r\n                        // Not actual position\r\n                        //  const distanceToCenterX = Math.abs(gear.position.x - halfSize);\r\n                        //  const distanceToCenterY = Math.abs(gear.position.y - halfSize);\r\n                        //  const distRatioToEdge = (halfSize - Math.sqrt(distanceToCenterX * distanceToCenterX + distanceToCenterY * distanceToCenterY)) / halfSize;\r\n                        // faceCreepyCount += Math.max(0, distRatioToEdge);\r\n                        faceCreepyCount++;\r\n                    }\r\n\r\n                    // Rotate slightly\r\n                    g.translate(gear.position.x, gear.position.y);\r\n                    g.rotate(s.TWO_PI * teethPassed / (teeth * 4));\r\n                    g.translate(-gear.position.x, -gear.position.y);\r\n                }\r\n                // s.image(g, 0, 0, canvasSize, canvasSize);\r\n\r\n                // console.log(`noiseLevel`, { level: faceCreepyCount / faceCount });\r\n                noise?.amp(faceCount > 0 ? faceCreepyCount / faceCount : 0);\r\n\r\n                // for (let i = 0; i < 10; i++) {\r\n                //     const color = s.color((cr * i) % 255, (cg * i) % 255, (cb * i) % 255, ca);\r\n                //     s.noFill();\r\n                //     s.stroke(color);\r\n                //     for (let j = 0; j < 36; j++) {\r\n                //         s.circle(200 - a / 2 + j % a, 200 - b / 2 + j % b, 270 - (i * 5) % c);\r\n                //     }\r\n                //     s.translate(200, 200);\r\n                //     // s.rotate((a + b + c + tick * 0.001) % 2);\r\n                //     s.rotate((a + b + c + tick * 0.001));\r\n                //     s.translate(-200, -200);\r\n                //     tick++;\r\n                // }\r\n\r\n                tick++;\r\n            };\r\n        }, hostElement);\r\n    },\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport p5 from 'p5';\r\nimport { createRandomGenerator } from '../../rando';\r\nimport { ArtWork } from '../../artwork-type';\r\n\r\nconst path = `/content/art/artwork/gpu-01/gpu-01`;\r\n\r\nexport const art_gpu_01: ArtWork = {\r\n    key: `art-gpu-01`,\r\n    title: `Gpu Example 01`,\r\n    description: `2015 - http://patriciogonzalezvivo.com\r\n\r\nThis is included as a great example of a gpu shader.\r\n    \r\nFrom: https://thebookofshaders.com/13/`,\r\n    artist: `@patriciogv`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        return null;\r\n    },\r\n    // openSea: {\r\n    //     tokenAddress: `0x495f947276749ce646f68ac8c248420045cb7b5e`,\r\n    //     tokenId: `91242641486941084018191434774360347389366801368112854311223385694785434025985`,\r\n    // },\r\n    renderArt: (hostElement: HTMLElement, hash = `This is my hash!`) => {\r\n        // const { a, b, c } = { a: 57, b: 23, c: 15 };\r\n\r\n        const { random } = createRandomGenerator(hash);\r\n\r\n\r\n        // const { a, b, c } = { a: 1 + Math.floor(57 * random()), b: 1 + Math.floor(213 * random()), c: 1 + Math.floor(115 * random()) };\r\n        // const { cr, cg, cb, ca } = { cr: Math.floor(25 + 230 * random()), cg: Math.floor(25 + 230 * random()), cb: Math.floor(25 + 230 * random()), ca: Math.floor(25 + 25 * random()) };\r\n\r\n        const size = 600;\r\n        // const h = 200;\r\n        // const scale = size / 400;\r\n        // const speed = 0.5;\r\n\r\n        // let tick = 0;\r\n\r\n        let shaderInstance: null | p5.Shader = null;\r\n\r\n        return new p5((s: p5) => {\r\n            s.preload = () => {\r\n                shaderInstance = s.loadShader(`${path}.vert`, `${path}.frag`);\r\n            };\r\n            s.setup = () => {\r\n                s.createCanvas(size, size, s.WEBGL);\r\n                s.noStroke();\r\n            };\r\n            s.draw = () => {\r\n                if (!shaderInstance) { return; }\r\n\r\n                // send resolution of sketch into shader\r\n                shaderInstance.setUniform(`u_resolution`, [size, size]);\r\n                shaderInstance.setUniform(`u_time`, s.millis() / 1000);\r\n                shaderInstance.setUniform(`u_mouse`, [s.mouseX, s.map(s.mouseY, 0, size, size, 0)]);\r\n\r\n                // shader() sets the active shader with our shader\r\n                s.shader(shaderInstance);\r\n\r\n                // rect gives us some geometry on the screen\r\n                s.rect(0, 0, size, size);\r\n            };\r\n        }, hostElement);\r\n    },\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport p5 from 'p5';\r\nimport { createRandomGenerator } from '../../rando';\r\nimport { ArtWork } from '../../artwork-type';\r\n\r\nconst path = `/content/art/artwork/flying-colors/flying-colors`;\r\n\r\nexport const art_flyingColors: ArtWork = {\r\n    key: `art-flying-colors`,\r\n    title: `Flying Colors`,\r\n    description: `Mmmm, bright`,\r\n    artist: `Rick Love`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        return null;\r\n    },\r\n    // openSea: {\r\n    //     tokenAddress: `0x495f947276749ce646f68ac8c248420045cb7b5e`,\r\n    //     tokenId: `91242641486941084018191434774360347389366801368112854311223385694785434025985`,\r\n    // },\r\n    renderArt: (hostElement: HTMLElement, hash = `This is my hash!`) => {\r\n        // const { a, b, c } = { a: 57, b: 23, c: 15 };\r\n\r\n        const { random } = createRandomGenerator(hash);\r\n        const seed = random();\r\n\r\n\r\n        // const { a, b, c } = { a: 1 + Math.floor(57 * random()), b: 1 + Math.floor(213 * random()), c: 1 + Math.floor(115 * random()) };\r\n        // const { cr, cg, cb, ca } = { cr: Math.floor(25 + 230 * random()), cg: Math.floor(25 + 230 * random()), cb: Math.floor(25 + 230 * random()), ca: Math.floor(25 + 25 * random()) };\r\n\r\n        const size = 600;\r\n        // const h = 200;\r\n        // const scale = size / 400;\r\n        // const speed = 0.5;\r\n\r\n        // let tick = 0;\r\n        let lastTimeMs = 0;\r\n        const gameTimeMs = 0;\r\n        const lastTimeModifier = 1;\r\n\r\n        let shaderInstance: null | p5.Shader = null;\r\n\r\n        return new p5((s: p5) => {\r\n            s.preload = () => {\r\n                shaderInstance = s.loadShader(`${path}.vert`, `${path}.frag`);\r\n            };\r\n            s.setup = () => {\r\n                s.createCanvas(size, size, s.WEBGL);\r\n                s.noStroke();\r\n            };\r\n            s.draw = () => {\r\n                if (!shaderInstance) { return; }\r\n\r\n                // send resolution of sketch into shader\r\n                const deltaTimeMs = lastTimeMs - s.millis();\r\n                lastTimeMs = s.millis();\r\n\r\n                // const timeModifier = 0.7 * (0.5 + 0.7 * Math.cos(s.millis() / (5 * 1000)));\r\n                // const timeModifier01 = lastTimeModifier + 0.25 * (0.5 - Math.random());\r\n                // const timeModifier02 = Math.min(1, Math.max(0, timeModifier01));\r\n                // const dampen = Math.pow(Math.abs(timeModifier02 - 0.5) * 2, 5);\r\n                // const timeModifier = dampen * 0.5 + (1 - dampen) * timeModifier02;\r\n\r\n                // const timeModifier01 = lastTimeModifier + 0.25 * (0.5 - Math.random());\r\n                // const timeModifier02 = Math.min(1, Math.max(0, timeModifier01));\r\n\r\n                // lastTimeModifier = timeModifier;\r\n                // gameTimeMs += deltaTimeMs * timeModifier;\r\n\r\n\r\n                // console.log(`draw`, { lastTimeModifier, seed, mouse: s.mouseX, gameTimeMs });\r\n\r\n                shaderInstance.setUniform(`u_resolution`, [size, size]);\r\n                shaderInstance.setUniform(`u_time`, lastTimeMs / 1000);\r\n                shaderInstance.setUniform(`u_mouse`, [s.mouseX, s.map(s.mouseY, 0, size, size, 0)]);\r\n                shaderInstance.setUniform(`u_seed`, seed);\r\n\r\n                // shader() sets the active shader with our shader\r\n                s.shader(shaderInstance);\r\n\r\n                // rect gives us some geometry on the screen\r\n                s.rect(0, 0, size, size);\r\n            };\r\n        }, hostElement);\r\n    },\r\n};\r\n","/* eslint-disable unicorn/filename-case */\r\n\r\n// WebGl Context ---\r\nexport function getWebGLSystem(canvas: HTMLCanvasElement): null | {\r\n    gl: WebGL2RenderingContext | WebGLRenderingContext;\r\n    ext: {\r\n        formatRGBA: SupportedFormat;\r\n        formatRG: SupportedFormat;\r\n        formatR: SupportedFormat;\r\n        halfFloatTexType: number;\r\n        supportLinearFiltering: null | OES_texture_float_linear | OES_texture_half_float_linear;\r\n    };\r\n} {\r\n    const params = { alpha: true, depth: false, stencil: false, antialias: false, preserveDrawingBuffer: false };\r\n\r\n    const gl2 = canvas.getContext(`webgl2`, params) as null | WebGL2RenderingContext;\r\n    if (gl2) {\r\n        const gl = gl2;\r\n        gl.getExtension(`EXT_color_buffer_float`);\r\n        const supportLinearFiltering = gl.getExtension(`OES_texture_float_linear`);\r\n        const halfFloatTexType = gl.HALF_FLOAT;\r\n        gl.clearColor(0, 0, 0, 1);\r\n\r\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n        const formatRGBA = getSupportedFormat(gl, gl.RGBA16F, gl.RGBA, halfFloatTexType);\r\n        const formatRG = getSupportedFormat(gl, gl.RG16F, gl.RG, halfFloatTexType);\r\n        const formatR = getSupportedFormat(gl, gl.R16F, gl.RED, halfFloatTexType);\r\n\r\n        return {\r\n            gl,\r\n            ext: {\r\n                formatRGBA,\r\n                formatRG,\r\n                formatR,\r\n                halfFloatTexType,\r\n                supportLinearFiltering,\r\n            },\r\n        };\r\n    }\r\n\r\n    const gl1 = (canvas.getContext(`webgl`, params) || canvas.getContext(`experimental-webgl`, params)) as null | WebGLRenderingContext;\r\n    if (!gl1) { return null; }\r\n\r\n    const gl = gl1;\r\n\r\n    const halfFloat = gl.getExtension(`OES_texture_half_float`) as OES_texture_half_float;\r\n    const supportLinearFiltering = gl.getExtension(`OES_texture_half_float_linear`);\r\n\r\n    gl.clearColor(0, 0, 0, 1);\r\n\r\n    const halfFloatTexType = halfFloat.HALF_FLOAT_OES;\r\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n    const formatRGBA = getSupportedFormat(gl, gl.RGBA, gl.RGBA, halfFloatTexType);\r\n    const formatRG = getSupportedFormat(gl, gl.RGBA, gl.RGBA, halfFloatTexType);\r\n    const formatR = getSupportedFormat(gl, gl.RGBA, gl.RGBA, halfFloatTexType);\r\n\r\n    return {\r\n        gl,\r\n        ext: {\r\n            formatRGBA,\r\n            formatRG,\r\n            formatR,\r\n            halfFloatTexType,\r\n            supportLinearFiltering,\r\n        },\r\n    };\r\n}\r\nexport type WebGlSystem = NonNullable<ReturnType<typeof getWebGLSystem>>;\r\n\r\ntype SupportedFormat = {\r\n    internalFormat: number;\r\n    format: number;\r\n};\r\nfunction getSupportedFormat(gl: WebGL2RenderingContext | WebGLRenderingContext, internalFormat: number, format: number, type: number): SupportedFormat {\r\n    if (!supportRenderTextureFormat(gl, internalFormat, format, type)) {\r\n        const gl2 = gl as WebGL2RenderingContext;\r\n        switch (internalFormat) {\r\n            case gl2.R16F:\r\n                return getSupportedFormat(gl, gl2.RG16F, gl2.RG, type);\r\n            case gl2.RG16F:\r\n                return getSupportedFormat(gl, gl2.RGBA16F, gl2.RGBA, type);\r\n            default:\r\n                throw new Error(`Unknown Render Format`);\r\n            // return null;\r\n        }\r\n    }\r\n\r\n    return {\r\n        internalFormat,\r\n        format,\r\n    };\r\n}\r\n\r\nfunction supportRenderTextureFormat(gl: WebGL2RenderingContext | WebGLRenderingContext, internalFormat: number, format: number, type: number) {\r\n    const texture = gl.createTexture();\r\n    gl.bindTexture(gl.TEXTURE_2D, texture);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, 4, 4, 0, format, type, null);\r\n\r\n    const fbo = gl.createFramebuffer();\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, fbo);\r\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\r\n\r\n    const status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\r\n    return status === gl.FRAMEBUFFER_COMPLETE;\r\n}\r\n","/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\nfunction ___$insertStyle(css) {\n  if (!css) {\n    return;\n  }\n\n  if (typeof window === 'undefined') {\n    return;\n  }\n\n  var style = document.createElement('style');\n  style.setAttribute('type', 'text/css');\n  style.innerHTML = css;\n  document.head.appendChild(style);\n  return css;\n}\n\nfunction colorToString(color, forceCSSHex) {\n  var colorFormat = color.__state.conversionName.toString();\n\n  var r = Math.round(color.r);\n  var g = Math.round(color.g);\n  var b = Math.round(color.b);\n  var a = color.a;\n  var h = Math.round(color.h);\n  var s = color.s.toFixed(1);\n  var v = color.v.toFixed(1);\n\n  if (forceCSSHex || colorFormat === 'THREE_CHAR_HEX' || colorFormat === 'SIX_CHAR_HEX') {\n    var str = color.hex.toString(16);\n\n    while (str.length < 6) {\n      str = '0' + str;\n    }\n\n    return '#' + str;\n  } else if (colorFormat === 'CSS_RGB') {\n    return 'rgb(' + r + ',' + g + ',' + b + ')';\n  } else if (colorFormat === 'CSS_RGBA') {\n    return 'rgba(' + r + ',' + g + ',' + b + ',' + a + ')';\n  } else if (colorFormat === 'HEX') {\n    return '0x' + color.hex.toString(16);\n  } else if (colorFormat === 'RGB_ARRAY') {\n    return '[' + r + ',' + g + ',' + b + ']';\n  } else if (colorFormat === 'RGBA_ARRAY') {\n    return '[' + r + ',' + g + ',' + b + ',' + a + ']';\n  } else if (colorFormat === 'RGB_OBJ') {\n    return '{r:' + r + ',g:' + g + ',b:' + b + '}';\n  } else if (colorFormat === 'RGBA_OBJ') {\n    return '{r:' + r + ',g:' + g + ',b:' + b + ',a:' + a + '}';\n  } else if (colorFormat === 'HSV_OBJ') {\n    return '{h:' + h + ',s:' + s + ',v:' + v + '}';\n  } else if (colorFormat === 'HSVA_OBJ') {\n    return '{h:' + h + ',s:' + s + ',v:' + v + ',a:' + a + '}';\n  }\n\n  return 'unknown format';\n}\n\nvar ARR_EACH = Array.prototype.forEach;\nvar ARR_SLICE = Array.prototype.slice;\nvar Common = {\n  BREAK: {},\n  extend: function extend(target) {\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\n      keys.forEach(function (key) {\n        if (!this.isUndefined(obj[key])) {\n          target[key] = obj[key];\n        }\n      }.bind(this));\n    }, this);\n    return target;\n  },\n  defaults: function defaults(target) {\n    this.each(ARR_SLICE.call(arguments, 1), function (obj) {\n      var keys = this.isObject(obj) ? Object.keys(obj) : [];\n      keys.forEach(function (key) {\n        if (this.isUndefined(target[key])) {\n          target[key] = obj[key];\n        }\n      }.bind(this));\n    }, this);\n    return target;\n  },\n  compose: function compose() {\n    var toCall = ARR_SLICE.call(arguments);\n    return function () {\n      var args = ARR_SLICE.call(arguments);\n\n      for (var i = toCall.length - 1; i >= 0; i--) {\n        args = [toCall[i].apply(this, args)];\n      }\n\n      return args[0];\n    };\n  },\n  each: function each(obj, itr, scope) {\n    if (!obj) {\n      return;\n    }\n\n    if (ARR_EACH && obj.forEach && obj.forEach === ARR_EACH) {\n      obj.forEach(itr, scope);\n    } else if (obj.length === obj.length + 0) {\n      var key = void 0;\n      var l = void 0;\n\n      for (key = 0, l = obj.length; key < l; key++) {\n        if (key in obj && itr.call(scope, obj[key], key) === this.BREAK) {\n          return;\n        }\n      }\n    } else {\n      for (var _key in obj) {\n        if (itr.call(scope, obj[_key], _key) === this.BREAK) {\n          return;\n        }\n      }\n    }\n  },\n  defer: function defer(fnc) {\n    setTimeout(fnc, 0);\n  },\n  debounce: function debounce(func, threshold, callImmediately) {\n    var timeout = void 0;\n    return function () {\n      var obj = this;\n      var args = arguments;\n\n      function delayed() {\n        timeout = null;\n        if (!callImmediately) func.apply(obj, args);\n      }\n\n      var callNow = callImmediately || !timeout;\n      clearTimeout(timeout);\n      timeout = setTimeout(delayed, threshold);\n\n      if (callNow) {\n        func.apply(obj, args);\n      }\n    };\n  },\n  toArray: function toArray(obj) {\n    if (obj.toArray) return obj.toArray();\n    return ARR_SLICE.call(obj);\n  },\n  isUndefined: function isUndefined(obj) {\n    return obj === undefined;\n  },\n  isNull: function isNull(obj) {\n    return obj === null;\n  },\n  isNaN: function (_isNaN) {\n    function isNaN(_x) {\n      return _isNaN.apply(this, arguments);\n    }\n\n    isNaN.toString = function () {\n      return _isNaN.toString();\n    };\n\n    return isNaN;\n  }(function (obj) {\n    return isNaN(obj);\n  }),\n  isArray: Array.isArray || function (obj) {\n    return obj.constructor === Array;\n  },\n  isObject: function isObject(obj) {\n    return obj === Object(obj);\n  },\n  isNumber: function isNumber(obj) {\n    return obj === obj + 0;\n  },\n  isString: function isString(obj) {\n    return obj === obj + '';\n  },\n  isBoolean: function isBoolean(obj) {\n    return obj === false || obj === true;\n  },\n  isFunction: function isFunction(obj) {\n    return obj instanceof Function;\n  }\n};\nvar INTERPRETATIONS = [{\n  litmus: Common.isString,\n  conversions: {\n    THREE_CHAR_HEX: {\n      read: function read(original) {\n        var test = original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);\n\n        if (test === null) {\n          return false;\n        }\n\n        return {\n          space: 'HEX',\n          hex: parseInt('0x' + test[1].toString() + test[1].toString() + test[2].toString() + test[2].toString() + test[3].toString() + test[3].toString(), 0)\n        };\n      },\n      write: colorToString\n    },\n    SIX_CHAR_HEX: {\n      read: function read(original) {\n        var test = original.match(/^#([A-F0-9]{6})$/i);\n\n        if (test === null) {\n          return false;\n        }\n\n        return {\n          space: 'HEX',\n          hex: parseInt('0x' + test[1].toString(), 0)\n        };\n      },\n      write: colorToString\n    },\n    CSS_RGB: {\n      read: function read(original) {\n        var test = original.match(/^rgb\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n\n        if (test === null) {\n          return false;\n        }\n\n        return {\n          space: 'RGB',\n          r: parseFloat(test[1]),\n          g: parseFloat(test[2]),\n          b: parseFloat(test[3])\n        };\n      },\n      write: colorToString\n    },\n    CSS_RGBA: {\n      read: function read(original) {\n        var test = original.match(/^rgba\\(\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*,\\s*(.+)\\s*\\)/);\n\n        if (test === null) {\n          return false;\n        }\n\n        return {\n          space: 'RGB',\n          r: parseFloat(test[1]),\n          g: parseFloat(test[2]),\n          b: parseFloat(test[3]),\n          a: parseFloat(test[4])\n        };\n      },\n      write: colorToString\n    }\n  }\n}, {\n  litmus: Common.isNumber,\n  conversions: {\n    HEX: {\n      read: function read(original) {\n        return {\n          space: 'HEX',\n          hex: original,\n          conversionName: 'HEX'\n        };\n      },\n      write: function write(color) {\n        return color.hex;\n      }\n    }\n  }\n}, {\n  litmus: Common.isArray,\n  conversions: {\n    RGB_ARRAY: {\n      read: function read(original) {\n        if (original.length !== 3) {\n          return false;\n        }\n\n        return {\n          space: 'RGB',\n          r: original[0],\n          g: original[1],\n          b: original[2]\n        };\n      },\n      write: function write(color) {\n        return [color.r, color.g, color.b];\n      }\n    },\n    RGBA_ARRAY: {\n      read: function read(original) {\n        if (original.length !== 4) return false;\n        return {\n          space: 'RGB',\n          r: original[0],\n          g: original[1],\n          b: original[2],\n          a: original[3]\n        };\n      },\n      write: function write(color) {\n        return [color.r, color.g, color.b, color.a];\n      }\n    }\n  }\n}, {\n  litmus: Common.isObject,\n  conversions: {\n    RGBA_OBJ: {\n      read: function read(original) {\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b) && Common.isNumber(original.a)) {\n          return {\n            space: 'RGB',\n            r: original.r,\n            g: original.g,\n            b: original.b,\n            a: original.a\n          };\n        }\n\n        return false;\n      },\n      write: function write(color) {\n        return {\n          r: color.r,\n          g: color.g,\n          b: color.b,\n          a: color.a\n        };\n      }\n    },\n    RGB_OBJ: {\n      read: function read(original) {\n        if (Common.isNumber(original.r) && Common.isNumber(original.g) && Common.isNumber(original.b)) {\n          return {\n            space: 'RGB',\n            r: original.r,\n            g: original.g,\n            b: original.b\n          };\n        }\n\n        return false;\n      },\n      write: function write(color) {\n        return {\n          r: color.r,\n          g: color.g,\n          b: color.b\n        };\n      }\n    },\n    HSVA_OBJ: {\n      read: function read(original) {\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v) && Common.isNumber(original.a)) {\n          return {\n            space: 'HSV',\n            h: original.h,\n            s: original.s,\n            v: original.v,\n            a: original.a\n          };\n        }\n\n        return false;\n      },\n      write: function write(color) {\n        return {\n          h: color.h,\n          s: color.s,\n          v: color.v,\n          a: color.a\n        };\n      }\n    },\n    HSV_OBJ: {\n      read: function read(original) {\n        if (Common.isNumber(original.h) && Common.isNumber(original.s) && Common.isNumber(original.v)) {\n          return {\n            space: 'HSV',\n            h: original.h,\n            s: original.s,\n            v: original.v\n          };\n        }\n\n        return false;\n      },\n      write: function write(color) {\n        return {\n          h: color.h,\n          s: color.s,\n          v: color.v\n        };\n      }\n    }\n  }\n}];\nvar result = void 0;\nvar toReturn = void 0;\n\nvar interpret = function interpret() {\n  toReturn = false;\n  var original = arguments.length > 1 ? Common.toArray(arguments) : arguments[0];\n  Common.each(INTERPRETATIONS, function (family) {\n    if (family.litmus(original)) {\n      Common.each(family.conversions, function (conversion, conversionName) {\n        result = conversion.read(original);\n\n        if (toReturn === false && result !== false) {\n          toReturn = result;\n          result.conversionName = conversionName;\n          result.conversion = conversion;\n          return Common.BREAK;\n        }\n      });\n      return Common.BREAK;\n    }\n  });\n  return toReturn;\n};\n\nvar tmpComponent = void 0;\nvar ColorMath = {\n  hsv_to_rgb: function hsv_to_rgb(h, s, v) {\n    var hi = Math.floor(h / 60) % 6;\n    var f = h / 60 - Math.floor(h / 60);\n    var p = v * (1.0 - s);\n    var q = v * (1.0 - f * s);\n    var t = v * (1.0 - (1.0 - f) * s);\n    var c = [[v, t, p], [q, v, p], [p, v, t], [p, q, v], [t, p, v], [v, p, q]][hi];\n    return {\n      r: c[0] * 255,\n      g: c[1] * 255,\n      b: c[2] * 255\n    };\n  },\n  rgb_to_hsv: function rgb_to_hsv(r, g, b) {\n    var min = Math.min(r, g, b);\n    var max = Math.max(r, g, b);\n    var delta = max - min;\n    var h = void 0;\n    var s = void 0;\n\n    if (max !== 0) {\n      s = delta / max;\n    } else {\n      return {\n        h: NaN,\n        s: 0,\n        v: 0\n      };\n    }\n\n    if (r === max) {\n      h = (g - b) / delta;\n    } else if (g === max) {\n      h = 2 + (b - r) / delta;\n    } else {\n      h = 4 + (r - g) / delta;\n    }\n\n    h /= 6;\n\n    if (h < 0) {\n      h += 1;\n    }\n\n    return {\n      h: h * 360,\n      s: s,\n      v: max / 255\n    };\n  },\n  rgb_to_hex: function rgb_to_hex(r, g, b) {\n    var hex = this.hex_with_component(0, 2, r);\n    hex = this.hex_with_component(hex, 1, g);\n    hex = this.hex_with_component(hex, 0, b);\n    return hex;\n  },\n  component_from_hex: function component_from_hex(hex, componentIndex) {\n    return hex >> componentIndex * 8 & 0xFF;\n  },\n  hex_with_component: function hex_with_component(hex, componentIndex, value) {\n    return value << (tmpComponent = componentIndex * 8) | hex & ~(0xFF << tmpComponent);\n  }\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nvar classCallCheck = function classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n};\n\nvar createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar get = function get(object, property, receiver) {\n  if (object === null) object = Function.prototype;\n  var desc = Object.getOwnPropertyDescriptor(object, property);\n\n  if (desc === undefined) {\n    var parent = Object.getPrototypeOf(object);\n\n    if (parent === null) {\n      return undefined;\n    } else {\n      return get(parent, property, receiver);\n    }\n  } else if (\"value\" in desc) {\n    return desc.value;\n  } else {\n    var getter = desc.get;\n\n    if (getter === undefined) {\n      return undefined;\n    }\n\n    return getter.call(receiver);\n  }\n};\n\nvar inherits = function inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n};\n\nvar possibleConstructorReturn = function possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n};\n\nvar Color = function () {\n  function Color() {\n    classCallCheck(this, Color);\n    this.__state = interpret.apply(this, arguments);\n\n    if (this.__state === false) {\n      throw new Error('Failed to interpret color arguments');\n    }\n\n    this.__state.a = this.__state.a || 1;\n  }\n\n  createClass(Color, [{\n    key: 'toString',\n    value: function toString() {\n      return colorToString(this);\n    }\n  }, {\n    key: 'toHexString',\n    value: function toHexString() {\n      return colorToString(this, true);\n    }\n  }, {\n    key: 'toOriginal',\n    value: function toOriginal() {\n      return this.__state.conversion.write(this);\n    }\n  }]);\n  return Color;\n}();\n\nfunction defineRGBComponent(target, component, componentHexIndex) {\n  Object.defineProperty(target, component, {\n    get: function get$$1() {\n      if (this.__state.space === 'RGB') {\n        return this.__state[component];\n      }\n\n      Color.recalculateRGB(this, component, componentHexIndex);\n      return this.__state[component];\n    },\n    set: function set$$1(v) {\n      if (this.__state.space !== 'RGB') {\n        Color.recalculateRGB(this, component, componentHexIndex);\n        this.__state.space = 'RGB';\n      }\n\n      this.__state[component] = v;\n    }\n  });\n}\n\nfunction defineHSVComponent(target, component) {\n  Object.defineProperty(target, component, {\n    get: function get$$1() {\n      if (this.__state.space === 'HSV') {\n        return this.__state[component];\n      }\n\n      Color.recalculateHSV(this);\n      return this.__state[component];\n    },\n    set: function set$$1(v) {\n      if (this.__state.space !== 'HSV') {\n        Color.recalculateHSV(this);\n        this.__state.space = 'HSV';\n      }\n\n      this.__state[component] = v;\n    }\n  });\n}\n\nColor.recalculateRGB = function (color, component, componentHexIndex) {\n  if (color.__state.space === 'HEX') {\n    color.__state[component] = ColorMath.component_from_hex(color.__state.hex, componentHexIndex);\n  } else if (color.__state.space === 'HSV') {\n    Common.extend(color.__state, ColorMath.hsv_to_rgb(color.__state.h, color.__state.s, color.__state.v));\n  } else {\n    throw new Error('Corrupted color state');\n  }\n};\n\nColor.recalculateHSV = function (color) {\n  var result = ColorMath.rgb_to_hsv(color.r, color.g, color.b);\n  Common.extend(color.__state, {\n    s: result.s,\n    v: result.v\n  });\n\n  if (!Common.isNaN(result.h)) {\n    color.__state.h = result.h;\n  } else if (Common.isUndefined(color.__state.h)) {\n    color.__state.h = 0;\n  }\n};\n\nColor.COMPONENTS = ['r', 'g', 'b', 'h', 's', 'v', 'hex', 'a'];\ndefineRGBComponent(Color.prototype, 'r', 2);\ndefineRGBComponent(Color.prototype, 'g', 1);\ndefineRGBComponent(Color.prototype, 'b', 0);\ndefineHSVComponent(Color.prototype, 'h');\ndefineHSVComponent(Color.prototype, 's');\ndefineHSVComponent(Color.prototype, 'v');\nObject.defineProperty(Color.prototype, 'a', {\n  get: function get$$1() {\n    return this.__state.a;\n  },\n  set: function set$$1(v) {\n    this.__state.a = v;\n  }\n});\nObject.defineProperty(Color.prototype, 'hex', {\n  get: function get$$1() {\n    if (this.__state.space !== 'HEX') {\n      this.__state.hex = ColorMath.rgb_to_hex(this.r, this.g, this.b);\n      this.__state.space = 'HEX';\n    }\n\n    return this.__state.hex;\n  },\n  set: function set$$1(v) {\n    this.__state.space = 'HEX';\n    this.__state.hex = v;\n  }\n});\n\nvar Controller = function () {\n  function Controller(object, property) {\n    classCallCheck(this, Controller);\n    this.initialValue = object[property];\n    this.domElement = document.createElement('div');\n    this.object = object;\n    this.property = property;\n    this.__onChange = undefined;\n    this.__onFinishChange = undefined;\n  }\n\n  createClass(Controller, [{\n    key: 'onChange',\n    value: function onChange(fnc) {\n      this.__onChange = fnc;\n      return this;\n    }\n  }, {\n    key: 'onFinishChange',\n    value: function onFinishChange(fnc) {\n      this.__onFinishChange = fnc;\n      return this;\n    }\n  }, {\n    key: 'setValue',\n    value: function setValue(newValue) {\n      this.object[this.property] = newValue;\n\n      if (this.__onChange) {\n        this.__onChange.call(this, newValue);\n      }\n\n      this.updateDisplay();\n      return this;\n    }\n  }, {\n    key: 'getValue',\n    value: function getValue() {\n      return this.object[this.property];\n    }\n  }, {\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      return this;\n    }\n  }, {\n    key: 'isModified',\n    value: function isModified() {\n      return this.initialValue !== this.getValue();\n    }\n  }]);\n  return Controller;\n}();\n\nvar EVENT_MAP = {\n  HTMLEvents: ['change'],\n  MouseEvents: ['click', 'mousemove', 'mousedown', 'mouseup', 'mouseover'],\n  KeyboardEvents: ['keydown']\n};\nvar EVENT_MAP_INV = {};\nCommon.each(EVENT_MAP, function (v, k) {\n  Common.each(v, function (e) {\n    EVENT_MAP_INV[e] = k;\n  });\n});\nvar CSS_VALUE_PIXELS = /(\\d+(\\.\\d+)?)px/;\n\nfunction cssValueToPixels(val) {\n  if (val === '0' || Common.isUndefined(val)) {\n    return 0;\n  }\n\n  var match = val.match(CSS_VALUE_PIXELS);\n\n  if (!Common.isNull(match)) {\n    return parseFloat(match[1]);\n  }\n\n  return 0;\n}\n\nvar dom = {\n  makeSelectable: function makeSelectable(elem, selectable) {\n    if (elem === undefined || elem.style === undefined) return;\n    elem.onselectstart = selectable ? function () {\n      return false;\n    } : function () {};\n    elem.style.MozUserSelect = selectable ? 'auto' : 'none';\n    elem.style.KhtmlUserSelect = selectable ? 'auto' : 'none';\n    elem.unselectable = selectable ? 'on' : 'off';\n  },\n  makeFullscreen: function makeFullscreen(elem, hor, vert) {\n    var vertical = vert;\n    var horizontal = hor;\n\n    if (Common.isUndefined(horizontal)) {\n      horizontal = true;\n    }\n\n    if (Common.isUndefined(vertical)) {\n      vertical = true;\n    }\n\n    elem.style.position = 'absolute';\n\n    if (horizontal) {\n      elem.style.left = 0;\n      elem.style.right = 0;\n    }\n\n    if (vertical) {\n      elem.style.top = 0;\n      elem.style.bottom = 0;\n    }\n  },\n  fakeEvent: function fakeEvent(elem, eventType, pars, aux) {\n    var params = pars || {};\n    var className = EVENT_MAP_INV[eventType];\n\n    if (!className) {\n      throw new Error('Event type ' + eventType + ' not supported.');\n    }\n\n    var evt = document.createEvent(className);\n\n    switch (className) {\n      case 'MouseEvents':\n        {\n          var clientX = params.x || params.clientX || 0;\n          var clientY = params.y || params.clientY || 0;\n          evt.initMouseEvent(eventType, params.bubbles || false, params.cancelable || true, window, params.clickCount || 1, 0, 0, clientX, clientY, false, false, false, false, 0, null);\n          break;\n        }\n\n      case 'KeyboardEvents':\n        {\n          var init = evt.initKeyboardEvent || evt.initKeyEvent;\n          Common.defaults(params, {\n            cancelable: true,\n            ctrlKey: false,\n            altKey: false,\n            shiftKey: false,\n            metaKey: false,\n            keyCode: undefined,\n            charCode: undefined\n          });\n          init(eventType, params.bubbles || false, params.cancelable, window, params.ctrlKey, params.altKey, params.shiftKey, params.metaKey, params.keyCode, params.charCode);\n          break;\n        }\n\n      default:\n        {\n          evt.initEvent(eventType, params.bubbles || false, params.cancelable || true);\n          break;\n        }\n    }\n\n    Common.defaults(evt, aux);\n    elem.dispatchEvent(evt);\n  },\n  bind: function bind(elem, event, func, newBool) {\n    var bool = newBool || false;\n\n    if (elem.addEventListener) {\n      elem.addEventListener(event, func, bool);\n    } else if (elem.attachEvent) {\n      elem.attachEvent('on' + event, func);\n    }\n\n    return dom;\n  },\n  unbind: function unbind(elem, event, func, newBool) {\n    var bool = newBool || false;\n\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, func, bool);\n    } else if (elem.detachEvent) {\n      elem.detachEvent('on' + event, func);\n    }\n\n    return dom;\n  },\n  addClass: function addClass(elem, className) {\n    if (elem.className === undefined) {\n      elem.className = className;\n    } else if (elem.className !== className) {\n      var classes = elem.className.split(/ +/);\n\n      if (classes.indexOf(className) === -1) {\n        classes.push(className);\n        elem.className = classes.join(' ').replace(/^\\s+/, '').replace(/\\s+$/, '');\n      }\n    }\n\n    return dom;\n  },\n  removeClass: function removeClass(elem, className) {\n    if (className) {\n      if (elem.className === className) {\n        elem.removeAttribute('class');\n      } else {\n        var classes = elem.className.split(/ +/);\n        var index = classes.indexOf(className);\n\n        if (index !== -1) {\n          classes.splice(index, 1);\n          elem.className = classes.join(' ');\n        }\n      }\n    } else {\n      elem.className = undefined;\n    }\n\n    return dom;\n  },\n  hasClass: function hasClass(elem, className) {\n    return new RegExp('(?:^|\\\\s+)' + className + '(?:\\\\s+|$)').test(elem.className) || false;\n  },\n  getWidth: function getWidth(elem) {\n    var style = getComputedStyle(elem);\n    return cssValueToPixels(style['border-left-width']) + cssValueToPixels(style['border-right-width']) + cssValueToPixels(style['padding-left']) + cssValueToPixels(style['padding-right']) + cssValueToPixels(style.width);\n  },\n  getHeight: function getHeight(elem) {\n    var style = getComputedStyle(elem);\n    return cssValueToPixels(style['border-top-width']) + cssValueToPixels(style['border-bottom-width']) + cssValueToPixels(style['padding-top']) + cssValueToPixels(style['padding-bottom']) + cssValueToPixels(style.height);\n  },\n  getOffset: function getOffset(el) {\n    var elem = el;\n    var offset = {\n      left: 0,\n      top: 0\n    };\n\n    if (elem.offsetParent) {\n      do {\n        offset.left += elem.offsetLeft;\n        offset.top += elem.offsetTop;\n        elem = elem.offsetParent;\n      } while (elem);\n    }\n\n    return offset;\n  },\n  isActive: function isActive(elem) {\n    return elem === document.activeElement && (elem.type || elem.href);\n  }\n};\n\nvar BooleanController = function (_Controller) {\n  inherits(BooleanController, _Controller);\n\n  function BooleanController(object, property) {\n    classCallCheck(this, BooleanController);\n\n    var _this2 = possibleConstructorReturn(this, (BooleanController.__proto__ || Object.getPrototypeOf(BooleanController)).call(this, object, property));\n\n    var _this = _this2;\n    _this2.__prev = _this2.getValue();\n    _this2.__checkbox = document.createElement('input');\n\n    _this2.__checkbox.setAttribute('type', 'checkbox');\n\n    function onChange() {\n      _this.setValue(!_this.__prev);\n    }\n\n    dom.bind(_this2.__checkbox, 'change', onChange, false);\n\n    _this2.domElement.appendChild(_this2.__checkbox);\n\n    _this2.updateDisplay();\n\n    return _this2;\n  }\n\n  createClass(BooleanController, [{\n    key: 'setValue',\n    value: function setValue(v) {\n      var toReturn = get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'setValue', this).call(this, v);\n\n      if (this.__onFinishChange) {\n        this.__onFinishChange.call(this, this.getValue());\n      }\n\n      this.__prev = this.getValue();\n      return toReturn;\n    }\n  }, {\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      if (this.getValue() === true) {\n        this.__checkbox.setAttribute('checked', 'checked');\n\n        this.__checkbox.checked = true;\n        this.__prev = true;\n      } else {\n        this.__checkbox.checked = false;\n        this.__prev = false;\n      }\n\n      return get(BooleanController.prototype.__proto__ || Object.getPrototypeOf(BooleanController.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return BooleanController;\n}(Controller);\n\nvar OptionController = function (_Controller) {\n  inherits(OptionController, _Controller);\n\n  function OptionController(object, property, opts) {\n    classCallCheck(this, OptionController);\n\n    var _this2 = possibleConstructorReturn(this, (OptionController.__proto__ || Object.getPrototypeOf(OptionController)).call(this, object, property));\n\n    var options = opts;\n    var _this = _this2;\n    _this2.__select = document.createElement('select');\n\n    if (Common.isArray(options)) {\n      var map = {};\n      Common.each(options, function (element) {\n        map[element] = element;\n      });\n      options = map;\n    }\n\n    Common.each(options, function (value, key) {\n      var opt = document.createElement('option');\n      opt.innerHTML = key;\n      opt.setAttribute('value', value);\n\n      _this.__select.appendChild(opt);\n    });\n\n    _this2.updateDisplay();\n\n    dom.bind(_this2.__select, 'change', function () {\n      var desiredValue = this.options[this.selectedIndex].value;\n\n      _this.setValue(desiredValue);\n    });\n\n    _this2.domElement.appendChild(_this2.__select);\n\n    return _this2;\n  }\n\n  createClass(OptionController, [{\n    key: 'setValue',\n    value: function setValue(v) {\n      var toReturn = get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'setValue', this).call(this, v);\n\n      if (this.__onFinishChange) {\n        this.__onFinishChange.call(this, this.getValue());\n      }\n\n      return toReturn;\n    }\n  }, {\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      if (dom.isActive(this.__select)) return this;\n      this.__select.value = this.getValue();\n      return get(OptionController.prototype.__proto__ || Object.getPrototypeOf(OptionController.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return OptionController;\n}(Controller);\n\nvar StringController = function (_Controller) {\n  inherits(StringController, _Controller);\n\n  function StringController(object, property) {\n    classCallCheck(this, StringController);\n\n    var _this2 = possibleConstructorReturn(this, (StringController.__proto__ || Object.getPrototypeOf(StringController)).call(this, object, property));\n\n    var _this = _this2;\n\n    function onChange() {\n      _this.setValue(_this.__input.value);\n    }\n\n    function onBlur() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    _this2.__input = document.createElement('input');\n\n    _this2.__input.setAttribute('type', 'text');\n\n    dom.bind(_this2.__input, 'keyup', onChange);\n    dom.bind(_this2.__input, 'change', onChange);\n    dom.bind(_this2.__input, 'blur', onBlur);\n    dom.bind(_this2.__input, 'keydown', function (e) {\n      if (e.keyCode === 13) {\n        this.blur();\n      }\n    });\n\n    _this2.updateDisplay();\n\n    _this2.domElement.appendChild(_this2.__input);\n\n    return _this2;\n  }\n\n  createClass(StringController, [{\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      if (!dom.isActive(this.__input)) {\n        this.__input.value = this.getValue();\n      }\n\n      return get(StringController.prototype.__proto__ || Object.getPrototypeOf(StringController.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return StringController;\n}(Controller);\n\nfunction numDecimals(x) {\n  var _x = x.toString();\n\n  if (_x.indexOf('.') > -1) {\n    return _x.length - _x.indexOf('.') - 1;\n  }\n\n  return 0;\n}\n\nvar NumberController = function (_Controller) {\n  inherits(NumberController, _Controller);\n\n  function NumberController(object, property, params) {\n    classCallCheck(this, NumberController);\n\n    var _this = possibleConstructorReturn(this, (NumberController.__proto__ || Object.getPrototypeOf(NumberController)).call(this, object, property));\n\n    var _params = params || {};\n\n    _this.__min = _params.min;\n    _this.__max = _params.max;\n    _this.__step = _params.step;\n\n    if (Common.isUndefined(_this.__step)) {\n      if (_this.initialValue === 0) {\n        _this.__impliedStep = 1;\n      } else {\n        _this.__impliedStep = Math.pow(10, Math.floor(Math.log(Math.abs(_this.initialValue)) / Math.LN10)) / 10;\n      }\n    } else {\n      _this.__impliedStep = _this.__step;\n    }\n\n    _this.__precision = numDecimals(_this.__impliedStep);\n    return _this;\n  }\n\n  createClass(NumberController, [{\n    key: 'setValue',\n    value: function setValue(v) {\n      var _v = v;\n\n      if (this.__min !== undefined && _v < this.__min) {\n        _v = this.__min;\n      } else if (this.__max !== undefined && _v > this.__max) {\n        _v = this.__max;\n      }\n\n      if (this.__step !== undefined && _v % this.__step !== 0) {\n        _v = Math.round(_v / this.__step) * this.__step;\n      }\n\n      return get(NumberController.prototype.__proto__ || Object.getPrototypeOf(NumberController.prototype), 'setValue', this).call(this, _v);\n    }\n  }, {\n    key: 'min',\n    value: function min(minValue) {\n      this.__min = minValue;\n      return this;\n    }\n  }, {\n    key: 'max',\n    value: function max(maxValue) {\n      this.__max = maxValue;\n      return this;\n    }\n  }, {\n    key: 'step',\n    value: function step(stepValue) {\n      this.__step = stepValue;\n      this.__impliedStep = stepValue;\n      this.__precision = numDecimals(stepValue);\n      return this;\n    }\n  }]);\n  return NumberController;\n}(Controller);\n\nfunction roundToDecimal(value, decimals) {\n  var tenTo = Math.pow(10, decimals);\n  return Math.round(value * tenTo) / tenTo;\n}\n\nvar NumberControllerBox = function (_NumberController) {\n  inherits(NumberControllerBox, _NumberController);\n\n  function NumberControllerBox(object, property, params) {\n    classCallCheck(this, NumberControllerBox);\n\n    var _this2 = possibleConstructorReturn(this, (NumberControllerBox.__proto__ || Object.getPrototypeOf(NumberControllerBox)).call(this, object, property, params));\n\n    _this2.__truncationSuspended = false;\n    var _this = _this2;\n    var prevY = void 0;\n\n    function onChange() {\n      var attempted = parseFloat(_this.__input.value);\n\n      if (!Common.isNaN(attempted)) {\n        _this.setValue(attempted);\n      }\n    }\n\n    function onFinish() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    function onBlur() {\n      onFinish();\n    }\n\n    function onMouseDrag(e) {\n      var diff = prevY - e.clientY;\n\n      _this.setValue(_this.getValue() + diff * _this.__impliedStep);\n\n      prevY = e.clientY;\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n      onFinish();\n    }\n\n    function onMouseDown(e) {\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n      prevY = e.clientY;\n    }\n\n    _this2.__input = document.createElement('input');\n\n    _this2.__input.setAttribute('type', 'text');\n\n    dom.bind(_this2.__input, 'change', onChange);\n    dom.bind(_this2.__input, 'blur', onBlur);\n    dom.bind(_this2.__input, 'mousedown', onMouseDown);\n    dom.bind(_this2.__input, 'keydown', function (e) {\n      if (e.keyCode === 13) {\n        _this.__truncationSuspended = true;\n        this.blur();\n        _this.__truncationSuspended = false;\n        onFinish();\n      }\n    });\n\n    _this2.updateDisplay();\n\n    _this2.domElement.appendChild(_this2.__input);\n\n    return _this2;\n  }\n\n  createClass(NumberControllerBox, [{\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      this.__input.value = this.__truncationSuspended ? this.getValue() : roundToDecimal(this.getValue(), this.__precision);\n      return get(NumberControllerBox.prototype.__proto__ || Object.getPrototypeOf(NumberControllerBox.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return NumberControllerBox;\n}(NumberController);\n\nfunction map(v, i1, i2, o1, o2) {\n  return o1 + (o2 - o1) * ((v - i1) / (i2 - i1));\n}\n\nvar NumberControllerSlider = function (_NumberController) {\n  inherits(NumberControllerSlider, _NumberController);\n\n  function NumberControllerSlider(object, property, min, max, step) {\n    classCallCheck(this, NumberControllerSlider);\n\n    var _this2 = possibleConstructorReturn(this, (NumberControllerSlider.__proto__ || Object.getPrototypeOf(NumberControllerSlider)).call(this, object, property, {\n      min: min,\n      max: max,\n      step: step\n    }));\n\n    var _this = _this2;\n    _this2.__background = document.createElement('div');\n    _this2.__foreground = document.createElement('div');\n    dom.bind(_this2.__background, 'mousedown', onMouseDown);\n    dom.bind(_this2.__background, 'touchstart', onTouchStart);\n    dom.addClass(_this2.__background, 'slider');\n    dom.addClass(_this2.__foreground, 'slider-fg');\n\n    function onMouseDown(e) {\n      document.activeElement.blur();\n      dom.bind(window, 'mousemove', onMouseDrag);\n      dom.bind(window, 'mouseup', onMouseUp);\n      onMouseDrag(e);\n    }\n\n    function onMouseDrag(e) {\n      e.preventDefault();\n\n      var bgRect = _this.__background.getBoundingClientRect();\n\n      _this.setValue(map(e.clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\n\n      return false;\n    }\n\n    function onMouseUp() {\n      dom.unbind(window, 'mousemove', onMouseDrag);\n      dom.unbind(window, 'mouseup', onMouseUp);\n\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    function onTouchStart(e) {\n      if (e.touches.length !== 1) {\n        return;\n      }\n\n      dom.bind(window, 'touchmove', onTouchMove);\n      dom.bind(window, 'touchend', onTouchEnd);\n      onTouchMove(e);\n    }\n\n    function onTouchMove(e) {\n      var clientX = e.touches[0].clientX;\n\n      var bgRect = _this.__background.getBoundingClientRect();\n\n      _this.setValue(map(clientX, bgRect.left, bgRect.right, _this.__min, _this.__max));\n    }\n\n    function onTouchEnd() {\n      dom.unbind(window, 'touchmove', onTouchMove);\n      dom.unbind(window, 'touchend', onTouchEnd);\n\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.getValue());\n      }\n    }\n\n    _this2.updateDisplay();\n\n    _this2.__background.appendChild(_this2.__foreground);\n\n    _this2.domElement.appendChild(_this2.__background);\n\n    return _this2;\n  }\n\n  createClass(NumberControllerSlider, [{\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      var pct = (this.getValue() - this.__min) / (this.__max - this.__min);\n\n      this.__foreground.style.width = pct * 100 + '%';\n      return get(NumberControllerSlider.prototype.__proto__ || Object.getPrototypeOf(NumberControllerSlider.prototype), 'updateDisplay', this).call(this);\n    }\n  }]);\n  return NumberControllerSlider;\n}(NumberController);\n\nvar FunctionController = function (_Controller) {\n  inherits(FunctionController, _Controller);\n\n  function FunctionController(object, property, text) {\n    classCallCheck(this, FunctionController);\n\n    var _this2 = possibleConstructorReturn(this, (FunctionController.__proto__ || Object.getPrototypeOf(FunctionController)).call(this, object, property));\n\n    var _this = _this2;\n    _this2.__button = document.createElement('div');\n    _this2.__button.innerHTML = text === undefined ? 'Fire' : text;\n    dom.bind(_this2.__button, 'click', function (e) {\n      e.preventDefault();\n\n      _this.fire();\n\n      return false;\n    });\n    dom.addClass(_this2.__button, 'button');\n\n    _this2.domElement.appendChild(_this2.__button);\n\n    return _this2;\n  }\n\n  createClass(FunctionController, [{\n    key: 'fire',\n    value: function fire() {\n      if (this.__onChange) {\n        this.__onChange.call(this);\n      }\n\n      this.getValue().call(this.object);\n\n      if (this.__onFinishChange) {\n        this.__onFinishChange.call(this, this.getValue());\n      }\n    }\n  }]);\n  return FunctionController;\n}(Controller);\n\nvar ColorController = function (_Controller) {\n  inherits(ColorController, _Controller);\n\n  function ColorController(object, property) {\n    classCallCheck(this, ColorController);\n\n    var _this2 = possibleConstructorReturn(this, (ColorController.__proto__ || Object.getPrototypeOf(ColorController)).call(this, object, property));\n\n    _this2.__color = new Color(_this2.getValue());\n    _this2.__temp = new Color(0);\n    var _this = _this2;\n    _this2.domElement = document.createElement('div');\n    dom.makeSelectable(_this2.domElement, false);\n    _this2.__selector = document.createElement('div');\n    _this2.__selector.className = 'selector';\n    _this2.__saturation_field = document.createElement('div');\n    _this2.__saturation_field.className = 'saturation-field';\n    _this2.__field_knob = document.createElement('div');\n    _this2.__field_knob.className = 'field-knob';\n    _this2.__field_knob_border = '2px solid ';\n    _this2.__hue_knob = document.createElement('div');\n    _this2.__hue_knob.className = 'hue-knob';\n    _this2.__hue_field = document.createElement('div');\n    _this2.__hue_field.className = 'hue-field';\n    _this2.__input = document.createElement('input');\n    _this2.__input.type = 'text';\n    _this2.__input_textShadow = '0 1px 1px ';\n    dom.bind(_this2.__input, 'keydown', function (e) {\n      if (e.keyCode === 13) {\n        onBlur.call(this);\n      }\n    });\n    dom.bind(_this2.__input, 'blur', onBlur);\n    dom.bind(_this2.__selector, 'mousedown', function () {\n      dom.addClass(this, 'drag').bind(window, 'mouseup', function () {\n        dom.removeClass(_this.__selector, 'drag');\n      });\n    });\n    dom.bind(_this2.__selector, 'touchstart', function () {\n      dom.addClass(this, 'drag').bind(window, 'touchend', function () {\n        dom.removeClass(_this.__selector, 'drag');\n      });\n    });\n    var valueField = document.createElement('div');\n    Common.extend(_this2.__selector.style, {\n      width: '122px',\n      height: '102px',\n      padding: '3px',\n      backgroundColor: '#222',\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.3)'\n    });\n    Common.extend(_this2.__field_knob.style, {\n      position: 'absolute',\n      width: '12px',\n      height: '12px',\n      border: _this2.__field_knob_border + (_this2.__color.v < 0.5 ? '#fff' : '#000'),\n      boxShadow: '0px 1px 3px rgba(0,0,0,0.5)',\n      borderRadius: '12px',\n      zIndex: 1\n    });\n    Common.extend(_this2.__hue_knob.style, {\n      position: 'absolute',\n      width: '15px',\n      height: '2px',\n      borderRight: '4px solid #fff',\n      zIndex: 1\n    });\n    Common.extend(_this2.__saturation_field.style, {\n      width: '100px',\n      height: '100px',\n      border: '1px solid #555',\n      marginRight: '3px',\n      display: 'inline-block',\n      cursor: 'pointer'\n    });\n    Common.extend(valueField.style, {\n      width: '100%',\n      height: '100%',\n      background: 'none'\n    });\n    linearGradient(valueField, 'top', 'rgba(0,0,0,0)', '#000');\n    Common.extend(_this2.__hue_field.style, {\n      width: '15px',\n      height: '100px',\n      border: '1px solid #555',\n      cursor: 'ns-resize',\n      position: 'absolute',\n      top: '3px',\n      right: '3px'\n    });\n    hueGradient(_this2.__hue_field);\n    Common.extend(_this2.__input.style, {\n      outline: 'none',\n      textAlign: 'center',\n      color: '#fff',\n      border: 0,\n      fontWeight: 'bold',\n      textShadow: _this2.__input_textShadow + 'rgba(0,0,0,0.7)'\n    });\n    dom.bind(_this2.__saturation_field, 'mousedown', fieldDown);\n    dom.bind(_this2.__saturation_field, 'touchstart', fieldDown);\n    dom.bind(_this2.__field_knob, 'mousedown', fieldDown);\n    dom.bind(_this2.__field_knob, 'touchstart', fieldDown);\n    dom.bind(_this2.__hue_field, 'mousedown', fieldDownH);\n    dom.bind(_this2.__hue_field, 'touchstart', fieldDownH);\n\n    function fieldDown(e) {\n      setSV(e);\n      dom.bind(window, 'mousemove', setSV);\n      dom.bind(window, 'touchmove', setSV);\n      dom.bind(window, 'mouseup', fieldUpSV);\n      dom.bind(window, 'touchend', fieldUpSV);\n    }\n\n    function fieldDownH(e) {\n      setH(e);\n      dom.bind(window, 'mousemove', setH);\n      dom.bind(window, 'touchmove', setH);\n      dom.bind(window, 'mouseup', fieldUpH);\n      dom.bind(window, 'touchend', fieldUpH);\n    }\n\n    function fieldUpSV() {\n      dom.unbind(window, 'mousemove', setSV);\n      dom.unbind(window, 'touchmove', setSV);\n      dom.unbind(window, 'mouseup', fieldUpSV);\n      dom.unbind(window, 'touchend', fieldUpSV);\n      onFinish();\n    }\n\n    function fieldUpH() {\n      dom.unbind(window, 'mousemove', setH);\n      dom.unbind(window, 'touchmove', setH);\n      dom.unbind(window, 'mouseup', fieldUpH);\n      dom.unbind(window, 'touchend', fieldUpH);\n      onFinish();\n    }\n\n    function onBlur() {\n      var i = interpret(this.value);\n\n      if (i !== false) {\n        _this.__color.__state = i;\n\n        _this.setValue(_this.__color.toOriginal());\n      } else {\n        this.value = _this.__color.toString();\n      }\n    }\n\n    function onFinish() {\n      if (_this.__onFinishChange) {\n        _this.__onFinishChange.call(_this, _this.__color.toOriginal());\n      }\n    }\n\n    _this2.__saturation_field.appendChild(valueField);\n\n    _this2.__selector.appendChild(_this2.__field_knob);\n\n    _this2.__selector.appendChild(_this2.__saturation_field);\n\n    _this2.__selector.appendChild(_this2.__hue_field);\n\n    _this2.__hue_field.appendChild(_this2.__hue_knob);\n\n    _this2.domElement.appendChild(_this2.__input);\n\n    _this2.domElement.appendChild(_this2.__selector);\n\n    _this2.updateDisplay();\n\n    function setSV(e) {\n      if (e.type.indexOf('touch') === -1) {\n        e.preventDefault();\n      }\n\n      var fieldRect = _this.__saturation_field.getBoundingClientRect();\n\n      var _ref = e.touches && e.touches[0] || e,\n          clientX = _ref.clientX,\n          clientY = _ref.clientY;\n\n      var s = (clientX - fieldRect.left) / (fieldRect.right - fieldRect.left);\n      var v = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\n\n      if (v > 1) {\n        v = 1;\n      } else if (v < 0) {\n        v = 0;\n      }\n\n      if (s > 1) {\n        s = 1;\n      } else if (s < 0) {\n        s = 0;\n      }\n\n      _this.__color.v = v;\n      _this.__color.s = s;\n\n      _this.setValue(_this.__color.toOriginal());\n\n      return false;\n    }\n\n    function setH(e) {\n      if (e.type.indexOf('touch') === -1) {\n        e.preventDefault();\n      }\n\n      var fieldRect = _this.__hue_field.getBoundingClientRect();\n\n      var _ref2 = e.touches && e.touches[0] || e,\n          clientY = _ref2.clientY;\n\n      var h = 1 - (clientY - fieldRect.top) / (fieldRect.bottom - fieldRect.top);\n\n      if (h > 1) {\n        h = 1;\n      } else if (h < 0) {\n        h = 0;\n      }\n\n      _this.__color.h = h * 360;\n\n      _this.setValue(_this.__color.toOriginal());\n\n      return false;\n    }\n\n    return _this2;\n  }\n\n  createClass(ColorController, [{\n    key: 'updateDisplay',\n    value: function updateDisplay() {\n      var i = interpret(this.getValue());\n\n      if (i !== false) {\n        var mismatch = false;\n        Common.each(Color.COMPONENTS, function (component) {\n          if (!Common.isUndefined(i[component]) && !Common.isUndefined(this.__color.__state[component]) && i[component] !== this.__color.__state[component]) {\n            mismatch = true;\n            return {};\n          }\n        }, this);\n\n        if (mismatch) {\n          Common.extend(this.__color.__state, i);\n        }\n      }\n\n      Common.extend(this.__temp.__state, this.__color.__state);\n      this.__temp.a = 1;\n      var flip = this.__color.v < 0.5 || this.__color.s > 0.5 ? 255 : 0;\n\n      var _flip = 255 - flip;\n\n      Common.extend(this.__field_knob.style, {\n        marginLeft: 100 * this.__color.s - 7 + 'px',\n        marginTop: 100 * (1 - this.__color.v) - 7 + 'px',\n        backgroundColor: this.__temp.toHexString(),\n        border: this.__field_knob_border + 'rgb(' + flip + ',' + flip + ',' + flip + ')'\n      });\n      this.__hue_knob.style.marginTop = (1 - this.__color.h / 360) * 100 + 'px';\n      this.__temp.s = 1;\n      this.__temp.v = 1;\n      linearGradient(this.__saturation_field, 'left', '#fff', this.__temp.toHexString());\n      this.__input.value = this.__color.toString();\n      Common.extend(this.__input.style, {\n        backgroundColor: this.__color.toHexString(),\n        color: 'rgb(' + flip + ',' + flip + ',' + flip + ')',\n        textShadow: this.__input_textShadow + 'rgba(' + _flip + ',' + _flip + ',' + _flip + ',.7)'\n      });\n    }\n  }]);\n  return ColorController;\n}(Controller);\n\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\n\nfunction linearGradient(elem, x, a, b) {\n  elem.style.background = '';\n  Common.each(vendors, function (vendor) {\n    elem.style.cssText += 'background: ' + vendor + 'linear-gradient(' + x + ', ' + a + ' 0%, ' + b + ' 100%); ';\n  });\n}\n\nfunction hueGradient(elem) {\n  elem.style.background = '';\n  elem.style.cssText += 'background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\n  elem.style.cssText += 'background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n  elem.style.cssText += 'background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);';\n}\n\nvar css = {\n  load: function load(url, indoc) {\n    var doc = indoc || document;\n    var link = doc.createElement('link');\n    link.type = 'text/css';\n    link.rel = 'stylesheet';\n    link.href = url;\n    doc.getElementsByTagName('head')[0].appendChild(link);\n  },\n  inject: function inject(cssContent, indoc) {\n    var doc = indoc || document;\n    var injected = document.createElement('style');\n    injected.type = 'text/css';\n    injected.innerHTML = cssContent;\n    var head = doc.getElementsByTagName('head')[0];\n\n    try {\n      head.appendChild(injected);\n    } catch (e) {}\n  }\n};\nvar saveDialogContents = \"<div id=\\\"dg-save\\\" class=\\\"dg dialogue\\\">\\n\\n  Here's the new load parameter for your <code>GUI</code>'s constructor:\\n\\n  <textarea id=\\\"dg-new-constructor\\\"></textarea>\\n\\n  <div id=\\\"dg-save-locally\\\">\\n\\n    <input id=\\\"dg-local-storage\\\" type=\\\"checkbox\\\"/> Automatically save\\n    values to <code>localStorage</code> on exit.\\n\\n    <div id=\\\"dg-local-explain\\\">The values saved to <code>localStorage</code> will\\n      override those passed to <code>dat.GUI</code>'s constructor. This makes it\\n      easier to work incrementally, but <code>localStorage</code> is fragile,\\n      and your friends may not see the same values you do.\\n\\n    </div>\\n\\n  </div>\\n\\n</div>\";\n\nvar ControllerFactory = function ControllerFactory(object, property) {\n  var initialValue = object[property];\n\n  if (Common.isArray(arguments[2]) || Common.isObject(arguments[2])) {\n    return new OptionController(object, property, arguments[2]);\n  }\n\n  if (Common.isNumber(initialValue)) {\n    if (Common.isNumber(arguments[2]) && Common.isNumber(arguments[3])) {\n      if (Common.isNumber(arguments[4])) {\n        return new NumberControllerSlider(object, property, arguments[2], arguments[3], arguments[4]);\n      }\n\n      return new NumberControllerSlider(object, property, arguments[2], arguments[3]);\n    }\n\n    if (Common.isNumber(arguments[4])) {\n      return new NumberControllerBox(object, property, {\n        min: arguments[2],\n        max: arguments[3],\n        step: arguments[4]\n      });\n    }\n\n    return new NumberControllerBox(object, property, {\n      min: arguments[2],\n      max: arguments[3]\n    });\n  }\n\n  if (Common.isString(initialValue)) {\n    return new StringController(object, property);\n  }\n\n  if (Common.isFunction(initialValue)) {\n    return new FunctionController(object, property, '');\n  }\n\n  if (Common.isBoolean(initialValue)) {\n    return new BooleanController(object, property);\n  }\n\n  return null;\n};\n\nfunction requestAnimationFrame(callback) {\n  setTimeout(callback, 1000 / 60);\n}\n\nvar requestAnimationFrame$1 = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || requestAnimationFrame;\n\nvar CenteredDiv = function () {\n  function CenteredDiv() {\n    classCallCheck(this, CenteredDiv);\n    this.backgroundElement = document.createElement('div');\n    Common.extend(this.backgroundElement.style, {\n      backgroundColor: 'rgba(0,0,0,0.8)',\n      top: 0,\n      left: 0,\n      display: 'none',\n      zIndex: '1000',\n      opacity: 0,\n      WebkitTransition: 'opacity 0.2s linear',\n      transition: 'opacity 0.2s linear'\n    });\n    dom.makeFullscreen(this.backgroundElement);\n    this.backgroundElement.style.position = 'fixed';\n    this.domElement = document.createElement('div');\n    Common.extend(this.domElement.style, {\n      position: 'fixed',\n      display: 'none',\n      zIndex: '1001',\n      opacity: 0,\n      WebkitTransition: '-webkit-transform 0.2s ease-out, opacity 0.2s linear',\n      transition: 'transform 0.2s ease-out, opacity 0.2s linear'\n    });\n    document.body.appendChild(this.backgroundElement);\n    document.body.appendChild(this.domElement);\n\n    var _this = this;\n\n    dom.bind(this.backgroundElement, 'click', function () {\n      _this.hide();\n    });\n  }\n\n  createClass(CenteredDiv, [{\n    key: 'show',\n    value: function show() {\n      var _this = this;\n\n      this.backgroundElement.style.display = 'block';\n      this.domElement.style.display = 'block';\n      this.domElement.style.opacity = 0;\n      this.domElement.style.webkitTransform = 'scale(1.1)';\n      this.layout();\n      Common.defer(function () {\n        _this.backgroundElement.style.opacity = 1;\n        _this.domElement.style.opacity = 1;\n        _this.domElement.style.webkitTransform = 'scale(1)';\n      });\n    }\n  }, {\n    key: 'hide',\n    value: function hide() {\n      var _this = this;\n\n      var hide = function hide() {\n        _this.domElement.style.display = 'none';\n        _this.backgroundElement.style.display = 'none';\n        dom.unbind(_this.domElement, 'webkitTransitionEnd', hide);\n        dom.unbind(_this.domElement, 'transitionend', hide);\n        dom.unbind(_this.domElement, 'oTransitionEnd', hide);\n      };\n\n      dom.bind(this.domElement, 'webkitTransitionEnd', hide);\n      dom.bind(this.domElement, 'transitionend', hide);\n      dom.bind(this.domElement, 'oTransitionEnd', hide);\n      this.backgroundElement.style.opacity = 0;\n      this.domElement.style.opacity = 0;\n      this.domElement.style.webkitTransform = 'scale(1.1)';\n    }\n  }, {\n    key: 'layout',\n    value: function layout() {\n      this.domElement.style.left = window.innerWidth / 2 - dom.getWidth(this.domElement) / 2 + 'px';\n      this.domElement.style.top = window.innerHeight / 2 - dom.getHeight(this.domElement) / 2 + 'px';\n    }\n  }]);\n  return CenteredDiv;\n}();\n\nvar styleSheet = ___$insertStyle(\".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\\n\");\n\ncss.inject(styleSheet);\nvar CSS_NAMESPACE = 'dg';\nvar HIDE_KEY_CODE = 72;\nvar CLOSE_BUTTON_HEIGHT = 20;\nvar DEFAULT_DEFAULT_PRESET_NAME = 'Default';\n\nvar SUPPORTS_LOCAL_STORAGE = function () {\n  try {\n    return !!window.localStorage;\n  } catch (e) {\n    return false;\n  }\n}();\n\nvar SAVE_DIALOGUE = void 0;\nvar autoPlaceVirgin = true;\nvar autoPlaceContainer = void 0;\nvar hide = false;\nvar hideableGuis = [];\n\nvar GUI = function GUI(pars) {\n  var _this = this;\n\n  var params = pars || {};\n  this.domElement = document.createElement('div');\n  this.__ul = document.createElement('ul');\n  this.domElement.appendChild(this.__ul);\n  dom.addClass(this.domElement, CSS_NAMESPACE);\n  this.__folders = {};\n  this.__controllers = [];\n  this.__rememberedObjects = [];\n  this.__rememberedObjectIndecesToControllers = [];\n  this.__listening = [];\n  params = Common.defaults(params, {\n    closeOnTop: false,\n    autoPlace: true,\n    width: GUI.DEFAULT_WIDTH\n  });\n  params = Common.defaults(params, {\n    resizable: params.autoPlace,\n    hideable: params.autoPlace\n  });\n\n  if (!Common.isUndefined(params.load)) {\n    if (params.preset) {\n      params.load.preset = params.preset;\n    }\n  } else {\n    params.load = {\n      preset: DEFAULT_DEFAULT_PRESET_NAME\n    };\n  }\n\n  if (Common.isUndefined(params.parent) && params.hideable) {\n    hideableGuis.push(this);\n  }\n\n  params.resizable = Common.isUndefined(params.parent) && params.resizable;\n\n  if (params.autoPlace && Common.isUndefined(params.scrollable)) {\n    params.scrollable = true;\n  }\n\n  var useLocalStorage = SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(this, 'isLocal')) === 'true';\n  var saveToLocalStorage = void 0;\n  var titleRow = void 0;\n  Object.defineProperties(this, {\n    parent: {\n      get: function get$$1() {\n        return params.parent;\n      }\n    },\n    scrollable: {\n      get: function get$$1() {\n        return params.scrollable;\n      }\n    },\n    autoPlace: {\n      get: function get$$1() {\n        return params.autoPlace;\n      }\n    },\n    closeOnTop: {\n      get: function get$$1() {\n        return params.closeOnTop;\n      }\n    },\n    preset: {\n      get: function get$$1() {\n        if (_this.parent) {\n          return _this.getRoot().preset;\n        }\n\n        return params.load.preset;\n      },\n      set: function set$$1(v) {\n        if (_this.parent) {\n          _this.getRoot().preset = v;\n        } else {\n          params.load.preset = v;\n        }\n\n        setPresetSelectIndex(this);\n\n        _this.revert();\n      }\n    },\n    width: {\n      get: function get$$1() {\n        return params.width;\n      },\n      set: function set$$1(v) {\n        params.width = v;\n        setWidth(_this, v);\n      }\n    },\n    name: {\n      get: function get$$1() {\n        return params.name;\n      },\n      set: function set$$1(v) {\n        params.name = v;\n\n        if (titleRow) {\n          titleRow.innerHTML = params.name;\n        }\n      }\n    },\n    closed: {\n      get: function get$$1() {\n        return params.closed;\n      },\n      set: function set$$1(v) {\n        params.closed = v;\n\n        if (params.closed) {\n          dom.addClass(_this.__ul, GUI.CLASS_CLOSED);\n        } else {\n          dom.removeClass(_this.__ul, GUI.CLASS_CLOSED);\n        }\n\n        this.onResize();\n\n        if (_this.__closeButton) {\n          _this.__closeButton.innerHTML = v ? GUI.TEXT_OPEN : GUI.TEXT_CLOSED;\n        }\n      }\n    },\n    load: {\n      get: function get$$1() {\n        return params.load;\n      }\n    },\n    useLocalStorage: {\n      get: function get$$1() {\n        return useLocalStorage;\n      },\n      set: function set$$1(bool) {\n        if (SUPPORTS_LOCAL_STORAGE) {\n          useLocalStorage = bool;\n\n          if (bool) {\n            dom.bind(window, 'unload', saveToLocalStorage);\n          } else {\n            dom.unbind(window, 'unload', saveToLocalStorage);\n          }\n\n          localStorage.setItem(getLocalStorageHash(_this, 'isLocal'), bool);\n        }\n      }\n    }\n  });\n\n  if (Common.isUndefined(params.parent)) {\n    this.closed = params.closed || false;\n    dom.addClass(this.domElement, GUI.CLASS_MAIN);\n    dom.makeSelectable(this.domElement, false);\n\n    if (SUPPORTS_LOCAL_STORAGE) {\n      if (useLocalStorage) {\n        _this.useLocalStorage = true;\n        var savedGui = localStorage.getItem(getLocalStorageHash(this, 'gui'));\n\n        if (savedGui) {\n          params.load = JSON.parse(savedGui);\n        }\n      }\n    }\n\n    this.__closeButton = document.createElement('div');\n    this.__closeButton.innerHTML = GUI.TEXT_CLOSED;\n    dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BUTTON);\n\n    if (params.closeOnTop) {\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_TOP);\n      this.domElement.insertBefore(this.__closeButton, this.domElement.childNodes[0]);\n    } else {\n      dom.addClass(this.__closeButton, GUI.CLASS_CLOSE_BOTTOM);\n      this.domElement.appendChild(this.__closeButton);\n    }\n\n    dom.bind(this.__closeButton, 'click', function () {\n      _this.closed = !_this.closed;\n    });\n  } else {\n    if (params.closed === undefined) {\n      params.closed = true;\n    }\n\n    var titleRowName = document.createTextNode(params.name);\n    dom.addClass(titleRowName, 'controller-name');\n    titleRow = addRow(_this, titleRowName);\n\n    var onClickTitle = function onClickTitle(e) {\n      e.preventDefault();\n      _this.closed = !_this.closed;\n      return false;\n    };\n\n    dom.addClass(this.__ul, GUI.CLASS_CLOSED);\n    dom.addClass(titleRow, 'title');\n    dom.bind(titleRow, 'click', onClickTitle);\n\n    if (!params.closed) {\n      this.closed = false;\n    }\n  }\n\n  if (params.autoPlace) {\n    if (Common.isUndefined(params.parent)) {\n      if (autoPlaceVirgin) {\n        autoPlaceContainer = document.createElement('div');\n        dom.addClass(autoPlaceContainer, CSS_NAMESPACE);\n        dom.addClass(autoPlaceContainer, GUI.CLASS_AUTO_PLACE_CONTAINER);\n        document.body.appendChild(autoPlaceContainer);\n        autoPlaceVirgin = false;\n      }\n\n      autoPlaceContainer.appendChild(this.domElement);\n      dom.addClass(this.domElement, GUI.CLASS_AUTO_PLACE);\n    }\n\n    if (!this.parent) {\n      setWidth(_this, params.width);\n    }\n  }\n\n  this.__resizeHandler = function () {\n    _this.onResizeDebounced();\n  };\n\n  dom.bind(window, 'resize', this.__resizeHandler);\n  dom.bind(this.__ul, 'webkitTransitionEnd', this.__resizeHandler);\n  dom.bind(this.__ul, 'transitionend', this.__resizeHandler);\n  dom.bind(this.__ul, 'oTransitionEnd', this.__resizeHandler);\n  this.onResize();\n\n  if (params.resizable) {\n    addResizeHandle(this);\n  }\n\n  saveToLocalStorage = function saveToLocalStorage() {\n    if (SUPPORTS_LOCAL_STORAGE && localStorage.getItem(getLocalStorageHash(_this, 'isLocal')) === 'true') {\n      localStorage.setItem(getLocalStorageHash(_this, 'gui'), JSON.stringify(_this.getSaveObject()));\n    }\n  };\n\n  this.saveToLocalStorageIfPossible = saveToLocalStorage;\n\n  function resetWidth() {\n    var root = _this.getRoot();\n\n    root.width += 1;\n    Common.defer(function () {\n      root.width -= 1;\n    });\n  }\n\n  if (!params.parent) {\n    resetWidth();\n  }\n};\n\nGUI.toggleHide = function () {\n  hide = !hide;\n  Common.each(hideableGuis, function (gui) {\n    gui.domElement.style.display = hide ? 'none' : '';\n  });\n};\n\nGUI.CLASS_AUTO_PLACE = 'a';\nGUI.CLASS_AUTO_PLACE_CONTAINER = 'ac';\nGUI.CLASS_MAIN = 'main';\nGUI.CLASS_CONTROLLER_ROW = 'cr';\nGUI.CLASS_TOO_TALL = 'taller-than-window';\nGUI.CLASS_CLOSED = 'closed';\nGUI.CLASS_CLOSE_BUTTON = 'close-button';\nGUI.CLASS_CLOSE_TOP = 'close-top';\nGUI.CLASS_CLOSE_BOTTOM = 'close-bottom';\nGUI.CLASS_DRAG = 'drag';\nGUI.DEFAULT_WIDTH = 245;\nGUI.TEXT_CLOSED = 'Close Controls';\nGUI.TEXT_OPEN = 'Open Controls';\n\nGUI._keydownHandler = function (e) {\n  if (document.activeElement.type !== 'text' && (e.which === HIDE_KEY_CODE || e.keyCode === HIDE_KEY_CODE)) {\n    GUI.toggleHide();\n  }\n};\n\ndom.bind(window, 'keydown', GUI._keydownHandler, false);\nCommon.extend(GUI.prototype, {\n  add: function add(object, property) {\n    return _add(this, object, property, {\n      factoryArgs: Array.prototype.slice.call(arguments, 2)\n    });\n  },\n  addColor: function addColor(object, property) {\n    return _add(this, object, property, {\n      color: true\n    });\n  },\n  remove: function remove(controller) {\n    this.__ul.removeChild(controller.__li);\n\n    this.__controllers.splice(this.__controllers.indexOf(controller), 1);\n\n    var _this = this;\n\n    Common.defer(function () {\n      _this.onResize();\n    });\n  },\n  destroy: function destroy() {\n    if (this.parent) {\n      throw new Error('Only the root GUI should be removed with .destroy(). ' + 'For subfolders, use gui.removeFolder(folder) instead.');\n    }\n\n    if (this.autoPlace) {\n      autoPlaceContainer.removeChild(this.domElement);\n    }\n\n    var _this = this;\n\n    Common.each(this.__folders, function (subfolder) {\n      _this.removeFolder(subfolder);\n    });\n    dom.unbind(window, 'keydown', GUI._keydownHandler, false);\n    removeListeners(this);\n  },\n  addFolder: function addFolder(name) {\n    if (this.__folders[name] !== undefined) {\n      throw new Error('You already have a folder in this GUI by the' + ' name \"' + name + '\"');\n    }\n\n    var newGuiParams = {\n      name: name,\n      parent: this\n    };\n    newGuiParams.autoPlace = this.autoPlace;\n\n    if (this.load && this.load.folders && this.load.folders[name]) {\n      newGuiParams.closed = this.load.folders[name].closed;\n      newGuiParams.load = this.load.folders[name];\n    }\n\n    var gui = new GUI(newGuiParams);\n    this.__folders[name] = gui;\n    var li = addRow(this, gui.domElement);\n    dom.addClass(li, 'folder');\n    return gui;\n  },\n  removeFolder: function removeFolder(folder) {\n    this.__ul.removeChild(folder.domElement.parentElement);\n\n    delete this.__folders[folder.name];\n\n    if (this.load && this.load.folders && this.load.folders[folder.name]) {\n      delete this.load.folders[folder.name];\n    }\n\n    removeListeners(folder);\n\n    var _this = this;\n\n    Common.each(folder.__folders, function (subfolder) {\n      folder.removeFolder(subfolder);\n    });\n    Common.defer(function () {\n      _this.onResize();\n    });\n  },\n  open: function open() {\n    this.closed = false;\n  },\n  close: function close() {\n    this.closed = true;\n  },\n  hide: function hide() {\n    this.domElement.style.display = 'none';\n  },\n  show: function show() {\n    this.domElement.style.display = '';\n  },\n  onResize: function onResize() {\n    var root = this.getRoot();\n\n    if (root.scrollable) {\n      var top = dom.getOffset(root.__ul).top;\n      var h = 0;\n      Common.each(root.__ul.childNodes, function (node) {\n        if (!(root.autoPlace && node === root.__save_row)) {\n          h += dom.getHeight(node);\n        }\n      });\n\n      if (window.innerHeight - top - CLOSE_BUTTON_HEIGHT < h) {\n        dom.addClass(root.domElement, GUI.CLASS_TOO_TALL);\n        root.__ul.style.height = window.innerHeight - top - CLOSE_BUTTON_HEIGHT + 'px';\n      } else {\n        dom.removeClass(root.domElement, GUI.CLASS_TOO_TALL);\n        root.__ul.style.height = 'auto';\n      }\n    }\n\n    if (root.__resize_handle) {\n      Common.defer(function () {\n        root.__resize_handle.style.height = root.__ul.offsetHeight + 'px';\n      });\n    }\n\n    if (root.__closeButton) {\n      root.__closeButton.style.width = root.width + 'px';\n    }\n  },\n  onResizeDebounced: Common.debounce(function () {\n    this.onResize();\n  }, 50),\n  remember: function remember() {\n    if (Common.isUndefined(SAVE_DIALOGUE)) {\n      SAVE_DIALOGUE = new CenteredDiv();\n      SAVE_DIALOGUE.domElement.innerHTML = saveDialogContents;\n    }\n\n    if (this.parent) {\n      throw new Error('You can only call remember on a top level GUI.');\n    }\n\n    var _this = this;\n\n    Common.each(Array.prototype.slice.call(arguments), function (object) {\n      if (_this.__rememberedObjects.length === 0) {\n        addSaveMenu(_this);\n      }\n\n      if (_this.__rememberedObjects.indexOf(object) === -1) {\n        _this.__rememberedObjects.push(object);\n      }\n    });\n\n    if (this.autoPlace) {\n      setWidth(this, this.width);\n    }\n  },\n  getRoot: function getRoot() {\n    var gui = this;\n\n    while (gui.parent) {\n      gui = gui.parent;\n    }\n\n    return gui;\n  },\n  getSaveObject: function getSaveObject() {\n    var toReturn = this.load;\n    toReturn.closed = this.closed;\n\n    if (this.__rememberedObjects.length > 0) {\n      toReturn.preset = this.preset;\n\n      if (!toReturn.remembered) {\n        toReturn.remembered = {};\n      }\n\n      toReturn.remembered[this.preset] = getCurrentPreset(this);\n    }\n\n    toReturn.folders = {};\n    Common.each(this.__folders, function (element, key) {\n      toReturn.folders[key] = element.getSaveObject();\n    });\n    return toReturn;\n  },\n  save: function save() {\n    if (!this.load.remembered) {\n      this.load.remembered = {};\n    }\n\n    this.load.remembered[this.preset] = getCurrentPreset(this);\n    markPresetModified(this, false);\n    this.saveToLocalStorageIfPossible();\n  },\n  saveAs: function saveAs(presetName) {\n    if (!this.load.remembered) {\n      this.load.remembered = {};\n      this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME] = getCurrentPreset(this, true);\n    }\n\n    this.load.remembered[presetName] = getCurrentPreset(this);\n    this.preset = presetName;\n    addPresetOption(this, presetName, true);\n    this.saveToLocalStorageIfPossible();\n  },\n  revert: function revert(gui) {\n    Common.each(this.__controllers, function (controller) {\n      if (!this.getRoot().load.remembered) {\n        controller.setValue(controller.initialValue);\n      } else {\n        recallSavedValue(gui || this.getRoot(), controller);\n      }\n\n      if (controller.__onFinishChange) {\n        controller.__onFinishChange.call(controller, controller.getValue());\n      }\n    }, this);\n    Common.each(this.__folders, function (folder) {\n      folder.revert(folder);\n    });\n\n    if (!gui) {\n      markPresetModified(this.getRoot(), false);\n    }\n  },\n  listen: function listen(controller) {\n    var init = this.__listening.length === 0;\n\n    this.__listening.push(controller);\n\n    if (init) {\n      updateDisplays(this.__listening);\n    }\n  },\n  updateDisplay: function updateDisplay() {\n    Common.each(this.__controllers, function (controller) {\n      controller.updateDisplay();\n    });\n    Common.each(this.__folders, function (folder) {\n      folder.updateDisplay();\n    });\n  }\n});\n\nfunction addRow(gui, newDom, liBefore) {\n  var li = document.createElement('li');\n\n  if (newDom) {\n    li.appendChild(newDom);\n  }\n\n  if (liBefore) {\n    gui.__ul.insertBefore(li, liBefore);\n  } else {\n    gui.__ul.appendChild(li);\n  }\n\n  gui.onResize();\n  return li;\n}\n\nfunction removeListeners(gui) {\n  dom.unbind(window, 'resize', gui.__resizeHandler);\n\n  if (gui.saveToLocalStorageIfPossible) {\n    dom.unbind(window, 'unload', gui.saveToLocalStorageIfPossible);\n  }\n}\n\nfunction markPresetModified(gui, modified) {\n  var opt = gui.__preset_select[gui.__preset_select.selectedIndex];\n\n  if (modified) {\n    opt.innerHTML = opt.value + '*';\n  } else {\n    opt.innerHTML = opt.value;\n  }\n}\n\nfunction augmentController(gui, li, controller) {\n  controller.__li = li;\n  controller.__gui = gui;\n  Common.extend(controller, {\n    options: function options(_options) {\n      if (arguments.length > 1) {\n        var nextSibling = controller.__li.nextElementSibling;\n        controller.remove();\n        return _add(gui, controller.object, controller.property, {\n          before: nextSibling,\n          factoryArgs: [Common.toArray(arguments)]\n        });\n      }\n\n      if (Common.isArray(_options) || Common.isObject(_options)) {\n        var _nextSibling = controller.__li.nextElementSibling;\n        controller.remove();\n        return _add(gui, controller.object, controller.property, {\n          before: _nextSibling,\n          factoryArgs: [_options]\n        });\n      }\n    },\n    name: function name(_name) {\n      controller.__li.firstElementChild.firstElementChild.innerHTML = _name;\n      return controller;\n    },\n    listen: function listen() {\n      controller.__gui.listen(controller);\n\n      return controller;\n    },\n    remove: function remove() {\n      controller.__gui.remove(controller);\n\n      return controller;\n    }\n  });\n\n  if (controller instanceof NumberControllerSlider) {\n    var box = new NumberControllerBox(controller.object, controller.property, {\n      min: controller.__min,\n      max: controller.__max,\n      step: controller.__step\n    });\n    Common.each(['updateDisplay', 'onChange', 'onFinishChange', 'step', 'min', 'max'], function (method) {\n      var pc = controller[method];\n      var pb = box[method];\n\n      controller[method] = box[method] = function () {\n        var args = Array.prototype.slice.call(arguments);\n        pb.apply(box, args);\n        return pc.apply(controller, args);\n      };\n    });\n    dom.addClass(li, 'has-slider');\n    controller.domElement.insertBefore(box.domElement, controller.domElement.firstElementChild);\n  } else if (controller instanceof NumberControllerBox) {\n    var r = function r(returned) {\n      if (Common.isNumber(controller.__min) && Common.isNumber(controller.__max)) {\n        var oldName = controller.__li.firstElementChild.firstElementChild.innerHTML;\n        var wasListening = controller.__gui.__listening.indexOf(controller) > -1;\n        controller.remove();\n\n        var newController = _add(gui, controller.object, controller.property, {\n          before: controller.__li.nextElementSibling,\n          factoryArgs: [controller.__min, controller.__max, controller.__step]\n        });\n\n        newController.name(oldName);\n        if (wasListening) newController.listen();\n        return newController;\n      }\n\n      return returned;\n    };\n\n    controller.min = Common.compose(r, controller.min);\n    controller.max = Common.compose(r, controller.max);\n  } else if (controller instanceof BooleanController) {\n    dom.bind(li, 'click', function () {\n      dom.fakeEvent(controller.__checkbox, 'click');\n    });\n    dom.bind(controller.__checkbox, 'click', function (e) {\n      e.stopPropagation();\n    });\n  } else if (controller instanceof FunctionController) {\n    dom.bind(li, 'click', function () {\n      dom.fakeEvent(controller.__button, 'click');\n    });\n    dom.bind(li, 'mouseover', function () {\n      dom.addClass(controller.__button, 'hover');\n    });\n    dom.bind(li, 'mouseout', function () {\n      dom.removeClass(controller.__button, 'hover');\n    });\n  } else if (controller instanceof ColorController) {\n    dom.addClass(li, 'color');\n    controller.updateDisplay = Common.compose(function (val) {\n      li.style.borderLeftColor = controller.__color.toString();\n      return val;\n    }, controller.updateDisplay);\n    controller.updateDisplay();\n  }\n\n  controller.setValue = Common.compose(function (val) {\n    if (gui.getRoot().__preset_select && controller.isModified()) {\n      markPresetModified(gui.getRoot(), true);\n    }\n\n    return val;\n  }, controller.setValue);\n}\n\nfunction recallSavedValue(gui, controller) {\n  var root = gui.getRoot();\n\n  var matchedIndex = root.__rememberedObjects.indexOf(controller.object);\n\n  if (matchedIndex !== -1) {\n    var controllerMap = root.__rememberedObjectIndecesToControllers[matchedIndex];\n\n    if (controllerMap === undefined) {\n      controllerMap = {};\n      root.__rememberedObjectIndecesToControllers[matchedIndex] = controllerMap;\n    }\n\n    controllerMap[controller.property] = controller;\n\n    if (root.load && root.load.remembered) {\n      var presetMap = root.load.remembered;\n      var preset = void 0;\n\n      if (presetMap[gui.preset]) {\n        preset = presetMap[gui.preset];\n      } else if (presetMap[DEFAULT_DEFAULT_PRESET_NAME]) {\n        preset = presetMap[DEFAULT_DEFAULT_PRESET_NAME];\n      } else {\n        return;\n      }\n\n      if (preset[matchedIndex] && preset[matchedIndex][controller.property] !== undefined) {\n        var value = preset[matchedIndex][controller.property];\n        controller.initialValue = value;\n        controller.setValue(value);\n      }\n    }\n  }\n}\n\nfunction _add(gui, object, property, params) {\n  if (object[property] === undefined) {\n    throw new Error('Object \"' + object + '\" has no property \"' + property + '\"');\n  }\n\n  var controller = void 0;\n\n  if (params.color) {\n    controller = new ColorController(object, property);\n  } else {\n    var factoryArgs = [object, property].concat(params.factoryArgs);\n    controller = ControllerFactory.apply(gui, factoryArgs);\n  }\n\n  if (params.before instanceof Controller) {\n    params.before = params.before.__li;\n  }\n\n  recallSavedValue(gui, controller);\n  dom.addClass(controller.domElement, 'c');\n  var name = document.createElement('span');\n  dom.addClass(name, 'property-name');\n  name.innerHTML = controller.property;\n  var container = document.createElement('div');\n  container.appendChild(name);\n  container.appendChild(controller.domElement);\n  var li = addRow(gui, container, params.before);\n  dom.addClass(li, GUI.CLASS_CONTROLLER_ROW);\n\n  if (controller instanceof ColorController) {\n    dom.addClass(li, 'color');\n  } else {\n    dom.addClass(li, _typeof(controller.getValue()));\n  }\n\n  augmentController(gui, li, controller);\n\n  gui.__controllers.push(controller);\n\n  return controller;\n}\n\nfunction getLocalStorageHash(gui, key) {\n  return document.location.href + '.' + key;\n}\n\nfunction addPresetOption(gui, name, setSelected) {\n  var opt = document.createElement('option');\n  opt.innerHTML = name;\n  opt.value = name;\n\n  gui.__preset_select.appendChild(opt);\n\n  if (setSelected) {\n    gui.__preset_select.selectedIndex = gui.__preset_select.length - 1;\n  }\n}\n\nfunction showHideExplain(gui, explain) {\n  explain.style.display = gui.useLocalStorage ? 'block' : 'none';\n}\n\nfunction addSaveMenu(gui) {\n  var div = gui.__save_row = document.createElement('li');\n  dom.addClass(gui.domElement, 'has-save');\n\n  gui.__ul.insertBefore(div, gui.__ul.firstChild);\n\n  dom.addClass(div, 'save-row');\n  var gears = document.createElement('span');\n  gears.innerHTML = '&nbsp;';\n  dom.addClass(gears, 'button gears');\n  var button = document.createElement('span');\n  button.innerHTML = 'Save';\n  dom.addClass(button, 'button');\n  dom.addClass(button, 'save');\n  var button2 = document.createElement('span');\n  button2.innerHTML = 'New';\n  dom.addClass(button2, 'button');\n  dom.addClass(button2, 'save-as');\n  var button3 = document.createElement('span');\n  button3.innerHTML = 'Revert';\n  dom.addClass(button3, 'button');\n  dom.addClass(button3, 'revert');\n  var select = gui.__preset_select = document.createElement('select');\n\n  if (gui.load && gui.load.remembered) {\n    Common.each(gui.load.remembered, function (value, key) {\n      addPresetOption(gui, key, key === gui.preset);\n    });\n  } else {\n    addPresetOption(gui, DEFAULT_DEFAULT_PRESET_NAME, false);\n  }\n\n  dom.bind(select, 'change', function () {\n    for (var index = 0; index < gui.__preset_select.length; index++) {\n      gui.__preset_select[index].innerHTML = gui.__preset_select[index].value;\n    }\n\n    gui.preset = this.value;\n  });\n  div.appendChild(select);\n  div.appendChild(gears);\n  div.appendChild(button);\n  div.appendChild(button2);\n  div.appendChild(button3);\n\n  if (SUPPORTS_LOCAL_STORAGE) {\n    var explain = document.getElementById('dg-local-explain');\n    var localStorageCheckBox = document.getElementById('dg-local-storage');\n    var saveLocally = document.getElementById('dg-save-locally');\n    saveLocally.style.display = 'block';\n\n    if (localStorage.getItem(getLocalStorageHash(gui, 'isLocal')) === 'true') {\n      localStorageCheckBox.setAttribute('checked', 'checked');\n    }\n\n    showHideExplain(gui, explain);\n    dom.bind(localStorageCheckBox, 'change', function () {\n      gui.useLocalStorage = !gui.useLocalStorage;\n      showHideExplain(gui, explain);\n    });\n  }\n\n  var newConstructorTextArea = document.getElementById('dg-new-constructor');\n  dom.bind(newConstructorTextArea, 'keydown', function (e) {\n    if (e.metaKey && (e.which === 67 || e.keyCode === 67)) {\n      SAVE_DIALOGUE.hide();\n    }\n  });\n  dom.bind(gears, 'click', function () {\n    newConstructorTextArea.innerHTML = JSON.stringify(gui.getSaveObject(), undefined, 2);\n    SAVE_DIALOGUE.show();\n    newConstructorTextArea.focus();\n    newConstructorTextArea.select();\n  });\n  dom.bind(button, 'click', function () {\n    gui.save();\n  });\n  dom.bind(button2, 'click', function () {\n    var presetName = prompt('Enter a new preset name.');\n\n    if (presetName) {\n      gui.saveAs(presetName);\n    }\n  });\n  dom.bind(button3, 'click', function () {\n    gui.revert();\n  });\n}\n\nfunction addResizeHandle(gui) {\n  var pmouseX = void 0;\n  gui.__resize_handle = document.createElement('div');\n  Common.extend(gui.__resize_handle.style, {\n    width: '6px',\n    marginLeft: '-3px',\n    height: '200px',\n    cursor: 'ew-resize',\n    position: 'absolute'\n  });\n\n  function drag(e) {\n    e.preventDefault();\n    gui.width += pmouseX - e.clientX;\n    gui.onResize();\n    pmouseX = e.clientX;\n    return false;\n  }\n\n  function dragStop() {\n    dom.removeClass(gui.__closeButton, GUI.CLASS_DRAG);\n    dom.unbind(window, 'mousemove', drag);\n    dom.unbind(window, 'mouseup', dragStop);\n  }\n\n  function dragStart(e) {\n    e.preventDefault();\n    pmouseX = e.clientX;\n    dom.addClass(gui.__closeButton, GUI.CLASS_DRAG);\n    dom.bind(window, 'mousemove', drag);\n    dom.bind(window, 'mouseup', dragStop);\n    return false;\n  }\n\n  dom.bind(gui.__resize_handle, 'mousedown', dragStart);\n  dom.bind(gui.__closeButton, 'mousedown', dragStart);\n  gui.domElement.insertBefore(gui.__resize_handle, gui.domElement.firstElementChild);\n}\n\nfunction setWidth(gui, w) {\n  gui.domElement.style.width = w + 'px';\n\n  if (gui.__save_row && gui.autoPlace) {\n    gui.__save_row.style.width = w + 'px';\n  }\n\n  if (gui.__closeButton) {\n    gui.__closeButton.style.width = w + 'px';\n  }\n}\n\nfunction getCurrentPreset(gui, useInitialValues) {\n  var toReturn = {};\n  Common.each(gui.__rememberedObjects, function (val, index) {\n    var savedValues = {};\n    var controllerMap = gui.__rememberedObjectIndecesToControllers[index];\n    Common.each(controllerMap, function (controller, property) {\n      savedValues[property] = useInitialValues ? controller.initialValue : controller.getValue();\n    });\n    toReturn[index] = savedValues;\n  });\n  return toReturn;\n}\n\nfunction setPresetSelectIndex(gui) {\n  for (var index = 0; index < gui.__preset_select.length; index++) {\n    if (gui.__preset_select[index].value === gui.preset) {\n      gui.__preset_select.selectedIndex = index;\n    }\n  }\n}\n\nfunction updateDisplays(controllerArray) {\n  if (controllerArray.length !== 0) {\n    requestAnimationFrame$1.call(window, function () {\n      updateDisplays(controllerArray);\n    });\n  }\n\n  Common.each(controllerArray, function (c) {\n    c.updateDisplay();\n  });\n}\n\nvar color = {\n  Color: Color,\n  math: ColorMath,\n  interpret: interpret\n};\nvar controllers = {\n  Controller: Controller,\n  BooleanController: BooleanController,\n  OptionController: OptionController,\n  StringController: StringController,\n  NumberController: NumberController,\n  NumberControllerBox: NumberControllerBox,\n  NumberControllerSlider: NumberControllerSlider,\n  FunctionController: FunctionController,\n  ColorController: ColorController\n};\nvar dom$1 = {\n  dom: dom\n};\nvar gui = {\n  GUI: GUI\n};\nvar GUI$1 = GUI;\nvar index = {\n  color: color,\n  controllers: controllers,\n  dom: dom$1,\n  gui: gui,\n  GUI: GUI$1\n};\nexport { color, controllers, dom$1 as dom, gui, GUI$1 as GUI };\nexport default index;","/* eslint-disable no-bitwise */\r\nexport function isMobile() {\r\n    return /mobi|android/i.test(navigator.userAgent);\r\n}\r\nexport function clamp01(input: number) {\r\n    return Math.min(Math.max(input, 0), 1);\r\n}\r\n\r\nexport function correctDeltaX(delta: number, canvas: { width: number, height: number }) {\r\n    const aspectRatio = canvas.width / canvas.height;\r\n    if (aspectRatio < 1) delta *= aspectRatio;\r\n    return delta;\r\n}\r\n\r\nexport function correctDeltaY(delta: number, canvas: { width: number, height: number }) {\r\n    const aspectRatio = canvas.width / canvas.height;\r\n    if (aspectRatio > 1) delta /= aspectRatio;\r\n    return delta;\r\n}\r\n\r\nexport function generateColor() {\r\n    const c = HSVtoRGB(Math.random(), 1, 1);\r\n    c.r *= 0.15;\r\n    c.g *= 0.15;\r\n    c.b *= 0.15;\r\n    return c;\r\n}\r\n\r\nexport function HSVtoRGB(h: number, s: number, v: number) {\r\n    const i = Math.floor(h * 6);\r\n    const f = h * 6 - i;\r\n    const p = v * (1 - s);\r\n    const q = v * (1 - f * s);\r\n    const t = v * (1 - (1 - f) * s);\r\n\r\n    switch (i % 6) {\r\n        case 0: return { r: v, g: t, b: p };\r\n        case 1: return { r: q, g: v, b: p };\r\n        case 2: return { r: p, g: v, b: t };\r\n        case 3: return { r: p, g: q, b: v };\r\n        case 4: return { r: t, g: p, b: v };\r\n        case 5: return { r: v, g: p, b: q };\r\n        default: return { r: v, g: p, b: q };\r\n    }\r\n}\r\n\r\nexport function normalizeColor(input: { r: number, g: number, b: number }) {\r\n    const output = {\r\n        r: input.r / 255,\r\n        g: input.g / 255,\r\n        b: input.b / 255,\r\n    };\r\n    return output;\r\n}\r\n\r\nexport function wrap(value: number, min: number, max: number) {\r\n    const range = max - min;\r\n    if (range === 0) return min;\r\n    return (value - min) % range + min;\r\n}\r\n\r\n\r\nexport function getTextureScale(texture: { width: number, height: number }, width: number, height: number) {\r\n    return {\r\n        x: width / texture.width,\r\n        y: height / texture.height,\r\n    };\r\n}\r\n\r\nexport function scaleByPixelRatio(input: number) {\r\n    const pixelRatio = window.devicePixelRatio || 1;\r\n    return Math.floor(input * pixelRatio);\r\n}\r\n\r\nexport function hashCode(s: string) {\r\n    if (!s) return 0;\r\n\r\n    let hash = 0;\r\n    for (let i = 0; i < s.length; i++) {\r\n        hash = (hash << 5) - hash + s.charCodeAt(i);\r\n        hash |= 0; // Convert to 32bit integer\r\n    }\r\n    return hash;\r\n};\r\n\r\nexport const randomIntRange = (minInclusive: number, maxInclusive: number) => {\r\n    return (minInclusive + (maxInclusive - minInclusive + 1) * Math.random()) | 0;\r\n};\r\n\r\nexport type ColorRgb = { r: number, g: number, b: number };\r\n","import { FrameBufferFactory, FrameBufferObject } from './frame-buffer';\r\nimport { clamp01 } from '../utils';\r\nimport { WebGlSystem } from './webgl';\r\n\r\nexport const createTextureUtils = ({ gl, ext }: WebGlSystem, { createFrameBufferObject }: FrameBufferFactory) => {\r\n\r\n    function captureScreenshot(render: (target: FrameBufferObject) => void, { resolution }: { resolution: number }) {\r\n        const res = getResolution(resolution);\r\n        const target = createFrameBufferObject(res.width, res.height, ext.formatRGBA.internalFormat, ext.formatRGBA.format, ext.halfFloatTexType, gl.NEAREST);\r\n        render(target);\r\n\r\n        const texture32 = framebufferToTexture(target);\r\n        const texture = normalizeTexture(texture32, target.width, target.height);\r\n\r\n        const captureCanvas = textureToCanvas(texture, target.width, target.height);\r\n        const datauri = captureCanvas.toDataURL();\r\n        downloadURI(`fluid.png`, datauri);\r\n        URL.revokeObjectURL(datauri);\r\n    }\r\n\r\n    function downloadURI(filename: string, uri: string) {\r\n        const link = document.createElement(`a`);\r\n        link.download = filename;\r\n        link.href = uri;\r\n        document.body.append(link);\r\n        link.click();\r\n        link.remove();\r\n    }\r\n\r\n    function getResolution(resolution: number) {\r\n        let aspectRatio = gl.drawingBufferWidth / gl.drawingBufferHeight;\r\n        if (aspectRatio < 1)\r\n            aspectRatio = 1 / aspectRatio;\r\n\r\n        const min = Math.round(resolution);\r\n        const max = Math.round(resolution * aspectRatio);\r\n\r\n        if (gl.drawingBufferWidth > gl.drawingBufferHeight)\r\n            return { width: max, height: min };\r\n        return { width: min, height: max };\r\n    }\r\n\r\n    function framebufferToTexture(target: FrameBufferObject) {\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, target.frameBuffer);\r\n        const length = target.width * target.height * 4;\r\n        const texture = new Float32Array(length);\r\n        gl.readPixels(0, 0, target.width, target.height, gl.RGBA, gl.FLOAT, texture);\r\n        return texture;\r\n    }\r\n\r\n    function normalizeTexture(texture: Float32Array, width: number, height: number) {\r\n        const result = new Uint8Array(texture.length);\r\n        let id = 0;\r\n        for (let i = height - 1; i >= 0; i--) {\r\n            for (let j = 0; j < width; j++) {\r\n                const nid = i * width * 4 + j * 4;\r\n                result[nid + 0] = clamp01(texture[id + 0]) * 255;\r\n                result[nid + 1] = clamp01(texture[id + 1]) * 255;\r\n                result[nid + 2] = clamp01(texture[id + 2]) * 255;\r\n                result[nid + 3] = clamp01(texture[id + 3]) * 255;\r\n                id += 4;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function textureToCanvas(texture: Uint8Array, width: number, height: number) {\r\n        const captureCanvas = document.createElement(`canvas`);\r\n        const ctx = captureCanvas.getContext(`2d`);\r\n        if (!ctx) { throw new Error(`Could not get canvas 2d context`); }\r\n\r\n        captureCanvas.width = width;\r\n        captureCanvas.height = height;\r\n\r\n        const imageData = ctx.createImageData(width, height);\r\n        imageData.data.set(texture);\r\n        ctx.putImageData(imageData, 0, 0);\r\n\r\n        return captureCanvas;\r\n    }\r\n\r\n    return {\r\n        captureScreenshot,\r\n        getResolution,\r\n        // framebufferToTexture,\r\n        // normalizeTexture,\r\n        // textureToCanvas,\r\n    };\r\n};\r\n","/* eslint-disable lines-between-class-members */\r\n/* eslint-disable max-classes-per-file */\r\nimport { hashCode } from '../utils';\r\nimport { WebGlSystem } from './webgl';\r\n\r\nexport const createShaderFactory = ({ gl, ext }: WebGlSystem) => {\r\n    function compileShader(type: number, source: string, keywords?: null | string[]) {\r\n        source = addKeywords(source, keywords);\r\n\r\n        const shader = gl.createShader(type);\r\n        if (!shader) { throw new Error(`shader could not be created`); }\r\n\r\n        gl.shaderSource(shader, source);\r\n        gl.compileShader(shader);\r\n\r\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n            console.trace(gl.getShaderInfoLog(shader));\r\n        }\r\n\r\n        return shader;\r\n    };\r\n\r\n    function addKeywords(source: string, keywords?: null | string[]) {\r\n        if (!keywords) return source;\r\n\r\n        let keywordsString = ``;\r\n        keywords.forEach(keyword => {\r\n            keywordsString += `#define ${keyword}\\n`;\r\n        });\r\n        return keywordsString + source;\r\n    }\r\n\r\n    function createProgram(vertexShader: WebGLShader, fragmentShader: WebGLShader) {\r\n        const program = gl.createProgram();\r\n        if (!program) { throw new Error(`program could not be created`); }\r\n\r\n        gl.attachShader(program, vertexShader);\r\n        gl.attachShader(program, fragmentShader);\r\n        gl.linkProgram(program);\r\n\r\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS))\r\n            console.trace(gl.getProgramInfoLog(program));\r\n\r\n        return program;\r\n    }\r\n\r\n    function getUniforms(program: WebGLProgram): { [name: string]: WebGLUniformLocation } {\r\n        const uniforms = {} as { [name: string]: WebGLUniformLocation };\r\n        const uniformCount = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\r\n        for (let i = 0; i < uniformCount; i++) {\r\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n            const uniformName = gl.getActiveUniform(program, i)?.name!;\r\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n            uniforms[uniformName] = gl.getUniformLocation(program, uniformName)!;\r\n        }\r\n        return uniforms;\r\n    }\r\n\r\n    return {\r\n        gl,\r\n        ext,\r\n        compileShader,\r\n        createProgram,\r\n        getUniforms,\r\n    };\r\n};\r\n\r\nexport type ShaderFactory = ReturnType<typeof createShaderFactory>;\r\nexport type ShaderUniforms = ReturnType<ShaderFactory['getUniforms']>;\r\n\r\nexport class ShaderMaterial {\r\n    vertexShader: WebGLShader;\r\n    fragmentShaderSource: string;\r\n    programs: WebGLProgram[];\r\n    activeProgram: null | WebGLProgram;\r\n    uniforms: ShaderUniforms;\r\n\r\n    constructor(private factory: ShaderFactory, vertexShader: WebGLShader, fragmentShaderSource: string) {\r\n        this.vertexShader = vertexShader;\r\n        this.fragmentShaderSource = fragmentShaderSource;\r\n        this.programs = [];\r\n        this.activeProgram = null;\r\n        this.uniforms = {};\r\n    }\r\n\r\n    setKeywords(keywords: string[]) {\r\n        let hash = 0;\r\n        for (let i = 0; i < keywords.length; i++)\r\n            hash += hashCode(keywords[i]);\r\n\r\n        let program = this.programs[hash];\r\n        if (program == null) {\r\n            const fragmentShader = this.factory.compileShader(this.factory.gl.FRAGMENT_SHADER, this.fragmentShaderSource, keywords);\r\n            program = this.factory.createProgram(this.vertexShader, fragmentShader);\r\n            this.programs[hash] = program;\r\n        }\r\n\r\n        if (program === this.activeProgram) return;\r\n\r\n        this.uniforms = this.factory.getUniforms(program);\r\n        this.activeProgram = program;\r\n    }\r\n\r\n    bind() {\r\n        this.factory.gl.useProgram(this.activeProgram);\r\n    }\r\n}\r\n\r\nexport class ShaderProgram {\r\n    uniforms: ShaderUniforms;\r\n    program: WebGLProgram;\r\n\r\n    constructor(private factory: ShaderFactory, vertexShader: WebGLShader, fragmentShader: WebGLShader) {\r\n        this.uniforms = {};\r\n        this.program = this.factory.createProgram(vertexShader, fragmentShader);\r\n        this.uniforms = this.factory.getUniforms(this.program);\r\n    }\r\n\r\n    bind() {\r\n        this.factory.gl.useProgram(this.program);\r\n    }\r\n}\r\n","/* eslint-disable no-bitwise */\r\n/* eslint-disable lines-between-class-members */\r\n/* eslint-disable max-classes-per-file */\r\n\r\nimport { TimeProvider } from '../../../time-provider';\r\nimport { createConfig } from './config';\r\nimport { createFrameBufferFactory, createFrameBufferUtils, DoubleFrameBufferObject, FrameBufferObject } from './systems/frame-buffer';\r\nimport { getWebGLSystem } from './systems/webgl';\r\nimport { startGUI } from './gui';\r\nimport { ColorRgb, correctDeltaX, correctDeltaY, generateColor, getTextureScale, isMobile, normalizeColor, randomIntRange, scaleByPixelRatio, wrap } from './utils';\r\nimport { createTextureUtils } from './systems/texture';\r\nimport { createShaderFactory, ShaderMaterial, ShaderProgram } from './systems/shader';\r\nimport { createShaders } from './shaders';\r\n// import { setupAppPopup } from './setup-app-popup';\r\n\r\n\r\nexport const runFluidSimulator = (host: HTMLDivElement, contentPath: string, style: { width: string, height: string }, options?: { timeProvider?: TimeProvider, disableGui?: boolean, disableInput?: boolean, disableStartupSplats?: boolean }) => {\r\n\r\n    const timeProvider = options?.timeProvider ?? { now: () => Date.now(), isPaused: () => false };\r\n\r\n    // setupAppPopup();\r\n\r\n    // Simulation section\r\n\r\n    // Setup ---\r\n    // const canvas = document.querySelectorAll(`canvas`)[0] as HTMLCanvasElement;\r\n    const canvas = document.createElement(`canvas`);\r\n    canvas.style.width = style.width;\r\n    canvas.style.height = style.height;\r\n    host.append(canvas);\r\n\r\n    resizeCanvas();\r\n\r\n\r\n    class PointerEntity {\r\n        id = -1;\r\n        texcoordX = 0;\r\n        texcoordY = 0;\r\n        prevTexcoordX = 0;\r\n        prevTexcoordY = 0;\r\n        deltaX = 0;\r\n        deltaY = 0;\r\n        down = false;\r\n        moved = false;\r\n        color = { r: 30, g: 0, b: 300 };\r\n        size = undefined as undefined | { x: number, y: number };\r\n        p = { r: 0, g: 0, b: 0 };\r\n    }\r\n    type PointerEntityType = PointerEntity;\r\n\r\n    const pointers = [] as PointerEntityType[];\r\n    const splatStack = [] as number[];\r\n    pointers.push(new PointerEntity());\r\n\r\n    console.log(`runFluidSimulator - 01 getWebGLSystem`, {});\r\n    const webGlSystem = getWebGLSystem(canvas);\r\n    if (!webGlSystem) { return null; }\r\n\r\n    const { gl, ext } = webGlSystem;\r\n    console.log(`runFluidSimulator - 01B getWebGLSystem`, { gl, ext });\r\n\r\n    const frameBufferFactory = createFrameBufferFactory(webGlSystem);\r\n    const {\r\n        createFrameBufferObject,\r\n        createDoubleFrameBufferObject,\r\n    } = frameBufferFactory;\r\n\r\n\r\n    const {\r\n        captureScreenshot,\r\n        getResolution,\r\n    } = createTextureUtils(webGlSystem, frameBufferFactory);\r\n\r\n    const shaderFactory = createShaderFactory(webGlSystem);\r\n\r\n    const config = createConfig();\r\n    if (isMobile()) {\r\n        config.DYE_RESOLUTION = 512;\r\n    }\r\n    if (!ext.supportLinearFiltering) {\r\n        config.DYE_RESOLUTION = 512;\r\n        config.SHADING = false;\r\n        config.BLOOM = false;\r\n        config.SUNRAYS = false;\r\n    }\r\n\r\n    console.log(`runFluidSimulator - 02 startGUI`, {});\r\n\r\n    const gui = options?.disableGui ? null : startGUI({\r\n        config,\r\n        splatStack,\r\n        initFramebuffers,\r\n        updateKeywords,\r\n        captureScreenshot: () => captureScreenshot(render, { resolution: config.CAPTURE_RESOLUTION }),\r\n    });\r\n\r\n    console.log(`runFluidSimulator - 03 ditheringTexture`, { url: `${contentPath}/LDR_LLL1_0.png` });\r\n    const ditheringTexture = createTextureAsync(`${contentPath}/LDR_LLL1_0.png`);\r\n\r\n    console.log(`runFluidSimulator - 04 createShaders`, {});\r\n    const shaders = createShaders(shaderFactory);\r\n    const blurProgram = new ShaderProgram(shaderFactory, shaders.blurVertexShader, shaders.blurShader);\r\n    const copyProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.copyShader);\r\n    const clearProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.clearShader);\r\n    const colorProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.colorShader);\r\n    const checkerboardProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.checkerboardShader);\r\n    const bloomPrefilterProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.bloomPrefilterShader);\r\n    const bloomBlurProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.bloomBlurShader);\r\n    const bloomFinalProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.bloomFinalShader);\r\n    const sunraysMaskProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.sunraysMaskShader);\r\n    const sunraysProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.sunraysShader);\r\n    const splatProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.splatShader);\r\n    const advectionProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.advectionShader);\r\n    const divergenceProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.divergenceShader);\r\n    const curlProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.curlShader);\r\n    const vorticityProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.vorticityShader);\r\n    const pressureProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.pressureShader);\r\n    const gradientSubtractProgram = new ShaderProgram(shaderFactory, shaders.baseVertexShader, shaders.gradientSubtractShader);\r\n    const displayMaterial = new ShaderMaterial(shaderFactory, shaders.baseVertexShader, shaders.displayShaderSource);\r\n\r\n    const {\r\n        blit,\r\n    } = createFrameBufferUtils(webGlSystem);\r\n\r\n    let dye: DoubleFrameBufferObject;\r\n    let velocity: DoubleFrameBufferObject;\r\n    let divergence: FrameBufferObject;\r\n    let curl: FrameBufferObject;\r\n    let pressure: DoubleFrameBufferObject;\r\n    let bloom: FrameBufferObject;\r\n    const bloomFramebuffers = [] as FrameBufferObject[];\r\n    let sunrays: FrameBufferObject;\r\n    let sunraysTemp: FrameBufferObject;\r\n\r\n    function resizeFBO(target: FrameBufferObject, w: number, h: number, internalFormat: number, format: number, type: number, param: number) {\r\n        const newFBO = createFrameBufferObject(w, h, internalFormat, format, type, param);\r\n        copyProgram.bind();\r\n        gl.uniform1i(copyProgram.uniforms.uTexture, target.attach(0));\r\n        blit(newFBO);\r\n        return newFBO;\r\n    }\r\n\r\n    function resizeDoubleFBO(target: DoubleFrameBufferObject, w: number, h: number, internalFormat: number, format: number, type: number, param: number) {\r\n        if (target.width === w && target.height === h)\r\n            return target;\r\n        target.read = resizeFBO(target.read, w, h, internalFormat, format, type, param);\r\n        target.write = createFrameBufferObject(w, h, internalFormat, format, type, param);\r\n        target.width = w;\r\n        target.height = h;\r\n        target.texelSizeX = 1 / w;\r\n        target.texelSizeY = 1 / h;\r\n        return target;\r\n    }\r\n\r\n    function initFramebuffers() {\r\n        const simRes = getResolution(config.SIM_RESOLUTION);\r\n        const dyeRes = getResolution(config.DYE_RESOLUTION);\r\n\r\n        const texType = ext.halfFloatTexType;\r\n        const rgba = ext.formatRGBA;\r\n        const rg = ext.formatRG;\r\n        const r = ext.formatR;\r\n        const filtering = ext.supportLinearFiltering ? gl.LINEAR : gl.NEAREST;\r\n\r\n        gl.disable(gl.BLEND);\r\n\r\n        if (dye == null)\r\n            dye = createDoubleFrameBufferObject(dyeRes.width, dyeRes.height, rgba.internalFormat, rgba.format, texType, filtering);\r\n        else\r\n            dye = resizeDoubleFBO(dye, dyeRes.width, dyeRes.height, rgba.internalFormat, rgba.format, texType, filtering);\r\n\r\n        if (velocity == null)\r\n            velocity = createDoubleFrameBufferObject(simRes.width, simRes.height, rg.internalFormat, rg.format, texType, filtering);\r\n        else\r\n            velocity = resizeDoubleFBO(velocity, simRes.width, simRes.height, rg.internalFormat, rg.format, texType, filtering);\r\n\r\n        divergence = createFrameBufferObject(simRes.width, simRes.height, r.internalFormat, r.format, texType, gl.NEAREST);\r\n        curl = createFrameBufferObject(simRes.width, simRes.height, r.internalFormat, r.format, texType, gl.NEAREST);\r\n        pressure = createDoubleFrameBufferObject(simRes.width, simRes.height, r.internalFormat, r.format, texType, gl.NEAREST);\r\n\r\n        initBloomFramebuffers();\r\n        initSunraysFramebuffers();\r\n    }\r\n\r\n    function initBloomFramebuffers() {\r\n        const res = getResolution(config.BLOOM_RESOLUTION);\r\n\r\n        const texType = ext.halfFloatTexType;\r\n        const rgba = ext.formatRGBA;\r\n        const filtering = ext.supportLinearFiltering ? gl.LINEAR : gl.NEAREST;\r\n\r\n        bloom = createFrameBufferObject(res.width, res.height, rgba.internalFormat, rgba.format, texType, filtering);\r\n\r\n        bloomFramebuffers.length = 0;\r\n        for (let i = 0; i < config.BLOOM_ITERATIONS; i++) {\r\n            const width = res.width >> (i + 1);\r\n            const height = res.height >> (i + 1);\r\n\r\n            if (width < 2 || height < 2) break;\r\n\r\n            const fbo = createFrameBufferObject(width, height, rgba.internalFormat, rgba.format, texType, filtering);\r\n            bloomFramebuffers.push(fbo);\r\n        }\r\n    }\r\n\r\n    function initSunraysFramebuffers() {\r\n        const res = getResolution(config.SUNRAYS_RESOLUTION);\r\n\r\n        const texType = ext.halfFloatTexType;\r\n        const r = ext.formatR;\r\n        const filtering = ext.supportLinearFiltering ? gl.LINEAR : gl.NEAREST;\r\n\r\n        sunrays = createFrameBufferObject(res.width, res.height, r.internalFormat, r.format, texType, filtering);\r\n        sunraysTemp = createFrameBufferObject(res.width, res.height, r.internalFormat, r.format, texType, filtering);\r\n    }\r\n\r\n\r\n    function createTextureAsync(url: string) {\r\n        const texture = gl.createTexture();\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.REPEAT);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.REPEAT);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, 1, 1, 0, gl.RGB, gl.UNSIGNED_BYTE, new Uint8Array([255, 255, 255]));\r\n\r\n        const obj = {\r\n            texture,\r\n            width: 1,\r\n            height: 1,\r\n            attach(id: number) {\r\n                gl.activeTexture(gl.TEXTURE0 + id);\r\n                gl.bindTexture(gl.TEXTURE_2D, texture);\r\n                return id;\r\n            },\r\n        };\r\n\r\n        const image = new Image();\r\n        image.addEventListener(`load`, () => {\r\n            obj.width = image.width;\r\n            obj.height = image.height;\r\n            gl.bindTexture(gl.TEXTURE_2D, texture);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGB, gl.RGB, gl.UNSIGNED_BYTE, image);\r\n        });\r\n        image.src = url;\r\n\r\n        return obj;\r\n    }\r\n\r\n    function updateKeywords() {\r\n        const displayKeywords = [];\r\n        if (config.SHADING) displayKeywords.push(`SHADING`);\r\n        if (config.BLOOM) displayKeywords.push(`BLOOM`);\r\n        if (config.SUNRAYS) displayKeywords.push(`SUNRAYS`);\r\n        displayMaterial.setKeywords(displayKeywords);\r\n    }\r\n\r\n    console.log(`runFluidSimulator - 05 updateKeywords`, {});\r\n    updateKeywords();\r\n\r\n    console.log(`runFluidSimulator - 06 initFramebuffers`, {});\r\n    initFramebuffers();\r\n\r\n    console.log(`runFluidSimulator - 07 multipleSplats`, {});\r\n    if (!options?.disableStartupSplats) {\r\n        multipleSplats(randomIntRange(5, 25));\r\n    }\r\n\r\n    function update() {\r\n        // console.log(`runFluidSimulator.update START`, {});\r\n        if (timeProvider.isPaused()) {\r\n            console.log(`runFluidSimulator.update timeProvider.PAUSED`, {});\r\n            requestAnimationFrame(update);\r\n            return;\r\n        }\r\n\r\n        const dt = calcDeltaTime();\r\n\r\n        if (resizeCanvas()) {\r\n            initFramebuffers();\r\n            updateKeywords();\r\n        }\r\n        updateColors(dt);\r\n        applyInputs();\r\n        if (!config.PAUSED)\r\n            step(dt);\r\n        render(null);\r\n        requestAnimationFrame(update);\r\n    }\r\n\r\n    let lastUpdateTime = timeProvider.now();\r\n    function calcDeltaTime() {\r\n        const now = timeProvider.now();\r\n        const dtActual = (now - lastUpdateTime) / 1000;\r\n        const dt = Math.min(dtActual, 0.016666);\r\n        lastUpdateTime = now;\r\n        return dt;\r\n    }\r\n\r\n    function resizeCanvas() {\r\n        const width = scaleByPixelRatio(canvas.clientWidth);\r\n        const height = scaleByPixelRatio(canvas.clientHeight);\r\n        if (canvas.width !== width || canvas.height !== height) {\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    let colorUpdateTimer = 0;\r\n    function updateColors(dt: number) {\r\n        if (!config.COLORFUL) return;\r\n\r\n        colorUpdateTimer += dt * config.COLOR_UPDATE_SPEED;\r\n        if (colorUpdateTimer >= 1) {\r\n            colorUpdateTimer = wrap(colorUpdateTimer, 0, 1);\r\n            pointers.forEach(p => {\r\n                p.color = generateColor();\r\n            });\r\n        }\r\n    }\r\n\r\n    function applyInputs() {\r\n\r\n        const lastSplat = splatStack.pop();\r\n        if (lastSplat != null) {\r\n            console.log(`applyInputs: lastSplat`, { lastSplat, splatStack, pointers });\r\n\r\n            multipleSplats(lastSplat);\r\n        }\r\n\r\n        pointers.forEach(p => {\r\n            if (p.moved) {\r\n                p.moved = false;\r\n                splatPointer(p);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    function step(dt: number) {\r\n        gl.disable(gl.BLEND);\r\n\r\n        // Calculate curl strength (based on cross-velocity gradient)\r\n        curlProgram.bind();\r\n        gl.uniform2f(curlProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);\r\n        gl.uniform1i(curlProgram.uniforms.uVelocity, velocity.read.attach(0));\r\n        blit(curl);\r\n\r\n        // Apply a vortex acceleration to velocity (based on curl strength)\r\n        vorticityProgram.bind();\r\n        gl.uniform2f(vorticityProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);\r\n        gl.uniform1i(vorticityProgram.uniforms.uVelocity, velocity.read.attach(0));\r\n        gl.uniform1i(vorticityProgram.uniforms.uCurl, curl.attach(1));\r\n        gl.uniform1f(vorticityProgram.uniforms.curl, config.CURL);\r\n        gl.uniform1f(vorticityProgram.uniforms.dt, dt);\r\n        blit(velocity.write);\r\n        velocity.swap();\r\n\r\n        // Calculate divergence strength (based on parallel-velocity gradient)\r\n        divergenceProgram.bind();\r\n        gl.uniform2f(divergenceProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);\r\n        gl.uniform1i(divergenceProgram.uniforms.uVelocity, velocity.read.attach(0));\r\n        blit(divergence);\r\n\r\n        // Dilute last pressure\r\n        clearProgram.bind();\r\n        gl.uniform1i(clearProgram.uniforms.uTexture, pressure.read.attach(0));\r\n        gl.uniform1f(clearProgram.uniforms.value, config.PRESSURE);\r\n        blit(pressure.write);\r\n        pressure.swap();\r\n\r\n        // Distribute pressure over N iterations based on divergence\r\n        pressureProgram.bind();\r\n        gl.uniform2f(pressureProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);\r\n        gl.uniform1i(pressureProgram.uniforms.uDivergence, divergence.attach(0));\r\n        for (let i = 0; i < config.PRESSURE_ITERATIONS; i++) {\r\n            gl.uniform1i(pressureProgram.uniforms.uPressure, pressure.read.attach(1));\r\n            blit(pressure.write);\r\n            pressure.swap();\r\n        }\r\n\r\n        // Apply pressure gradient as a force to velocity\r\n        gradientSubtractProgram.bind();\r\n        gl.uniform2f(gradientSubtractProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);\r\n        gl.uniform1i(gradientSubtractProgram.uniforms.uPressure, pressure.read.attach(0));\r\n        gl.uniform1i(gradientSubtractProgram.uniforms.uVelocity, velocity.read.attach(1));\r\n        blit(velocity.write);\r\n        velocity.swap();\r\n\r\n        // Move the velocity position (based on the velocity)\r\n        advectionProgram.bind();\r\n        gl.uniform2f(advectionProgram.uniforms.texelSize, velocity.texelSizeX, velocity.texelSizeY);\r\n        if (!ext.supportLinearFiltering)\r\n            gl.uniform2f(advectionProgram.uniforms.dyeTexelSize, velocity.texelSizeX, velocity.texelSizeY);\r\n        const velocityId = velocity.read.attach(0);\r\n        gl.uniform1i(advectionProgram.uniforms.uVelocity, velocityId);\r\n        gl.uniform1i(advectionProgram.uniforms.uSource, velocityId);\r\n        gl.uniform1f(advectionProgram.uniforms.dt, dt);\r\n        gl.uniform1f(advectionProgram.uniforms.dissipation, config.VELOCITY_DISSIPATION);\r\n        gl.uniform2f(advectionProgram.uniforms.motion, config.MOTION_X, config.MOTION_Y);\r\n        blit(velocity.write);\r\n        velocity.swap();\r\n\r\n        // Move the dye position (based on the velocity)\r\n        if (!ext.supportLinearFiltering)\r\n            gl.uniform2f(advectionProgram.uniforms.dyeTexelSize, dye.texelSizeX, dye.texelSizeY);\r\n        gl.uniform1i(advectionProgram.uniforms.uVelocity, velocity.read.attach(0));\r\n        gl.uniform1i(advectionProgram.uniforms.uSource, dye.read.attach(1));\r\n        gl.uniform1f(advectionProgram.uniforms.dissipation, config.DENSITY_DISSIPATION);\r\n        gl.uniform2f(advectionProgram.uniforms.motion, config.MOTION_X, config.MOTION_Y);\r\n        blit(dye.write);\r\n        dye.swap();\r\n    }\r\n\r\n    function render(target: null | FrameBufferObject) {\r\n        if (config.BLOOM)\r\n            applyBloom(dye.read, bloom);\r\n        if (config.SUNRAYS) {\r\n            applySunrays(dye.read, dye.write, sunrays);\r\n            blur(sunrays, sunraysTemp, 1);\r\n        }\r\n\r\n        if (target == null || !config.TRANSPARENT) {\r\n            gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\r\n            gl.enable(gl.BLEND);\r\n        }\r\n        else {\r\n            gl.disable(gl.BLEND);\r\n        }\r\n\r\n        if (!config.TRANSPARENT)\r\n            drawColor(target, normalizeColor(config.BACK_COLOR));\r\n        if (target == null && config.TRANSPARENT)\r\n            drawCheckerboard(target);\r\n        drawDisplay(target);\r\n    }\r\n\r\n    function drawColor(target: null | FrameBufferObject, color: ColorRgb) {\r\n        colorProgram.bind();\r\n        gl.uniform4f(colorProgram.uniforms.color, color.r, color.g, color.b, 1);\r\n        blit(target);\r\n    }\r\n\r\n    function drawCheckerboard(target: null | FrameBufferObject) {\r\n        checkerboardProgram.bind();\r\n        gl.uniform1f(checkerboardProgram.uniforms.aspectRatio, canvas.width / canvas.height);\r\n        blit(target);\r\n    }\r\n\r\n    const TESTING = false;\r\n    let testCount = 0;\r\n    const getTestMaterials = () => [\r\n        dye.read,\r\n        velocity.read,\r\n        // divergence,\r\n        // curl,\r\n        // pressure.read,\r\n        // bloom,\r\n        // ditheringTexture,\r\n        // sunrays,\r\n        // sunraysTemp,\r\n    ];\r\n    function drawDisplay(target: null | FrameBufferObject) {\r\n        // console.log(`drawDisplay`, { target });\r\n\r\n        const width = target == null ? gl.drawingBufferWidth : target.width;\r\n        const height = target == null ? gl.drawingBufferHeight : target.height;\r\n\r\n        if (TESTING) {\r\n            displayMaterial.bind();\r\n            const tMats = getTestMaterials();\r\n            const tMat = tMats[Math.floor(testCount / 100) % tMats.length];\r\n            gl.uniform1i(displayMaterial.uniforms.uTexture, tMat.attach(0));\r\n            blit(target);\r\n            testCount++;\r\n            return;\r\n        }\r\n\r\n        displayMaterial.bind();\r\n        if (config.SHADING)\r\n            gl.uniform2f(displayMaterial.uniforms.texelSize, 1 / width, 1 / height);\r\n        gl.uniform1i(displayMaterial.uniforms.uTexture, dye.read.attach(0));\r\n        if (config.BLOOM) {\r\n            gl.uniform1i(displayMaterial.uniforms.uBloom, bloom.attach(1));\r\n            gl.uniform1i(displayMaterial.uniforms.uDithering, ditheringTexture.attach(2));\r\n            const scale = getTextureScale(ditheringTexture, width, height);\r\n            gl.uniform2f(displayMaterial.uniforms.ditherScale, scale.x, scale.y);\r\n        }\r\n        if (config.SUNRAYS)\r\n            gl.uniform1i(displayMaterial.uniforms.uSunrays, sunrays.attach(3));\r\n        blit(target);\r\n    }\r\n\r\n    function applyBloom(source: FrameBufferObject, destination: FrameBufferObject) {\r\n        if (bloomFramebuffers.length < 2)\r\n            return;\r\n\r\n        let last = destination;\r\n\r\n        gl.disable(gl.BLEND);\r\n        bloomPrefilterProgram.bind();\r\n        const knee = config.BLOOM_THRESHOLD * config.BLOOM_SOFT_KNEE + 0.0001;\r\n        const curve0 = config.BLOOM_THRESHOLD - knee;\r\n        const curve1 = knee * 2;\r\n        const curve2 = 0.25 / knee;\r\n        gl.uniform3f(bloomPrefilterProgram.uniforms.curve, curve0, curve1, curve2);\r\n        gl.uniform1f(bloomPrefilterProgram.uniforms.threshold, config.BLOOM_THRESHOLD);\r\n        gl.uniform1i(bloomPrefilterProgram.uniforms.uTexture, source.attach(0));\r\n        blit(last);\r\n\r\n        bloomBlurProgram.bind();\r\n        for (const dest of bloomFramebuffers) {\r\n            gl.uniform2f(bloomBlurProgram.uniforms.texelSize, last.texelSizeX, last.texelSizeY);\r\n            gl.uniform1i(bloomBlurProgram.uniforms.uTexture, last.attach(0));\r\n            blit(dest);\r\n            last = dest;\r\n        }\r\n\r\n        gl.blendFunc(gl.ONE, gl.ONE);\r\n        gl.enable(gl.BLEND);\r\n\r\n        for (let i = bloomFramebuffers.length - 2; i >= 0; i--) {\r\n            const baseTex = bloomFramebuffers[i];\r\n            gl.uniform2f(bloomBlurProgram.uniforms.texelSize, last.texelSizeX, last.texelSizeY);\r\n            gl.uniform1i(bloomBlurProgram.uniforms.uTexture, last.attach(0));\r\n            gl.viewport(0, 0, baseTex.width, baseTex.height);\r\n            blit(baseTex);\r\n            last = baseTex;\r\n        }\r\n\r\n        gl.disable(gl.BLEND);\r\n        bloomFinalProgram.bind();\r\n        gl.uniform2f(bloomFinalProgram.uniforms.texelSize, last.texelSizeX, last.texelSizeY);\r\n        gl.uniform1i(bloomFinalProgram.uniforms.uTexture, last.attach(0));\r\n        gl.uniform1f(bloomFinalProgram.uniforms.intensity, config.BLOOM_INTENSITY);\r\n        blit(destination);\r\n    }\r\n\r\n    function applySunrays(source: FrameBufferObject, mask: FrameBufferObject, destination: FrameBufferObject) {\r\n        gl.disable(gl.BLEND);\r\n        sunraysMaskProgram.bind();\r\n        gl.uniform1i(sunraysMaskProgram.uniforms.uTexture, source.attach(0));\r\n        blit(mask);\r\n\r\n        sunraysProgram.bind();\r\n        gl.uniform1f(sunraysProgram.uniforms.weight, config.SUNRAYS_WEIGHT);\r\n        gl.uniform1i(sunraysProgram.uniforms.uTexture, mask.attach(0));\r\n        blit(destination);\r\n    }\r\n\r\n    function blur(target: FrameBufferObject, temp: FrameBufferObject, iterations: number) {\r\n        blurProgram.bind();\r\n        for (let i = 0; i < iterations; i++) {\r\n            gl.uniform2f(blurProgram.uniforms.texelSize, target.texelSizeX, 0);\r\n            gl.uniform1i(blurProgram.uniforms.uTexture, target.attach(0));\r\n            blit(temp);\r\n\r\n            gl.uniform2f(blurProgram.uniforms.texelSize, 0, target.texelSizeY);\r\n            gl.uniform1i(blurProgram.uniforms.uTexture, temp.attach(0));\r\n            blit(target);\r\n        }\r\n    }\r\n\r\n    function splatPointer(pointer: PointerEntity) {\r\n        const dx = pointer.deltaX * config.SPLAT_FORCE;\r\n        const dy = pointer.deltaY * config.SPLAT_FORCE;\r\n        // const dy = -10;\r\n        splat(pointer.texcoordX, pointer.texcoordY, dx, dy, pointer.color, pointer.size);\r\n    }\r\n\r\n    function multipleSplats(amount: number) {\r\n        for (let i = 0; i < amount; i++) {\r\n            const color = generateColor();\r\n            color.r *= 10;\r\n            color.g *= 10;\r\n            color.b *= 10;\r\n            const x = Math.random();\r\n            const y = Math.random();\r\n            const dx = 1000 * (Math.random() - 0.5);\r\n            const dy = 1000 * (Math.random() - 0.5);\r\n            splat(x, y, dx, dy, color);\r\n        }\r\n    }\r\n\r\n    function splat(x: number, y: number, dx: number, dy: number, color: ColorRgb, size?: { x: number, y: number }) {\r\n        // console.log(`splat`, { x, y, dx, dy, color });\r\n\r\n        splatProgram.bind();\r\n        gl.uniform1i(splatProgram.uniforms.uTarget, velocity.read.attach(0));\r\n        gl.uniform1f(splatProgram.uniforms.aspectRatio, canvas.width / canvas.height);\r\n        gl.uniform2f(splatProgram.uniforms.point, x, y);\r\n        gl.uniform3f(splatProgram.uniforms.color, dx, dy, 0);\r\n        gl.uniform1f(splatProgram.uniforms.radius, correctRadius((size?.x ?? (config.SPLAT_RADIUS * 2)) * 0.5 / 100));\r\n        blit(velocity.write);\r\n        velocity.swap();\r\n\r\n        gl.uniform1i(splatProgram.uniforms.uTarget, dye.read.attach(0));\r\n        gl.uniform3f(splatProgram.uniforms.color, color.r, color.g, color.b);\r\n        blit(dye.write);\r\n        dye.swap();\r\n    }\r\n\r\n    function correctRadius(radius: number) {\r\n        const aspectRatio = canvas.width / canvas.height;\r\n        if (aspectRatio > 1)\r\n            radius *= aspectRatio;\r\n        return radius;\r\n    }\r\n\r\n    console.log(`runFluidSimulator - 08 addEventListeners`, {});\r\n\r\n    const windowSubs = [] as { name: string, handler: () => void }[];\r\n    const windowAddEventListener = ((name: string, handler: () => void) => {\r\n        if (options?.disableInput) { return; }\r\n\r\n        window.addEventListener(name, handler);\r\n        windowSubs.push({ name, handler });\r\n    }) as typeof window.addEventListener;\r\n    const windowEventListenersDestroy = () => {\r\n        windowSubs.forEach(({ name, handler }) => {\r\n            window.removeEventListener(name, handler);\r\n        });\r\n    };\r\n\r\n    const canvasSubs = [] as { name: string, handler: () => void }[];\r\n    const canvasAddEventListener = ((name: string, handler: () => void) => {\r\n        if (options?.disableInput) { return; }\r\n\r\n        canvas.addEventListener(name, handler);\r\n        canvasSubs.push({ name, handler });\r\n    }) as typeof canvas.addEventListener;\r\n    const canvasEventListenersDestroy = () => {\r\n        canvasSubs.forEach(({ name, handler }) => {\r\n            canvas.removeEventListener(name, handler);\r\n        });\r\n    };\r\n\r\n    canvasAddEventListener(`mousedown`, e => {\r\n        const posX = scaleByPixelRatio(e.offsetX);\r\n        const posY = scaleByPixelRatio(e.offsetY);\r\n        let pointer = pointers.find(p => p.id === -1);\r\n        if (pointer == null)\r\n            pointer = new PointerEntity();\r\n        updatePointerDownData(pointer, -1, posX, posY);\r\n    });\r\n\r\n    canvasAddEventListener(`mousemove`, e => {\r\n        const pointer = pointers[0];\r\n        if (!pointer.down) return;\r\n        const posX = scaleByPixelRatio(e.offsetX);\r\n        const posY = scaleByPixelRatio(e.offsetY);\r\n        updatePointerMoveData(pointer, posX, posY);\r\n    });\r\n\r\n    windowAddEventListener(`mouseup`, () => {\r\n        updatePointerUpData(pointers[0]);\r\n    });\r\n\r\n    canvasAddEventListener(`touchstart`, e => {\r\n        e.preventDefault();\r\n        const touches = e.targetTouches as unknown as Touch[];\r\n        while (touches.length >= pointers.length)\r\n            pointers.push(new PointerEntity());\r\n        for (const [i, touch] of touches.entries()) {\r\n            const posX = scaleByPixelRatio(touch.pageX);\r\n            const posY = scaleByPixelRatio(touch.pageY);\r\n            updatePointerDownData(pointers[i + 1], touch.identifier, posX, posY);\r\n        }\r\n    });\r\n\r\n    canvasAddEventListener(`touchmove`, e => {\r\n        e.preventDefault();\r\n        const touches = e.targetTouches as unknown as Touch[];\r\n        for (const [i, touch] of touches.entries()) {\r\n            const pointer = pointers[i + 1];\r\n            if (!pointer.down) continue;\r\n            const posX = scaleByPixelRatio(touch.pageX);\r\n            const posY = scaleByPixelRatio(touch.pageY);\r\n            updatePointerMoveData(pointer, posX, posY);\r\n        }\r\n    }, false);\r\n\r\n    windowAddEventListener(`touchend`, e => {\r\n        const touches = e.changedTouches as unknown as Touch[];\r\n        for (const touch of touches) {\r\n            const pointer = pointers.find(p => p.id === touch.identifier);\r\n            if (pointer == null) continue;\r\n            updatePointerUpData(pointer);\r\n        }\r\n    });\r\n\r\n    windowAddEventListener(`keydown`, e => {\r\n        if (e.code === `KeyP`)\r\n            config.PAUSED = !config.PAUSED;\r\n        if (e.key === ` `)\r\n            splatStack.push(randomIntRange(5, 25));\r\n    });\r\n\r\n    function updatePointerDownData(pointer: PointerEntity, id: number, posX: number, posY: number) {\r\n        pointer.id = id;\r\n        pointer.down = true;\r\n        pointer.moved = false;\r\n        pointer.texcoordX = posX / canvas.width;\r\n        pointer.texcoordY = 1 - posY / canvas.height;\r\n        pointer.prevTexcoordX = pointer.texcoordX;\r\n        pointer.prevTexcoordY = pointer.texcoordY;\r\n        pointer.deltaX = 0;\r\n        pointer.deltaY = 0;\r\n        pointer.color = generateColor();\r\n\r\n        // console.log(`updatePointerDownData`, { pointer });\r\n    }\r\n\r\n    function updatePointerMoveData(pointer: PointerEntity, posX: number, posY: number) {\r\n        pointer.prevTexcoordX = pointer.texcoordX;\r\n        pointer.prevTexcoordY = pointer.texcoordY;\r\n        pointer.texcoordX = posX / canvas.width;\r\n        pointer.texcoordY = 1 - posY / canvas.height;\r\n        pointer.deltaX = correctDeltaX(pointer.texcoordX - pointer.prevTexcoordX, canvas);\r\n        pointer.deltaY = correctDeltaY(pointer.texcoordY - pointer.prevTexcoordY, canvas);\r\n        pointer.moved = Math.abs(pointer.deltaX) > 0 || Math.abs(pointer.deltaY) > 0;\r\n    }\r\n\r\n    function updatePointerUpData(pointer: PointerEntity) {\r\n        pointer.down = false;\r\n    }\r\n\r\n    console.log(`runFluidSimulator - 09 update Start Loop`, {});\r\n    update();\r\n\r\n    console.log(`runFluidSimulator - 10 DONE`, {});\r\n\r\n    const pointerMap = new Map<number, PointerEntity>();\r\n    return {\r\n        canvas,\r\n        getSize: () => ({\r\n            width: canvas.width,\r\n            height: canvas.height,\r\n        }),\r\n        config,\r\n        updateConfig: () => {\r\n            updateKeywords();\r\n        },\r\n        splat: (id: number, active: boolean, x: number, y: number, dx: number, dy: number, size?: { x: number, y: number }, color?: ColorRgb) => {\r\n            let p = pointerMap.get(id);\r\n            if (!p) {\r\n                p = new PointerEntity();\r\n                pointerMap.set(id, p);\r\n                pointers.push(p);\r\n                p.id = id;\r\n                // console.log(`splat - new`, { id, active, x, y });\r\n            }\r\n            // console.log(`splat`, { id, color, active, x, y });\r\n\r\n\r\n            p.down = active;\r\n            p.moved = active;\r\n            p.texcoordX = x;\r\n            p.texcoordY = y;\r\n            p.prevTexcoordX = x - dx;\r\n            p.prevTexcoordY = y - dy;\r\n            p.deltaX = correctDeltaX(p.texcoordX - p.prevTexcoordX, canvas);\r\n            p.deltaY = correctDeltaY(p.texcoordY - p.prevTexcoordY, canvas);\r\n            p.color = color ?? generateColor();\r\n            p.size = size;\r\n        },\r\n        close: () => {\r\n            gui?.gui?.destroy();\r\n            windowEventListenersDestroy();\r\n            canvasEventListenersDestroy();\r\n\r\n            gl.canvas.width = 1;\r\n            gl.canvas.height = 1;\r\n            canvas.remove();\r\n        },\r\n    };\r\n};\r\n","import { WebGlSystem } from './webgl';\r\n\r\nexport const createFrameBufferFactory = ({ gl }: WebGlSystem) => {\r\n\r\n    function createFrameBufferObject(w: number, h: number, internalFormat: number, format: number, type: number, param: number) {\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        const texture = gl.createTexture();\r\n        if (!texture) { throw new Error(`texture not created`); }\r\n\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, param);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, param);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, internalFormat, w, h, 0, format, type, null);\r\n\r\n        const frameBuffer = gl.createFramebuffer();\r\n        if (!frameBuffer) { throw new Error(`frame buffer not created`); }\r\n\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer);\r\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\r\n        gl.viewport(0, 0, w, h);\r\n        gl.clear(gl.COLOR_BUFFER_BIT);\r\n\r\n        const texelSizeX = 1 / w;\r\n        const texelSizeY = 1 / h;\r\n\r\n        return {\r\n            texture,\r\n            frameBuffer,\r\n            width: w,\r\n            height: h,\r\n            texelSizeX,\r\n            texelSizeY,\r\n            attach(id: number) {\r\n                gl.activeTexture(gl.TEXTURE0 + id);\r\n                gl.bindTexture(gl.TEXTURE_2D, texture);\r\n                return id;\r\n            },\r\n        };\r\n    }\r\n\r\n    function createDoubleFrameBufferObject(w: number, h: number, internalFormat: number, format: number, type: number, param: number) {\r\n        let fbo1 = createFrameBufferObject(w, h, internalFormat, format, type, param);\r\n        let fbo2 = createFrameBufferObject(w, h, internalFormat, format, type, param);\r\n\r\n        return {\r\n            width: w,\r\n            height: h,\r\n            texelSizeX: fbo1.texelSizeX,\r\n            texelSizeY: fbo1.texelSizeY,\r\n            get read() {\r\n                return fbo1;\r\n            },\r\n            set read(value) {\r\n                fbo1 = value;\r\n            },\r\n            get write() {\r\n                return fbo2;\r\n            },\r\n            set write(value) {\r\n                fbo2 = value;\r\n            },\r\n            swap() {\r\n                const temp = fbo1;\r\n                fbo1 = fbo2;\r\n                fbo2 = temp;\r\n            },\r\n        };\r\n    }\r\n\r\n\r\n    return {\r\n        createFrameBufferObject,\r\n        createDoubleFrameBufferObject,\r\n    };\r\n};\r\n\r\nexport type FrameBufferFactory = ReturnType<typeof createFrameBufferFactory>;\r\nexport type FrameBufferObject = ReturnType<FrameBufferFactory['createFrameBufferObject']>;\r\nexport type DoubleFrameBufferObject = ReturnType<FrameBufferFactory['createDoubleFrameBufferObject']>;\r\n\r\n\r\nexport const createFrameBufferUtils = ({ gl }: WebGlSystem) => {\r\n\r\n    const createBlit = () => {\r\n        // 4 2d-coords: [0](-1,-1) [1](-1,1) [2](1,1) [3](1,-1)\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, gl.createBuffer());\r\n        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([-1, -1, -1, 1, 1, 1, 1, -1]), gl.STATIC_DRAW);\r\n\r\n        // 6 points (2 triangles) => [0,1,2] [0,2,3]\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, gl.createBuffer());\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 0, 2, 3]), gl.STATIC_DRAW);\r\n\r\n        // coords = size 2, floats, no norm, stride, or offset\r\n        gl.vertexAttribPointer(0, 2, gl.FLOAT, false, 0, 0);\r\n        gl.enableVertexAttribArray(0);\r\n\r\n        return (target: null | FrameBufferObject, clear = false) => {\r\n            // console.log(`blit`, { target, clear });\r\n\r\n            if (target == null) {\r\n                gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\r\n                gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n            }\r\n            else {\r\n                gl.viewport(0, 0, target.width, target.height);\r\n                gl.bindFramebuffer(gl.FRAMEBUFFER, target.frameBuffer);\r\n            }\r\n            if (clear) {\r\n                gl.clearColor(0, 0, 0, 1);\r\n                gl.clear(gl.COLOR_BUFFER_BIT);\r\n            }\r\n            // CHECK_FRAMEBUFFER_STATUS();\r\n\r\n            // 2 Triangles (6 points)\r\n            gl.drawElements(gl.TRIANGLES, 6, gl.UNSIGNED_SHORT, 0);\r\n        };\r\n    };\r\n    const blit = createBlit();\r\n\r\n    // function CHECK_FRAMEBUFFER_STATUS() {\r\n    //     const status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\r\n    //     if (status != gl.FRAMEBUFFER_COMPLETE)\r\n    //         console.trace(`Framebuffer error: ${status}`);\r\n    // }\r\n\r\n    return {\r\n        blit,\r\n    };\r\n};\r\n","\r\n// Normal\r\nexport const createConfig = () => ({\r\n    SIM_RESOLUTION: 128,\r\n    DYE_RESOLUTION: 1024,\r\n    CAPTURE_RESOLUTION: 512,\r\n    DENSITY_DISSIPATION: 1,\r\n    VELOCITY_DISSIPATION: 0.2,\r\n    PRESSURE: 0.8,\r\n    PRESSURE_ITERATIONS: 20,\r\n    CURL: 30,\r\n    SPLAT_RADIUS: 0.25,\r\n    SPLAT_FORCE: 6000,\r\n    SHADING: true,\r\n    COLORFUL: true,\r\n    COLOR_UPDATE_SPEED: 10,\r\n    PAUSED: false,\r\n    BACK_COLOR: { r: 0, g: 0, b: 0 },\r\n    TRANSPARENT: false,\r\n    BLOOM: true,\r\n    BLOOM_ITERATIONS: 8,\r\n    BLOOM_RESOLUTION: 256,\r\n    BLOOM_INTENSITY: 0.8,\r\n    BLOOM_THRESHOLD: 0.6,\r\n    BLOOM_SOFT_KNEE: 0.7,\r\n    SUNRAYS: true,\r\n    SUNRAYS_RESOLUTION: 196,\r\n    SUNRAYS_WEIGHT: 1,\r\n\r\n    MOTION_X: 0,\r\n    MOTION_Y: 0,\r\n});\r\n\r\n// Simple\r\n// export const createConfig = () => ({\r\n//     SIM_RESOLUTION: 128,\r\n//     DYE_RESOLUTION: 1024,\r\n//     CAPTURE_RESOLUTION: 512,\r\n//     DENSITY_DISSIPATION: 0.1,\r\n//     VELOCITY_DISSIPATION: 0.1,\r\n//     PRESSURE: 1,\r\n//     PRESSURE_ITERATIONS: 20,\r\n//     CURL: 0,\r\n//     SPLAT_RADIUS: 0.1,\r\n//     SPLAT_FORCE: 6000,\r\n//     SHADING: false,\r\n//     COLORFUL: true,\r\n//     COLOR_UPDATE_SPEED: 10,\r\n//     PAUSED: false,\r\n//     BACK_COLOR: { r: 0, g: 0, b: 0 },\r\n//     TRANSPARENT: false,\r\n//     BLOOM: false,\r\n//     BLOOM_ITERATIONS: 8,\r\n//     BLOOM_RESOLUTION: 256,\r\n//     BLOOM_INTENSITY: 0.8,\r\n//     BLOOM_THRESHOLD: 0.6,\r\n//     BLOOM_SOFT_KNEE: 0.7,\r\n//     SUNRAYS: false,\r\n//     SUNRAYS_RESOLUTION: 196,\r\n//     SUNRAYS_WEIGHT: 1,\r\n// });\r\n\r\nexport type Config = ReturnType<typeof createConfig>;\r\n","import * as dat from 'dat.gui';\r\nimport { Config } from './config';\r\nimport { ga } from './ga';\r\nimport { isMobile, randomIntRange } from './utils';\r\n\r\n// type DatGui = {\r\n//     add: (configObject: unknown, key: string, options?: (number | { [key: string]: number }), options2?: number) => {\r\n//         name: (value: string) => {\r\n//             onFinishChange: (callback: () => void) => void;\r\n//             listen: () => void;\r\n//             step: (count: number) => void;\r\n//             __li: {\r\n//                 className: string;\r\n//                 style: HTMLDivElement['style'];\r\n//             };\r\n//             domElement: HTMLDivElement;\r\n//         };\r\n//     };\r\n//     addFolder: (name: string) => DatGui;\r\n//     addColor: (configObject: unknown, key: string) => {\r\n//         name: (value: string) => void;\r\n//     };\r\n//     close: () => void;\r\n// };\r\n// declare let dat: {\r\n//     GUI: {\r\n//         new(...args: unknown[]): DatGui;\r\n//     };\r\n// };\r\n\r\nexport function startGUI({\r\n    config,\r\n    splatStack,\r\n    initFramebuffers,\r\n    updateKeywords,\r\n    captureScreenshot,\r\n}: {\r\n    config: Config;\r\n    splatStack: number[];\r\n    initFramebuffers: () => void;\r\n    updateKeywords: () => void;\r\n    captureScreenshot: () => void;\r\n}) {\r\n    const gui = new dat.GUI({ width: 300 });\r\n    gui.add(config, `DYE_RESOLUTION`, { 'high': 1024, 'medium': 512, 'low': 256, 'very low': 128 }).name(`quality`).onFinishChange(initFramebuffers);\r\n    gui.add(config, `SIM_RESOLUTION`, { '32': 32, '64': 64, '128': 128, '256': 256 }).name(`sim resolution`).onFinishChange(initFramebuffers);\r\n    gui.add(config, `DENSITY_DISSIPATION`, 0, 4).name(`density diffusion`);\r\n    gui.add(config, `VELOCITY_DISSIPATION`, 0, 4).name(`velocity diffusion`);\r\n    gui.add(config, `PRESSURE`, 0, 1).name(`pressure`);\r\n    gui.add(config, `CURL`, 0, 50).name(`vorticity`).step(1);\r\n    gui.add(config, `SPLAT_RADIUS`, 0.01, 1).name(`splat radius`);\r\n    gui.add(config, `SHADING`).name(`shading`).onFinishChange(updateKeywords);\r\n    gui.add(config, `COLORFUL`).name(`colorful`);\r\n    gui.add(config, `PAUSED`).name(`paused`).listen();\r\n\r\n    gui.add({\r\n        fun: () => {\r\n            splatStack.push(randomIntRange(5, 25));\r\n        },\r\n    }, `fun`).name(`Random splats`);\r\n\r\n    const bloomFolder = gui.addFolder(`Bloom`);\r\n    bloomFolder.add(config, `BLOOM`).name(`enabled`).onFinishChange(updateKeywords);\r\n    bloomFolder.add(config, `BLOOM_INTENSITY`, 0.1, 2).name(`intensity`);\r\n    bloomFolder.add(config, `BLOOM_THRESHOLD`, 0, 1).name(`threshold`);\r\n\r\n    const sunraysFolder = gui.addFolder(`Sunrays`);\r\n    sunraysFolder.add(config, `SUNRAYS`).name(`enabled`).onFinishChange(updateKeywords);\r\n    sunraysFolder.add(config, `SUNRAYS_WEIGHT`, 0.3, 1).name(`weight`);\r\n\r\n    const captureFolder = gui.addFolder(`Capture`);\r\n    captureFolder.addColor(config, `BACK_COLOR`).name(`background color`);\r\n    captureFolder.add(config, `TRANSPARENT`).name(`transparent`);\r\n    captureFolder.add({ fun: captureScreenshot }, `fun`).name(`take screenshot`);\r\n\r\n    const github = gui.add({\r\n        fun: () => {\r\n            window.open(`https://github.com/PavelDoGreat/WebGL-Fluid-Simulation`);\r\n            ga(`send`, `event`, `link button`, `github`);\r\n        },\r\n    }, `fun`).name(`Github - PavelDoGreat`);\r\n    // github.__li.className = `cr function bigFont`;\r\n    // github.__li.style.borderLeft = `3px solid #8C8C8C`;\r\n    const githubIcon = document.createElement(`span`);\r\n    github.domElement.parentElement?.append(githubIcon);\r\n    githubIcon.className = `icon github`;\r\n\r\n    // const twitter = gui.add({\r\n    //     fun: () => {\r\n    //         ga(`send`, `event`, `link button`, `twitter`);\r\n    //         window.open(`https://twitter.com/PavelDoGreat`);\r\n    //     },\r\n    // }, `fun`).name(`Twitter`);\r\n    // twitter.__li.className = `cr function bigFont`;\r\n    // twitter.__li.style.borderLeft = `3px solid #8C8C8C`;\r\n    // const twitterIcon = document.createElement(`span`);\r\n    // twitter.domElement.parentElement?.append(twitterIcon);\r\n    // twitterIcon.className = `icon twitter`;\r\n\r\n    // const discord = gui.add({\r\n    //     fun: () => {\r\n    //         ga(`send`, `event`, `link button`, `discord`);\r\n    //         window.open(`https://discordapp.com/invite/CeqZDDE`);\r\n    //     },\r\n    // }, `fun`).name(`Discord`);\r\n    // discord.__li.className = `cr function bigFont`;\r\n    // discord.__li.style.borderLeft = `3px solid #8C8C8C`;\r\n    // const discordIcon = document.createElement(`span`);\r\n    // discord.domElement.parentElement?.append(discordIcon);\r\n    // discordIcon.className = `icon discord`;\r\n\r\n    // const app = gui.add({\r\n    //     fun: () => {\r\n    //         ga(`send`, `event`, `link button`, `app`);\r\n    //         window.open(`http://onelink.to/5b58bn`);\r\n    //     },\r\n    // }, `fun`).name(`Check out mobile app`);\r\n    // app.__li.className = `cr function appBigFont`;\r\n    // app.__li.style.borderLeft = `3px solid #00FF7F`;\r\n    // const appIcon = document.createElement(`span`);\r\n    // app.domElement.parentElement?.append(appIcon);\r\n    // appIcon.className = `icon app`;\r\n\r\n    // if (isMobile())\r\n    //     gui.close();\r\n    gui.close();\r\n\r\n    return { gui };\r\n}\r\n","import { ShaderFactory } from './systems/shader';\r\n\r\nexport const createShaders = ({ gl, ext, compileShader }: ShaderFactory) => {\r\n    return {\r\n        baseVertexShader: compileShader(gl.VERTEX_SHADER, `\r\n    precision highp float;\r\n\r\n    attribute vec2 aPosition;\r\n    varying vec2 vUv;\r\n    varying vec2 vL;\r\n    varying vec2 vR;\r\n    varying vec2 vT;\r\n    varying vec2 vB;\r\n    uniform vec2 texelSize;\r\n\r\n    void main () {\r\n        vUv = aPosition * 0.5 + 0.5;\r\n        vL = vUv - vec2(texelSize.x, 0.0);\r\n        vR = vUv + vec2(texelSize.x, 0.0);\r\n        vT = vUv + vec2(0.0, texelSize.y);\r\n        vB = vUv - vec2(0.0, texelSize.y);\r\n        gl_Position = vec4(aPosition, 0.0, 1.0);\r\n    }\r\n`),\r\n\r\n        blurVertexShader: compileShader(gl.VERTEX_SHADER, `\r\n    precision highp float;\r\n\r\n    attribute vec2 aPosition;\r\n    varying vec2 vUv;\r\n    varying vec2 vL;\r\n    varying vec2 vR;\r\n    uniform vec2 texelSize;\r\n\r\n    void main () {\r\n        vUv = aPosition * 0.5 + 0.5;\r\n        float offset = 1.33333333;\r\n        vL = vUv - texelSize * offset;\r\n        vR = vUv + texelSize * offset;\r\n        gl_Position = vec4(aPosition, 0.0, 1.0);\r\n    }\r\n`),\r\n\r\n        blurShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    varying vec2 vL;\r\n    varying vec2 vR;\r\n    uniform sampler2D uTexture;\r\n\r\n    void main () {\r\n        vec4 sum = texture2D(uTexture, vUv) * 0.29411764;\r\n        sum += texture2D(uTexture, vL) * 0.35294117;\r\n        sum += texture2D(uTexture, vR) * 0.35294117;\r\n        gl_FragColor = sum;\r\n    }\r\n`),\r\n\r\n        copyShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying highp vec2 vUv;\r\n    uniform sampler2D uTexture;\r\n\r\n    void main () {\r\n        gl_FragColor = texture2D(uTexture, vUv);\r\n    }\r\n`),\r\n\r\n        clearShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying highp vec2 vUv;\r\n    uniform sampler2D uTexture;\r\n    uniform float value;\r\n\r\n    void main () {\r\n        gl_FragColor = value * texture2D(uTexture, vUv);\r\n    }\r\n`),\r\n\r\n        colorShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n\r\n    uniform vec4 color;\r\n\r\n    void main () {\r\n        gl_FragColor = color;\r\n    }\r\n`),\r\n\r\n        checkerboardShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision highp float;\r\n    precision highp sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    uniform sampler2D uTexture;\r\n    uniform float aspectRatio;\r\n\r\n    #define SCALE 25.0\r\n\r\n    void main () {\r\n        vec2 uv = floor(vUv * SCALE * vec2(aspectRatio, 1.0));\r\n        float v = mod(uv.x + uv.y, 2.0);\r\n        v = v * 0.1 + 0.8;\r\n        gl_FragColor = vec4(vec3(v), 1.0);\r\n    }\r\n`),\r\n\r\n        displayShaderSource: `\r\n    precision highp float;\r\n    precision highp sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    varying vec2 vL;\r\n    varying vec2 vR;\r\n    varying vec2 vT;\r\n    varying vec2 vB;\r\n    uniform sampler2D uTexture;\r\n    uniform sampler2D uBloom;\r\n    uniform sampler2D uSunrays;\r\n    uniform sampler2D uDithering;\r\n    uniform vec2 ditherScale;\r\n    uniform vec2 texelSize;\r\n\r\n    vec3 linearToGamma (vec3 color) {\r\n        color = max(color, vec3(0));\r\n        return max(1.055 * pow(color, vec3(0.416666667)) - 0.055, vec3(0));\r\n    }\r\n\r\n    void main () {\r\n        vec3 c = texture2D(uTexture, vUv).rgb;\r\n\r\n    #ifdef SHADING\r\n        vec3 lc = texture2D(uTexture, vL).rgb;\r\n        vec3 rc = texture2D(uTexture, vR).rgb;\r\n        vec3 tc = texture2D(uTexture, vT).rgb;\r\n        vec3 bc = texture2D(uTexture, vB).rgb;\r\n\r\n        float dx = length(rc) - length(lc);\r\n        float dy = length(tc) - length(bc);\r\n\r\n        vec3 n = normalize(vec3(dx, dy, length(texelSize)));\r\n        vec3 l = vec3(0.0, 0.0, 1.0);\r\n\r\n        float diffuse = clamp(dot(n, l) + 0.7, 0.7, 1.0);\r\n        c *= diffuse;\r\n    #endif\r\n\r\n    #ifdef BLOOM\r\n        vec3 bloom = texture2D(uBloom, vUv).rgb;\r\n    #endif\r\n\r\n    #ifdef SUNRAYS\r\n        float sunrays = texture2D(uSunrays, vUv).r;\r\n        c *= sunrays;\r\n    #ifdef BLOOM\r\n        bloom *= sunrays;\r\n    #endif\r\n    #endif\r\n\r\n    #ifdef BLOOM\r\n        float noise = texture2D(uDithering, vUv * ditherScale).r;\r\n        noise = noise * 2.0 - 1.0;\r\n        bloom += noise / 255.0;\r\n        bloom = linearToGamma(bloom);\r\n        c += bloom;\r\n    #endif\r\n\r\n        float a = max(c.r, max(c.g, c.b));\r\n        gl_FragColor = vec4(c, a);\r\n    }\r\n`,\r\n\r\n        bloomPrefilterShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    uniform sampler2D uTexture;\r\n    uniform vec3 curve;\r\n    uniform float threshold;\r\n\r\n    void main () {\r\n        vec3 c = texture2D(uTexture, vUv).rgb;\r\n        float br = max(c.r, max(c.g, c.b));\r\n        float rq = clamp(br - curve.x, 0.0, curve.y);\r\n        rq = curve.z * rq * rq;\r\n        c *= max(rq, br - threshold) / max(br, 0.0001);\r\n        gl_FragColor = vec4(c, 0.0);\r\n    }\r\n`),\r\n\r\n        bloomBlurShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying vec2 vL;\r\n    varying vec2 vR;\r\n    varying vec2 vT;\r\n    varying vec2 vB;\r\n    uniform sampler2D uTexture;\r\n\r\n    void main () {\r\n        vec4 sum = vec4(0.0);\r\n        sum += texture2D(uTexture, vL);\r\n        sum += texture2D(uTexture, vR);\r\n        sum += texture2D(uTexture, vT);\r\n        sum += texture2D(uTexture, vB);\r\n        sum *= 0.25;\r\n        gl_FragColor = sum;\r\n    }\r\n`),\r\n\r\n        bloomFinalShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying vec2 vL;\r\n    varying vec2 vR;\r\n    varying vec2 vT;\r\n    varying vec2 vB;\r\n    uniform sampler2D uTexture;\r\n    uniform float intensity;\r\n\r\n    void main () {\r\n        vec4 sum = vec4(0.0);\r\n        sum += texture2D(uTexture, vL);\r\n        sum += texture2D(uTexture, vR);\r\n        sum += texture2D(uTexture, vT);\r\n        sum += texture2D(uTexture, vB);\r\n        sum *= 0.25;\r\n        gl_FragColor = sum * intensity;\r\n    }\r\n`),\r\n\r\n        sunraysMaskShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision highp float;\r\n    precision highp sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    uniform sampler2D uTexture;\r\n\r\n    void main () {\r\n        vec4 c = texture2D(uTexture, vUv);\r\n        float br = max(c.r, max(c.g, c.b));\r\n        c.a = 1.0 - min(max(br * 20.0, 0.0), 0.8);\r\n        gl_FragColor = c;\r\n    }\r\n`),\r\n\r\n        sunraysShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision highp float;\r\n    precision highp sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    uniform sampler2D uTexture;\r\n    uniform float weight;\r\n\r\n    #define ITERATIONS 16\r\n\r\n    void main () {\r\n        float Density = 0.3;\r\n        float Decay = 0.95;\r\n        float Exposure = 0.7;\r\n\r\n        vec2 coord = vUv;\r\n        vec2 dir = vUv - 0.5;\r\n\r\n        dir *= 1.0 / float(ITERATIONS) * Density;\r\n        float illuminationDecay = 1.0;\r\n\r\n        float color = texture2D(uTexture, vUv).a;\r\n\r\n        for (int i = 0; i < ITERATIONS; i++)\r\n        {\r\n            coord -= dir;\r\n            float col = texture2D(uTexture, coord).a;\r\n            color += col * illuminationDecay * weight;\r\n            illuminationDecay *= Decay;\r\n        }\r\n\r\n        gl_FragColor = vec4(color * Exposure, 0.0, 0.0, 1.0);\r\n    }\r\n`),\r\n\r\n        splatShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision highp float;\r\n    precision highp sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    uniform sampler2D uTarget;\r\n    uniform float aspectRatio;\r\n    uniform vec3 color;\r\n    uniform vec2 point;\r\n    uniform float radius;\r\n\r\n    void main () {\r\n        vec2 p = vUv - point.xy;\r\n        p.x *= aspectRatio;\r\n        vec3 splat = exp(-dot(p, p) / radius) * color;\r\n        vec3 base = texture2D(uTarget, vUv).xyz;\r\n        gl_FragColor = vec4(base + splat, 1.0);\r\n    }\r\n`),\r\n\r\n        // Based on the center velocity, grab the value that would move to this position (as if the velocity is sucking that value into this position) \r\n        // Also to linear interpolation of that value between the points\r\n        advectionShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision highp float;\r\n    precision highp sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    uniform sampler2D uVelocity;\r\n    uniform sampler2D uSource;\r\n    uniform vec2 texelSize;\r\n    uniform vec2 dyeTexelSize;\r\n    uniform float dt;\r\n    uniform float dissipation;\r\n    uniform vec2 motion;\r\n\r\n    vec4 bilerp (sampler2D sam, vec2 uv, vec2 tsize) {\r\n        vec2 st = uv / tsize - 0.5;\r\n\r\n        vec2 iuv = floor(st);\r\n        vec2 fuv = fract(st);\r\n\r\n        vec4 a = texture2D(sam, (iuv + vec2(0.5, 0.5)) * tsize);\r\n        vec4 b = texture2D(sam, (iuv + vec2(1.5, 0.5)) * tsize);\r\n        vec4 c = texture2D(sam, (iuv + vec2(0.5, 1.5)) * tsize);\r\n        vec4 d = texture2D(sam, (iuv + vec2(1.5, 1.5)) * tsize);\r\n\r\n        return mix(mix(a, b, fuv.x), mix(c, d, fuv.x), fuv.y);\r\n    }\r\n\r\n    void main () {\r\n    #ifdef MANUAL_FILTERING\r\n        vec2 coord = vUv - dt * bilerp(uVelocity, vUv, texelSize).xy * texelSize - dt * motion;\r\n        vec4 result = bilerp(uSource, coord, dyeTexelSize);\r\n    #else\r\n        vec2 coord = vUv - dt * texture2D(uVelocity, vUv).xy * texelSize - dt * motion;\r\n        vec4 result = texture2D(uSource, coord);\r\n    #endif\r\n        float decay = 1.0 + dissipation * dt;\r\n        gl_FragColor = result / decay;\r\n    }`,\r\n            ext.supportLinearFiltering ? null : [`MANUAL_FILTERING`],\r\n        ),\r\n\r\n        divergenceShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying highp vec2 vUv;\r\n    varying highp vec2 vL;\r\n    varying highp vec2 vR;\r\n    varying highp vec2 vT;\r\n    varying highp vec2 vB;\r\n    uniform sampler2D uVelocity;\r\n\r\n    void main () {\r\n        float L = texture2D(uVelocity, vL).x;\r\n        float R = texture2D(uVelocity, vR).x;\r\n        float T = texture2D(uVelocity, vT).y;\r\n        float B = texture2D(uVelocity, vB).y;\r\n\r\n        vec2 C = texture2D(uVelocity, vUv).xy;\r\n        if (vL.x < 0.0) { L = -C.x; }\r\n        if (vR.x > 1.0) { R = -C.x; }\r\n        if (vT.y > 1.0) { T = -C.y; }\r\n        if (vB.y < 0.0) { B = -C.y; }\r\n\r\n        float div = 0.5 * (R - L + T - B);\r\n        gl_FragColor = vec4(div, 0.0, 0.0, 1.0);\r\n    }\r\n`),\r\n\r\n        curlShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying highp vec2 vUv;\r\n    varying highp vec2 vL;\r\n    varying highp vec2 vR;\r\n    varying highp vec2 vT;\r\n    varying highp vec2 vB;\r\n    uniform sampler2D uVelocity;\r\n\r\n    void main () {\r\n        float L = texture2D(uVelocity, vL).y;\r\n        float R = texture2D(uVelocity, vR).y;\r\n        float T = texture2D(uVelocity, vT).x;\r\n        float B = texture2D(uVelocity, vB).x;\r\n        float vorticity = R - L - T + B;\r\n        gl_FragColor = vec4(0.5 * vorticity, 0.0, 0.0, 1.0);\r\n    }\r\n`),\r\n\r\n        vorticityShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision highp float;\r\n    precision highp sampler2D;\r\n\r\n    varying vec2 vUv;\r\n    varying vec2 vL;\r\n    varying vec2 vR;\r\n    varying vec2 vT;\r\n    varying vec2 vB;\r\n    uniform sampler2D uVelocity;\r\n    uniform sampler2D uCurl;\r\n    uniform float curl;\r\n    uniform float dt;\r\n\r\n    void main () {\r\n        float L = texture2D(uCurl, vL).x;\r\n        float R = texture2D(uCurl, vR).x;\r\n        float T = texture2D(uCurl, vT).x;\r\n        float B = texture2D(uCurl, vB).x;\r\n        float C = texture2D(uCurl, vUv).x;\r\n\r\n        vec2 force = 0.5 * vec2(abs(T) - abs(B), abs(R) - abs(L));\r\n        force /= length(force) + 0.0001;\r\n        force *= curl * C;\r\n        force.y *= -1.0;\r\n\r\n        vec2 velocity = texture2D(uVelocity, vUv).xy;\r\n        velocity += force * dt;\r\n        velocity = min(max(velocity, -1000.0), 1000.0);\r\n        gl_FragColor = vec4(velocity, 0.0, 1.0);\r\n    }\r\n`),\r\n\r\n        pressureShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying highp vec2 vUv;\r\n    varying highp vec2 vL;\r\n    varying highp vec2 vR;\r\n    varying highp vec2 vT;\r\n    varying highp vec2 vB;\r\n    uniform sampler2D uPressure;\r\n    uniform sampler2D uDivergence;\r\n\r\n    void main () {\r\n        float L = texture2D(uPressure, vL).x;\r\n        float R = texture2D(uPressure, vR).x;\r\n        float T = texture2D(uPressure, vT).x;\r\n        float B = texture2D(uPressure, vB).x;\r\n        float C = texture2D(uPressure, vUv).x;\r\n        float divergence = texture2D(uDivergence, vUv).x;\r\n        float pressure = (L + R + B + T - divergence) * 0.25;\r\n        gl_FragColor = vec4(pressure, 0.0, 0.0, 1.0);\r\n    }\r\n`),\r\n\r\n        gradientSubtractShader: compileShader(gl.FRAGMENT_SHADER, `\r\n    precision mediump float;\r\n    precision mediump sampler2D;\r\n\r\n    varying highp vec2 vUv;\r\n    varying highp vec2 vL;\r\n    varying highp vec2 vR;\r\n    varying highp vec2 vT;\r\n    varying highp vec2 vB;\r\n    uniform sampler2D uPressure;\r\n    uniform sampler2D uVelocity;\r\n\r\n    void main () {\r\n        float L = texture2D(uPressure, vL).x;\r\n        float R = texture2D(uPressure, vR).x;\r\n        float T = texture2D(uPressure, vT).x;\r\n        float B = texture2D(uPressure, vB).x;\r\n        vec2 velocity = texture2D(uVelocity, vUv).xy;\r\n        velocity.xy -= vec2(R - L, T - B);\r\n        gl_FragColor = vec4(velocity, 0.0, 1.0);\r\n    }\r\n`),\r\n    };\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport { createRandomGenerator } from '../../rando';\r\nimport { ArtWork } from '../../artwork-type';\r\nimport { runFluidSimulator } from './src/run';\r\n\r\nconst contentPath = `/content/art/artwork/example-PavelDoGreat-fluid-simulation/src`;\r\n\r\nexport const art_exampleFluidSimulator: ArtWork = {\r\n    key: `art-exampleFluidSimulator`,\r\n    title: `Fluid Simulator`,\r\n    description: `2017 \r\n\r\nThis is included as an amazing gpu shader.\r\n    \r\nFrom: https://paveldogreat.github.io/WebGL-Fluid-Simulation/`,\r\n    artist: `Pavel Dobryakov`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        return null;\r\n    },\r\n    // openSea: {\r\n    //     tokenAddress: `0x495f947276749ce646f68ac8c248420045cb7b5e`,\r\n    //     tokenId: `91242641486941084018191434774360347389366801368112854311223385694785434025985`,\r\n    // },\r\n    renderArt: (hostElement: HTMLDivElement, hash) => {\r\n        const result = runFluidSimulator(hostElement, contentPath, { width: `100%`, height: `100%` });\r\n        return {\r\n            remove: () => result?.close(),\r\n        };\r\n    },\r\n};\r\n","import { ArtGame, ColorRgb, Vector2 } from './types';\r\n\r\ntype EntityRenderData = {\r\n    id: number;\r\n    kind: 'player' | 'obstacle' | 'obstacle-still';\r\n    position: Vector2;\r\n    velocity: Vector2;\r\n    size: Vector2;\r\n    color: ColorRgb;\r\n};\r\ntype UpdateArgs = {\r\n    onPlayerHit: () => void;\r\n};\r\ntype RenderArgs = {\r\n    renderEntity: (data: EntityRenderData) => void;\r\n    removeEntity: (id: number) => void;\r\n    setBackgroundVelocity: (data: { velocity: Vector2 }) => void;\r\n}\r\nexport const flappyDodgeGame: ArtGame<UpdateArgs, RenderArgs> = {\r\n    name: `Flappy Dodge`,\r\n    createGame: (timeProvider, environmentProvider) => {\r\n\r\n        let destroyed = false;\r\n\r\n        const MOTION_X = -0.1;\r\n        const MOTION_Y = -0.025;\r\n\r\n        const COLOR_STRENGTH = 1;\r\n\r\n        type Entity = {\r\n            id: number;\r\n            color: ColorRgb;\r\n            position: Vector2;\r\n            velocity: Vector2;\r\n            size: Vector2;\r\n            isStill: boolean;\r\n        };\r\n        const state = {\r\n            environment: {\r\n                time: 0,\r\n                timeLast: timeProvider.now(),\r\n                timeMsStart: timeProvider.now(),\r\n                timeDelta: 0,\r\n                tick: 0,\r\n                size: { x: 600, y: 600 },\r\n            },\r\n            input: {\r\n                u: false,\r\n                d: false,\r\n                l: false,\r\n                r: false,\r\n            },\r\n            player: {\r\n                id: 42,\r\n                position: { x: 0.5, y: 0.5 },\r\n                velocity: { x: 0, y: 0 },\r\n                size: { x: 0.05, y: 0.05 },\r\n                color: { r: COLOR_STRENGTH, g: COLOR_STRENGTH, b: COLOR_STRENGTH },\r\n                color1: { r: COLOR_STRENGTH, g: COLOR_STRENGTH, b: COLOR_STRENGTH },\r\n                color2: { r: COLOR_STRENGTH, g: COLOR_STRENGTH, b: COLOR_STRENGTH },\r\n                color2Stength: 0.5,\r\n            },\r\n            obstacles: [] as Entity[],\r\n            obstaclesState: {\r\n                timeNextObstacle: 1,\r\n            },\r\n        };\r\n\r\n        const updatePlayer = () => {\r\n            const { player, environment: { timeDelta, size } } = state;\r\n\r\n            // Player color\r\n            player.color2Stength += timeDelta * 1;\r\n            if (player.color2Stength > 1) {\r\n                player.color1 = player.color2;\r\n                player.color2 = {\r\n                    r: 1 * COLOR_STRENGTH * 0.5 * Math.random(),\r\n                    g: 1 * COLOR_STRENGTH * 0.5 * Math.random(),\r\n                    b: 1 * COLOR_STRENGTH * 0.5 * Math.random(),\r\n                };\r\n                player.color2Stength = 0;\r\n            }\r\n\r\n\r\n            const ratio = player.color2Stength;\r\n            player.color = {\r\n                r: (1 - ratio) * player.color1.r + ratio * player.color2.r,\r\n                g: (1 - ratio) * player.color1.g + ratio * player.color2.g,\r\n                b: (1 - ratio) * player.color1.b + ratio * player.color2.b,\r\n            };\r\n\r\n            // Player motion\r\n            const speedX = 0.9;\r\n            const speedY = speedX * size.x / size.y;\r\n            player.velocity = {\r\n                x: player.velocity.x + timeDelta * (state.input.l ? -speedX : state.input.r ? speedX : 0),\r\n                y: player.velocity.y + timeDelta * (state.input.d ? -speedY : state.input.u ? speedY : 0),\r\n            };\r\n\r\n            player.position.x += timeDelta * player.velocity.x;\r\n            player.position.y += timeDelta * player.velocity.y;\r\n\r\n            // Dampening\r\n            player.velocity.x *= 1 - (0.5 * timeDelta);\r\n            player.velocity.y *= 1 - (0.5 * timeDelta);\r\n\r\n            // Gravity\r\n            player.velocity.y -= timeDelta * 0.4;\r\n\r\n            // Boundaries\r\n            if (player.position.x < 0) { player.position.x = 0; player.velocity.x = 0; }\r\n            if (player.position.x > 1) { player.position.x = 1; player.velocity.x = 0; }\r\n            if (player.position.y < 0) { player.position.y = 0; player.velocity.y = 0; }\r\n            if (player.position.y > 1) { player.position.y = 1; player.velocity.y = 0; }\r\n        };\r\n\r\n        const updateObstacles = (onPlayerHit: () => void) => {\r\n            const { player, obstacles, obstaclesState, environment: { time, timeDelta } } = state;\r\n\r\n            if (time > obstaclesState.timeNextObstacle) {\r\n                obstaclesState.timeNextObstacle = time + 1.5;\r\n\r\n                let freeObstacle = obstacles.find(x => x.position.x < -0.25);\r\n                if (!freeObstacle) {\r\n                    freeObstacle = {\r\n                        id: obstacles.length + 1000,\r\n                        position: { x: 1.25, y: 0.1 },\r\n                        velocity: { x: -0.125, y: 0 },\r\n                        color: { r: 0.01, g: 0, b: 0 },\r\n                        size: { x: 0.1, y: 0.1 },\r\n                        isStill: false,\r\n                    };\r\n                    // Add an obstacle\r\n                    obstacles.push(freeObstacle);\r\n                }\r\n\r\n                freeObstacle.color = { r: COLOR_STRENGTH * Math.random(), g: COLOR_STRENGTH * Math.random(), b: COLOR_STRENGTH * Math.random() };\r\n\r\n                const motionSignX = Math.sign(MOTION_X);\r\n\r\n                freeObstacle.position = { x: motionSignX * -1.05, y: Math.random() };\r\n                freeObstacle.velocity = {\r\n                    x: motionSignX * (0.05 + 0.25 * Math.random()),\r\n                    y: (0.2 + 0.1 - 0.2 * Math.random()),\r\n                };\r\n                freeObstacle.isStill = Math.random() < 0.1;\r\n\r\n                freeObstacle.size = { x: 0.1 + 0.02 * Math.random(), y: 0.1 + 0.02 * Math.random() };\r\n            }\r\n\r\n            for (const entity of obstacles) {\r\n                if (entity.isStill) {\r\n                    entity.velocity = { x: MOTION_X, y: MOTION_Y };\r\n                }\r\n\r\n                entity.position.x += entity.velocity.x * timeDelta;\r\n                entity.position.y += entity.velocity.y * timeDelta;\r\n\r\n                // Gravity\r\n                entity.velocity.y -= timeDelta * 0.1;\r\n            }\r\n\r\n            // Collisions\r\n            for (const entity of obstacles) {\r\n                const r = 0.35 * (player.size.x + entity.size.x);\r\n                if (r > Math.abs(entity.position.x - player.position.x)\r\n                    && r > Math.abs(entity.position.y - player.position.y)\r\n                ) {\r\n                    onPlayerHit();\r\n                }\r\n            }\r\n\r\n        };\r\n\r\n        const minTickTimeMs = 16;\r\n        const update = (args: UpdateArgs) => {\r\n            // console.log(`game.update START`, {});\r\n\r\n            if (destroyed) {\r\n                console.error(`game.update DESTROYED`, {});\r\n                return;\r\n            }\r\n\r\n            if (timeProvider.isPaused()) {\r\n                console.log(`game.update timeProvider.PAUSED`, {});\r\n                return;\r\n            }\r\n\r\n            const size = environmentProvider.getDisplaySize();\r\n            state.environment.size = { x: size.width, y: size.height };\r\n            state.environment.timeLast = state.environment.time;\r\n            state.environment.time = 0.001 * (timeProvider.now() - state.environment.timeMsStart);\r\n            state.environment.timeDelta = Math.max(minTickTimeMs * 0.001 * 0.5, state.environment.time - state.environment.timeLast);\r\n            // console.log(`gameInverval`, { environment: state.environment });\r\n\r\n            updatePlayer();\r\n            updateObstacles(args.onPlayerHit);\r\n\r\n            state.environment.tick++;\r\n\r\n            // console.log(`game.update DONE`, {});\r\n        };\r\n\r\n        const render = (args: RenderArgs) => {\r\n            const { player, obstacles } = state;\r\n\r\n            args.setBackgroundVelocity({\r\n                velocity: {\r\n                    x: MOTION_X,\r\n                    y: MOTION_Y,\r\n                },\r\n            });\r\n\r\n            // Render Player\r\n            args.renderEntity({\r\n                id: player.id,\r\n                kind: `player`,\r\n                position: player.position,\r\n                velocity: player.velocity,\r\n                size: player.size,\r\n                color: player.color,\r\n            });\r\n\r\n            // Render Entities\r\n            for (const entity of obstacles) {\r\n\r\n                const isHidden = entity.position.x < -0.25\r\n                    || entity.position.x > 1.25\r\n                    || entity.position.y < -0.25\r\n                    || entity.position.y > 1.25;\r\n\r\n                if (isHidden) {\r\n                    args.removeEntity(entity.id);\r\n                    continue;\r\n                }\r\n\r\n                if (entity.isStill) {\r\n                    args.renderEntity({\r\n                        id: entity.id,\r\n                        kind: `obstacle-still`,\r\n                        position: entity.position,\r\n                        velocity: { x: 0, y: 0 },\r\n                        size: entity.size,\r\n                        color: entity.color,\r\n                    });\r\n                    continue;\r\n                }\r\n\r\n                args.renderEntity({\r\n                    id: entity.id,\r\n                    kind: `obstacle`,\r\n                    position: entity.position,\r\n                    velocity: entity.velocity,\r\n                    size: entity.size,\r\n                    color: entity.color,\r\n                });\r\n            }\r\n        };\r\n\r\n        const windowSubs = [] as { name: string, handler: () => void }[];\r\n        const windowAddEventListener = ((name: string, handler: () => void) => {\r\n            window.addEventListener(name, handler);\r\n            windowSubs.push({ name, handler });\r\n        }) as typeof window.addEventListener;\r\n        const windowEventListenersDestroy = () => {\r\n            windowSubs.forEach(({ name, handler }) => {\r\n                window.removeEventListener(name, handler);\r\n            });\r\n        };\r\n        windowAddEventListener(`keydown`, e => {\r\n            if (e.key === `w` || e.key === `ArrowUp`) { state.input.u = true; }\r\n            if (e.key === `a` || e.key === `ArrowLeft`) { state.input.l = true; }\r\n            if (e.key === `s` || e.key === `ArrowDown`) { state.input.d = true; }\r\n            if (e.key === `d` || e.key === `ArrowRight`) { state.input.r = true; }\r\n        });\r\n        windowAddEventListener(`keyup`, e => {\r\n            if (e.key === `w` || e.key === `ArrowUp`) { state.input.u = false; }\r\n            if (e.key === `a` || e.key === `ArrowLeft`) { state.input.l = false; }\r\n            if (e.key === `s` || e.key === `ArrowDown`) { state.input.d = false; }\r\n            if (e.key === `d` || e.key === `ArrowRight`) { state.input.r = false; }\r\n        });\r\n\r\n\r\n        return {\r\n            start: () => { },\r\n            update,\r\n            render,\r\n            destroy: () => {\r\n                windowEventListenersDestroy();\r\n                destroyed = true;\r\n            },\r\n        };\r\n    },\r\n};\r\n","/* eslint-disable new-cap */\r\n/* eslint-disable no-new */\r\nimport { clamp } from 'utils/clamp';\r\nimport { ArtWork } from '../../artwork-type';\r\nimport { runFluidSimulator } from './src/run';\r\nimport { flappyDodgeGame } from '../games/flappy-dodge';\r\n\r\nconst contentPath = `/content/art/artwork/example-PavelDoGreat-fluid-simulation/src`;\r\n\r\nexport const art_fluidSimulatorGame: ArtWork = {\r\n    key: `art-fluid-simulator-game`,\r\n    title: `Fluid Simulator Game`,\r\n    description: `Flappy Dodge with Fluid Simulator Renderer \r\n\r\nRenderer based on Fluid Simulator by Pavel Dobryakov: https://paveldogreat.github.io/WebGL-Fluid-Simulation/`,\r\n    artist: `Rick Love`,\r\n    getTokenDescription: (tokenId: string) => {\r\n        return null;\r\n    },\r\n    // openSea: {\r\n    //     tokenAddress: `0x495f947276749ce646f68ac8c248420045cb7b5e`,\r\n    //     tokenId: `91242641486941084018191434774360347389366801368112854311223385694785434025985`,\r\n    // },\r\n    renderArt: (hostElement, hash, recorder) => {\r\n        const sim = runFluidSimulator(hostElement, contentPath, { width: `100%`, height: `100%` }, {\r\n            disableGui: false, disableInput: true, disableStartupSplats: true,\r\n            timeProvider: recorder?.timeProvider,\r\n        });\r\n        if (!sim) { return { remove: () => { } }; }\r\n\r\n        const timeProvider = recorder?.timeProvider ?? { now: () => Date.now(), isPaused: () => false };\r\n\r\n        const game = flappyDodgeGame.createGame(\r\n            timeProvider,\r\n            {\r\n                getDisplaySize: () => ({ width: sim.canvas.width, height: sim.canvas.height }),\r\n            });\r\n\r\n        const { config } = sim;\r\n\r\n        if (config) {\r\n            // config.SPLAT_RADIUS = 0.001;\r\n\r\n            config.COLORFUL = false;\r\n            config.CURL = 10;\r\n            // config.BLOOM = false;\r\n        }\r\n\r\n        const VEL_MULT = 0.0005;\r\n        const SIZE_MULT_OBSTACLE = 2;\r\n        const SIZE_MULT_PLAYER = 2;\r\n        const COLOR_STRENGTH = 0.06;\r\n        // const CURL_BASE_VALUE = 30;\r\n\r\n        const state = {\r\n            resetBloomAtTimeMs: 0,\r\n        };\r\n\r\n        const updateGame = () => {\r\n            config.BLOOM_INTENSITY = clamp(0.001 * (state.resetBloomAtTimeMs - timeProvider.now()), 0, 2);\r\n\r\n            game.update({\r\n                onPlayerHit: () => {\r\n                    // console.log(`onPlayerHit`, {});\r\n\r\n                    // config.BLOOM = true;\r\n                    // sim.updateConfig();\r\n\r\n                    state.resetBloomAtTimeMs = timeProvider.now() + 3000;\r\n                },\r\n            });\r\n            game.render({\r\n                renderEntity: (data) => {\r\n\r\n                    // if (data.kind === `player`) {\r\n                    //     console.log(`player`, { data, config });\r\n\r\n                    //     // // Adjust vorticity based on player speed\r\n                    //     // const curl = CURL_BASE_VALUE * clamp((1 + 0.1 * data.velocity.x), 0.5, 2);\r\n                    //     // config.CURL = curl;\r\n\r\n                    //     // if (Math.abs(data.velocity.x) > 0.25) {\r\n                    //     //     config.BLOOM = true;\r\n                    //     //     state.resetBloomAtTime = timeProvider.now() + 5;\r\n                    //     // }\r\n                    // }\r\n\r\n                    sim.splat(data.id,\r\n                        true,\r\n                        data.position.x, data.position.y,\r\n                        VEL_MULT * data.velocity.x,\r\n                        VEL_MULT * data.velocity.y,\r\n                        {\r\n                            x: data.size.x * (data.kind === `player` ? SIZE_MULT_PLAYER : SIZE_MULT_OBSTACLE),\r\n                            y: data.size.y * (data.kind === `player` ? SIZE_MULT_PLAYER : SIZE_MULT_OBSTACLE),\r\n                        },\r\n                        {\r\n                            r: data.color.r * COLOR_STRENGTH,\r\n                            g: data.color.g * COLOR_STRENGTH,\r\n                            b: data.color.b * COLOR_STRENGTH,\r\n                        });\r\n                },\r\n                removeEntity: (id) => {\r\n                    sim.splat(id, false, 0, 0, 0, 0);\r\n                },\r\n                setBackgroundVelocity: (data) => {\r\n                    config.MOTION_X = data.velocity.x;\r\n                    config.MOTION_Y = data.velocity.y;\r\n                },\r\n            });\r\n        };\r\n\r\n        const update = async () => {\r\n\r\n            if (!timeProvider.isPaused()) {\r\n                updateGame();\r\n            }\r\n\r\n            if (recorder?.isWaitingForFrame()) {\r\n                console.log(`game.update waitingForFrame - addFrame`, {});\r\n                await recorder.getRecorder().addFrame(sim.canvas);\r\n            }\r\n\r\n            return requestAnimationFrame(update);\r\n        };\r\n        // Start\r\n        (async () => { await update(); })();\r\n\r\n        return {\r\n            remove: () => {\r\n                game.destroy();\r\n                sim?.close();\r\n            },\r\n        };\r\n    },\r\n};\r\n","export const clamp = (value: number, min: number, max: number) => {\r\n    return value < min ? min\r\n        : value > max ? max\r\n            : value;\r\n};\r\n","/* eslint-disable no-await-in-loop */\r\n/* eslint-disable jsx-a11y/accessible-emoji */\r\n/* eslint-disable jsx-a11y/no-static-element-interactions */\r\n/* eslint-disable jsx-a11y/click-events-have-key-events */\r\nimport { useAutoLoadingError } from 'utils-react/hooks';\r\nimport React, { useState } from 'react';\r\nimport { createFFmpeg } from '@ffmpeg/ffmpeg';\r\nimport { TimeProvider } from '../time-provider';\r\n\r\nexport const createRecorder = () => {\r\n\r\n    let _settings: null | { framesPerSecond: number, quality?: number, width: number, height: number } = null;\r\n\r\n    let timeMsLost = 0;\r\n    let timeMs = Date.now();\r\n    let isRecording = false;\r\n    let mode = `none` as 'none'\r\n        | 'targetPrepareRequested' | 'targetReady'\r\n        | `waitingForFrame` | `processingFrame` | `increasingTime`\r\n        | 'completingVideo';\r\n\r\n    let workingCanvas = null as null | HTMLCanvasElement;\r\n    let workingContext = null as null | CanvasRenderingContext2D;\r\n    let blobs = null as null | Blob[];\r\n\r\n    const timeProvider: TimeProvider = {\r\n        now: () => isRecording ? timeMs : (Date.now() - timeMsLost),\r\n        isPaused: () => isRecording ? mode === `processingFrame` : false,\r\n    };\r\n\r\n    const requestPrepareTarget = async (settings: NonNullable<typeof _settings>) => {\r\n        _settings = settings;\r\n\r\n        // Get canvas ready\r\n        workingCanvas = document.createElement(`canvas`);\r\n        workingCanvas.width = _settings.width;\r\n        workingCanvas.height = _settings.height;\r\n        document.body.append(workingCanvas);\r\n\r\n        workingContext = workingCanvas.getContext(`2d`);\r\n\r\n        // wait for target canvas\r\n        mode = `targetPrepareRequested`;\r\n    };\r\n\r\n    const start = async () => {\r\n        if (!_settings) { console.error(`prepareCanvas first!`); return; }\r\n        if (isRecording || mode === `completingVideo`) { console.error(`Not able to start!`); return; }\r\n\r\n        blobs = [];\r\n        timeMs = Date.now() - timeMsLost;\r\n        isRecording = true;\r\n        mode = `waitingForFrame`;\r\n    };\r\n\r\n    const beginIncreasingTime = () => {\r\n        if (!_settings) { console.error(`prepareCanvas first!`); return; }\r\n        const timeMsPerFrame = 1000 / _settings.framesPerSecond;\r\n\r\n        setTimeout(() => {\r\n            // Finally update time\r\n            timeMs += timeMsPerFrame;\r\n            mode = `waitingForFrame`;\r\n        }, 0);\r\n\r\n        mode = `increasingTime`;\r\n    };\r\n\r\n    const completeToBlob = async () => {\r\n        if (!blobs || !_settings) { throw new Error(`Recorder has not started`); }\r\n        console.log(`completeToBlob.compile started`);\r\n\r\n        isRecording = false;\r\n        timeMsLost = Date.now() - timeMs;\r\n        mode = `completingVideo`;\r\n\r\n        try {\r\n            // const webMBlob = new Blob(blobs, { type: `video/webm; codecs=vp9` });\r\n            // const webMBlob = new Blob(blobs, { type: `video/webm` });\r\n\r\n            // const webMBlob = new Blob(blobs, { type: `image/webp[array]?` });\r\n            // const webMBlob = new Blob(blobs[0], { type: `image/webp` });\r\n\r\n\r\n            const ffmpeg = createFFmpeg({});\r\n            await ffmpeg.load();\r\n\r\n            // Write images to virtual file system\r\n            // https://github.com/welefen/canvas2video/blob/master/src/index.ts\r\n            for (const [i, blob] of blobs.entries()) {\r\n                const buffer = await blob.arrayBuffer();\r\n                ffmpeg.FS(`writeFile`, `image${`${i}`.padStart(3, `0`)}.webp`, new Uint8Array(buffer));\r\n            }\r\n\r\n            // Run ffmpeg as slideshow\r\n            // https://trac.ffmpeg.org/wiki/Slideshow\r\n            // ffmpeg -framerate 24 -i img%03d.png output.mp4\r\n            await ffmpeg.run(...`-framerate ${_settings.framesPerSecond} -i image%03d.webp output.mp4`.split(` `));\r\n\r\n            const data = ffmpeg.FS(`readFile`, `output.mp4`);\r\n            const videoBlob = new Blob([data.buffer], { type: `video/mp4` });\r\n\r\n            console.log(`completeToBlob.compile done`, { videoBlob });\r\n\r\n            return videoBlob;\r\n\r\n        } catch (err) {\r\n            console.error(`completeToBlob.compile ERROR`, { err });\r\n            throw err;\r\n        }\r\n    };\r\n\r\n    const completeToDataUrl = async () => {\r\n        const videoBlob = await completeToBlob();\r\n        console.log(`completeToDownloadFile videoBlob ready`, { videoBlob });\r\n\r\n        return URL.createObjectURL(videoBlob);\r\n    };\r\n\r\n    const completeToDownloadFile = async (filename: string) => {\r\n        const dataUrl = await completeToDataUrl();\r\n        console.log(`completeToDownloadFile dataUrl ready`, { dataUrl });\r\n\r\n        const link = document.createElement(`a`);\r\n        link.download = filename;\r\n        link.href = dataUrl;\r\n        document.body.append(link);\r\n        link.click();\r\n        link.remove();\r\n\r\n        console.log(`completeToDownloadFile done`, { link, dataUrl });\r\n    };\r\n\r\n\r\n    const addFrame = async (canvas: HTMLCanvasElement) => {\r\n\r\n        return await new Promise<void>((resolve, reject) => {\r\n            const cvs = workingCanvas;\r\n            const ctx = workingContext;\r\n            if (!cvs || !ctx || !blobs || !_settings) { throw new Error(`Recorder has not started`); }\r\n\r\n            try {\r\n                mode = `processingFrame`;\r\n\r\n                ctx.drawImage(canvas, 0, 0, _settings.width, _settings.height);\r\n                cvs.toBlob(b => {\r\n                    if (!ctx || !blobs || !_settings) { throw new Error(`Recorder has not started`); }\r\n\r\n                    b && blobs?.push(b);\r\n\r\n                    beginIncreasingTime();\r\n\r\n                    resolve();\r\n\r\n                }, `image/webp`, _settings.quality);\r\n\r\n\r\n            } catch (err) {\r\n                console.error(`addFrame ERROR`, { err });\r\n                mode = `waitingForFrame`;\r\n                reject(err);\r\n            }\r\n        });\r\n    };\r\n\r\n    return {\r\n        prepareTarget: requestPrepareTarget,\r\n        getSettings: () => _settings,\r\n        getMode: () => mode,\r\n        targetReady: () => { mode = `targetReady`; },\r\n        start,\r\n        isRecording: () => isRecording,\r\n        isWaitingForFrame: () => mode === `waitingForFrame`,\r\n        iscompletingVideo: () => mode === `completingVideo`,\r\n        getRecorder: () => {\r\n            if (!isRecording) { throw new Error(`Recorder is not recording`); }\r\n\r\n            return {\r\n                addFrame,\r\n                completeToBlob,\r\n                completeToDownloadFile,\r\n                completeToDataUrl,\r\n                settings: _settings,\r\n            };\r\n        },\r\n        timeProvider,\r\n    };\r\n};\r\n\r\nexport type CanvasVideoRecorder = ReturnType<typeof createRecorder>;\r\n\r\nexport const CanvasVideoRecorderControl = (props: { recorder: CanvasVideoRecorder, onPrepareTarget: () => void }) => {\r\n\r\n    const [mode, setMode] = useState(`prepare` as 'prepare' | 'ready' | 'recording' | 'stopped');\r\n\r\n    const prepareTarget = () => {\r\n        doWork(async (stopIfObsolete) => {\r\n            await props.recorder.prepareTarget({\r\n                framesPerSecond: 30,\r\n\r\n                // 720p - Looks good on mobile\r\n                width: 1280,\r\n                height: 720,\r\n\r\n                // // Blurry on twitter\r\n                // width: 480,\r\n                // height: 270,\r\n\r\n                // // Blurry on twitter\r\n                // width: 256,\r\n                // height: 256,\r\n\r\n                // width: 507,\r\n                // height: 507,\r\n                quality: 0.95,\r\n                // quality: 0.95,\r\n                // width: 1920,\r\n                // height: 1080,\r\n            });\r\n            stopIfObsolete();\r\n            setMode(`ready`);\r\n            props.onPrepareTarget();\r\n        });\r\n    };\r\n\r\n    const startRecording = () => {\r\n        setMode(`recording`);\r\n        doWork(async (stopIfObsolete) => {\r\n            await props.recorder.start();\r\n        });\r\n    };\r\n\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n\r\n    const stopRecording = () => {\r\n        setMode(`stopped`);\r\n        doWork(async (stopIfObsolete) => {\r\n            await props.recorder.getRecorder().completeToDownloadFile(`video.mp4`);\r\n        });\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div>\r\n                {error && (\r\n                    <div style={{ background: `#88888888` }}><span>ERROR! </span></div>\r\n                )}\r\n                {loading && (\r\n                    <div style={{ background: `#88888888` }}><span>Loading </span></div>\r\n                )}\r\n                {mode === `prepare` && (\r\n                    <div onClick={prepareTarget} style={{ background: `#88888888` }}><span>Prepare </span></div>\r\n                )}\r\n                {mode === `ready` && (\r\n                    <div onClick={startRecording} style={{ background: `#88888888` }}><span>Record </span></div>\r\n                )}\r\n                {mode === `recording` && (\r\n                    <div onClick={stopRecording} style={{ background: `#88888888` }}><span>Stop </span></div>\r\n                )}\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n","/* eslint-disable jsx-a11y/no-static-element-interactions */\r\n/* eslint-disable jsx-a11y/click-events-have-key-events */\r\nimport React, { useEffect, useState, useRef } from 'react';\r\nimport { C } from 'controls-react';\r\nimport { useDebounce } from 'utils-react/hooks';\r\nimport { theme } from 'themes/theme';\r\nimport { art_circles } from './artwork/circles';\r\nimport { art_layersOfTheOnionsSoul } from './artwork/layers-of-the-onions-soul';\r\nimport { art_121 } from './artwork/art-121';\r\nimport { DivHost } from './div-host';\r\nimport { art_puzzle01 } from './artwork/puzzle/art-puzzle-01';\r\nimport { art_gears } from './artwork/gears';\r\nimport { ArtWork } from './artwork-type';\r\nimport { art_gpu_01 } from './artwork/gpu-01/gpu-01';\r\nimport { art_flyingColors } from './artwork/flying-colors/flying-colors';\r\nimport { art_exampleFluidSimulator } from './artwork/example-PavelDoGreat-fluid-simulation/example-fluid-simulator';\r\nimport { art_fluidSimulatorGame } from './artwork/example-PavelDoGreat-fluid-simulation/fluid-simulator-game';\r\nimport { CanvasVideoRecorderControl, createRecorder } from './canvas-video-recording/canvas-video-recorder';\r\n\r\nexport const ArtGallery = (props: {}) => {\r\n    const artItems: ArtWork[] = [\r\n        art_fluidSimulatorGame,\r\n        art_exampleFluidSimulator,\r\n        art_flyingColors,\r\n        art_gpu_01,\r\n        art_gears,\r\n        art_puzzle01,\r\n        art_121,\r\n        art_circles,\r\n        art_layersOfTheOnionsSoul,\r\n    ];\r\n\r\n    const art = useRef(artItems[0]);\r\n    const recorderRef = useRef(createRecorder());\r\n\r\n    const [renderId, setRenderId] = useState(0);\r\n    const [showNavigation, setShowNavigation] = useState(true);\r\n    const [tokenId, setTokenId] = useState(`0`);\r\n    const [isFullScreen, setIsFullScreen] = useState(false);\r\n    const [customSize, setCustomSize] = useState(null as null | { width: number, height: number });\r\n\r\n    type ArtRender = {\r\n        kind: 'div';\r\n        renderArt: (hostElement: HTMLDivElement) => { remove: () => void };\r\n        openSea?: ArtWork['openSea'];\r\n    } | {\r\n        kind: 'react';\r\n        ArtComponent: () => JSX.Element;\r\n        openSea?: ArtWork['openSea'];\r\n    };\r\n    const [tokenDescription, setTokenDescription] = useState(null as null | string);\r\n\r\n    const { debounce } = useDebounce(250);\r\n\r\n    useEffect(() => {\r\n        const queryParts = document.location.search.substr(1).split(`&`);\r\n        const artKey = queryParts.find(x => x.startsWith(`key`))?.split(`=`)[1];\r\n        if (!artKey) { changeTokenId(`0`); return; }\r\n        const artworkItem = artItems.find(x => x.key === artKey);\r\n        if (!artworkItem) { changeTokenId(`0`); return; }\r\n\r\n        art.current = artworkItem;\r\n        const newTokenId = queryParts.find(x => x.startsWith(`tokenId`))?.split(`=`)[1];\r\n\r\n        setShowNavigation(false);\r\n        changeTokenId(`${newTokenId || tokenId}`);\r\n    }, [document.location.search]);\r\n\r\n    const prepareTarget = () => {\r\n        const settings = recorderRef.current.getSettings();\r\n        if (!settings) { return; }\r\n\r\n        setCustomSize({ width: settings.width, height: settings.height });\r\n        recorderRef.current.targetReady();\r\n    };\r\n\r\n    const changeArt = (value: typeof artItems[0]) => {\r\n        art.current = value;\r\n        changeTokenId(tokenId);\r\n    };\r\n\r\n    const changeTokenId = (value: string) => {\r\n        console.log(`changeTokenId`, { value });\r\n\r\n        setTokenId(value);\r\n\r\n        debounce(() => {\r\n            console.log(`changeTokenId debounce`, { value });\r\n            setTokenDescription(art.current.getTokenDescription(value));\r\n            const { renderArt, ArtComponent } = art.current;\r\n            if (renderArt) {\r\n                cacheRenderArtwork({\r\n                    kind: `div`,\r\n                    renderArt: (hostElement) => renderArt(hostElement, value, recorderRef.current),\r\n                    openSea: art.current.openSea,\r\n                });\r\n            } else if (ArtComponent) {\r\n                cacheRenderArtwork({\r\n                    kind: `react`,\r\n                    ArtComponent: () => <ArtComponent hash={value} />,\r\n                    openSea: art.current.openSea,\r\n                });\r\n            }\r\n        });\r\n    };\r\n\r\n    const ArtworkComponentRef = useRef(<></>);\r\n    const cacheRenderArtwork = (artRenderer: ArtRender) => {\r\n        ArtworkComponentRef.current = (\r\n            <>\r\n                {artRenderer?.kind === `div` && (\r\n                    <DivHost renderArt={artRenderer.renderArt} openSea={artRenderer.openSea} />\r\n                )}\r\n                {artRenderer?.kind === `react` && (\r\n                    <artRenderer.ArtComponent />\r\n                )}\r\n                <div style={{ position: `absolute`, top: 4, right: 4, width: 16, height: 16, fontFamily: `monospace`, fontSize: 14, lineHeight: `16px`, textAlign: `center`, color: `#FFFFFF`, background: `#88888888` }}\r\n                    onClick={() => setIsFullScreen(s => !s)}>{isFullScreen ? `-` : `+`}</div>\r\n            </>\r\n        );\r\n        setRenderId(s => s + 1);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <C.View_Panel>\r\n                {showNavigation && (\r\n                    <C.View_Form>\r\n                        {artItems.map(x => (\r\n                            <React.Fragment key={x.title}>\r\n                                <div style={{ paddingBottom: 4 }}>\r\n                                    <C.Button_FormAction onPress={() => changeArt(x)}>{x.title}</C.Button_FormAction>\r\n                                </div>\r\n                            </React.Fragment>\r\n                        ))}\r\n                        <C.View_FieldRow>\r\n                            <C.Text_FormTitle>Enter a preview tokenId:</C.Text_FormTitle>\r\n                            <C.Input_Text value={tokenId} onChange={changeTokenId} />\r\n                        </C.View_FieldRow>\r\n                    </C.View_Form>\r\n                )}\r\n\r\n\r\n                <C.Text_FormTitle style={{ ...theme.text_formTitle, whiteSpace: `pre-wrap` }}>{art.current.title}</C.Text_FormTitle>\r\n                <C.Text_FormTitle style={{ ...theme.text_formTitle, whiteSpace: `pre-wrap` }}>{art.current.artist}</C.Text_FormTitle>\r\n                <div style={customSize ? { position: `fixed`, left: 0, right: 0, top: 0, bottom: 0, background: `#000000` }\r\n                    : isFullScreen ? { position: `fixed`, left: 0, right: 0, top: 0, bottom: 0, background: `#000000` }\r\n                        : { maxWidth: `600px`, maxHeight: `600px` }}>\r\n                    <div style={{ position: `relative`, width: `100%`, height: `100%`, ...customSize ?? {} }} >\r\n                        {ArtworkComponentRef.current}\r\n                    </div>\r\n                </div>\r\n                {recorderRef.current && (\r\n                    <div style={{ position: `fixed`, right: 0, bottom: 0 }} >\r\n                        <CanvasVideoRecorderControl recorder={recorderRef.current} onPrepareTarget={prepareTarget} />\r\n                    </div>\r\n                )}\r\n                {tokenDescription && (<C.Text_FormTitle style={{ ...theme.text_formTitle, background: `#EEEEEE`, padding: 8, whiteSpace: `pre-wrap` }}>{tokenDescription}</C.Text_FormTitle>)}\r\n                <C.Text_FormTitle style={{ ...theme.text_formTitle, whiteSpace: `pre-wrap` }}>{art.current.description}</C.Text_FormTitle>\r\n            </C.View_Panel>\r\n            {!showNavigation && (\r\n                <div style={{ padding: 16, fontSize: 16 }}>\r\n                    <a href='/art'>Other Art by Rick Love</a>\r\n                </div>\r\n            )}\r\n        </>\r\n    );\r\n};\r\n","// eslint-disable-next-line import/no-mutable-exports\r\ndeclare let ga: (send: 'send', event: 'event', name: string, message: string) => void;\r\nif (typeof (ga) === `undefined`) { ga = () => { }; }\r\nexport { ga };\r\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","var logging = false;\n\nvar customLogger = function customLogger() {};\n\nvar setLogging = function setLogging(_logging) {\n  logging = _logging;\n};\n\nvar setCustomLogger = function setCustomLogger(logger) {\n  customLogger = logger;\n};\n\nvar log = function log(type, message) {\n  customLogger({\n    type: type,\n    message: message\n  });\n\n  if (logging) {\n    console.log(\"[\".concat(type, \"] \").concat(message));\n  }\n};\n\nmodule.exports = {\n  logging: logging,\n  setLogging: setLogging,\n  setCustomLogger: setCustomLogger,\n  log: log\n};","var defaultOptions = require('./defaultOptions');\n\nvar getCreateFFmpegCore = require('./getCreateFFmpegCore');\n\nvar fetchFile = require('./fetchFile');\n\nmodule.exports = {\n  defaultOptions: defaultOptions,\n  getCreateFFmpegCore: getCreateFFmpegCore,\n  fetchFile: fetchFile\n};","function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","// Copyright 2014 Simon Lydell\n// X11 (MIT) Licensed. (See LICENSE.)\nvoid function (root, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(factory);\n  } else if (typeof exports === \"object\") {\n    module.exports = factory();\n  } else {\n    root.resolveUrl = factory();\n  }\n}(this, function () {\n  function resolveUrl()\n  /* ...urls */\n  {\n    var numUrls = arguments.length;\n\n    if (numUrls === 0) {\n      throw new Error(\"resolveUrl requires at least one argument; got none.\");\n    }\n\n    var base = document.createElement(\"base\");\n    base.href = arguments[0];\n\n    if (numUrls === 1) {\n      return base.href;\n    }\n\n    var head = document.getElementsByTagName(\"head\")[0];\n    head.insertBefore(base, head.firstChild);\n    var a = document.createElement(\"a\");\n    var resolved;\n\n    for (var index = 1; index < numUrls; index++) {\n      a.href = arguments[index];\n      resolved = a.href;\n      base.href = resolved;\n    }\n\n    head.removeChild(base);\n    return resolved;\n  }\n\n  return resolveUrl;\n});","var _toConsumableArray = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/toConsumableArray\");\n\nvar _regeneratorRuntime = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/regenerator\");\n\nrequire(\"regenerator-runtime/runtime.js\");\n\nvar _asyncToGenerator = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _defineProperty = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/defineProperty\");\n\nvar _objectWithoutProperties = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/objectWithoutProperties\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar _require = require('./config'),\n    defaultArgs = _require.defaultArgs,\n    baseOptions = _require.baseOptions;\n\nvar _require2 = require('./utils/log'),\n    setLogging = _require2.setLogging,\n    setCustomLogger = _require2.setCustomLogger,\n    log = _require2.log;\n\nvar parseProgress = require('./utils/parseProgress');\n\nvar parseArgs = require('./utils/parseArgs');\n\nvar _require3 = require('./node'),\n    defaultOptions = _require3.defaultOptions,\n    getCreateFFmpegCore = _require3.getCreateFFmpegCore;\n\nvar _require4 = require('../package.json'),\n    version = _require4.version;\n\nvar NO_LOAD = Error('ffmpeg.wasm is not ready, make sure you have completed load().');\n\nmodule.exports = function () {\n  var _options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var _baseOptions$defaultO = _objectSpread(_objectSpread(_objectSpread({}, baseOptions), defaultOptions), _options),\n      logging = _baseOptions$defaultO.log,\n      logger = _baseOptions$defaultO.logger,\n      optProgress = _baseOptions$defaultO.progress,\n      options = _objectWithoutProperties(_baseOptions$defaultO, [\"log\", \"logger\", \"progress\"]);\n\n  var Core = null;\n  var ffmpeg = null;\n  var runResolve = null;\n  var running = false;\n  var progress = optProgress;\n\n  var detectCompletion = function detectCompletion(message) {\n    if (message === 'FFMPEG_END' && runResolve !== null) {\n      runResolve();\n      runResolve = null;\n      running = false;\n    }\n  };\n\n  var parseMessage = function parseMessage(_ref) {\n    var type = _ref.type,\n        message = _ref.message;\n    log(type, message);\n    parseProgress(message, progress);\n    detectCompletion(message);\n  };\n  /*\n   * Load ffmpeg.wasm-core script.\n   * In browser environment, the ffmpeg.wasm-core script is fetch from\n   * CDN and can be assign to a local path by assigning `corePath`.\n   * In node environment, we use dynamic require and the default `corePath`\n   * is `$ffmpeg/core`.\n   *\n   * Typically the load() func might take few seconds to minutes to complete,\n   * better to do it as early as possible.\n   *\n   */\n\n\n  var load = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$getCreateFFmpe, createFFmpegCore, corePath, workerPath, wasmPath;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              log('info', 'load ffmpeg-core');\n\n              if (!(Core === null)) {\n                _context.next = 17;\n                break;\n              }\n\n              log('info', 'loading ffmpeg-core');\n              /*\n               * In node environment, all paths are undefined as there\n               * is no need to set them.\n               */\n\n              _context.next = 5;\n              return getCreateFFmpegCore(options);\n\n            case 5:\n              _yield$getCreateFFmpe = _context.sent;\n              createFFmpegCore = _yield$getCreateFFmpe.createFFmpegCore;\n              corePath = _yield$getCreateFFmpe.corePath;\n              workerPath = _yield$getCreateFFmpe.workerPath;\n              wasmPath = _yield$getCreateFFmpe.wasmPath;\n              _context.next = 12;\n              return createFFmpegCore({\n                /*\n                 * Assign mainScriptUrlOrBlob fixes chrome extension web worker issue\n                 * as there is no document.currentScript in the context of content_scripts\n                 */\n                mainScriptUrlOrBlob: corePath,\n                printErr: function printErr(message) {\n                  return parseMessage({\n                    type: 'fferr',\n                    message: message\n                  });\n                },\n                print: function print(message) {\n                  return parseMessage({\n                    type: 'ffout',\n                    message: message\n                  });\n                },\n\n                /*\n                 * locateFile overrides paths of files that is loaded by main script (ffmpeg-core.js).\n                 * It is critical for browser environment and we override both wasm and worker paths\n                 * as we are using blob URL instead of original URL to avoid cross origin issues.\n                 */\n                locateFile: function locateFile(path, prefix) {\n                  if (typeof window !== 'undefined') {\n                    if (typeof wasmPath !== 'undefined' && path.endsWith('ffmpeg-core.wasm')) {\n                      return wasmPath;\n                    }\n\n                    if (typeof workerPath !== 'undefined' && path.endsWith('ffmpeg-core.worker.js')) {\n                      return workerPath;\n                    }\n                  }\n\n                  return prefix + path;\n                }\n              });\n\n            case 12:\n              Core = _context.sent;\n              ffmpeg = Core.cwrap('proxy_main', 'number', ['number', 'number']);\n              log('info', 'ffmpeg-core loaded');\n              _context.next = 18;\n              break;\n\n            case 17:\n              throw Error('ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.');\n\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function load() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  /*\n   * Determine whether the Core is loaded.\n   */\n\n\n  var isLoaded = function isLoaded() {\n    return Core !== null;\n  };\n  /*\n   * Run ffmpeg command.\n   * This is the major function in ffmpeg.wasm, you can just imagine it\n   * as ffmpeg native cli and what you need to pass is the same.\n   *\n   * For example, you can convert native command below:\n   *\n   * ```\n   * $ ffmpeg -i video.avi -c:v libx264 video.mp4\n   * ```\n   *\n   * To\n   *\n   * ```\n   * await ffmpeg.run('-i', 'video.avi', '-c:v', 'libx264', 'video.mp4');\n   * ```\n   *\n   */\n\n\n  var run = function run() {\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n\n    log('info', \"run ffmpeg command: \".concat(_args.join(' ')));\n\n    if (Core === null) {\n      throw NO_LOAD;\n    } else if (running) {\n      throw Error('ffmpeg.wasm can only run one command at a time');\n    } else {\n      running = true;\n      return new Promise(function (resolve) {\n        var args = [].concat(_toConsumableArray(defaultArgs), _args).filter(function (s) {\n          return s.length !== 0;\n        });\n        runResolve = resolve;\n        ffmpeg.apply(void 0, _toConsumableArray(parseArgs(Core, args)));\n      });\n    }\n  };\n  /*\n   * Run FS operations.\n   * For input/output file of ffmpeg.wasm, it is required to save them to MEMFS\n   * first so that ffmpeg.wasm is able to consume them. Here we rely on the FS\n   * methods provided by Emscripten.\n   *\n   * Common methods to use are:\n   * ffmpeg.FS('writeFile', 'video.avi', new Uint8Array(...)): writeFile writes\n   * data to MEMFS. You need to use Uint8Array for binary data.\n   * ffmpeg.FS('readFile', 'video.mp4'): readFile from MEMFS.\n   * ffmpeg.FS('unlink', 'video.map'): delete file from MEMFS.\n   *\n   * For more info, check https://emscripten.org/docs/api_reference/Filesystem-API.html\n   *\n   */\n\n\n  var FS = function FS(method) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n\n    log('info', \"run FS.\".concat(method, \" \").concat(args.map(function (arg) {\n      return typeof arg === 'string' ? arg : \"<\".concat(arg.length, \" bytes binary file>\");\n    }).join(' ')));\n\n    if (Core === null) {\n      throw NO_LOAD;\n    } else {\n      var ret = null;\n\n      try {\n        var _Core$FS;\n\n        ret = (_Core$FS = Core.FS)[method].apply(_Core$FS, args);\n      } catch (e) {\n        if (method === 'readdir') {\n          throw Error(\"ffmpeg.FS('readdir', '\".concat(args[0], \"') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')\"));\n        } else if (method === 'readFile') {\n          throw Error(\"ffmpeg.FS('readFile', '\".concat(args[0], \"') error. Check if the path exists\"));\n        } else {\n          throw Error('Oops, something went wrong in FS operation.');\n        }\n      }\n\n      return ret;\n    }\n  };\n\n  var setProgress = function setProgress(_progress) {\n    progress = _progress;\n  };\n\n  var setLogger = function setLogger(_logger) {\n    setCustomLogger(_logger);\n  };\n\n  setLogging(logging);\n  setCustomLogger(logger);\n  log('info', \"use ffmpeg.wasm v\".concat(version));\n  return {\n    setProgress: setProgress,\n    setLogger: setLogger,\n    setLogging: setLogging,\n    load: load,\n    isLoaded: isLoaded,\n    run: run,\n    FS: FS\n  };\n};","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;","module.exports = function (Core, args) {\n  var argsPtr = Core._malloc(args.length * Uint32Array.BYTES_PER_ELEMENT);\n\n  args.forEach(function (s, idx) {\n    var buf = Core._malloc(s.length + 1);\n\n    Core.writeAsciiToMemory(s, buf);\n    Core.setValue(argsPtr + Uint32Array.BYTES_PER_ELEMENT * idx, buf, 'i32');\n  });\n  return [args.length, argsPtr];\n};","var $ = require('../internals/export');\n\nvar $hypot = Math.hypot;\nvar abs = Math.abs;\nvar sqrt = Math.sqrt;\n\n// Chrome 77 bug\n// https://bugs.chromium.org/p/v8/issues/detail?id=9546\nvar BUGGY = !!$hypot && $hypot(Infinity, NaN) !== Infinity;\n\n// `Math.hypot` method\n// https://tc39.es/ecma262/#sec-math.hypot\n$({ target: 'Math', stat: true, forced: BUGGY }, {\n  hypot: function hypot(value1, value2) { // eslint-disable-line no-unused-vars\n    var sum = 0;\n    var i = 0;\n    var aLen = arguments.length;\n    var larg = 0;\n    var arg, div;\n    while (i < aLen) {\n      arg = abs(arguments[i++]);\n      if (larg < arg) {\n        div = larg / arg;\n        sum = sum * div * div + 1;\n        larg = arg;\n      } else if (arg > 0) {\n        div = arg / larg;\n        sum += div * div;\n      } else sum += arg;\n    }\n    return larg === Infinity ? Infinity : larg * sqrt(sum);\n  }\n});\n","module.exports = {\n  defaultArgs: [\n  /* args[0] is always the binary path */\n  './ffmpeg',\n  /* Disable interaction mode */\n  '-nostdin',\n  /* Force to override output file */\n  '-y'],\n  baseOptions: {\n    /* Flag to turn on/off log messages in console */\n    log: false,\n\n    /*\n     * Custom logger to get ffmpeg.wasm output messages.\n     * a sample logger looks like this:\n     *\n     * ```\n     * logger = ({ type, message }) => {\n     *   console.log(type, message);\n     * }\n     * ```\n     *\n     * type can be one of following:\n     *\n     * info: internal workflow debug messages\n     * fferr: ffmpeg native stderr output\n     * ffout: ffmpeg native stdout output\n     */\n    logger: function logger() {},\n\n    /*\n     * Progress handler to get current progress of ffmpeg command.\n     * a sample progress handler looks like this:\n     *\n     * ```\n     * progress = ({ ratio }) => {\n     *   console.log(ratio);\n     * }\n     * ```\n     *\n     * ratio is a float number between 0 to 1.\n     */\n    progress: function progress() {},\n\n    /*\n     * Path to find/download ffmpeg.wasm-core,\n     * this value should be overwriten by `defaultOptions` in\n     * each environment.\n     */\n    corePath: ''\n  }\n};","var _slicedToArray = require(\"D:/Projects/rick-love-master/node_modules/@babel/runtime/helpers/slicedToArray\");\n\nvar duration = 0;\n\nvar ts2sec = function ts2sec(ts) {\n  var _ts$split = ts.split(':'),\n      _ts$split2 = _slicedToArray(_ts$split, 3),\n      h = _ts$split2[0],\n      m = _ts$split2[1],\n      s = _ts$split2[2];\n\n  return parseFloat(h) * 60 * 60 + parseFloat(m) * 60 + parseFloat(s);\n};\n\nmodule.exports = function (message, progress) {\n  if (typeof message === 'string') {\n    if (message.startsWith('  Duration')) {\n      var ts = message.split(', ')[0].split(': ')[1];\n      var d = ts2sec(ts);\n\n      if (duration === 0 || duration > d) {\n        duration = d;\n      }\n    } else if (message.startsWith('frame') || message.startsWith('size')) {\n      var _ts = message.split('time=')[1].split(' ')[0];\n      var t = ts2sec(_ts);\n      progress({\n        ratio: t / duration\n      });\n    } else if (message.startsWith('video:')) {\n      progress({\n        ratio: 1\n      });\n      duration = 0;\n    }\n  }\n};"],"sourceRoot":""}