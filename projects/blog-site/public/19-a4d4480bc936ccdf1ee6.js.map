{"version":3,"sources":["webpack:///D:/Projects/rick-love-master/code/code-training/lesson-server/client/lesson-api-client.ts","webpack:///D:/Projects/rick-love-master/code/code-training/lesson-player/lesson-module-player.tsx","webpack:///D:/Projects/rick-love-master/code/code-training/lesson-editor/lesson-modules-client-editor.tsx"],"names":["serverUrl","request","styles","container","background","containerPanel","editorModeTabRowView","flexDirection","paddingLeft","editorModeTabView","alignSelf","padding","marginRight","editorModeTabView_selected","editorModeTabText","fontSize","color","editorModeTabText_selected","buttonView","margin","buttonText","sectionHeaderText","infoView","infoText","wrap","lessonFieldView","lessonFieldLabelText","minWidth","lessonFieldText","flex","jsonText","getLessonNavigatorItems","module","lessons","flatMap","x","kind","lesson","label","title","map","key","LessonModulePlayer","props","useState","items","setItems","activeItem","setActiveItem","useEffect","newItems","nextStep","console","log","itemSteps","filter","activeItemStepIndex","findIndex","activeItemIndex","nextItem","setTimeout","style","undefined","onChange","data","onDone","setProjectState","navigatorStyles","itemView","alignItems","itemView_selected","itemText","itemText_selected","LessonModuleNavigator","onPress","item","apiClient","endpoint","a","webRequest","getLessonModules","getLessonModule","setLessonModule","deleteLessonModule","LessonModulesClientEditor","mode","setMode","modes","value","modules","setModules","activeModule","setActiveModule","useAutoLoadingError","loading","error","doWork","reloadModules","stopIfObsolete","result","projectState","selectedTabText","header","getKey","getLabel","selected","find","onSelect","onAdd","newItem","createDefaultLessonModule","justifyContent"],"mappings":"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","file":"19-a4d4480bc936ccdf1ee6.js","sourcesContent":["import { webRequest } from 'utils/web-request';\r\nimport { LessonServerApi } from '../lesson-api-types';\r\n\r\nexport const createLessonApiClient = ({\r\n    serverUrl = `http://localhost:3042/api/`,\r\n}: {\r\n    serverUrl?: string;\r\n}): LessonServerApi => {\r\n\r\n    const request = async <T, TResponse>(endpoint: string, data: T): Promise<TResponse> => {\r\n        return await webRequest(serverUrl, { endpoint, data });\r\n    };\r\n\r\n    const client: LessonServerApi = {\r\n        getLessonModules: async (data) => await request(`getLessonModules`, data),\r\n        getLessonModule: async (data) => await request(`getLessonModule`, data),\r\n        setLessonModule: async (data) => await request(`setLessonModule`, data),\r\n        deleteLessonModule: async (data) => await request(`deleteLessonModule`, data),\r\n        setProjectState: async (data) => await request(`setProjectState`, data),\r\n    };\r\n    return client;\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\nimport React, { useEffect, useState } from 'react';\r\nimport { View, Text, TextInput, TouchableOpacity } from 'react-native-lite';\r\nimport { LessonProjectFilesEditor, LessonProjectEditorMode, LessonFileEditorMode } from '../common/components/lesson-file-editor';\r\nimport { LessonData, LessonExperiment, LessonModule, LessonProjectFileSelection, LessonProjectState, LessonStep_ConstructCode, LessonStep_UnderstandCode } from '../common/lesson-types';\r\nimport { lessonExperiments_createReplacementProjectState, lessonExperiments_calculateProjectStateReplacements } from '../common/replacements';\r\nimport { LessonView_ConstructCode, LessonView_ExperimentCode, LessonView_UnderstandCode } from '../common/components/lesson-view';\r\nimport { LessonProjectStatePreview, LessonRenderView } from '../common/components/lesson-render-view';\r\n\r\nconst styles = {\r\n    container: {\r\n        background: `#111111`,\r\n    },\r\n    containerPanel: {\r\n        background: `#292a2d`,\r\n    },\r\n    editorModeTabRowView: {\r\n        flexDirection: `row`,\r\n        paddingLeft: 16,\r\n    },\r\n    editorModeTabView: {\r\n        background: `#1e1e1e`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        marginRight: 1,\r\n    },\r\n    editorModeTabView_selected: {\r\n        background: `#292a2d`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        marginRight: 1,\r\n    },\r\n    editorModeTabText: {\r\n        fontSize: 14,\r\n        color: `#FFFFFFF`,\r\n    },\r\n    editorModeTabText_selected: {\r\n        fontSize: 14,\r\n        color: `#FFFF88`,\r\n    },\r\n    buttonView: {\r\n        background: `#1e1e1e`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        margin: 1,\r\n    },\r\n    buttonText: {\r\n        fontSize: 14,\r\n        color: `#FFFFFFF`,\r\n    },\r\n    sectionHeaderText: {\r\n        margin: 8,\r\n        fontSize: 18,\r\n        color: `#FFFF88`,\r\n    },\r\n    infoView: {\r\n    },\r\n    infoText: {\r\n        margin: 8,\r\n        fontSize: 12,\r\n        wrap: `wrap`,\r\n    },\r\n    lessonFieldView: {\r\n        flexDirection: `row`,\r\n    },\r\n    lessonFieldLabelText: {\r\n        minWidth: 80,\r\n        padding: 4,\r\n        fontSize: 12,\r\n    },\r\n    lessonFieldText: {\r\n        flex: 1,\r\n        padding: 4,\r\n        fontSize: 12,\r\n        wrap: `wrap`,\r\n    },\r\n    jsonText: {\r\n        padding: 4,\r\n        fontSize: 12,\r\n        color: `#FFFFFF`,\r\n        background: `#000000`,\r\n    },\r\n} as const;\r\n\r\n\r\nconst getLessonNavigatorItems = (module: LessonModule) => {\r\n    const items = module.lessons.flatMap(x => [\r\n        { kind: `lesson` as const, lesson: x, label: x.title },\r\n        { kind: `construct` as const, lesson: x, label: `  📝 Construct the Code` },\r\n        { kind: `understand` as const, lesson: x, label: `  🔎 Understand the Code` },\r\n        { kind: `experiment` as const, lesson: x, label: `  🔬 Experiment with the Code` },\r\n    ]).map(x => ({ ...x, key: x.lesson.key + x.kind }));\r\n    return items;\r\n};\r\ntype NavigatorItem = ReturnType<typeof getLessonNavigatorItems>[0];\r\n\r\nexport const LessonModulePlayer = (props: { module: LessonModule, setProjectState: (projectState: LessonProjectState) => Promise<void> }) => {\r\n    const [items, setItems] = useState(getLessonNavigatorItems(props.module));\r\n    const [activeItem, setActiveItem] = useState(null as null | NavigatorItem);\r\n\r\n    useEffect(() => {\r\n        const newItems = getLessonNavigatorItems(props.module);\r\n        setItems(newItems);\r\n        nextStep();\r\n    }, [props.module]);\r\n\r\n    useEffect(() => {\r\n        if (activeItem?.kind === `lesson`) {\r\n            nextStep();\r\n        }\r\n    }, [activeItem]);\r\n\r\n    const nextStep = () => {\r\n        console.log(`LessonModulePlayer nextStep`, { activeItem });\r\n        if (!items) { return; }\r\n\r\n        const itemSteps = items.filter(x => x.kind !== `lesson`);\r\n        const activeItemStepIndex = itemSteps.findIndex(x => x.key === activeItem?.key);\r\n        const activeItemIndex = items.findIndex(x => x.key === activeItem?.key);\r\n        const nextItem = (activeItemStepIndex >= 0 ? itemSteps[activeItemStepIndex + 1] : null)\r\n            ?? (activeItemIndex >= 0 ? items[activeItemIndex + 1] : null)\r\n            ?? items[0];\r\n        setTimeout(() => {\r\n            setActiveItem(nextItem);\r\n        }, 1000);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <View style={styles.container}>\r\n                <LessonModuleNavigator items={items} activeItem={activeItem ?? undefined} onChange={x => setActiveItem(x)} />\r\n                <View key={activeItem?.key}>\r\n                    {activeItem?.kind === `construct` && (\r\n                        <LessonView_ConstructCode data={activeItem.lesson} onDone={nextStep} />\r\n                    )}\r\n                    {activeItem?.kind === `understand` && (\r\n                        <LessonView_UnderstandCode data={activeItem.lesson} onDone={nextStep} />\r\n                    )}\r\n                    {activeItem?.kind === `experiment` && (\r\n                        <LessonView_ExperimentCode data={activeItem.lesson} setProjectState={props.setProjectState} onDone={nextStep} />\r\n                    )}\r\n                </View>\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n\r\n\r\nconst navigatorStyles = {\r\n    container: {\r\n        flexDirection: `column`,\r\n    },\r\n    itemView: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n        background: `#1e1e1e`,\r\n        // alignSelf: `flex-start`,\r\n        padding: 4,\r\n        marginRight: 1,\r\n    },\r\n    itemView_selected: {\r\n        flexDirection: `row`,\r\n        alignItems: `center`,\r\n        background: `#292a2d`,\r\n        // alignSelf: `flex-start`,\r\n        padding: 4,\r\n        marginRight: 1,\r\n    },\r\n    itemText: {\r\n        fontSize: 14,\r\n    },\r\n    itemText_selected: {\r\n        fontSize: 14,\r\n        color: `#FFFF88`,\r\n    },\r\n    // headerTabView: {\r\n    //     flexDirection: `row`,\r\n    //     alignItems: `center`,\r\n    //     // background: `#1e1e1e`,\r\n    //     // alignSelf: `flex-start`,\r\n    //     padding: 4,\r\n    //     marginRight: 1,\r\n    // },\r\n    // headerTabText: {\r\n    //     fontSize: 14,\r\n    // },\r\n    // moveButtonView: {\r\n    //     minWidth: 24,\r\n    //     justifyContents: `center`,\r\n    //     alignItems: `center`,\r\n    // },\r\n} as const;\r\n\r\nexport const LessonModuleNavigator = (props: { items: NavigatorItem[], activeItem?: NavigatorItem, onChange: (value: NavigatorItem) => void }) => {\r\n    const { items, activeItem } = props;\r\n\r\n    const changeItem = (item: typeof items[0]) => {\r\n        props.onChange(item);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <View style={navigatorStyles.container}>\r\n                {items.map(x => (\r\n                    <TouchableOpacity key={x.key} onPress={() => changeItem(x)}>\r\n                        <View style={x.key === activeItem?.key ? navigatorStyles.itemView_selected : navigatorStyles.itemView}>\r\n                            <Text style={x.key === activeItem?.key ? navigatorStyles.itemText_selected : navigatorStyles.itemText}>{x.label}</Text>\r\n                        </View>\r\n                    </TouchableOpacity>\r\n                ))}\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n","/* eslint-disable react/no-array-index-key */\r\nimport React, { useEffect, useState } from 'react';\r\nimport { TouchableOpacity, View, Text, TextInput } from 'react-native-lite';\r\nimport { useAutoLoadingError } from 'utils-react/hooks';\r\nimport { ErrorBox } from 'controls-react/error-box';\r\nimport { Loading } from 'controls-react/loading';\r\nimport { LessonModulePlayer } from '../lesson-player/lesson-module-player';\r\nimport { LessonModuleMeta } from '../lesson-server/lesson-api-types';\r\nimport { createLessonApiClient } from '../lesson-server/client/lesson-api-client';\r\nimport { TabsComponent, TabsListEditorComponent } from '../common/components/tabs';\r\nimport { LessonData, LessonModule, LessonProjectState } from '../common/lesson-types';\r\nimport { createDefaultLesson, createDefaultLessonModule } from './lesson-defaults';\r\nimport { LessonEditor } from './lesson-editor';\r\nimport { LessonModuleEditor } from './lesson-module-editor';\r\n\r\n\r\nconst styles = {\r\n    container: {\r\n        background: `#111111`,\r\n    },\r\n    containerPanel: {\r\n        background: `#292a2d`,\r\n    },\r\n    buttonView: {\r\n        background: `#1e1e1e`,\r\n        alignSelf: `flex-start`,\r\n        padding: 8,\r\n        margin: 1,\r\n    },\r\n    buttonText: {\r\n        fontSize: 14,\r\n        color: `#FFFFFFF`,\r\n    },\r\n} as const;\r\n\r\nconst apiClient = createLessonApiClient({});\r\nexport const LessonModulesClientEditor = (props: {}) => {\r\n    const [mode, setMode] = useState(`edit` as 'edit' | 'play');\r\n    const modes = [\r\n        { value: `edit` as const, label: `Edit` },\r\n        { value: `play` as const, label: `Play` },\r\n    ];\r\n\r\n    const [modules, setModules] = useState(null as null | LessonModuleMeta[]);\r\n    const [activeModule, setActiveModule] = useState(null as null | LessonModule);\r\n    // const [mode, setMode] = useState(`lesson` as 'lesson' | 'json');\r\n\r\n    const { loading, error, doWork } = useAutoLoadingError();\r\n    const reloadModules = async (stopIfObsolete: () => void) => {\r\n        const result = await apiClient.getLessonModules({});\r\n        stopIfObsolete();\r\n        setModules(result.data);\r\n    };\r\n    useEffect(() => {\r\n        doWork(async (stopIfObsolete) => {\r\n            await reloadModules(stopIfObsolete);\r\n        });\r\n    }, []);\r\n\r\n    const loadModule = (key: string) => {\r\n        doWork(async (stopIfObsolete) => {\r\n            const result = await apiClient.getLessonModule({ key });\r\n            stopIfObsolete();\r\n\r\n            setActiveModule(result.data);\r\n        });\r\n    };\r\n\r\n    const onChangeModule = (value: LessonModule) => {\r\n        setActiveModule(value);\r\n    };\r\n    const onSaveModule = () => {\r\n        if (!activeModule) { return; }\r\n        doWork(async (stopIfObsolete) => {\r\n            const r2 = await apiClient.setLessonModule({ value: activeModule });\r\n            stopIfObsolete();\r\n        });\r\n    };\r\n\r\n    const onAddModule = () => {\r\n        const newItem = createDefaultLessonModule();\r\n        setActiveModule(newItem);\r\n\r\n        doWork(async (stopIfObsolete) => {\r\n            const r2 = await apiClient.setLessonModule({ value: newItem });\r\n            stopIfObsolete();\r\n\r\n            await reloadModules(stopIfObsolete);\r\n        });\r\n    };\r\n    const onDeleteModule = () => {\r\n        const key = activeModule?.key;\r\n        if (!key) { return; }\r\n\r\n        setActiveModule(null);\r\n        doWork(async (stopIfObsolete) => {\r\n            const r2 = await apiClient.deleteLessonModule({ key });\r\n            stopIfObsolete();\r\n\r\n            await reloadModules(stopIfObsolete);\r\n        });\r\n    };\r\n    const setProjectState = async (projectState: LessonProjectState) => {\r\n        await apiClient.setProjectState({ projectState });\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <Loading loading={loading} />\r\n            <ErrorBox error={error} />\r\n            <View style={styles.container}>\r\n                <TabsComponent\r\n                    style={{ selectedTabText: { color: `#8888FF` } }}\r\n                    header='Mode'\r\n                    items={modes}\r\n                    getKey={x => x.value}\r\n                    getLabel={x => x.label}\r\n                    selected={modes.find(x => x.value === mode)}\r\n                    onSelect={x => setMode(x.value)}\r\n                />\r\n                {modules && (\r\n                    <TabsComponent\r\n                        style={{ selectedTabText: { color: `#88FF88` } }}\r\n                        header='Modules'\r\n                        items={modules}\r\n                        getKey={x => x.key}\r\n                        getLabel={x => x.title}\r\n                        selected={modules?.find(x => x.key === activeModule?.key)}\r\n                        onSelect={x => loadModule(x.key)}\r\n                        onAdd={mode === `edit` ? onAddModule : undefined}\r\n                    />\r\n                )}\r\n                {activeModule && mode === `edit` && (\r\n                    <>\r\n                        <View style={{ flexDirection: `row`, justifyContent: `flex-end` }}>\r\n                            <TouchableOpacity onPress={onSaveModule}>\r\n                                <View style={styles.buttonView}>\r\n                                    <Text style={styles.buttonText}>{`${`💾`} Save Module`}</Text>\r\n                                </View>\r\n                            </TouchableOpacity>\r\n                            <TouchableOpacity onPress={onDeleteModule}>\r\n                                <View style={styles.buttonView}>\r\n                                    <Text style={styles.buttonText}>{`${`❌`} Delete Module`}</Text>\r\n                                </View>\r\n                            </TouchableOpacity>\r\n                        </View>\r\n                        <LessonModuleEditor key={activeModule.key} value={activeModule} onChange={onChangeModule} setProjectState={setProjectState} />\r\n                    </>\r\n                )}\r\n                {activeModule && mode === `play` && (\r\n                    <>\r\n                        <LessonModulePlayer key={activeModule.key} module={activeModule} setProjectState={setProjectState} />\r\n                    </>\r\n                )}\r\n            </View>\r\n        </>\r\n    );\r\n};\r\n"],"sourceRoot":""}