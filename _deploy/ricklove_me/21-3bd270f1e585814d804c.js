(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[21],{F8Jo:function(e,t,n){"use strict";n.r(t),n.d(t,"art_fluidSnakeGame",(function(){return D}));var i=n("VtSi"),r=n.n(i),o=(n("3yYM"),n("QsI/")),a=n("hTyw"),s={add:function(e,t){return{x:e.x+t.x,y:e.y+t.y}},subtract:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},divide:function(e,t){return{x:e.x/t.x,y:e.y/t.y}},scale:function(e,t){return{x:e*t.x,y:e*t.y}},lengthSq:function(e){return e.x*e.x+e.y*e.y},distanceSq:function(e,t){return s.lengthSq(s.subtract(e,t))},equal:function(e,t,n){return void 0===n&&(n=1e-4),s.distanceSq(e,t)<=n}},u=function(e,t,n){return void 0===n&&(n=1),Math.abs(e.position.x-t.position.x)<.5*n*(e.size.x+t.size.x)&&Math.abs(e.position.y-t.position.y)<.5*n*(e.size.y+t.size.y)};function c(e){var t=window.devicePixelRatio||1;return Math.floor(e*t)}var l=function(e){var t=[],n=[],i=function(t,n){var i=null!=n?n:e.getBoundingClientRect(),r={x:t.clientX-i.left,y:t.clientY-i.top};return{x:c(r.x)/e.width,y:1-c(r.y)/e.height}};return{windowAddEventListener:function(e,n,i){return t.push({name:e,handler:n}),window.addEventListener(e,n,i)},canvasAddEventListener:function(t,i,r){return e?(n.push({name:t,handler:i}),e.addEventListener(t,i,r)):null},tools:{getMouseGamePosition:function(e){return i(e)},getTouchPositions:function(t){for(var n=e.getBoundingClientRect(),r=[],o=t.touches,a=0;a<o.length;a++){var s=o.item(a);s&&r.push(i(s,n))}return r}},destroy:function(){t.forEach((function(e){var t=e.name,n=e.handler;window.removeEventListener(t,n)})),n.forEach((function(t){var n=t.name,i=t.handler;e.removeEventListener(n,i)}))}}},d=function(e,t,n){if(console.log("createDebugGameView",{game:e,gameCanvas:t}),!e.debugRenderer)return null;var i=null,r=function(){return i||(i=function(){var n;if(!e.debugRenderer)return null;var i=document.createElement("canvas");null===(n=t.parentElement)||void 0===n||n.appendChild(i),i.style.pointerEvents="none",i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.opacity="0.5";var r=i.getContext("2d");if(!r)throw new Error("createDebugCanvas: Could not get context");var o=function(e,t){var n=function(e){return e?"string"==typeof e?e:"rgb("+e.r+","+e.g+","+e.b+")":"#00FF00"},i=function(e){var n=t();return{x:e.x*n.width,y:(1-e.y)*n.height}},r=function(e){var n=t();return{x:e.x*n.width,y:e.y*n.height}},o={drawX:function(t,o,a){var s=i(t),u=o?r(o):void 0;e.strokeStyle=n(a);var c=u?{x:u.x/2,y:u.y/2}:{x:2,y:2};e.beginPath(),e.moveTo(s.x-c.x,s.y-c.y),e.lineTo(s.x+c.x,s.y+c.y),e.moveTo(s.x-c.x,s.y+c.y),e.lineTo(s.x+c.x,s.y-c.y),e.stroke()},drawBox:function(t,o,a){var s=i(t),u=o?r(o):void 0;e.strokeStyle=n(a);var c=u?{x:u.x/2,y:u.y/2}:{x:2,y:2};e.beginPath(),e.moveTo(s.x-c.x,s.y-c.y),e.lineTo(s.x-c.x,s.y+c.y),e.lineTo(s.x+c.x,s.y+c.y),e.lineTo(s.x+c.x,s.y-c.y),e.lineTo(s.x-c.x,s.y-c.y),e.stroke()},drawArrow:function(t,r,a){var s=i(t),u=i(r);e.strokeStyle=n(a),e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(u.x,u.y),e.stroke(),o.drawX(r,{x:.01,y:.01},a)},drawLabel:function(t,r,o){var a=i(t);e.fillStyle="#000000",e.fillRect(a.x,a.y-24,8*r.length,32),e.fillStyle=n(o),e.beginPath(),e.font="14px monospace",e.fillText(r,a.x,a.y)}};return o}(r,(function(){return{width:i.width,height:i.height}})),a=e.debugRenderer(o,r,i),s={frameLast:{time:Date.now(),updateFrameTick:0,renderFrameTick:0},frame125:{time:Date.now(),updateFrameTick:0,renderFrameTick:0},frame250:{time:Date.now(),updateFrameTick:0,renderFrameTick:0}};return{isVisible:!1,canvas:i,context:r,tools:o,renderArgs:a,statsState:s,autoResizeCanvas:function(){var e=c(t.clientWidth),n=c(t.clientHeight);return(i.width!==e||i.height!==n)&&(i.width=e,i.height=n,!0)}}}()),i};return n.windowAddEventListener("keydown",(function(e){var t=r();t&&"t"===e.key&&(t.isVisible=!t.isVisible,t.canvas.style.opacity=t.isVisible?"0.5":"0")})),{render:function(e,t){if(i){var n=r();if(n&&n.isVisible){var o=n.canvas,a=n.context,s=n.tools,u=n.renderArgs,c=n.statsState,l=n.autoResizeCanvas;Date.now()>c.frame250.time+250&&(c.frame250=c.frame125),Date.now()>c.frame125.time+125&&(c.frame125=c.frameLast),c.frameLast={time:Date.now(),renderFrameTick:t.renderFrameTick,updateFrameTick:t.updateFrameTick},l(),a.beginPath(),a.fillStyle="#00000010",a.fillRect(0,0,o.width,o.height),s.drawBox({x:.5,y:.5},{x:.1,y:.1},"#00FF008"),e.render(u);var d=c.frame125,m=c.frame250;s.drawLabel({x:0,y:.1},"render fps: "+(1e3*(d.renderFrameTick-m.renderFrameTick)/(d.time-m.time)).toFixed(1).padStart(8," ")),s.drawLabel({x:0,y:.2},"update fps: "+(1e3*(d.updateFrameTick-m.updateFrameTick)/(d.time-m.time)).toFixed(1).padStart(8," "))}}},destroy:function(){i&&i.canvas.remove()}}},m=n("fGyu");function y(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var f,p,g={name:"Snake",createGame:function(e,t){var n=!1,i={environment:{time:0,timeLast:e.now(),timeMsStart:e.now(),timeDelta:0,tick:0,size:{x:600,y:600},gridSize:{x:16,y:9}},input:{u:!1,d:!1,l:!1,r:!1,pointer:null,lastTime:-1e3},player:{id:42,position:{x:.5,y:.5},targetGridPosition:{x:10,y:10},targetPosition:{x:.5,y:.5},velocity:{x:0,y:0},size:{x:.01,y:.01},sizeInit:{x:.01,y:.01},color:{r:1,g:1,b:1},color1:{r:1,g:1,b:1},color2:{r:1,g:1,b:1},color2Stength:.5,segments:[]},playerState:{deadAtTime:null,restartAtTime:null,wasHitThisFrame:!1,ateThisFrame:!1,wasThisFrameOnBeat:!1,beatIndex:0,timeNextTurn:0,nextDirection:{x:1,y:0}},food:[],foodState:{}},r=function(e){return s.divide(s.add(e,{x:.5,y:.5}),s.add(i.environment.gridSize,{x:1,y:1}))},o=function(e){var t=Object.assign({},e),n=i.environment.gridSize;return t.x<0&&(t.x=0),t.y<0&&(t.y=0),t.x>n.x&&(t.x=n.x),t.y>n.y&&(t.y=n.y),t},a=function(){var e,t=i.player,n=null!==(e=t.segments[t.segments.length-1])&&void 0!==e?e:t;t.segments.push({id:1e3+t.segments.length,isStill:!1,color:Object.assign({},t.color),position:Object.assign({},n.position),velocity:Object.assign({},n.velocity),size:Object.assign({},n.size),targetPosition:s.add(Object.assign({},n.targetPosition),{x:.001,y:0})});t.size=s.scale(1.01,t.size),t.segments.forEach((function(e){e.size=s.scale(1.01,e.size)}))},c=function(){var e=i.player,t=i.playerState,n=i.input,a=i.environment,u=a.time,c=a.timeDelta;a.size;e.color2Stength+=1*c,e.color2Stength>1&&(e.color1=e.color2,e.color2={r:.5*Math.random(),g:.5*Math.random(),b:.5*Math.random()},e.color2Stength=0);var l=e.color2Stength;e.color={r:(1-l)*e.color1.r+l*e.color2.r,g:(1-l)*e.color1.g+l*e.color2.g,b:(1-l)*e.color1.b+l*e.color2.b},n.l&&(t.nextDirection={x:-1,y:0}),n.r&&(t.nextDirection={x:1,y:0}),n.u&&(t.nextDirection={x:0,y:1}),n.d&&(t.nextDirection={x:0,y:-1});var d=3*Math.pow(1.01,e.segments.length),m=1/d;if(u>t.timeNextTurn){t.timeNextTurn=u+m,t.wasThisFrameOnBeat=!0;for(var v=e.segments.length-1;v>=0;v--){var f,p;e.segments[v].targetPosition=null!==(f=null===(p=e.segments[v-1])||void 0===p?void 0:p.targetPosition)&&void 0!==f?f:e.targetPosition;var g=s.subtract(e.segments[v].targetPosition,e.segments[v].position);e.segments[v].velocity={x:g.x*d,y:g.y*d}}!function(){var e=i.player,t=i.playerState,n=(i.input,i.environment),a=n.time;n.timeDelta,n.size;if(!(a<i.input.lastTime+15)){var u=i.food[0];if(u){var c=s.subtract(u.position,e.position),l=r(s.add(e.targetGridPosition,t.nextDirection)),d=t.nextDirection,m={x:t.nextDirection.y,y:t.nextDirection.x},y={x:-t.nextDirection.y,y:-t.nextDirection.x},v=r(s.add(e.targetGridPosition,m)),f=r(s.add(e.targetGridPosition,y)),p=s.subtract(u.position,l);if(!(s.lengthSq(p)<s.lengthSq(c))&&Math.random()<.75){var g=s.subtract(u.position,v),x=s.subtract(u.position,f);s.lengthSq(g)<s.lengthSq(x)?t.nextDirection=m:t.nextDirection=y}var b=!s.equal(v,o(v)),h=!s.equal(f,o(f)),w=b||e.segments.some((function(e){return s.equal(e.targetPosition,v)})),A=h||e.segments.some((function(e){return s.equal(e.targetPosition,f)}));w&&A?t.nextDirection=d:w?t.nextDirection=y:A&&(t.nextDirection=m)}}}(),e.targetGridPosition=t.deadAtTime?e.targetGridPosition:s.add(e.targetGridPosition,t.nextDirection),e.targetGridPosition=o(e.targetGridPosition),e.targetPosition=r(e.targetGridPosition);var x=s.subtract(e.targetPosition,e.position);e.velocity={x:x.x*d,y:x.y*d}}var b=s.scale(.2,s.subtract(e.targetPosition,e.position));e.position.x+=b.x,e.position.y+=b.y;for(var h,w=y(e.segments);!(h=w()).done;){var A=h.value;A.position.x+=c*A.velocity.x,A.position.y+=c*A.velocity.y}for(var T,D=y(e.segments);!(T=D()).done;){var F=T.value;if(s.distanceSq(F.targetPosition,e.targetPosition)<=0){i.playerState.wasHitThisFrame=!0,i.playerState.deadAtTime=u;break}}i.playerState.deadAtTime&&!i.playerState.restartAtTime&&(e.segments.every((function(t){return s.distanceSq(t.targetPosition,e.targetPosition)<=.01}))&&(t.restartAtTime=u+3));i.playerState.restartAtTime&&u>i.playerState.restartAtTime&&(e.segments=[],t.deadAtTime=null,t.restartAtTime=null,e.size=Object.assign({},e.sizeInit))};return{setup:function(t){!function(t){var n=t.windowAddEventListener,r=t.canvasAddEventListener,o=t.tools;n("keydown",(function(e){"w"!==e.key&&"ArrowUp"!==e.key||(i.input.u=!0,i.input.lastTime=i.environment.time),"a"!==e.key&&"ArrowLeft"!==e.key||(i.input.l=!0,i.input.lastTime=i.environment.time),"s"!==e.key&&"ArrowDown"!==e.key||(i.input.d=!0,i.input.lastTime=i.environment.time),"d"!==e.key&&"ArrowRight"!==e.key||(i.input.r=!0,i.input.lastTime=i.environment.time)})),n("keyup",(function(e){"w"!==e.key&&"ArrowUp"!==e.key||(i.input.u=!1,i.input.lastTime=i.environment.time),"a"!==e.key&&"ArrowLeft"!==e.key||(i.input.l=!1,i.input.lastTime=i.environment.time),"s"!==e.key&&"ArrowDown"!==e.key||(i.input.d=!1,i.input.lastTime=i.environment.time),"d"!==e.key&&"ArrowRight"!==e.key||(i.input.r=!1,i.input.lastTime=i.environment.time)}));var a=function(t){i.input.pointer={position:t,timeMs:e.now()}};r("mousedown",(function(e){a(o.getMouseGamePosition(e))})),r("mousemove",(function(t){!i.input.pointer||e.now()>i.input.pointer.timeMs+1e3||a(o.getMouseGamePosition(t))})),r("touchstart",(function(e){return a(o.getTouchPositions(e)[0]),e.preventDefault(),!1})),r("touchmove",(function(e){return a(o.getTouchPositions(e)[0]),e.preventDefault(),!1}),!1)}(t)},update:function(){if(n)console.error("game.update DESTROYED",{});else if(e.isPaused())console.log("game.update timeProvider.PAUSED",{});else{var r=t.getDisplaySize();i.environment.size={x:r.width,y:r.height},i.environment.timeLast=i.environment.time,i.environment.time=.001*(e.now()-i.environment.timeMsStart),i.environment.timeDelta=Math.max(.008,i.environment.time-i.environment.timeLast),i.playerState.ateThisFrame=!1,i.playerState.wasHitThisFrame=!1,i.playerState.wasThisFrameOnBeat=!1,c(),function(){var e=i.player,t=i.food,n=(i.foodState,i.environment),r=(n.time,n.timeDelta,s.divide({x:1,y:1},i.environment.gridSize));t.length<=0&&t.push({id:1e4+t.length,color:e.color,isStill:!0,position:{x:.1+.8*Math.random(),y:.1+.8*Math.random()},size:r,velocity:{x:0,y:0}});for(var o,c=y(t.entries());!(o=c()).done;){var l=o.value,d=l[0],m=l[1];if(u(m,e,.8)){i.playerState.ateThisFrame=!0,a(),t.splice(d,1);break}}}();for(var o=t.getDisplaySize(),l=0,d=[i.player].concat(Object(m.a)(i.food));l<d.length;l++){var v=d[l];v.size.y=v.size.x*o.width/o.height}i.environment.tick++}},render:function(e){var t=i.player,n=i.playerState,r=i.food;e.renderEntity({id:t.id,kind:"player",position:t.position,velocity:t.velocity,size:t.size,color:t.color}),n.ateThisFrame&&e.onPlayerReward({position:t.segments[t.segments.length-1].position}),n.wasHitThisFrame&&e.onPlayerHit({position:t.position}),n.wasThisFrameOnBeat&&(e.onBeat({beatIndex:n.beatIndex,positions:[t.position].concat(Object(m.a)(t.segments.map((function(e){return e.position})).filter((function(e){return!s.equal(e,t.position)}))))}),n.beatIndex++);for(var o,a=y(t.segments);!(o=a()).done;){var u=o.value;e.renderEntity({id:u.id,kind:"obstacle",position:u.position,velocity:u.velocity,size:u.size,color:u.color})}for(var c,l=y(r);!(c=l()).done;){var d=c.value;d.position.x<-.25||d.position.x>1.25||d.position.y<-.25||d.position.y>1.25?e.removeEntity(d.id):d.isStill?e.renderEntity({id:d.id,kind:"obstacle-still",position:d.position,velocity:{x:0,y:0},size:d.size,color:d.color}):e.renderEntity({id:d.id,kind:"obstacle",position:d.position,velocity:d.velocity,size:d.size,color:d.color})}},destroy:function(){n=!0}}},debugRenderer:function(e){return{onPlayerHit:function(t){e.drawX(t.position,{x:.1,y:.1},"#FF0000")},onPlayerReward:function(t){e.drawX(t.position,{x:.1,y:.1},"#0000FF")},onBeat:function(t){t.positions.forEach((function(t){e.drawX(t,{x:.1,y:.1},"#00FFFF")}))},renderEntity:function(t){e.drawBox(t.position,t.size,"player"===t.kind?"#0000FF":void 0),e.drawArrow(t.position,s.add(t.position,t.velocity),"player"===t.kind?"#0000FF":void 0)},removeEntity:function(e){},setBackgroundVelocity:function(t){e.drawArrow({x:.5,y:.5},s.add({x:.5,y:.5},t.velocity),"#FFFF00")}}}},x=n("4cHy"),b=(f="\nC0        16.35                 \nC#0/Db0   17.32                         \nD0        18.35                 \nD#0/Eb0   19.45                         \nE0        20.60                 \nF0        21.83                 \nF#0/Gb0   23.12                         \nG0        24.50                 \nG#0/Ab0   25.96                         \nA0        27.50                 \nA#0/Bb0   29.14                         \nB0        30.87                 \nC1        32.70                 \nC#1/Db1   34.65                         \nD1        36.71                 \nD#1/Eb1   38.89                         \nE1        41.20                 \nF1        43.65                 \nF#1/Gb1   46.25                         \nG1        49.00                 \nG#1/Ab1   51.91                         \nA1        55.00                 \nA#1/Bb1   58.27                         \nB1        61.74                 \nC2        65.41                 \nC#2/Db2   69.30                         \nD2        73.42                 \nD#2/Eb2   77.78                         \nE2        82.41                 \nF2        87.31                 \nF#2/Gb2   92.50                         \nG2        98.00                 \nG#2/Ab2   103.83                         \nA2        110.00                 \nA#2/Bb2   116.54                         \nB2        123.47                 \nC3        130.81                 \nC#3/Db3   138.59                         \nD3        146.83                 \nD#3/Eb3   155.56                         \nE3        164.81                 \nF3        174.61                 \nF#3/Gb3   185.00                         \nG3        196.00                 \nG#3/Ab3   207.65                         \nA3        220.00                 \nA#3/Bb3   233.08                         \nB3        246.94                 \nC4        261.63                 \nC#4/Db4   277.18                         \nD4        293.66                 \nD#4/Eb4   311.13                         \nE4        329.63                 \nF4        349.23                 \nF#4/Gb4   369.99                         \nG4        392.00                 \nG#4/Ab4   415.30                         \nA4        440.00                 \nA#4/Bb4   466.16                         \nB4        493.88                 \nC5        523.25                 \nC#5/Db5   554.37                         \nD5        587.33                 \nD#5/Eb5   622.25                         \nE5        659.25                 \nF5        698.46                 \nF#5/Gb5   739.99                         \nG5        783.99                 \nG#5/Ab5   830.61                         \nA5        880.00                 \nA#5/Bb5   932.33                         \nB5        987.77                 \nC6        1046.50                 \nC#6/Db6   1108.73                         \nD6        1174.66                 \nD#6/Eb6   1244.51                         \nE6        1318.51                 \nF6        1396.91                 \nF#6/Gb6   1479.98                         \nG6        1567.98                 \nG#6/Ab6   1661.22                         \nA6        1760.00                 \nA#6/Bb6   1864.66                         \nB6        1975.53                 \nC7        2093.00                 \nC#7/Db7   2217.46                         \nD7        2349.32                 \nD#7/Eb7   2489.02                         \nE7        2637.02                 \nF7        2793.83                 \nF#7/Gb7   2959.96                         \nG7        3135.96                 \nG#7/Ab7   3322.44                         \nA7        3520.00                 \nA#7/Bb7   3729.31                         \nB7        3951.07                 \nC8        4186.01                 \nC#8/Db8   4434.92                         \nD8        4698.63                 \nD#8/Eb8   4978.03                         \nE8        5274.04                 \nF8        5587.65                 \nF#8/Gb8   5919.91                         \nG8        6271.93                 \nG#8/Ab8   6644.88                         \nA8        7040.00                 \nA#8/Bb8   7458.62                         \nB8        7902.13                 \n".split("\n").filter((function(e){return e})).map((function(e){var t=e.split(" ").filter((function(e){return e})),n=t[0],i=t[1];return{notes:n.split("/").filter((function(e){return e})).map((function(e){return e})),frequency:parseFloat(i)}})),p=new Map,f.forEach((function(e){return e.notes.forEach((function(t){return p.set(t,e.frequency)}))})),p);function h(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var A=function(e){var t=function(){try{return new(window.AudioContext||window.webkitAudioContext)}catch(e){return console.error("The Web Audio API is apparently not supported in this browser."),null}}();if(!t)return null;var n,i=t.createDynamicsCompressor?((n=t.createDynamicsCompressor()).connect(t.destination),n):t.destination,r=t.createBiquadFilter();r.Q.value=1,r.type="lowpass",r.frequency.value=.5*t.sampleRate,r.connect(i);var o=t.createGain();o.gain.value=.7,o.connect(r);var a=o;return{audioContext:t,voices:Object(m.a)(new Array(e)).map((function(){return function(){var e=t.createOscillator();e.frequency.value=0;var n=t.createGain();n.gain.value=0;var i=t.createBiquadFilter();i.Q.value=1,i.type="bandpass";return e.connect(i),i.connect(n),n.connect(a),{oscNode:e,filterNode:i,gainNode:n}}()}))}},T=function(){var e=function(e){return e.replace(/\s/g," ").split(" ").filter((function(e){return e})).map((function(e){return t=e,b.has(t)?b.get(t):0;var t}))},t=e("\n    A2 A2 A2 .\n    A2 A2 A2 A4\n    "),n=e("\n    C2 D2 E2 G2\n    D2 E2 G2 A2\n    E2 G2 A2 C3\n    "),i=(e("\n    C2 E2 D2 G2\n    E2 A2 G2 C3\n    A2 D3 C3 E3\n\n    D3 G3 E3 A3 \n    G3 C4 A3 D4 \n    C4 .  .  .\n    "),e("\n    C4 A3 G3 E3\n    A3 G3 E3 .\n    G3 E3 D3 C3\n    E3 D3 C3 .\n    D3 C3 A2 G2\n    C3 A2 G2 .\n    A2 G2 E2 D2\n    G2 E2 D2 .\n    ")),r=function(){if(Math.random()<.25){var r="CDEGACDEGA.".split(""),o=Object(x.b)([2,3]),a=Object(m.a)(new Array(4*(2+Math.floor(4*Math.random())))).map((function(){return""+Object(x.b)(r)+o+" "})).join("");return e(a.substr(1)+"C"+(o+1))}return Object(x.b)([t,n,i])},o={audio:null,isStarted:!1,iBeat:0,timePerBeat:.25,timeLastBeat:0,positions:[],shape:null,songs:[r()]},a=function(e,t,n,i){var r,a=o.audio;if(a&&0!==o.positions.length){var s=a.audioContext.currentTime+n,u=null!==(r=o.songs[e][t])&&void 0!==r?r:0;if(a.voices[e].oscNode.frequency.setValueAtTime(u,s),a.voices[e].filterNode.frequency.setValueAtTime(u,s),u){var c=s+.01*i,l=c+.1*i,d=l+i,m=d+.1*i;a.voices[e].gainNode.gain.setValueAtTime(0,c),a.voices[e].gainNode.gain.linearRampToValueAtTime(1,l),a.voices[e].gainNode.gain.setValueAtTime(1,d),a.voices[e].gainNode.gain.linearRampToValueAtTime(0,m)}}};return{start:function(){var e;o.isStarted||(o.isStarted=!0,o.audio=A(2),null===(e=o.audio)||void 0===e||e.voices.forEach((function(e){return e.oscNode.start(0)})))},beat:function(e){if(o.audio&&o.isStarted){o.timePerBeat=o.audio.audioContext.currentTime-o.timeLastBeat,o.timeLastBeat=o.audio.audioContext.currentTime;if(e.beatIndex%4==0){o.iBeat+=4,o.positions=e.positions;for(var t=o.audio.voices.length,n=function(n){if(n>=o.positions.length)return"continue";(!o.songs[n]||e.beatIndex%o.songs[n].length==0&&Math.random()<.15)&&(o.songs[n]=r(),o.iBeat=0);var i=o.positions.filter((function(e,i){return i%t===n}));!function(e,t){var n=o.audio;if(n&&0!==t.length){console.log("updateWaveform",{iVoice:e,positions:t});var i=new Float32Array(2+t.length),r=new Float32Array(2+t.length);i[0]=0,r[0]=0,i[t.length-1]=1,r[t.length-1]=0;for(var a,s=h(t.entries());!(a=s()).done;){var u=a.value,c=u[0],l=u[1];i[c+1]=l.x,r[c+1]=l.y}var d=n.audioContext.createPeriodicWave(i,r,{disableNormalization:!0});n.voices[e].oscNode.setPeriodicWave(d)}}(n,i);for(var s=0;s<4;s++){var u=o.timePerBeat/Math.min(1+o.positions.length,o.audio.voices.length);a(n,(o.iBeat+s)%o.songs[n].length,s*o.timePerBeat+n*u,u)}},i=0;i<t;i++)n(i)}}}}},D={key:"fluid-snake-game",title:"Fluid Snake Game",description:"Snake with Fluid Simulator Renderer and Procedural Music\nMusic is procedurally generated using waveforms shaped like the snake's current body and position.\nFluid Renderer is based on Fluid Simulator by Pavel Dobryakov: https://paveldogreat.github.io/WebGL-Fluid-Simulation/",artist:"Rick Love",getTokenDescription:function(e){return null},renderArt:function(e,t,n){var i,s=Object(a.a)(e,"/content/art/artwork/example-PavelDoGreat-fluid-simulation/src",{width:"100%",height:"100%"},{disableGui:!0,disableInput:!0,disableStartupSplats:!0,timeProvider:null==n?void 0:n.timeProvider});if(!s)return{remove:function(){}};var u=null!==(i=null==n?void 0:n.timeProvider)&&void 0!==i?i:{now:function(){return Date.now()},isPaused:function(){return!1}},c=l(s.canvas),m=g,y=m.createGame(u,{getDisplaySize:function(){return{width:s.canvas.width,height:s.canvas.height}}});y.setup(c);var v=T();c.canvasAddEventListener("touchdown",(function(){v.start()})),c.canvasAddEventListener("mousedown",(function(){v.start()})),c.canvasAddEventListener("keydown",(function(){v.start()}));var f=d(m,s.canvas,c),p=s.config;p&&(p.COLORFUL=!1,p.CURL=10);var x={resetBloomAtTimeMs:0,darkenAtTimeMs:0,darkenUntilTimeMs:0},b=0,h=!1,w=function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!h){e.next=2;break}return e.abrupt("return");case 2:if(u.isPaused()||(t=void 0,i=void 0,r=void 0,p.BLOOM_INTENSITY=(t=.001*(x.resetBloomAtTimeMs-u.now()),r=2,t<(i=0)?i:t>r?r:t),p.SUNRAYS_WEIGHT=u.now()>x.darkenAtTimeMs&&u.now()<x.darkenUntilTimeMs?0:1,y.update(),null==f||f.render(y,{updateFrameTick:b,renderFrameTick:s.getFrameTick()}),y.render({onPlayerHit:function(){x.resetBloomAtTimeMs=u.now()+3e3},onPlayerReward:function(e){x.resetBloomAtTimeMs=u.now()+500},onBeat:function(e){v.beat(e),e.beatIndex%4==3&&(x.darkenAtTimeMs=u.now()+0,x.darkenUntilTimeMs=u.now()+50)},renderEntity:function(e){s.splat(e.id,!0,e.position.x,e.position.y,5e-4*e.velocity.x,5e-4*e.velocity.y,{x:e.size.x*(e.kind,4),y:e.size.y*(e.kind,4)},{r:.06*e.color.r,g:.06*e.color.g,b:.06*e.color.b})},removeEntity:function(e){s.splat(e,!1,0,0,0,0)},setBackgroundVelocity:function(e){p.MOTION_X=e.velocity.x,p.MOTION_Y=e.velocity.y}}),b++),null==n||!n.isWaitingForFrame()){e.next=7;break}return console.log("game.update waitingForFrame - addFrame",{}),e.next=7,n.getRecorder().addFrame(s.canvas);case 7:return e.abrupt("return",requestAnimationFrame((function(){w()})));case 8:case"end":return e.stop()}var t,i,r}),e)})));return function(){return e.apply(this,arguments)}}();return setTimeout((function(){Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w();case 2:case"end":return e.stop()}}),e)})))(),s.start()}),250),{remove:function(){h=!0,c.destroy(),y.destroy(),null==f||f.destroy(),null==s||s.close()}}}}}}]);
//# sourceMappingURL=21-3bd270f1e585814d804c.js.map